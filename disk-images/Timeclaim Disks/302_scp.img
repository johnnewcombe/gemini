ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(UHTOV2)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                          /*					*/
uhtov2(td,mode,deflt,swtch)     /* Set up tape descriptor from switches	*/
struct	_tpdesc	*td;		/* Target tape descriptor		*/
BYTE	mode;			/* Open mode of tape			*/
BOOLEAN	deflt;			/* Take default if none specified Y/N	*/
struct	_sw	*swtch;		/* Switch names and values		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	TDES tape descriptor init
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
         Commentary amended - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
01/07/88 ICFO - If BS swtich has no value it is requested without
         an error message
29/10/87 ICFO - Switch names and values passed as arguments and whole
         thing made into an overlay
         This used to be SETBLK
28/10/87 ICFO - Messages are now different for INPUT and OUTPUT concerning
         short blocks
14/04/87 DAR - Created
*/

{

/************************************************************************/
/*									*/
/* This overlay handles switches:- BT (Block Type)			*/
/*				   BS (Block Size)			*/
/*				   SH (Short Block)			*/
/*									*/
/************************************************************************/

LOCAL
WORD	index,		/* Index into switch value array		*/
	n,		/* Used in number length calculations		*/
	c;		/* Character input from 'getkey'		*/

LOCAL
BYTE	gstring[10];	/* Byte array used for number entry		*/

LOCAL
BOOLEAN	kcalc,		/* Calc blocksize in Kb (TRUE) or bytes (FALSE)	*/
	defined;	/* Is an item defined or not			*/

VOID	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Get type of block used						*/
if ((index = fndswt(swtch->swtot,swtch->swnames,"BT")) != FAIL)
			    td->bktype = toupper(*(swtch->swvals[index]));

else if (deflt == TRUE)  td->bktype = 'F';

/* Not specified or invalid so ask operator				*/
while (td->bktype != 'F' && td->bktype != 'V') {

/* "enter block type 'F' or 'V'"					*/
    tpchat(0,1,2,23,0,swtch);
    if ((td->bktype = toupper(getkey())) == ESC)  return(FAIL);

/* RET enters default of 'F'						*/
    if (td->bktype == 13)  td->bktype = 'F';
}

/* Get block size							*/
defined = FALSE;
if ((index = fndswt(swtch->swtot,swtch->swnames,"BS")) != FAIL) {
    if (*(swtch->swvals[index]) != NULL) {
	td->bksize = gtkbnm(swtch->swvals[index]);
	if (td->bksize > MAXBKSIееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееZE)  tperr(9);
	if (td->bksize < MINBKSIZE)  tperr(31);
	if (td->bksize >= MINBKSIZE && td->bksize <= MAXBKSIZE)
    							   defined = TRUE;
    }
}

else if (deflt == TRUE) {
    td->bksize = DEFBKSIZE;
    defined = TRUE;
}

/* While blocksize undefined or invalid ask operator for size		*/
while (defined == FALSE) {

/* Get size of max block number ready for answer box			*/
    n = numlen(MAXBKSIZE);

/* Enter blocksize							*/
    if (td->bktype == 'F')  tpchat(0,3,5,23,n,swtch);	/* Fixed size	*/
    else		    tpchat(0,4,5,23,n,swtch);	/* Max size	*/

/* Enter a number							*/
    if (lgetlin(gstring,++n))  return(FAIL);

/* Take default on RET only						*/
    if (gstring[0] == 0)  td->bksize = 80;

/* Translate number that might contain a 'K' char in it			*/
    else td->bksize = gtkbnm(gstring);
    if (td->bksize > MAXBKSIZE)  tperr(9);
    if (td->bksize < MINBKSIZE)  tperr(31);
    if (td->bksize >= MINBKSIZE && td->bksize <= MAXBKSIZE)
							   defined = TRUE;
}

/* Are short blocks allowed if fixed length blocks in use		*/

if (td->bktype == 'F') {
    td->short_block = -1;	/* Prime flag to silly value		*/

/* Is definition in the switches					*/
    if ((index = fndswt(swtch->swtot,swtch->swnames,"SH")) != FAIL)
						   td->short_block = TRUE;

/* .. no so is it a default def						*/
    else if (deflt == TRUE)  td->short_block = FALSE;

/* .. no so get it from the operator					*/
    if (td->short_block == -1) {
	if (mode == 'W') tpchat(0,28,7,23,0,swtch);	/* Short blk ...*/
	else		 tpchat(0,6,7,23,0,swtch);	/* ... allowed?	*/

/* Default is no							*/
	if ((c = getkey()) == ESC)  return(FAIL);
	td->short_block = (BOOLEAN) (toupper(c) == 'Y');
    }
}

return(SUCCESS);

}

/*======================================================================*/
block = FALSE;

/* .. no so get it from the operator					*/
    if (td->short_block == -1) {
	if (mode == 'W') tpchat(0,28,7ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееGTAPE   H     "              UHT     OV8                  UHINIФ  C                    UHT     OVD   -              UHTLN±  SUB                  UHT     MS4                  UHT     OVC   	               RDDATБ  C     
               UHTOVё  REL                  UHTOUФ  C     *              UHTOVµ  C     )              UHT     MS3                  UHT     OV6                  BKOCLПSEC                    BKOOPЕN C     
               BKREAД  C                    CORHEШ  C     	               DOINIФ  C     
               FLDETУ  C                    FSTPOУ  C     	               UHTOVД  REL                  GTKBNН  C                    ISSIGО  C                    LGETLО  C                    NUMLEО  C                    NXTTPЕ  C                    ONLCHЛ  C                    UHTOV·  C                     RUNOVМ  C     
!               UHTOVі  C     7"#              SEKERТ  C     $               SETBOФ  C     %               SETEOД  C     &               UHTOV№  REL   '               SKIPB   C     (               SKIPF   C     )               TAPCHФ  C     *               TFFOPО  CX    +               TPCHAФ  C     
,               TPCLSЕ  C     -               TPERR   C     .               TPFCLУ  C     /               TPICLУE CX    0               TPIFCМS CX    	1               TPIFOРN C     2               TPIIOГK C     3               TPOFOРN C     4               TPOIOГK C     5               UHTOVБ  REL   6               TPREAД  C     7               TPRESФ  C     
8               TPSEEЛ  C     9               TPSTAФ  C     :               TPWRIФE C     ;               BKIOPЕN C     <               UHMENХ  C     
=               UHT     ERR   	>               UHTOVґ  REL   ?               UHT     OV9   @               UHTOVГ  REL   A               UHTBL±  SUB   B               UHTBLІ  SUB   C               UHTLNЛ  SUB   D               UHT     INP   E               UHT     OV7   F               UHT     MAN   G               UHT     OV0   H               UHT     OV1   	I               UHT     OVA   J               UHT     OV2   K               UHT     OV3   L               UHT     OV4   !MN              UHT     OV5   O               UHT     OVB   P               UHTOV¶  C     *QR              UHT     OUT   )ST              UHTOV¶  REL   U               WTDATБ  C     V               WTFMKУ  C     W               UHTOV°  C     X               UHTOVґ  C     CYZ[             UHTOVµ  REL   \               RUNTDП  C     ]               UHTOV·  REL   ^               UHTOV±  C     _               UHTOVВ  REL   `               UHT     MS2   	a               UHTOVІ  C     'bc              UHTOVё  C     d               UHTOV№  C     e               UHTINР  C     *fg              UHTOVБ  C     h               UHTOVВ  C     i               UHTOVГ  C     j               UHTOVД  C     k               UHTMAО  C     l               UHTOV°  REL   m               UHTOUФ  REL   n               UHTMAО  REL   o               UHT     MS1   p               UHTOV±  REL   q               UHTOVІ  REL   r               UHTOVі  REL   s               SETTPЕ  C     t               UHTBLД  SUB   
u               TPOPEО  CX    *vw              TPOFOРN CX    x               UHTLIВ  IRL  yz{|}           TPOPEО  C     *~              UHTINР  REL   Ђ               VARFXПV2REL   Ѓ               VARFXПV1C     c‚ѓ„…            VAR2FШ  ERR   †               VAR2FШ  H     ‡               VAR2FШ  MS1   €               VARFXВLDSUB   ‰               VARFXМN1SUB   Љ               VARFXМNKSUB   ‹               VARFXРRCC    ЊЌЋЏђ           VARFXПV2C     ‘               VAR2FШ  OV1   ’               VARFXРRCREL   “               VAR2FШ  OV2   ”               VAR2FШ  PRC   •               VARFXПV1REL   –               VARFXВL1SUB   —               BUILDБ  SUB                  BUILDВ  SUB   ™               /*
.pa
.he                                                            AMIE (GTAPE.H)
*/
/*======================================================================*/
/*	GTAPE.H - General tape descriptor header file			*/
/*======================================================================*/
/*USE
Portability level	1
Revision history:-
13/02/89 Now only 32 messages in AMIE.MS2 - ICFO
         Maximum number of switches is 13 - *** WATCH THIS ONE *** - ICFO
20/06/88 Structure _ctrl added - ICFO
13/06/88 58 messages - ICFO
07/06/88 Listing tidied up - ICFO
29/10/87 Structure '_sw' added - ICFO
04/04/87 Created - DAR
*/

/* This file contains the structures associated with a generalised	*/
/* tape file description						*/

#define		WPROT	0
#define		EOT	1
#define		BOT	2
#define		ONLINE	3
#define		FXDMDE	4

/* Tape file status							*/
#define 	CLOSED	0
#define		OPEN	1
#define		TEOF	2
#define 	EORD	3

#define 	MAXBLOCK  0x8000	/* Max # blocks allowed per file*/
#define 	MAXBKSIZ/*
.he                                                               UHT(UHTOV8)
.pa
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                   /*				*/
uhtov8(control,lev)                      /* Overlay OPEN_FILE for INPUT */
struct	_ctrl	*control;			/* Control structure	*/
struct	lvl	*lev;				/* AMIE Level structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHT INPUT
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
         'tplibv'added - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
23/06/88 Arguments removed from call to 'tpi_fopen' - ICFO
21/06/88 Started - ICFO
*/

{

VOID	tplibv(),
	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

return(tpi_fopen(control,lev));

}

/*======================================================================*/
use V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.he                                                               UHT(UHTOV9)
.pa
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                            /*			*/
uhtov9(control,lev)                               /* Overlay CLOSE_FILE */
struct	_ctrl	*control;			/* Control structure	*/
struct	lvl	*lev;				/* AMIE Level structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHT INPUT
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
         'tplibv'added - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - E 0x4000	/* 16k max block size		*/
#define 	MINBKSIZE 12		/* 12 byte min block size	*/
#define 	DEFBKSIZE 80		/* 80 byte default block size	*/
#define 	MAXFILE	1024		/* Max no of files on a tape	*/

struct _tpdesc	{
	STATUS	eot_action;	/* WRITING ONLY - action at end of tape	*/
				/* 0 - continue from curr pos in file	*/
				/* 1 - restart file on new tape		*/
				/* 2 - abandon file & stop		*/
	UWORD	st_file,	/* Starting position on tape		*/
				/* 1 - n at file n			*/
				/* 0 at end of recorded data (WRT ONLY)	*/
		end_file;	/* End file of transfer			*/
				/* 1 - n at file n			*/
				/* 0 at EORD (RD) / concatenate (WRT)	*/
	WORD	sk_file;	/* READING ONLY - Number of files to	*/
				/* skip if NOT at BOT			*/
	UWORD	st_block,	/* Starting block no - ONLY IF st_file	*/
				/* is not 0				*/
		end_block;	/* READING ONLY - stop block no		*/
				/* n - block n  0 EOF			*/
	BYTE	bktype;		/* Block type				*/
				/* V = variable length			*/
				/* F = fixed length			*/
	UWORD	bksize;		/* Blocksize				*/
				/* if type 'F' it is block size		*/
				/* if type 'V' it is max block size	*/
	BOOLEAN	short_block;	/* Flags short blocks allowed in fixed	*/
				/* length block ops			*/
	UWORD	pre_pad,	/* # bytes of pre data padding		*/
		post_pad;	/* # bytes post data padding		*/
	BYTE	dpad_chr,	/* Padding char for above 		*/
		bpad_chr;	/* Last block padding char - only used	*/
				/* when writing fixed length blocks	*/
	BOOLEAN	no_rewind;	/* TRUE if tape NOT to be rewound at	*/
				/* beginning and end of run		*/
} ;

/* Block controller structure						*/
struct _bc	{
	STATUS	bk_stat;	/* Block status 1 - open  0 - closed	*/
	BYTE	*bk_base,	/* Base of block buffer area		*/
		*bk_ptr;	/* Current pointer into block		*/
	UWORD	bk_size,	/* Overall size of the block		*/
		bk_data,	/* No of data bytes in block		*/
		bk_free;	/* No bytes free in block		*/
	BYTE	bk_omode;	/* Open mode 'W' write  'R' read	*/
	UWORD	bk_curnum;	/* Number of current block in file	*/
				/* may be 1 - n or 			*/
} ;

/* Tape file controller structure					*/
struct _tf	{
	BOOLEAN	tf_stat;	/* File status 0 - closed 1 - open	*/
	UWORD	tf_num;		/* Current tape file no 1 - n		*/
	BOOLEAN	tf_span;	/* Is file spanned across tapes		*/
} ;

/* Used by tptell to return position information			*/
struct	_tpos	{
	WORD	fstat;		/* File status				*/
	UWORD	fnum,		/* File number				*/
		blk;		/* Block number				*/
} ;

/* Structure to hold switches and text pointers for the initialisation	*/
/* overlays								*/
struct	_sw	{
	BYTE	*swnames[13],	/* Switch names				*/
		*swvals[13],	/* Switch values			*/
		*tapmes[33];	/* General messages			*/
	WORD	swtot;		/* Total number of switches		*/
} ;

struct	_ctrl	{
	struct	_bc	*bc;	/* Pointer to Buffer Control Structure	*/
	struct	_tf	*tf;	/* Pointer to Tape Control Structure	*/
	struct	_tpdesc	*tp;	/* Pointer to Tape Descriptor Structure	*/
	WORD	curfile;	/* Current file number			*/
	BOOLEAN	st_sess;	/* Flag if first file of a session	*/
	STATUS	(*bk_clse)();	/* Block Close function			*/
	STATUS	(*bk_open)();	/* Block Open function			*/
	STATUS	(*tape_chat)();	/* Pointer to Tape Dialogue function	*/
} ;

/*======================================================================*/
ol Structure	*/
	struct	_tf	*tf;	/* Pointer to Tape Control Structure	*/
	struct	_tpdesc	*tp;	/* Pointer to Tape Descriptor Structure	*/
	WORD	curfile;	/* Current file number			*/
	BOOLEAN	st_sess;	/* Flag if first file of a session	*/
	STATUS	(*bk_clееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
21/06/88 Started - ICFO
*/

{

VOID	tplibv(),
	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (control->bc->bk_omode == 'R'
|| (control->bc->bk_omode == 'W' && control->tp->end_file != 0)) {
    ++control->curfile;
    ++control->tf->tf_num;		/* Checked for in 'bki_open'	*/
}

return(tp_fclose(control));

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.he                                                               UHT(UHTINP)
.pa
*/
#include	"dd.h"		/* Declares AMIE globals & structures	*/
#include	"gtape.h"

struct	_bc	bc;		/* Block Control Structure		*/

struct	_tf	tf;		/* Tape Control Structure		*/

struct	_tpdesc	tp;		/* Tape descriptor 			*/

BYTE	*tpmes[18];		/* Holds pointers to tape messages	*/

/*======================================================================*/
uhtinp(comd,lev)                       /* Start of the UHT input driver */
WORD	comd;				/* Command to be actioned	*/
struct	lvl	*lev;
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	UHTINP tape input module
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
         'tplibv'added - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13/10/88 V03.00 issued - ICFO
         Records are no longer structured (see UHTOV0) - ICFO
08/07/88 V02.00 issued - ICFO
20/06/88 Global variables removed and passed in a 'control' structure
         to enable the processor to be more heavily overlaid - ICFO
14/06/88 'curfile' passed to 'in_attr' as argument so it can be
         overlaid - ICFO
         'curfile' and 'text' made LOCAL - ICFO
13/06/88 Bug Report 462(4) - ICFO
         18 messages now
         Bug Report 461 and 490 - ICFO
         Messages changed and messages cleared once the new tape
         is online
         Fix in NXTITPE, new number of messages in UHTINP and new
         messages in UHT.MS1
	         BUG Report 462(3) - ICFO
         Tape rewinds to BOT at end of run without waiting for BOT
         Fix in SETBOT (new argument)
                TPееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее                                                                                                                              Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ! 9Нл"е! 9Нл"еНЂББЙ! еН‡ЂБНN"К0Ђ!  еНЧЂБЙ! 9Нл" Нл"е!DЂгй#НN"КOЂ!яяЙ! 9Нл"##Нл"6#6 ! 9Нл"##Нл" 6 #6 !  Й         !ѓЂеНЃБ! 9Нл")yЂНл"е:„ЂНж"Н("Н2"КґЂ! Г·Ђ!  "…Ђ! 9Нл"+++|µВУЂ*…Ђ}оo"…Ђ*…ЂЙ!мЂеН|Б! 9Нл"еНpБЙUHT                    ЙН"Ѓ! }2рЂ! "уЂ! 9Нл""чЂНCЃЙ!тЂе!тЂе!рЂНУ" ХНУ"е!  еН.БББЙ!рЂT]###F#Np+qbkНџЃН№ЃНсЃЫеж(bk 	~#foЫеж НшЃН‚bkННЃ8ТИеНџЃ!‚Н№ЃНсЃbk	 	НшЃbkННЃбЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙНсЃЫежАЫежИ~/Уж#мНсЃЫж/х>= эНсЃЫж/ 	wс& oж(7Й}§ЙЫеж ъЙНсЃЫежИЫж/w#сНсЃЫежИ~/Уж#с   
 Й    @        D @@@ ђ$@    €€   ђ  B’          @        !ѓЂеНЃБ! 9Нл")yЂНл"е:„ЂНж"Н("Н2"КґЂ! Г·Ђ!  "…Ђ! 9Нл"+++|µВУЂ*…Ђ}оo"…Ђ*…ЂЙ!мЂеН|Б! 9Нл"еНpБЙUHT                 ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееIOPEN
                TPOOPEN
                TPICLSE
                TPOCLSE
                NXTITPE
                NXTOTPE
                TPSEEK
                SETEOD
10/06/88 Bug Report 456 - ICFO
         Record size in VFD no longer includes pre and post block
         padding bytes
         Fix in INATTR
09/06/88 Listing tidied and 'lev->levchk' etc moved to OV1 - ICFO
07/06/88 Bug Report 454 - ICFO
         Error detected if number of bytes in a block is less than the
         number of padding bytes.
         Fix in BKREAD
25/05/88 Function name changed to fit in with AMIE V5 standards - ICFO
27/10/87 Bug Report 314 - ICFO
         Last line of the Tape Settings is now displayed
         on 'lines per page - 1'
         Fix in DSPDTS

         Bug Report 405 - ICFO
         Switch 'ET:' changed to 'EH'
         Fix in SETEOT         

         Bug Report 436 - ICFO
         Summary of switch settings not displayed if /DF: switch is
         present
         Fix in SETTPE

09/04/87 DAR - Created
*/

{

LOCAL
BYTE	(*ov_go)();		/* Pointer to overlay			*/

LOCAL
WORD	text,			/* text descriptor			*/
	curfile;

LOCAL
struct	_ctrl	control;	/* Control structure			*/

STATUS	bki_open(),		/* Block Open function			*/
	tape_chat();		/* Tape Dialogue function		*/

VOID	tplibv(),
	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (comd == DATA)  return(rd_data(lev));/* stripped out for speed	*/

lev->err_action = DISCONN;	/* primed for any fails 		*/

/* Action the command passed from the copy controller			*/
switch (comd) {

    case CONNECT:	/* establish transfer connection & init driver	*/

/* Load up the control structure					*/
	control.bc = &bc;
	control.tf = &tf;
	control.tp = &tp;
	control.bk_open = bki_open;
	control.tape_chat = tape_chat;

/* Load general tape messages						*/
	if ((text = opn_txt("UHT.MS1",tpmes,18)) == FAIL)
					      return(flerr("UHT.MS1",46));
	if (uhinit(&control,lev,'R',tpmes) == FAIL)  return(FAIL);

	break;

    case RELEASE:	/* Transfer termination sequences		*/
    case DISCONN:
    case ABORT:
	runovl('B',&control,lev);

	cls_txt(text);	/* release text area				*/

	break;

    case SELECT_FILE:

/* finish conditions = end is at EORD & EORD hit			*/
/*                     next file > end file				*/

	return(runovl('7',&control,lev));

    case OPEN_FILE:
	return(runovl('8',&control,lev));

    case READ_ATTR:	/* read VFS attributes & pass across to output	*/
	return(runovl('0',&control,lev));	/* NB No return value	*/

    case ABORT_DATA:		/* abort data transfer			*/
    case CLOSE_FILE:		/* close the input file			*/
	return(runovl('9',&control,lev));

    case RESTART:	/* restart the data transfer from beginning	*/

	lev->err_action = ABORT_DATA;		/* if an error happens	*/
	return(runovl('A',&control,lev));

    case BEGIN_DATA:		/* start data transfer			*/
    case END_DATA:		/* end data transfer			*/
    case REL_FILE:		/* release currently selected file	*/
	break;


    default:
	err_handle(FATAL,NULLPTR,32);
}

return(SUCCESS);

}

/*======================================================================*/
transfer from beginning	*/

	lev->err_action = ABORT_DATA;		/* if an error happens	*/
	return(runovl('A',&control,lev));

    case BEGIN_DATA:		/* start data transfer			*/
    case END_DATA:		/* end data transfer			*/
    case REL_FILE:		/* release ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
/*
.pa
.he                                                               UHT(UHINIT)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                  /*				*/
uhinit(control,lev,mode,tpmess)         /* initialise a UHT tape driver */
struct	_ctrl	*control;	/* Control structure			*/
struct	lvl	*lev;		/* level descriptor for calling driver	*/
BYTE	mode,			/* R for read  W for write		*/
	**tpmess;		/* Pointers to messages			*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/06/88 Arguments passed in 'control' structure - ICFO
14/06/88 'tpopen' moved into the overlay and allocation of buffer
         moved from 'tpopen'- ICFO
08/04/87 Created DAR
*/

{ 

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* run overlay to fill tape descriptor					*/
if (runtdo(control,lev,mode,tpmess) == FAIL)  return(FAIL);

/* allocate space for the block	buffer					*/
if ((control->bc->bk_base = spalloc(control->tp->bksize)) ==
					 (BYTE *) FAIL)  return(tperr(9));

return(SUCCESS);

}

/*======================================================================*/


{ 

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* run overlay to fill tape descriptor		ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.he                                                               UHT(UHTOVA)
.pa
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                               /*			*/
uhtova(control,lev)                                  /* Overlay RESTART */
struct	_ctrl	*control;			/* Control structure	*/
struct	lvl	*lev;				/* AMIE Level structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHT INPUT
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
         'tplibv'added - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
21/06/88 Started - ICFO
*/

{

VOID	tplibv(),
	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

lev->err_action = ABORT_DATA;			/* in case of error	*/
return(tp_restart(control,lev));

}

/*======================================================================*/

ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее ф                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ! 9Нл"еН=„Б#НN"КЂ!яяЙ! 9Нл"е! 9Не"е! 9Нл"еНoЂБББ#НN"КCЂ!яяЙ! 9Нл" е! 9Нл" Нл"##Нл"Нр"!  Й      ! 9Нл"Нл"е! е!  еН.БББ! 9Нл"##Нл"е! е!  еН.БББ! еНЉЋБНN"КєЂ!  еНжЏБЙ! 9Не"©яНN"КЧЂ!  еНЉЋБ+НN"Н2"КжЂ! еНжЏБЙ!  еН=ђБ! 9Нл" Нл" Нл"НN"КЃ! 9Нл"е! еНpЉББГQЃ! еНЉЋБНN"КQЃ! 9Нл"##Нл"##6#6 ! 9Нл"Нл" 6#6 ! 9Нл"Нл"6#6 ! 9Нл"Нл" е! 9Нл" Нл" Нл"Нр"! 9Нл"Нл" е! 9Не"С}! еНЉЋБ"mЂ+НN"ВКЃ! 9Нл" Нл" Нл"НN"Н2"КҐ‚! 9Не"®яНN"ВшЃ! 9Нл" Нл"##Нл"+Н2"Н2"В‚! 9Нл" Нл" Нл"+Н2"Н2"Кў‚! 9Нл"еН€Б#НN"Кў‚! 9Нл"##Нл"Нл"+++НN"К`‚! 9Нл"е! 9Нл"еНў„ББНN"Н2"К›‚! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!“‚гйБББББГџ‚!яяЙГ‚Г9„! 9Не"®яНN"Кј‚*mЂНN"Н2"К©ѓ! 9Нл" Нл" Нл"|µК¦ѓ!яяе!B е!kЂеНЕђБББ! 9Нл" Нл" Нл"е!F е!kЂеНЕђБББ! 9Нл" Нл" е! 9Нл" Нл" Нл"е!
 9Нл" Нл"##Нл"НУ"#Нр"! 9Нл" Нл"##е! 9Нл"##Нл"##е!
 9Нл"Нл" е! 9Нл" Нл" е! Нр"Нр"Нр"Нр"Г9„!яяе!B е!kЂеНЕђБББ"iЂ*iЂ& }жoН2"Кчѓ*iЂ& }ж@oН2"КЯѓГчѓ!яяе!B е!kЂеНЕђБББ"iЂГѕѓ! е!B е!kЂеНЕђБББ! 9Нл" Нл" Нл"Н2"В+„*mЂ+НN"Н2"К9„! еНЮЋБ!  Й! еНЉЋБНN"Кћ„! 9Нл" Нл"е!  ге! ге!
 ге!  ге!  ге!x„гйБББББ! еНЉЋБНN"Кћ„Н‘(ея|µВ›„!яяЙГ}„!  ЙЕЕ! 9Нл" Нл"Нл"++|µВш„! 9Нл" 6#6 ! 9Нл"Нл" Не"©яНN"Кн„! Гр„! еНжЏБББЙ! 9е!
 9Нл"##Нл"##Нл"Нр"!  9е!
 9Нл"Нл" Нл"Нр"! 9Нл"Нл" Не"®я|µВ7†! 9Нл" Нл"е!  ге! ге! ге! ге!  ге!q…гйБББББ!  еН}ђБ! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!«…гйБББББН•‘НРН±(ея|µВИ…!яяГх„! 9Нл"еН=„Б#НN"Кб…!яяГх„! 9Нл"е!  еНpЉББ#НN"Кя…!яяГх„Нѕ'! 9Нл" Нл"е!  ге! ге!  ге!  ге!  ге!/†гйБББББГ€! 9Нл" Нл"е!  ге! ге! ге! ге!  ге!d†гйБББББ! 9Нл" Нл"Нл"+|µВ™†! 9Нл"еНoЏБ#НN"К™†!яяГх„! еНЮЋБ#НN"К®†!яяГх„!  еН}ђБ! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!г†гйБББББН•‘НРН±(ея|µВ ‡!яяГх„! 9Нл"еН=„Б#НN"К‡!яяГх„! 9Нл"е!  еНpЉББ#НN"К7‡!яяГх„!  еНЉЋБ+НN"КТ‡! еНжЏБ! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!{‡гйБББББН•‘НРН±(ея|µВ‡!яяГх„! 9Нл"еН=„Б#НN"К±‡!яяГх„! 9Нл"е!  еНpЉББ#НN"КП‡!яяГх„Г7‡Нѕ'! 9Нл" Нл"е!  ге! ге!  ге!  ге!  ге!€гйБББББ! 9Нл"##Нл" 6#6 ! 9Нл" Нл"Нл"+|µВI€! 9Нл" 6#6 !яяГх„! 9Нл"##Нл"##е! 9Нл"Нр"! 9Нл"Нл" е! 9Нл"Нр"! 9Нл" Нл"е!Џ€гйГх„      ! 9Нл" Нл"##Нл""’€! 9Нл" Нл" Нл""”€! 9Нл"Нл" Не"©яНN"Кз€*’€НN"Н2"Къ€! 9Нл"еН‹БЙ*’€ Нf"В‰! 9Нл"##Нл"##Нл"л*’€Н«"Н2"КZ‰! 9Нл"Нл" Не"©яНN"ВW‰! 9Нл" Нл" Нл"НN"Н2"Н2"Кq‰! 9Нл"е! еНpЉББ*’€юН“"Тё‰! 9Нл" Нл"е!  ге! ге!  ге!  ге!  ге!Є‰гйБББББ! "–€Гѕ‰!  "–€! 9Нл"е*’€+еНЯЊББ#НN"КЫ‰!яяЙ*”€ Нw"Кн‰*–€НN"Н2"К%Љ! 9Нл" Нл"е!  ге! ге!  ге!  ге!  ге! ЉгйБББББ! 9Нл"е*”€+еНmЊББ#НN"КBЉ!яяЙ! 9Нл"Нл" е*”€Нр"! 9Нл"##Нл"##е*’€Нр"!  Й! еНЉЋБНN"КСЉ! 9Нл"+НN"КЙЉ! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!№ЉгйБББББ!  еН}ђБГСЉ! еН}ђБ! 9Нл"##Нл"е! 9Нл"##Нл"Нл"Н2"Нр"! 9Нл"##Нл"##6#6 ! 9Нл"Нл" 6#6 !  Й  ! 9Нл"е! еНpЉББ#НN"К;‹!яяЙ! е!B е!‹еНЕђБББ++НN"Кl‹! е!B е!‹еНЕђБББ++НN"Н2"К§‹!  еН}ђБ! 9Нл"##Нл"6#6 ! 9Нл" Нл"##еНл"#Нр"!  Й! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!Ф‹гйБББББ!  еН}ђБ! 9Нл"##Нл"Нл"+++|µК?ЊН‘(ея|µВЊ!яяЙ! 9Нл" Нл"##еНл"#Нр"! 9Нл"е! еНЯЊББ#НN"К<Њ!яяЙГб‹! 9Нл"##Нл"##е! 9Нл" Нл"##Нл"Нр"!  Й     !  "iЊ! 9Нл"|µКЦЊ! 9Нл"е!B е!kЊеНЕђБББ}2hЊ:hЊНж"|µВ­Њ! 96 #6 ! 9Нл"е:hЊНж"е!B еНАЌБББ"iЊ#НN"КУЊГЦЊГsЊ*iЊЙ     ! 9Нл"  Нw"КхЊ*ЫЊНN"Н2"КјЌ! е!F е!ЭЊеНЕђБББ}2ЪЊ++НN"КNЌ! 9еНл"+Нр"! 9Нл"##Нл"##еНл"#Нр"! 9Нл"Нл" 6#6 ! е!B е!ЭЊеНЕђБББ|µК‹Ќ! 9Нл"##Нл"6#6 ! 9Нл"|µК€Ќ!яя"ЫЊГ§Ќ! 9Нл"е:ЪЊНж"е!F еНАЌБББ"ЫЊ!яяе!B е!ЭЊеНЕђБББГЯЊ*ЫЊЙ! 9Не"|µВРЌ!  Й! 9Нл"ѕяНN"КсЌ! 9Не"& }жDoНN"Н2"К$Ћ!яяе!B е! 9еНЕђБББ! 9Нл"##Нл"6#6 ! еНжЏБЙ! 9Нл"Нл" Не"©яНN"КKЋ! еНЉЋБ+НN"Н2"КZЋ! еНжЏБЙ! 9Не"& }жoН2"КxЋ! еНжЏБГ{Ћ!  Й         !†ЋеНђБ! 9Нл")|ЋНл"е:‡ЋНж"Н("Н2"К·Ћ! ГєЋ!  "€Ћ! 9Нл"+++|µВЦЋ*€Ћ}оo"€Ћ*€ЋЙ    *ЬЋе*ЪЋе! 9еНл"+Нр"#|µКgЏ! е!ЪЋеНҐ‘ББ"ЬЋЮяНN"КЏ! еНЉЋБ+НN"Н2"К'ЏГшЋ*ЬЋЮяНN"К?Џ! еНЉЋБНN"Н2"КPЏ! еНЉЋБНN"Н2"КdЏ!яялб"ЪЋб"ЬЋлЙГжЋ!  ГYЏ  ! еНЉЋБНN"КЏЏ!яяе!F е!mЏеНЕђБББ! еНЉЋБНN"КЇЏ! е!F е!mЏеНЕђБББ! 9Нл"е! 9Нл"Нл" е! 9Нл" Нл" Нл"Нр"+еНmЊББЙ!ыЏеН|Б! 9Нл"еНpБЙUHT                    ЙНс‘! }2яЏ! "ђ! 9Нл""ђН’Й           Нс‘! }2яЏ! 9Нл"|µВZђ!  }2 ђ! "ђ! 9Нл"еНм’Б";ђ!1ђ"ђН’Й    *{ђе*yђеНс‘! }2яЏ: ђНж""{ђ! 9Нл"Н2"}2 ђН’"yђ*{ђ}2 ђ*yђлб"yђб"{ђлЙ    Нс‘! }2яЏ: ђНж""Бђ! 9е! 9Не"еНР#БС}ѕяНN"Кьђ!  Г‘! 9Не"єяНN"К‘! Г‘! }2 ђ! 9Нл""ђ  Нv"К3‘!я Г6‘!  }2ђН’"Гђ& }жoе! 9Нл"е!  Нр"НX"КЉ‘! 9Нл"е*ђеНм’БНр":
ђНж"& }ж@oН2"КЉ‘*Гђ}ц@o"Гђ*Бђ}2 ђ*ГђЙНс‘! }2яЏН’Й  Нс‘! }2яЏ! 9Нл""ђН’"Ј‘& }жoе! 9Нл"е!  Нр"НX"Кн‘! 9Нл"е*ђеНм’БНр"*Ј‘Й!ђе!ђе!яЏНУ" ХНУ"е!  еН.БББЙ!яЏT]###F#Np+qbkНn’Н€’НА’Ыеж(bk 	~#foЫеж НЗ’НЦ’bkНњ’8ТИеНn’!е’Н€’НА’bk	 	НЗ’bkНњ’бЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙНА’ЫежАЫежИ~/Уж#мНА’Ыж/х>= эНА’Ыж/ 	wс& oж(7Й}§ЙЫеж ъЙНА’ЫежИЫж/w#сНА’ЫежИ~/Уж#с   
 ЙБбеЕLeiЙ        /*
.he                                                               UHT(UHTOVB)
.pa
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                            /*			*/
uhtovb(control,lev)                               /* Overlay CLOSE_FILE */
struct	_ctrl	*control;			/* Control structure	*/
struct	lvl	*lev;				/* AMIE Level structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHT INPUT
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
         'tplibv'added - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
21/06/88 Started - ICFO
*/

{

VOID	tplibv(),
	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

return(tp_close(control));

}

/*======================================================================*/
ued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.he                                                               UHT(UHTOVC)
.pa
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                  /*				*/
uhtovc(control,lev)                     /* Overlay OPEN_FILE for OUTPUT */
struct	_ctrl	*control;			/* Control structure	*/
struct	lvl	*lev;				/* AMIE Level structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHT INPUT
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
	 'tpofopn.c' changed to write a file mark between files ONLY if
	 the concatenate files flag is NOT set
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
         'tplibv'added - ICFO
08/08/89 V04.00 issued because V03.01 required a          @Ѓ   @   Ђ                @    Ђ               Ђ H Ђ@      "                   ЂЂ	  D D    Ѓ                                  Ђ  A   Ђ ‚          @     Ѓ     Ђ  A   Ђ ‚     Ђ  A   Ђ ‚@             Ђ       @       ђ              	 „@          Ђ      Ѓ            @ @Ђ          @               @ђ   Ѓ$Ђ @ @ЂЂ       €   A  ‚ D   Ђ     @   Ѓ    Ђ ‚ Ђ€ ! @Ђ@ B       Ђ     	   A "IA ’$"A     @ I    @Ђ H‘A ’   @Ѓ   	   „	$          @ Ђ   ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееpip m:=c:uht$1.rel[g15
xsubm
link uht.$1=uht$1[op,guht$1,l8000],amdum,uhtlib.irl[s],uhtlib.irl[s],&
tapdrv.irl[s],tlib.irl[s]
dexsub
era uht$1.rel
prlpat uht.$1 $2 $3 $4 $5
prltrm uht.$1
xp c:[g15]=uht.$1
symsort uht
era uht.sym
era uht.srt
CPMBL2  SUB   L               CRTDIТ  C     6               CPMBLD  SUB   M               CTDOPО  C     8               CTOPNТ  C     9               CTOS    H     &: ;             CTOS    MS1   <               CTOSBМ1 SUB   =               ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееchange to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
27/06/88 Code moved to here from BEGIN_DATA because we cannot load
         overlays at BEGIN_DATA as 'allocamax' is in force - ICFO
23/06/88 Major simplification due to the positioning being moved to
         CONNECT rather then OPEN_FILE - ICFO
21/06/88 Started - ICFO
*/

{

VOID	tplibv(),
	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

tpo_fopen(control,lev);

/* Flag the tape file as open						*/
control->tf->tf_stat = TRUE;

/* Flag file as unspanned						*/
control->tf->tf_span = FALSE;

return(SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.he                                                               UHT(UHTOVD)
.pa
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                   /*						*/
uhtovd(control,mode,lev) /* Open the tape and set up control structures */
struct	_ctrl	*control;	/* Control structure			*/
BYTE	mode;			/* R for read W for write		*/
struct	lvl	*lev;		/* Pointer to an AMIE Level structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHT - Unheadered Tape Processor
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
         'tpopen.c' changed to correct action when opening with the tape
	 not positioned at BOT
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
         Repositioning algorithm for when tape is not at BOT corrected
         (Change in TPOPEN.C) - ICFO
22/11/89 V05.00 issued - ICFO
         New algorithm for positioning when not at BOT
         (Change in TPOPEN.C) - ICFO
14/09/89 V04.01 issued - ICFO
         'tplibv'added - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 Made into a separate overlay from UHTOV1 - ICFO
*/

{

VOID	tplibv(),
	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (onlchk(control) == FAIL)  return(FAIL);

/* Open the tape and set up the control structures			*/
if (tp_open(control,mode,lev) == FAIL)  return(FAIL);

control->curfile = control->tp->st_file;

return(SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееTape file settings
Start file           =
End file             =
End of recorded data
Start block          =
End block            =
End of file
Block type           =
Fixed length
Variable length
Block size           =
Block max size       =
Short block allowed
Short block produces error
Pre data header bytes=
Post data trail bytes=
Header/trailer byte  =
Short block pad byte =
ESC abandons transfer, another key starts
Short block status   =
End of tape action   =
Last block padded to fixed length
Last block written short
Rewind after each run - 
No
Yes
Concatenate input files  =
Blocks to skip       =
       =
End of file
Block type           =
Fixed length
Variable length
Block size           =
Block max size       =
Short block allowed
Short block produces error
Pre data header bytes=
Post data trail bytes=
Header/trailer byte  =
Short block pad byte =
ESC abandons transfer, another key starts
Short block status   =
End of tape action   =
Last block padded to fееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(UHTMAN)
*/
#include	"dd.h"
#include	"gtape.h"

BYTE	*tpmes[26];		/* General tape message pointers	*/

/*======================================================================*/
STATUS
uhtman(target)                       /* Main entry point into utilities */
WORD	target;			/* 0 for Source, 1 for DESTINATION	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	UHTMAN Unheadered tape utilities
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
         'tplibv'added - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
20/06/88 'tpini' removed and code moved in-line - ICFO
13/06/88 Bug Report 491 - ICFO
         Test for 'Valid Bit Not Set' introduced
         Fix in FLDETS

27/10/87 No Bug Report - ICFO
         Messages and actions on completion of tape initialisation
         tidied up
         Fix in DOINIT
                ISSIGN

         Bug Report 411 - ICFO
         Tape initialisation now needs 'I' for first response
         not 'Y'
         Fix in ISSIGN

         Bug Report 407 - ICFO
         Test for 'Esc' while reading tape for analyse added
         Fix in FLDETS

         Bug Report 399 - ICFO
         The block size is now reported correctly for zero length
         files
         Fix in FLDETS

         Bug Report 328 - ICFO
         Facility to initialise the SOURCE tape removed
         Fix in UHTMAN
                UHMENU

20/04/87 Written - DAR
*/

{

LOCAL
WORD	choice;		/* manager menu choice				*/

LOCAL
WORD	text;		/* text descriptor				*/

VOID	tplibv(),
	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* load tape specific messages						*/
if ((text = opn_txt("UHT.MS3",tpmes,26)) == FAIL)
					      return(flerr("UHT.MS3",46));

/* run utility menu & act on choice					*/
while ((choice = uhmenu(target)) != FAIL) {

/* If this is the SOURCE convert the response from 'uhmenu' from 0 or 1	*/
/* to 0 or 2 to avoid allowing the user to initialise SOURCE tapes	*/
    if (target == SOURCE)  choice *= 2;

    switch (choice) {

	case 0:
	    file_dets();			/* listing of files	*/
	    break;

	case 1:
	    if (isignon() == TRUE)  do_init();	/* init a tape		*/
	    break;
    }
}
			
cls_txt(text);		/* free the general message area		*/

return(SUCCESS);	/* back to general manager & main menu		*/

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее Х                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ! 9Нл"е! 9Нл"еНFЂББ! 9Нл"##Нл"6#6 ! 9Нл"##Нл" 6 #6 !  Й    ! еН †БНN"К]Ђ!  еН|‡БЙ! еН †БН2"К„Ђ! 9Нл"е! 9Нл"еНuЃББ#НN"Н2"КЋЂ!яяЙ! 9Нл" Нл"НN"К­Ђ! еН †БНN"Н2"КaЃ!яяе!B е!DЂеН¦‰БББ"BЂ*BЂ& }жoН2"КЃ*BЂ& }ж@oН2"КйЂГЃ!яяе!B е!DЂеН¦‰БББ"BЂГИЂ! е!B е!DЂеН¦‰БББ! 9Нл" Нл" Нл"|µВFЃ! 9Нл"##Нл"##еНл"+Нр"ГaЃ! 9Нл"Нл" 6#6 ! еНt†Б! 9Нл" 6 #6 !  ЙЕЕ! 9Нл" Нл"Нл"++|µВЛЃ! 9Нл" 6#6 ! 9Нл"Нл" Не"©яНN"КАЃ! ГГЃ! еН|‡БББЙ! 9е!
 9Нл"##Нл"##Нл"Нр"!  9е!
 9Нл"Нл" Нл"Нр"! 9Нл"Нл" Не"®я|µВ
ѓ! 9Нл" Нл"е!  ге! ге! ге! ге!  ге!D‚гйБББББ!  еН^‰Б! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!~‚гйБББББНvЉНРН±(ея|µВ›‚!яяГИЃ! 9Нл"еН•‡Б#НN"Кґ‚!яяГИЃ! 9Нл"е!  еНe…ББ#НN"КТ‚!яяГИЃНѕ'! 9Нл" Нл"е!  ге! ге!  ге!  ге!  ге!ѓгйБББББГп„! 9Нл" Нл"е!  ге! ге! ге! ге!  ге!7ѓгйБББББ! 9Нл" Нл"Нл"+|µВlѓ! 9Нл"еН‡Б#НN"Кlѓ!яяГИЃ! еНt†Б#НN"КЃѓ!яяГИЃ!  еН^‰Б! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!¶ѓгйБББББНvЉНРН±(ея|µВУѓ!яяГИЃ! 9Нл"еН•‡Б#НN"Кмѓ!яяГИЃ! 9Нл"е!  еНe…ББ#НN"К
„!яяГИЃ!  еН †Б+НN"КҐ„! еН|‡Б! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!N„гйБББББНvЉНРН±(ея|µВk„!яяГИЃ! 9Нл"еН•‡Б#НN"К„„!яяГИЃ! 9Нл"е!  еНe…ББ#НN"Кў„!яяГИЃГ
„Нѕ'! 9Нл" Нл"е!  ге! ге!  ге!  ге!  ге!Х„гйБББББ! 9Нл"##Нл" 6#6 ! 9Нл" Нл"Нл"+|µВ…! 9Нл" 6#6 !яяГИЃ! 9Нл"##Нл"##е! 9Нл"Нр"! 9Нл"Нл" е! 9Нл"Нр"! 9Нл" Нл"е!b…гйГИЃ! еН †БНN"КЖ…! 9Нл"+НN"Кѕ…! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!®…гйБББББ!  еН^‰БГЖ…! еН^‰Б! 9Нл"##Нл"е! 9Нл"##Нл"Нл"Н2"Нр"! 9Нл"##Нл"##6#6 ! 9Нл"Нл" 6#6 !  Й         !†еН<‰Б! 9Нл")†Нл"е:†Нж"Н("Н2"КM†! ГP†!  "†! 9Нл"+++|µВl†*†}оo"†*†Й    *r†е*p†е! 9еНл"+Нр"#|µКэ†! е!p†еН†ЉББ"r†ЮяНN"Кґ†! еН †Б+НN"Н2"КЅ†ГЋ†*r†ЮяНN"КХ†! еН †БНN"Н2"Кж†! еН †БНN"Н2"Къ†!яялб"p†б"r†лЙГ|†!  Гп†  ! еН †БНN"К%‡!яяе!F е!‡еН¦‰БББ! еН †БНN"КE‡! е!F е!‡еН¦‰БББ! 9Нл"е! 9Нл"Нл" е! 9Нл" Нл" Нл"Нр"+еНя‡ББЙ!‘‡еН|Б! 9Нл"еНpБЙUHT ! еН †БНN"Кц‡! 9Нл" Нл"е!  ге! ге!
 ге!  ге!  ге!Р‡гйБББББ! еН †БНN"Кц‡Н‘(ея|µВу‡!яяЙГХ‡!  Й     !  "ы‡! 9Нл"|µКh€! 9Нл"е!B е!э‡еН¦‰БББ}2ъ‡:ъ‡Нж"|µВ?€! 96 #6 ! 9Нл"е:ъ‡Нж"е!B еНl€БББ"ы‡#НN"Кe€Гh€Г€*ы‡Й! 9Не"|µВ|€!  Й! 9Нл"ѕяНN"Кќ€! 9Не"& }жDoНN"Н2"КР€!яяе!B е! 9еН¦‰БББ! 9Нл"##Нл"6#6 ! еН|‡БЙ! 9Нл"Нл" Не"©яНN"Кч€! еН †Б+НN"Н2"К‰! еН|‡БЙ! 9Не"& }жoН2"К$‰! еН|‡БГ'‰!  Й                   ЙНТЉ! }2(‰! "+‰! 9Нл""/‰НуЉЙ    *\‰е*Z‰еНТЉ! }2(‰:)‰Нж""\‰! 9Нл"Н2"}2)‰НуЉ"Z‰*\‰}2)‰*Z‰лб"Z‰б"\‰лЙ    НТЉ! }2(‰:)‰Нж""ў‰! 9е! 9Не"еНР#БС}ѕяНN"КЭ‰!  Гч‰! 9Не"єяНN"Кф‰! Гч‰! }2)‰! 9Нл""+‰  Нv"КЉ!я ГЉ!  }2*‰НуЉ"¤‰& }жoе! 9Нл"е!  Нр"НX"КkЉ! 9Нл"е*6‰еНН‹БНр":3‰Нж"& }ж@oН2"КkЉ*¤‰}ц@o"¤‰*ў‰}2)‰*¤‰ЙНТЉ! }2(‰НуЉЙ  НТЉ! }2(‰! 9Нл""+‰НуЉ"„Љ& }жoе! 9Нл"е!  Нр"НX"КОЉ! 9Нл"е*6‰еНН‹БНр"*„ЉЙ!*‰е!*‰е!(‰НУ" ХНУ"е!  еН.БББЙ!(‰T]###F#Np+qbkНO‹Нi‹НЎ‹Ыеж(bk 	~#foЫеж НЁ‹Н·‹bkН}‹8ТИеНO‹!Ж‹Нi‹НЎ‹bk	 	НЁ‹bkН}‹бЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙНЎ‹ЫежАЫежИ~/Уж#мНЎ‹Ыж/х>= эНЎ‹Ыж/ 	wс& oж(7Й}§ЙЫеж ъЙНЎ‹ЫежИЫж/w#сНЎ‹ЫежИ~/Уж#с   
 ЙБбеЕLeiЙ            @  @Ђ A @ЂЂ                 A              @         @     @          Ѓ         @ЂЃ         H                      Ђ     D           "     H  „ I @Ђ @  @ @      ‚            Ђ$  @ I              @  Ѓ  Ђ€Ѓ ЂI Ѓ Ђ    $Ђ   @ ђ$HЃ Ѓ I    @€€   ђ  B’          @   ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХЊ eT…Dхc	@ Ц$           °Ђ" rН     e›D@¬Р ‚" А0 2НЈ * еЄАQ  еfЂ UB TК*Ў@Vh  Б`ЉЁ 4  °_б“вХ•Y T F" Ђ:– * Ђ1Љ‚ @ЂЛ6“Ђ@А Л6ёЂЁ „  P U  їOмР µqАvp U@ b*  Г°`Є +P@”U@ЂbPљ  :В#  eў}	
Ё¬B
 3mh ЉЃ 0мђ Є„ RА Л”B Yµа " Y·P " Yµ< "є†Y  *ъ @ ч Ђ@иHUB )p eК! ,Ы¶  ,ЪЂ,Ъе‚ –mЃ –m„@–m$fЂ Q  9fТ°€ fУ`€L fУРm.fЂ h  * АeXЊl P`ЌКНЁЂ!«ь2Н     е›WАB А e›[@\ўЄ еfЂ „  d•гсш3~PЛ‘UЈ= №9=R3PЛ•Х#  I53Д ‘ЛЈ  95N0 QСS“QЈ.Ђ) є2”RKђ“#,А)Dє28QСU#/Ђ5EUU2Ћ”ЛЈ&АMQ562њ”УУ‘ЛЈ(аMQIAf0 UP•ЈЎЂU!Q=XВp  ћfЂ Q  9fТ°€ fУ" Ђ:– * Ђ1Љ‚ @ЂЛ6“Ђ@А Л6ёЂЁ „  P U  їOмР µqАvp U@ b*  Г°`Є +P@”U@ЂbPљ  :В#  eў}	
Ё¬B
 3mh ЉЃ 0мђ Є„ RА Л”B Yµа " Y·P " Yµ< "є†Y  *ъ @ ч Ђ@иHUB )p eК! ,Ы¶  ,ЪЂ,Ъе‚ –mЃ –m„@–m$fЂ Q  9fТ°€ fУ`€L fУРm.fЂ h  * АeXЊl P`ЌКНЁЂ!«ь2Н     е›WАB А e›[@\ўЄ еfЂ „  d•гсш3~PЛ‘UЈ= №9=R3PЛ•Х#  I53Д ‘ЛЈ ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(RDDATA)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
WORD                        /*						*/
rd_data(lev)                /* Read next block of data from source file */
struct	lvl	*lev;		/* Level structure of this driver	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTINP
Revision history:
08/06 88 Listing brought up to standard and optimised - ICFO
10/04/87 Created DAR
*/

{

LOCAL
UWORD	rbytes,		/* Number of bytes requested from the tape file	*/
	nbytes,		/* Number of bytes read from source file	*/
	rflags;		/* Record flags					*/

LOCAL
struct	pkthdr	*pkt;	/* Pointer to a packet header			*/

STATIC
BOOLEAN	spanning = FALSE;	/* Span status of record		*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Get an empty packet from the pool					*/
/* Get no of bytes to read						*/
rbytes = (pkt = qget(lev->in_q))->d_freesp;

/* Read bytes of file into data area					*/
/* Cannot move assignment of 'rbytes' into next line or the order of	*/
/* evaluation will matter when setting up 'pkt'				*/
if ((nbytes = tp_read(pkt->d_start,rbytes)) == FAIL) {
    lev->err_action = ABORT_DATA;
    return(tperr(15));
}

/* Has EOF been hit - Yes so create EOF packet				*/
if (nbytes == -2)  pkt->d_bytes = -1;

/* No so adjust the packet control variables 				*/

/************************************************************************/
/*									*/
/*                       (nbytes == rbytes) (record not yet complete)	*/
/*                    +---------------------				*/
/*                    |       T        F				*/
/*                    |  T  Cont.     End				*/
/*   already spanning |							*/
/*                    |  F  Start     No span				*/
/*                    |							*/
/* New spanning value |       T        F				*/
/*           (rflags) |							*/
/*									*/
/************************************************************************/

else {
    rflags = (spanning == TRUE) ? (spanning = nbytes == rbytes) ? 2 : 3
				: (spanning = nbytes == rbytes) ? 1 : 0;

    pkt->d_bytes += nbytes;
    pkt->d_freesp -= nbytes;
    pkt->d_rtype = rflags;
}

/* Output above packet, may be zero length				*/
/* 'queue' always return SUCCESS					*/
return(queue(lev->out_q,pkt));

}

/*======================================================================*/
else {
    rflags = (spanning == TRUE) ? (spanning = nbytes == rbytes) ? 2 : 3
				: (spanning = nbytes == rbytes) ? 1 : 0;

    pkt->d_bytes += nbytes;
    pkt->d_freesp -= nbytes;
    pkt->d_rtype = rflags;
}

/* Output above packet, may be zero length				*/
/* 'queue' always return SUCCESS					*/
return(queue(lev->out_q,pkt));

}

/*===============================ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХЋ eT…Dхc‰@ ФX B Y  ”B YґКН  ,L` "#) ¦ўЖ  9t` #ў§&ў©Ж  *:*rj4d4$F  *ўbJґdD*($ЇЈ'Ж  2ў‚bJґt *¤*'«N   ћ 	IBMDEШ  OV7   Lь s°          UHTOV8  $$$                    	IBMDEX  OV8   &ю t            UHTOUT  C     *П Щ            DSPUSR  C     	x              	IBMDEПV7REL   й               	IBMDEX  H     p        	IBMDEX  MS1   
              	IBMDEШ  MS2                 	IBMDEШ  MS3                 	IBMDEШ  MS4                 
ICL29°0 H                   ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХU $$8	QTPЃUQTаeT…DхUI@ ФP                                                                                                                   9fЂ ›ь2|Z°¬@ †« 9D @ е›ZА¬Р ‚Бd€@@Л6їЂBЂ ИШ#  @ е›c@w0C@ UX CCАU` CE@Uh B  « „  V   "¬Ђ EWЂ40	К!ҐАQH еfЂ ETЂlР •}Ђ40	К! ¬Р ‚Бd€j°”B Y¶tК!+Ђў\ еfЂ ‚#fЮ0UїЯм––ЏЂЛGАD$ ”CUЂў0 rНїаVh  Б`°EUHКН  ,:ГЎ BК!ЄАQ 9fТА+6 °X,H„ іjЂD іjш”B Yµ"
 YµёКН  .Vh  Б`Іe°`"ИК!ЄАQ 9fЧP+6Є °X,H„‚ r€j°”B Y¶@КНІЂ,’Н¶ Ы@Ђ Q  е€ Vh  Б`°Xt 	љ  Z   ЏЂЂ@| Ја 0@Ђ*(VЂA  X0XН „ Д ¶Ђ аґ   ·Ђ ’© Ё.&”Ж Оh.SWITCЋЂ $$8НШBKO_CLЊЩ д$ґхфхИC.NOTЊќ д4Е5хE€А DFRAMEЊв дU%%ф„П€FLERRЊ  $rиА GENMESЊ  TtTдФhН8
H.ЊмЂdхехE€ЛИQGETЊї ХTUTXНXRUNOVLЊаЂeDUф8иxTFЊ  UDД”%hиЁTPЊ  eEД”%hйpTPMESЊ…ЂеT„”д•Hл0UHTOUTЊБЂeuEфDIА  ћ ¶Ђ аґ   їаVh  Б`°EUHКН  ,:ГЎ BК!ЄАQ 9fТА+6 °X,H„ іjЂD іjш”B Yµ"
 YµёКН  .Vh  Б`Іe°`"ИК!ЄАQ 9fЧP+6Є °X,ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RPS UEФU8U!Q5:P 5О                                                                Ь`(†Ђ 9D! •љ  0X,6 і@ Ub Ь`(„\ rі@ “-b ЂЂ–h  еfЂ 4 і@ Uє ЂЂ–mg >-XV, UM "*h *¦Ђ;T Н  vЬљ  
Щµ<•i   ЫЂ0нё4  І   —  Ђ  b S`+4  `€@ ITђTJc0f¬)«¤Є!Жg *rrz¤fь!¦)ЇЄ,F  2"2’
j,f€"'Ї¤§$Ж\А)q„fH#$¦"ЇўFW@*2b*’”` #—F  2:*rj*њ` Јў§&ЈF_@Atf`$©¤Ј§'ЖQ@2z‚rъўД` Є&$Ў+F  2ў‚bJґt Є(&ў©ЖZА2ЄBj*r¬tа*¤*& §N   ћ UM "*h *¦Ђ;T Н  vЬљ  
Щµ<•i   ЫЂ0нё4  І   —  Ђ  b S`+4  `€@ Iееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(UHTOUT)
*/
#include	"dd.h"		/* Declares AMIE globals & structures	*/
#include	"gtape.h"

struct	_bc	bc;		/* Block Control Structure		*/

struct	_tf	tf;		/* Tape Control Structure		*/

struct	_tpdesc	tp;		/* Pointer to tape descriptor		*/

BYTE	*tpmes[18];		/* Holds pointers to tape messages	*/

/*======================================================================*/
STATUS                                /*				*/
uhtout(comd,lev)		      /* Start of the UHT output driver	*/
WORD	comd;				/* Command to be actioned	*/
struct	lvl	*lev;
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	UHTOUT tape output module
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
         'tplibv'added - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
         Changes to UHTOV1, UHTOV2, UHTOV3, UHTOV4, UHTOV5, UHTOV6
         and UHTOVD introduced.  UHT.MS2 split into two and UHT.MS4
         created - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
23/06/88 ICFO - Processor now positions tape at CONNECT and OPEN_FILE
         not at CLOSE_FILE
14/06/88 ICFO - 'out_attr' did very little so the code has been moved
         in-line
13/06/88 ICFO - Bug Report 462(4)
         Now 18 messages
         ICFO - Bug Report 462(2)
         TPWCLSE introduced and called at RELEASE

         ICFO - Bug Report 461 and 490
         Messages changed and messages cleared once the tape is online.
         Check for Write Protect added
         Fix in NXTOTPE, number of messages changed in UHTOUT and
         UHT.MS1 changed.ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееUnheadered 1/2" tape
Load tape & put online
Load next tape & put online
Rewinding tape
Winding to start position
Winding to end of data
Please wait
Winding to end of recorded data
Change tapes
Press a key to continue
Press ESC to exit
End of recorded data
Operator interrupt
Retain data written so far?
Press N for No another for Yes
Transfer resumed
Press a key to continue unit online
End of Tape Marker
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее

         ICFO - BUG Report 462(3)
         Tape rewinds to BOT at end of run without waiting for BOT
         Fix in SETBOT (new argument)
                TPIOPEN
                TPOOPEN
                TPICLSE
                TPOCLSE
                NXTITPE
                NXTOTPE
                TPSEEK
                SETEOD
10/06/88 ICFO - Bug Report 462(1) and 467
         If 'E' is specified as start file number and multiple files
         are copied the program now performs correctly.
         Fix in SETEOD and code at OPEN_FILE
09/06/88 ICFO
         Listing tidied and 'lev->levchk' etc moved to OV1
07/06 88 ICFO
         Listing corrected to fit on 80 column paper
30/10/87 ICFO - Bug Report 410
         When an output file is aborted by pressing the 'Esc' key
         the user is presented with the option of writing 3 tape marks
         or backspacing to the start of the file and writing the
         tape marks there.  There are now incidentally only 15 messages
         in UHT.MS1
         Fix in TPCLSE

20/04/87 DAR - Created
*/


{

LOCAL
WORD	text;			/* text descriptor			*/

LOCAL
STATUS	rv;		/* Return value					*/

LOCAL
struct	_ctrl	control;

STATUS	tape_chat(),
	bko_open(),
	bko_close();

VOID	tplibv(),
	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (comd == DATA)  return(wt_data(&control,lev));

lev->err_action = DISCONN;	/* primed for any fails 		*/

/* Action the command passed from the copy controller			*/
switch (comd) {

    case CONNECT:	/* establish transfer connection & init driver	*/

/* Load up the control structure					*/
	control.bc = &bc;
	control.tf = &tf;
	control.tp = &tp;
	control.bk_open = bko_open;
	control.bk_clse = bko_close;
	control.tape_chat = tape_chat;

	control.st_sess = TRUE;		/* flag 1st file as unstarted	*/

/* load general tape messages						*/
	if ((text = opn_txt("UHT.MS1",tpmes,18)) == FAIL)
					      return(flerr("UHT.MS1",46));

	if (uhinit(&control,lev,'W',tpmes) == FAIL)  return(FAIL);

	break;

    case RELEASE:	/* transfer termination sequences		*/
    case DISCONN:
    case ABORT:
	runovl('B',&control,lev);	/* close tape			*/
	cls_txt(text);
	break;

    case SELECT_FILE:
	break;
					
    case OPEN_FILE:
		/* if we are writing the 1st file seek to start if reqd	*/
	return(runovl('C',&control,lev));

    case READ_ATTR:	/* read VFS attributes & pass across to output	*/

/* Function 'queue' always return SUCCESS				*/
	return(queue(lev->out_q,qget(lev->in_q)));

    case ABORT_DATA:		/* abort data transfer			*/
    case CLOSE_FILE:		/* close the input file			*/
	return(runovl('9',&control,lev));

    case RESTART:	/* restart the data transfer from beginning	*/

	return(runovl('A',&control,lev));

    case BEGIN_DATA:		/* start data transfer			*/
	bko_open();		/* Open first block of the file		*/

/* Note the drop through						*/

    case END_DATA:		/* end data transfer			*/
    case REL_FILE:		/* release currently selected file	*/
	break;

    default:
	err_handle(FATAL,NULLPTR,32);
}

return(SUCCESS);

}

/*======================================================================*/
	return(runovl('A',&control,lev));

    case BEGIN_DATA:		/* start data transfer			*/
	bko_open();		/* Open first block of the file		*/

/* Note the drop through						*/

    case END_DATA:		/* end data transfer			*/
    case REL_FILE:		/* release ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХЊ`UEФU8U!Q=XЖP 5Э                                                                                                                                                ЂЂ–h  "  0 rН° ђ 26 ЖА 9fШр €   c` „ іlш D №D ` ељ  U/рЛ4  e\Р Гє љ  @АЛ6ЧЂC  Л6м ¬+Ю !Ђ¬Р ‚Йѓ@Q  9fЭр €` fЯЂ(†„ 9D4€КН  ,E_Ђ74К!§ЂQ„ еfЂ EA lЫ„ К§А"ље‹ЂVh  Б`ІD Ђ е›А @ e›PА\ў0 rН·`Q rі@ ‚" @Є еfЂ U fЂ Єо!їЩ"ЄеfЂ  іiX*ЛЂ€nЁ”B 9Yґд‚БdЉЁ0”B
 Yµ(Же‚ –mRq№D А е›h \nQ»qєX,ЉЃ 
Ё0•љ  0ET’U$ДТИ U$Дт±„ЁeЙЙк‘–p†¦ѕЁ±  И€КH)Ё±–аЉ\a’ЁЙ€ЄJQњ`Њ¤Љ‹©HеСЂ ЋЉњљЉ§  Ёи©ЙЁС› ђ]|©€Љ
I‘’ћ њѕЁ±С J%Сђ°¦ЉЁ¦®©ZКhЄЉЉ±Ђ 
Ё’„­л ЄЉЄJQР 
Ё љЉ§Ђ К©
‰кЖ3Ђ  ћЁ”B 9Yґд‚БdЉЁ0”B
 Yµ(Же‚ –mRє љ  @АЛ6ЧЂC  Л6м ¬+Ю !Ђ¬Р ‚Йѓ@Q  9fЭр €` fЯЂ(†„ 9D4€КН  ,E_Ђ74К!§ЂQ„ еfЂ EA lЫ„ К§А"ље‹ЂVh  Б`ІD Ђ е›А @ e›PА\ў0 rН·`Q rі@ ‚" @Є еfЂ U fЂ Єо!їЩ"ЄеfЂ  іiX*ЛЂ€nЁ”B 9Yґд‚БdЉЁ0”B
 Yµ(Же‚ –mRееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(UHTOV5)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                        /*			*/
uhtov5(td,mode,deflt,swtch)                   /* Set end of tape action */
struct	_tpdesc	*td;		/* Target tape descriptor		*/
BYTE	mode;			/* Open mode of tape			*/
BOOLEAN	deflt;			/* Take default if none specified Y/N	*/
struct	_sw	*swtch;		/* Switch names and values		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	TDES tape descriptor init
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
         New switch SK added - ICFO
14/09/89 V04.01 issued - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13/02/89 Commentary amended and message numbers changed
         (see UHTOV6.C) - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
09/06/88 ICFO - Listing brought uo to standard
30/10/87 ICFO - Handling of '/NR:' switch added
29/10/87 ICFO - Made into an overlay
         Used to be called SETEOT
27/10/87 ICFO - Switch changed from 'ET' to 'EH'
14/04/87 DAR - Created
*/

{


/************************************************************************/
/*									*/
/* This overlay handles switches:- EH (End Handling)			*/
/*				   NR (No Rewind)			*/
/*				   SK (Skip Files)			*/
/*									*/
/************************************************************************/

LOCAL
WORD	index,		/* Index into switch value array		*/
	c,		/* Holds code of EOT action			*/
	choice,		/* Choice returned from menu func		*/
	nl;		/* Number length				*/

LOCAL
BYTE	gstring[10];	/* Stores ASCII number strings			*/

LOCAL
BOOLEAN	defined;

VOID	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

defined = FALSE;

/* Get from switches if poss						*/
if ((index = fndswt(swtch->swtot,swtch->swnames,"EH")) != FAIL)
				     c = toupper(*(swtch->swvals[index]));
else if (deflt == TRUE)  c = 'C';

/* Restart only available on write					*/
if (mode == 'W' && c == 'R')  defined = TRUE;
else if (c == 'A' || c == 'C') defined = TRUE;

if (defined == FALSE) {
    if (mode == 'W' && defined == FALSE) {

/* Set up menu options							*/
	dframe[0] = swtch->tapmes[26];
	dframe[1] = swtch->tapmes[21];		/* Abandon		*/
	dframe[2] = swtch->tapmes[19];		/* Continue		*/
	dframe[3] = swtch->tapmes[20];		/* Restart		*/
	choice = genmen(3,0);			/* Call menu function	*/
    }

    if (mode == 'R' && defined == FALSE) { 	/* Must be reading	*/

/* Set up menu options							*/
	dframe[0] = swtch->tapmes[26];
	dframe[1] = swtch->tapmes[25];		/* Abandon		*/
	dframe[2] = swtch->tapmes[24];		/* Continue		*/
	choice = genmen(2,0);			/* Call menu function	*/
    }


/* What do we want to do						*/

    switch (choice) {

	case 0:
	    c = 'A';			/* Abandon			*/
	    break;

	case 1:
	    c = 'C';			/* Continue			*/
	    break;

	case 2:
	    c = 'R';			/* Restart			*/
	    break;

	default:
	    return(FAIL);

    }
}


switch (c) {

    case 'C':
	td->eot_action = 0;
	break;

    case 'R':
	td->eot_action = 1;
	break;

    case 'A':
	td->eot_action = 2;
	break;
}

/* Test if 'NR:' switch is set						*/
td->no_rewind = -1;  			/* Set to a silly value		*/
if ((index = fndswt(swtch->swtot,swtch->swnames,"NR")) != FAIL)
						     td->no_rewind = TRUE;
else if (deflt == TRUE)  td->no_rewind = FALSE;

/* If neither the '/NR:' switch nor the default switch is set ask the	*/
/* operator								*/
if (td->no_rewind == -1) {
    tpchat(0,29,30,0,0,swtch);
    if ((c = getkey()) == ESC)  ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХЊ eT…Dхc)@ ЦА                         ељ  NА Л6ЊЂ9D @ е›H ўNеfЂ E@ lР •[Ђ Ђ е›J  А eК! ,Ъ€  .QU  ґC,Ъ  Н  ¬Р ‚С>„v$ B Yµx VН  V$ B YµМ " FДilH¶$ B Y¶ " Yµ„ "є†Yґи•mЂ Ђ е›cЂ А e›e@*§шe›g ¶Р•KЂD  ”B 9D  ”B 9D  ”B Y¶КН  b` rщu€A Л6кЂAЂ Л•љ  9Yµ”‚С>„‚.Wшe›]АTBяІD Ђ е›yА А e›k@/7шdшµaR°  9fРА€0 v$ B  Ёђ „ іiDм іiИ”B Yµ К!µ@ЋVm0 `°X"*  #fЫpUЂЂ–mH†Ђ—(ЄЂ 
Z!–mdfС0mZeQp!  9fЧ €4 r€@ЂЛ6Б „C@ Л”U@ -Л6З №Y  љ  A Л6О „A  Л6ХЂ„_лрЛJбЂ€A +4  `€A Л6Щ „A  Л6д „^ЏрЛjр €Cа+6а °D Ђ е›sАB Р e›y@B А4  eP°!  9fЮА€4 fЯА€ ЂН  µа•EА„  Љ‰ KEАtшB YґVНїАЄ|! ,Ъ>Ђ#bЂЊl Ђ@*$->–џ
Ёђ6‘Ѓ2«Ш„ @rі@ ЉЃ A Л6–ЃAЂ Л6єЂ„WOрЙсjВІ@B К!Ђў(К!ЂўЄ еѓ –mWrіnИ¬B _.¶ёЂ Q еЃ@Q\ еP („ іl•›aЂќb` rщu€h0”U@Ђb* еfЂ 	сjКє@Bыэ’: АР  шµa_ !  9fЪ° €4 c`ѓЃ€A Л6сA  Л”CAЂ¬Ы@БfЪ@  9fЯP €4 fРА0‹э~iR@1$ еfЭР„ іhD іiHEия¶Є„> rіiB YґА" Yµ" 3oђ*¶€A Л6¦Ѓ„A  Л6®Ѓ„@m	fРА&UxЂ@*$ Г§АB@ rН¬Ђa` 2Н«АAУь2|Z°­ „ іl D Ќџв1іьB Y¶\"v Y¶њК! ,Ы\еЪРG+6Ё °X,  іkh*р€A Л6Ы„Aа ИШ# wшB Y·HVНЁ@L«ь! ,ЫКЂ#` Њl –я€A Л6щЃ„Aа Л6Ѓ‚П‹VЈЃЂ–m‡Є_б“вХ…RБ  ”B 9D p”B 9D  ”B Yґ(КНµаN±0 9|єШuДB  9D `”B 9D!p”B  9D А е›NБ¬Ъ~лѓ —Л­›{АT "е†Y·¤•aA/чы$B Yµђ" \ўЄ еfЯ0ENяіkа#6‚ЃЛhБ  $„T Љ`™ ћЁeЙЙк‘ќ`*†\¦°©jЁeКЁи±•0:†\Є‹  И€КH)Ё±њЂ6Љ\aѕИЙИЉjк‘‘pDЋ]  Ии©ЙЁЄqЂ 
ЋЉњљЌrИиЄ‰h«1ђ<ЋЁ–„њ›ЉIСњP,ЋЉЁ“LЙК©©€©СљDў]  Є‰‰(JС™`LЁћЄ  ‹hКЉi*‘“а:Ё Љ¤Ґ К©
‰кЖSЂ  ћАT "е†Y·¤•aA/чы$B Yµђ" \ўЄ еfЯ0ENяіkа#6‚ЃЛhБ  $„T Љ`6Ы„Aа ИШ# wшB Y·HVНЁ@L«ь! ,ЫКЂ#` Њl –я€A Л6щЃ„Aа Л6Ѓ‚П‹VЈЃЂ–m‡Є_б“вХ…RБ  ”B 9D p”B 9D  ”B Yґ(КНµаN±0 9|єШuДB  9D `”B 9D!p”B  9D А е›NБ¬Ъ~лѓ —Л­›{АT "е†Y·¤•aA/чы$B Yµђ" \ўЄ еfЯ0ENяіkа#6‚ЃЛhБ  $„T Љ`™ ћЁeЙЙк‘ќ`*†\¦°©jЁeКЁи±•0:†\Є‹  И€КH)Ё±њЂ6Љ\aѕИЙИЉjк‘‘pDЋ]  Ии©ЙЁЄqЂ 
ЋЉњљЌrИиЄ‰h«1ђ<ЋЁ–„њ›ЉIСњP,ЋЉЁ“LЙК©©ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееreturn(FAIL);
    td->no_rewind = (BOOLEAN) (toupper(c) == 'N');
}

/* Get the /SK switch							*/
if (td->no_rewind == FALSE || mode != 'R')  td->sk_file = 0;

else {
    defined = FALSE;

/* If switch exists then set it to switch value				*/
    if ((index = fndswt(swtch->swtot,swtch->swnames,"SK")) != FAIL) {
	if (strlen(swtch->swvals[index]) != 0) {
	    td->sk_file = atoi(swtch->swvals[index]);
	    if (td->sk_file >= 0)  defined = TRUE;
	}
    }

/* Or take a default if reqd						*/
    else if (deflt == TRUE) {
	td->sk_file = 0;
	 defined = TRUE;
    }

/* While number of files to skip is invalid				*/
    if (defined == FALSE) {
	while (TRUE) {

/* Get length of max file number allowed & add 1 			*/
	    tpchat(0,32,23,0,nl = numlen(MAXFILE),swtch);
	    if (lgetlin(gstring,++nl) != 0)  return(FAIL);

/* If RET only set default to 0 or translate number if not		*/
	    td->sk_file = (gstring[0] == 0) ? 0 : atoi(gstring);

	    if (td->sk_file >= 0)  break;

	    tperr(28);
	}
    }
}

return(SUCCESS);

}

/*======================================================================*/

    if (defined == FALSE) {
	while (TRUE) {

/* Get length of max file number allowed & add 1 			*/
	    tpchat(0,32,23,0,nl = numlen(MAXFILE),swtch);
	    if (lgetlin(gstring,++nl) != 0)  return(FAIL);

/* If RET only set default to 0 or translate number if not		*/
	    td->sk_file = (gstring[0] == 0) ? 0 : atoi(gstring);

	    if (td->sk_file >= 0)  break;

	    tpeееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееAMIE unheadered 1/2" tape utilities
Analyse tape files
Initialise tape
Exit tape utility
Press 'I' to initialise, any other to exit
Load tape for initialisation
Place tape unit online
N.B. Any data held on tape may be lost
Tape initialisation complete
Analysing tape
Tape file number = 
Please wait
Block size = 
Max block size = 
Block type = 
Variable length
Fixed length
No of blocks in file = 
File size = 
Press ESC to exit, another to continue
End of tape files hit
Press any key to continue
Tape now rewinding
Analysis complete
Analysis terminated
Press 'Y' to initialise, another to exit
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХЊаeT…Dхc9@ ЧLB Y   D" №D   е›A@ў@ rНў Q  9fСђ(†г‚9D! ”B 9Yґ€	Ц! /—[4  r€_пцh  К©`ыэ’! ,ЪB 	Ђ.Q( 9fХ („ іjа”B YµђК!№@ЋQL е‚@Vm"u€AЂЛеЦН§`QэюНЁ@«, !їЩ"@ rН­Ђ€ 2Ні`Q( 9fЪ  €L fЪ €eК! ,Ыb Ђ,Ыv СfЂ «ц !
 ¬Р ‚! ,Ы„ е‚ –h  е‚ –mШ r€A Л6ф 9Yґ ‚Б`°Y"@ rНѕ € 2Н  ! љ  0©0„ іh8D& іhёD  fРРh  К§@"0 rНј Kь2Н  ґњ•a@D Ђ е›GЂB!P eК! ,ЪЉе‚ –mQr€A Л6¬Ђ№D74К! ¬ЫБ`°X,‰ф$еїЯмЫ К° "ыэ“-…ЃЂ–m1Є_б–m8eZ°  9fЦ€0 fШ ЉйюfЩm;e\0  9fЩ°€< fЫ`[6ФЂіm`*‡A Л6ЮЂ„BА Л”B
 Y·8К! ,Ыґе‚ –mвr€nЂ#”B 9Y¶(‚Б`°X-иIК!їЩµр•CЂ„/чы&Z!                      EDЂ„ Ђ е›zЂB'` e›K@њўP rН¦ЂNQ( 9fУА'+4  `°X"*@#fЬ@UВ‚ –mD†Ђ—(Єђ
Z!–m\fЪ mRe[р!  9fЦ  €h rЉ© ҐўfЧ '+4  `€Ёр„ іl@D іlё¬UGЂ™  *ЩЃ@ aЫр! 9fЩа'+6и 0e·аL;ё! ,Ыp+fЬUЬЂ *<! ЂTH
[ё-ЬQ &mЛeWp1  еЃ –mЗr€@ („. r€@ („$ іop•љ  :Д А етлС@'(„ rі@ шµeRP1эюЙQ@&h  |Z°©И„  Qа&DС@'+6Ж0DTxB Ёђ„ іhD іjx¬UGЂ™  *є€@ЂЛ6«№Y¶р	‚!  TH	‡w …Tx	’                 B  «Ш„ іk8Dм іlЁ”B Y¶pК! ,ЫHеfФЂ&‚"± b6mpeQpA 9fЪА0€h rЉ¬@ҐўfЬ@6mmfЫ 6UЃЂ–mТ†Ђ—(ЄДЉZ!–mвr€kи•љ  0X"6mаePаAT еfЦ°6Љ@ {–Љ0йђ „ іoЂ­›ЂЩTИB  FUфB «ШґИZd*Ї`lЪ@К·А‚ К! ,Ъ8е‚АQ0 еЂЂQ@ 9fФ@G+6ѓєД А етлЧа7(„ rіhА‚|ZІ«Ш …юяdЋ«р6”Ѓџ¬+,!  Ј*ъ! ЂUм‡nБ5шК!Ї nVmш`°DlЪlК¶ ‚ЁКНЎ Њ»Ђ@*ц-»aУ AХ}fЧрA0’P) 
р@† (ЂљPJ†\њћ©ВЁeКk
‘њ`
†\ЄЋ‹ҐЁeКЁк‘•Р:†\Є‹$ЁeК©Љ‘™рL†ћ¤ђЉ±  И€КH)Ё±ђP$Љ]ШhҐЖ› <Њњ€¦®©ХHеСЂ ЋЉњљЉ§  Ёи©ЙЁС“а<ЋЁ–„њ›XIС–аLЋЉЁ“† J%СЂ 
Ё’„­\КЉi*‘љрJЁ Љ¤Ґ  К©
‰кЖsЂ  ћК!Ї nVmш`°DlЪlКfЬ@6mmfЫ 6UЃЂ–mТ†Ђ—(ЄДЉZ!–mвr€kи•љ  0X"6mаePаAT еfЦ°6Љ@ {–Љ0йђ „ іoЂ­›ЂЩTИB  FUфB «ШґИZd*Ї`lЪ@К·А‚ К! ,Ъ8е‚АQ0 еЂЂQ@ 9fФ@G+6ѓєД А етлЧа7(„ rіhА‚|ZІ«Ш …юяdЋ«р6”Ѓџ¬+,!  Ј*ъ! ЂUм‡nБ5шК!Ї nVmш`°DlЪlК¶ ‚ЁКНЎ Њ»Ђ@*ц-»aУ AХ}fЧрA0’P) 
р@† (ЂљPJ†\њћ©ВЁeКk
‘њ`
†\ЄЋ‹ҐЁeКЁк‘•Р:†\Є‹$ЁeК©Љ‘™рL†ћ¤ђЉ±  И€КH)Ё±ђP$Љ]ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(SETTPE)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                          /*					*/
settpe(tp,mode,swtch)           /* set up tape descriptor from switches */
struct	_tpdesc	*tp;			/* Pointer to tape descriptor	*/
BYTE	mode;				/* Open mode of tape		*/
struct	_sw	*swtch;			/* Switch names and values	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHT.OV1
Revision history:
20/02/89 'deflt' added and 'spfree' changed to 'free' - ICFO
28/10/87 ICFO - Now calls the various analysis routines as overlays
27/10/87 ICFO - Summary of settings not now output if /DF: switch is
         present
14/04/87 DAR - Created
*/

{

LOCAL
WORD	(*ov_go)(),	/* Pointer to a function			*/
	rv,		/* Return value from the overlay		*/
	count;		/* Counter to count through the overlaysееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее Ї                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            Г?Ђ                                                            ! 9Нл"+НN"КQЂ!  Й!†е!Ђе! еН*БББ"Ђ#НN"К{Ђ!†е!. еН‡ББЙНѕ'!†еН„'Б*ЂеН„'Б!†еН„'Б*ЂеН„'Б! 9Нл" Не"єя|µВАЂ*ЂеН„'БГИЂ*ЂеН„'Б!†еН„'Б! 9Нл" Не"єя|µВтЂ*ЂеН„'БГъЂ*ЂеН„'Б! 9Нл" Нл"еНI†Б!†еН„'Б*/ЂеН„'Б! 9Нл"Нл"ГМЃ! 9Не"®я|µВTЃ! 9Нл"4 0 Нл"еН„'БГkЃ! 9Нл"4 & Нл"еН„'БГЭЃ! 9Нл"4 ( Нл"еН„'БГЭЃ! 9Не"®я|µВІЃ! 9Нл"4 2 Нл"еН„'БГЙЃ! 9Нл"4 * Нл"еН„'БГЭЃНш"*Ѓ  nЃ €Ѓ   !†еН„'Б*	ЂеН„'Б! 9Нл"##Нл"|µВ	‚*ЂеН„'БГ‚! 9Нл"##Нл"еНI†Б!†еН„'Б! 9Не"®я|µВn‚*ЂеН„'Б! 9Нл" Нл"|µВX‚*ЂеН„'БГk‚! 9Нл" Нл"еНI†БГќ‚*7ЂеН„'Б!  еН)Б! 9Нл" Нл" )ЅНл"еН„'Б!†еН„'Б! 9Не"®я|µВШ‚*=ЂеН„'Б! 9Нл" Нл"еНI†Б!†еН„'Б*ЂеН„'Б! 9Нл" Нл"еНI†Б! 9Не"®я|µВDѓ!†еН„'Б*ЂеН„'Б! 9Нл"
 Нл"|µВ1ѓ*ЂеН„'БГDѓ! 9Нл"
 Нл"еНI†Б!†еН„'Б*#ЂеН„'Б! 9Нл" Нл"еНI†Б!†еН„'Б*%ЂеН„'Б! 9Нл" Нл"еНI†Б! 9Не"©яНN"КЅѓ! 9Нл" Нл"е!
 9Нл" Нл"СН2"Н2"КB„!†еН„'Б*'ЂеН„'Б! 9Нл" Не"еН'†Б!†еН„'Б! 9Нл" Не"  Нw"К„! 9Нл" Не" Нv"Н2"КB„!"†еН„'Б! 9Нл" Не"еН)Б!> еН)Б! 9Нл" Не"єя|µВМ„!†еН„'Б*-ЂеН„'Б! 9Не"®я|µВ¤„! 9Нл" Нл"+НN"К™„*ЂеН„'БГЎ„*!ЂеН„'БГМ„! 9Нл" Нл"+НN"КД„*1ЂеН„'БГМ„*3ЂеН„'Б! 9Нл" Не"єяНN"Кц„! 9Нл" Нл"+НN"Н2"К
…! 9Не"©яНN"Н2"КЏ…!†еН„'Б*)ЂеН„'Б! 9Нл" Не"еН'†Б!†еН„'Б! 9Нл" Не"  Нw"Кf…! 9Нл" Не" Нv"Н2"КЏ…!"†еН„'Б! 9Нл" Не"еН)Б!> еН)Б!†еН„'Б*5ЂеН„'Б!  еН)Б! 9Нл" Нл"+НN"КЗ…*пеН„'БГП…*неН„'БНD'+е!  еНb(ББ*+ЂеН„'Б*ЂеН~БНРН±("ЂНѕ'*ЂеяНN"К†!яяГ†!  ЙUHT.MS4 
 

  HEX  = < ! 9FЇнoН9†xжН9†Йю
8ЖЖ0OЕН)БЙЙ! 9Нл" ЂН“"Ъs†!- еН)Б! 9е! 9Нл"НЭ"Нр"! 9Нл"цН“"Т–†! 9Нл"л!
 Н3#еНI†Б! 9Нл"л!
 Н3#л0 еН)БЙ          	  ЂЂЂЂ  	    @H    @ @          @  €Ѓ  ЂЂ €  H  	  DЂ  	*/

LOCAL
BOOLEAN	deflt;		/* TRUE if "DF" switch set			*/

STATIC
BYTE	*sov_names[] = {
		"UHT.OV2",	/* set up block structure		*/
		"UHT.OV3",	/* set up block padding if any		*/
		"UHT.OV4",	/* set up start and end position	*/
		"UHT.OV5",	/* set action at end of tape		*/
		"UHT.OV6"	/* Output details if /DF switch absent	*/
	} ;

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

deflt = (BOOLEAN) (fndswt(swtch->swtot,swtch->swnames,"DF") != FAIL);

for (count = 0; count < sizeof(sov_names) / sizeof (BYTE *); ++count) {
	if ((ov_go = ldprl(*(sov_names + count))) == FAIL)
				    return(flerr(*(sov_names + count),4));
	rv = (*ov_go)(tp,mode,deflt,swtch);
	free(ov_go);
	if (rv == FAIL)  return(FAIL);
}

return(SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееpip m:=c:gtape.h[g15
pip m:=c:uhtbl1.sub[g15
pip m:=c:rddata.c[g15
c rddata
era rddata.c
m80 =rddata
era rddata.mac
lib uhtlib[i]=rddata
era rddata.rel
x uhtbl1 runovl
x uhtbl1 wtdata
x uhtbl1 uhinit
x uhtbl1 runtdo
x uhtbl1 tpopen
x uhtbl1 tpclse
x uhtbl1 tpifopn
x uhtbl1 tpofopn
x uhtbl1 tpfcls
x uhtbl1 tpread
x uhtbl1 tpwrite
x uhtbl1 bkiopen
x uhtbl1 bkread
x uhtbl1 bkoopen
x uhtbl1 onlchk
x uhtbl1 bkoclose
x uhtbl1 nxttpe
x uhtbl1 tpchat
x uhtbl1 tapcht
x uhtbl1 tpseek
x uhtbl1 tprest
x uhtbl1 setbot
x uhtbl1 seteod
x uhtbl1 skipb
x uhtbl1 skipf
x uhtbl1 sekerr
x uhtbl1 tpiiock
x uhtbl1 tpoiock
x uhtbl1 tpstat
x uhtbl1 wtfmks
x uhtbl1 lgetln
x uhtbl1 fstpos
x uhtbl1 settpe
x uhtbl1 corhex
x uhtbl1 gtkbnm
x uhtbl1 numlen
x uhtbl1 uhmenu
x uhtbl1 issign
x uhtbl1 doinit
x uhtbl1 fldets
x uhtbl1 tperr
xp c:[g15]=uhtlib.irl
era uhtbl1.sub
pip m:=c:uhtbl2.sub[g15
x uhtbl2 inp
x uhtbl2 out
x uhtbl2 man
x uhtbl2 ov0
x uhtbl2 ov1
x uhtbl2 ov2
x uhtbl2 ov3
x uhtbl2 ov4
x uhtbl2 ov5
x uhtbl2 ov6
x uhtbl2 ov7
x uhtbl2 ov8
x uhtbl2 ov9
x uhtbl2 ovA
x uhtbl2 ovB
x uhtbl2 ovC
x uhtbl2 ovD
era gtape.h
era uhtbl2.sub
era uhtbld.sub
bl1 numlen
x uhtbl1 uhmenu
x uhtbl1 issign
x uhtbl1 doinit
x uhtbl1 fldets
x uhtbl1 tperr
xp c:[g15]=uhtlib.irl
era uhtbl1.sub
pip m:=c:uhtbl2.sub[g15
x uhtbl2 inp
x uhtbl2 out
x uhtbl2 man
x uhtbl2 ov0
x uhtbl2 ov1
x uhtbl2 ov2
x uhtbl2 ov3ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее    	      @ $  ЂЂ "  @@  Ђ      $  Ђ    @      ђ  Ђ Ђђ  ђ          D   @      @@          A    Ђ         ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                             UHT(BKOCLOSE)
*/
#include	"dd.h"
#include	"gtape.h"

EXTERN
struct	_bc	bc;

EXTERN
struct	_tpdesc	tp;

/*======================================================================*/
STATUS                                            /*			*/
bko_close()                                       /* Close OUTPUT block */
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/06/88 Code from 'bkwrite' moved in here as it was only one line - ICFO
10/06/88 Block is padded when 'tp->short_block' is TRUE not FALSE - ICFO
07/06/88 Split into two from 'bk_close'
06/04/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* if we have valid data in the block					*/
if (bc.bk_data != 0) {

/* if writing fixed length blocks then pad out the block if necessary	*/
    if (tp.bktype == 'F' && tp.short_block == TRUE) {

	setmem(bc.bk_ptr,bc.bk_free,tp.bpad_chr);
	bc.bk_data += bc.bk_free;
	bc.bk_free = 0;
    }

/* add any post data padding						*/
    setmem(bc.bk_ptr,tp.post_pad,tp.dpad_chr);

/* write the block to tape						*/
    if (tpo_iochk(
	mtwrite(bc.bk_data + tp.pre_pad + tp.post_pad,bc.bk_base),0)
						   == FAIL)  return(FAIL);
}

/* increment current block no						*/
++bc.bk_curnum;

return(SUCCESS);

}

/*======================================================================*/

	bc.bk_free = 0;
    }

/* add any post data padding						*/
    setmem(bc.bk_ptr,tp.post_pad,tp.dpad_chr);

/* write the block to tape						*/
    if (tpo_iochk(
	mtwrite(bc.bk_data + tp.pre_pad + tp.post_pad,bc.bk_base),0)
						   == FAIL)  return(FAIL);
}

/* increment current block no						*/
++bc.bk_curnum;

return(SUCCESS);

}

/*=========================ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(TPOPEN)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                           /*			*/
tp_open(control,mode,lev)                        /* Open a tape for I/O */
struct	_ctrl	*control;		/* Control structure		*/
BYTE	mode;				/* Open mode = 'R' or 'W'	*/
struct	lvl	*lev;			/* AMIE Level structure		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- General Unheadered Tape Library
Revision history:
08/05/90 Correction to repositioning algorithm for INPUT and not at
         BOT - ICFO
22/11/89 New positioning algorithm when reading and tape is not
         at BOT - ICFO
20/11/89 Bug fixed in positioning algorithm when tape was not
         at BOT - ICFO
19/10/88 Changes to positioning algorithm - ICFO
28/06/88 Code to allow for not rewinding at the start of a run
         added - ICFO
24/06/88 Updating of block controller moved to before 'tp_seek' because
         'seteod' which 'tp_seek' calles uses the values set up - ICFO
23/06/88 Code to seek to start moved to here from file open code - ICFO
20/06/88 Arguments passed in 'control' structure - ICFO
14/06/88 Listing brought up to standard - ICFO
         Allocation of block buffer removed so it can be overlaid - ICFO
         Control structures passed as arguments - ICFO
30/10/87 Does not rewind or seek to start of file if /NR switch set
06/04/87 Created DAR
*/

{

LOCAL
WORD	status,			/* Return status from 'space'		*/
	retval;			/* Dummy because we only skip one block	*/

LOCAL
BOOLEAN	at_bot;			/* TRUE if tape at BOT at start of run	*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* clear control structures						*/
setmem(control->bc,sizeof(struct _bc),0);
setmem(control->tf,sizeof(struct _tf),0);

/* check if unit is online						*/
if (tpstat(ONLINE) == FALSE)  return(tperr(0));

/* check that we can write to the tape					*/
if (mode == 'W' && tpstat(WPROT) == TRUE)  return(tperr(1));

/* set I/O mode to variable blocklength					*/
modsel(0);

/* rewind tape if Writing OR allowed to rewind by the absence of 	*/
/* the /NR switch							*/
if (control->tp->no_rewind == FALSE)  setbot(control,TRUE);
else {
    if (tpstat(BOT) == FALSE) {	/* NOT at BOT				*/
	control->tf->tf_num = 1;/* Prevent seek to start if no rewind	*/
	control->bc->bk_curnum = 1;
    }
}

/* update the block controller						*/
control->bc->bk_stat = TRUE;
control->bc->bk_size = control->tp->bksize;
control->bc->bk_omode = mode;

/************************************************************************/
/*									*/
/* The search to start position is performed as follows:-		*/
/*									*/
/* 1) If  the tape is at BOT and / or the NR (No Rewind) switch is  not */
/*    set then space forward as defined by the SF (Start File), EF (End */
/*   ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                              UHT(BKOOPEN)
*/
#include	"dd.h"
#include	"gtape.h"

EXTERN
struct	_bc	bc;

EXTERN
struct	_tpdesc	tp;

/*======================================================================*/
STATUS                                    /*				*/
bko_open()                                /* Open block area for OUTPUT */
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheadered tape library
Revision history:
07/06/88 Created from 'bk_open' - ICFO
06/04/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* set block pointer to start of block data area			*/
bc.bk_ptr = bc.bk_base;

/* if we are at EOT forget it						*/
if (tpstat(EOT) != 0)  return(FAIL);

/* fill pre data area with pad character				*/
setmem(bc.bk_ptr,tp.pre_pad,tp.dpad_chr);
bc.bk_ptr += tp.pre_pad;

/* calc no of bytes available in block					*/
bc.bk_free = bc.bk_size - (tp.pre_pad + tp.post_pad);

/* set valid data byte count to 0					*/
bc.bk_data = 0;

return(SUCCESS);

}

/*======================================================================*/
rea			*/
bc.bk_ptr = bc.bk_base;

/* if we are at EOT forget it						*/
if (tpstat(EOT) != 0)  return(FAIL);

/* fill pre data area with pad character				*/
setmem(bc.bk_ptr,tp.pre_pad,tp.dpad_chr);
bc.bk_ptr += tp.pre_pad;

/* calc no of bytes aееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее File), SB (Start Block) and EB (End Block) switches.		*/
/*									*/
/* 2) If the mode is INPUT and the tape is NOT at BOT and the NR switch */
/*    is  set then space backwards one block and space forward over  SK */
/*    (Skip Files) file marks.						*/
/*									*/
/* 3) If  the mode is OUTPUT and the tape is NOT at BOT space backwards */
/*    until a block is found which is not a File Mark.   Space forwards */
/*    over  this  block (good practice any way to  position  the  heads */
/*    correctly in the inter block gap).   If the 'concatenate' flag is */
/*    NOT set write a File Mark to terminate the previous file.  If the */
/*    concatenate  flag IS set this will position the tape correctly to */
/*    add data to the file.						*/
/*									*/
/************************************************************************/

if ((at_bot = tpstat(BOT)) == TRUE || control->tp->no_rewind == FALSE) {
    if (mode == 'R' || control->tp->st_file  != 1
		    || control->tp->st_block != 1) {

	while (tp_seek(control) == FAIL) {
	    if (control->tf->tf_stat == EORD && nxt_tape(control,lev)
			    == SUCCESS)  (*control->tape_chat)(0,4,6,0,0);
	    else return(FAIL);
	}
    }
}

/* If we are reading and NOT at BOT skip forward a number of files if	*/
/* so requested								*/
else if (mode == 'R' && at_bot == FALSE) {
putstr("Here 2");
    if (control->tp->sk_file != 0) {
	space(-1,'B',&retval);		/* Skip back one block		*/
	space(control->tp->sk_file,'F',&retval);
	control->tp->end_file =
			 control->tp->end_file - control->tp->st_file + 1;
	control->tp->st_file =
    		control->tf->tf_num =
				control->bc->bk_curnum =
						control->tp->st_block = 1;
    }
}

/* If we are not now at BOT ensure that we are at the end of a file.	*/
/* Create an end if necessary						*/
else {
    status = space(-1,'B',&retval);
    while ((status & 0x02) != 0) {
	if ((status & 0x40) != 0)  break;	/* BOT hit		*/
	status = space(-1,'B',&retval);
    }
    space(1,'B',&retval);
    if (control->tp->end_file != 0 || at_bot == TRUE)  wtfmks(1);
}

return(SUCCESS);

}

/*======================================================================*/
e end of a file.	*/
/* Create an end if necessary						*/
else {
    status = space(-1,'B',&retval);
    while ((status & 0x02) != 0) {
	if ((status & 0x40) != 0)  break;	/* BOT hit		*/
	status = space(-1,'B',&retval);
    }
    space(1,'B',&retvalееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(BKREAD)
*/
#include	"dd.h"
#include	"gtape.h"

EXTERN
struct	_bc	bc;

EXTERN
struct	_tpdesc	tp;

/*======================================================================*/
STATUS                        /*					*/
bkread()                      /* read block from tape into block buffer */
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHT INPUT Processor
Revision history:
28/06/88 Separated out from 'bki_open' because TCDP needs it - ICFO
*/

{

LOCAL
WORD	bkstat,		/* return value from mtread			*/
	byterr;		/* no of bytes too long/short			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Issue the read command						*/
if ((bkstat = mtread(bc.bk_size,bc.bk_base,&byterr)) != 0) {

/* Check out the return value and return the status			*/
    if (tpi_iochk(bkstat,byterr) == FAIL)  return(FAIL);
}

/* Calculate number  of bytes in the block				*/
/* Error if block < number of padding bytes				*/
/* Cannot compensate for padding and then test for < 0 as bc.bk_data	*/
/* is UWORD								*/
if ((bc.bk_data = bc.bk_size - byterr) < tp.pre_pad + tp.post_pad)
							return(tperr(20));

/* Adjust to compensate for pre & post padding				*/
bc.bk_data -= (tp.pre_pad + tp.post_pad);

/* Number of free bytes = 0						*/
bc.bk_free = bc.bk_size - bc.bk_data;

/* Put block pointer at start of block data				*/
bc.bk_ptr = bc.bk_base + tp.pre_pad;

return(SUCCESS);

}

/*======================================================================*/
pad)
							return(tperr(20));

/* Adjust to compensate for pre & post padding				*/
bc.bk_data -= (tp.pre_pad + tp.post_pad);

/* Number of free bytes = 0						*/
bc.bk_free = bc.bk_size - bc.bk_data;

/* Put block pointer at start of block data	ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(CORHEX)
*/
#include	"portab.h"

/*======================================================================*/
STATUS                     /*						*/
corhex(sptr,dbyte)         /* parses a character or hex val from string */
BYTE	*sptr,	/* pointer to the source ASCII string			*/
	*dbyte;	/* pointer to the destination byte to be set		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module 	UHTLIB - general unheadered tape library
Revision History:-
07/06/88 Listing brought up to latest standard - ICO
15/04/87 Created DAR
*/

{

BYTE	hatoc();	/* ascii hex to char converter			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (strlen(sptr) >= 2) {	/* parse a hex no from the string	*/
    sptr[2] = 0;
    *dbyte = hatoc(sptr);
}
else *dbyte = *sptr;

return(SUCCESS);

}

/*========================================/*
.pa
.he                                                              UHT(TPOFOPN)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                             /*			*/
tpo_fopen(control,lev)                             /* open up tape file */
struct	_ctrl	*control;		/* Control structure		*/
struct	lvl	*lev;			/* level descriptor		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/10/88 Algorithm for skipping back over trailing filemarks has been
         rewritten in the same way as that in 'tpopen' - ICFO
23/06/88 Code changed to allow for concatenation of files and spacing
         over file marks to be done at open file rather than at close
         file - ICFO
20/06/88 Arguments passed in 'control' structure - ICFO
14/06/88 Call to 'tp_seek' changed to 'tpo_seek' - ICFO
08/06/88 'tpfopn' split in to two, one for INPUT, one for OUTPUT - ICFO
06/04/87 Created DAR
*/

{

/* assumes that the tape is now set to the start position & position	*/
/* variables are set to current file and block				*/

LOCAL
WORD	status,			/* Return value from 'space'		*/
	retval;			/* Return value from 'space'		*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* check tape unit ready						*/
if (tpstat(ONLINE) == FALSE)  return(tperr(0));

/* if we are at EOT check multivol action				*/
if (tpstat(EOT) != 0 && nxt_tape(control,lev) == FAIL)  return(FAIL);

/* Space back to just after the first file mark unless this if the 	*/
/* first file of a session (in which case the tape will have been 	*/
/* positioned in 'tpopen') or the tape is at BOT			*/
if (control->st_sess == FALSE && tpstat(BOT) == FALSE) {	
/*    space(-1,'B',&retval);	/* Cannot space -2 because the file ...	*/
/*    space(-1,'B',&retval);	/* ... mark will terminate after the ...*/
/*    if (control->tp->end_file == 0) {	/* ... first one		*/
/*	space(-1,'B',&retval);						*/
/*	--control->tf->tf_num;						*/
/*    }								!!!!!!!!*/
    status = space(-1,'B',&retval);
    while ((status & 0x02) != 0) {
	if ((status & 0x40) != 0)  break;	/* Will this leave a ...*/
	status = space(-1,'B',&retval);		/* ..spare block at BOT?*/
    }
    space(1,'B',&retval);
    if (control->tp->end_file == 0)  --control->tf->tf_num;
    else {  /* Do not concatenate files */
        control->bc->bk_curnum = 1;
        wtfmks(1);
    }
}

control->st_sess = FALSE;

return(SUCCESS);

}

/*======================================================================*/
0) != 0)  break;	/* Will this leave a ...*/
	status = space(-1,'B',&retval);		/* ..spare block at BOT?*/
    }
    space(1,'B',&retval);
    if (control->tp->end_file == 0)  --control->tf->tf_num;
    else {  /* Do not concatenate files */
        coееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее                                                                                                                                  RD_DATю /RUNOVLю 	WT_DATю cUHINITю 	]RUNTDOю DTP_OPEю gTP_CLOю TPI_FOю ]TPO_FOю ITP_FCLю !{TP_REAю $'TP_WRIю &rBKI_OPю (ZBKREADю +6BKO_OPю --ONLCHKю /BKO_CLю 1sNXT_TAю <2TAPE_Cю >~TPCHATю AnTP_SEEю G1TP_RESю ISETBOTю KGSETEORю OISKIPBю Q3SKIPFю T8SEEKERю W TPI_IOю [NTPO_IOю \zTPSTATю ^LWTFMKSю `aLGETLIю aSFSTPOSю cMSETTPEю ftCORHEXю hGTKBNMю jdNUMLENю kaUHMENUю m\ISIGNOю pDO_INIю rFILE_Dю }TPERRю  ю…”‘U`e$EфDI@ Ф           ЂЂ–h   ,Ъ еfЂ  €ЩґX E@ T " YґЊК*  Vh  Б`€Ё Ќљ  2Єш „ іiЂ D( ЌЃв1° B 9Y  ’* @1сjВ®ЂЄ 6€ЖПцк PЂ[6 Ђ2¬а ЄЂ 9ETљ  Ё@сjКІА‡f@ 0ЫЂ
Ё ”U@Ђ¶ EB ‹VUґ Ђ@;n !  %¶а* * АVmK uЉЁ eљ  
Ё0 ЊFеfЫр(ЄЃ 3@ mЗ P` € rЉЁ 6н @@Л6и AЂ Л6чЂ9ETКН  ,LeдЎ—''ЄF  2"2’
j,fђ"—F  9t` #ў§&ў©Ж  *:*rj4gШ$Fz ‰tdh(Ј==============================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(DOINIT)
*/
#include	"dd.h"

/*======================================================================*/
STATUS                                  /*				*/
do_init()                               /* main initialisation sequence	*/
/*======================================================================*/
/*USE
Portability level 1
Parent module UHTMAN
Revision history
07/06/88 Keyboard buffer flushed before input of operator response - ICFO
27/10/87 Completion message now requests user to press any key to
         return to Utilities Menu
20/04/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Please wait								*/
chat(19,20,NULL,NULL);

/* rewind tape to BOT							*/
rewind(FALSE);

/* write 3 filemarks							*/
if (wtfmks(3) == FAIL)  return(FAIL);

/* rewind tape to BOT							*/
rewind(FALSE);

/* acknowledge sucessful completion of init sequence			*/
tape_chat(0,8,21,0,0);
kflush();
getkey();

/* initialisation sequence complete					*/
return(SUCCESS);

}

/*=====================================================================*/
	*/
chat(19,20,NULL,NULL);

/* rewind tape to BOT							*/
rewind(FALSE);

/* write 3 filemarks							*/
if (wtfmks(3) == FAIL)  return(FAIL);

/* rewind tape to BOT							*/
rewind(FALSE);

/* acknowledge sucessful completion of init sequence	ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееўЄFЂ*ЉЄ*Є,t()"/ў ЄFuА™telЄ("©)FN 2ў‚ъ’*а  …”•S“Х“ e%TдхdЙ@ ХЊ ЄH*‰еaш      ` ељ  FT C@ ¬Р ‚"Ў 6h  К¦а  еЃ Vh  Б`ІET К! ,Р ЖеЃЂ–m@ q№D5HЖй`°DT( UB ¬Р ‚*Ў@Й C.NOTЊ  dDe$ФXЙђFLERRЊ® De$TXИ€G.Њ  dtTдФU8А GENMFЊ¤Ђ$‚иИаLDPRLЋ† e%TдхdЙА  …•ХU`euEфDI@ ЦШ        ЉЃ @@Л4  ‚Ђ–m rі@ ЉЂ 3h° Ќљ  2©hН 
Ё  D іi”U@ ґФК*    2Н§ЂЪJ В«аЄ   ,ЪЋ +ЉЩµ(љ  9Y  ‚БP 6®Ђ2¬Р „ rі@ ­›[ЂVh B Yµ\К! ,Ы еfЂ ЉЃ KfЂ%і@ rН±а` 2НіаQU  rі@ U@Ђ1—Р
†\њћ©  И€КH)Ё±– Љ\a  HеСЂ ЋЉњљЉ§  Ёи©ЙЁСљ`ђ]“ ЙЛ
‹к€1‘ ўЋЉ©® Є*ЁЄЁ±—ЂЁ ¦Ё‚©d КЉккI1Р@®Ёѕ€‚©8  …•RS’U eT„”д•I@ ХМ B Y  ”B YґК! ,Р К! ,Ъ еfЂ ‚#fЂ Єd !їЩ"@ rНЈ Ъn #№D   е›NЂ @ e›Q  Р e›RА¬Р ‚Н  ўыэљ  2«x „ rі@ $B  2c% №9=R0 ‘”ђSQc, 	є2* ‘ЛЈ  95N0 QСS“QЈ*@	 є2ґ ”KЈ$ IU9Q>2¬”ФSг-`QAIJ: •RS’U'   …”•S•аe%TеDDщ@ Хј     5њКН  "*  еїЯмР •IА5њК! ¬Р ‚БdЉЁ ”B
 Y  ЌК! ,Ъ` гr€A@Л4  q№D   е›N@nQT qєX,E@ЂT КН  "Є Й*’
‚вyXb Њ  dDe$ФXИ E.Њ‘ TdДU%(КG.Њ  dtTдФU8А GENMFЊҐЂ$‚иИHLDPRLЋ‚ e%TеDDшЛ SPFREEњ   …•ФS eEфхY@ ЧP       9fЂ Ъ еѓАQ  еfЂ B Yґ8 F#fТ@(„ r€@ +6Ќ 0X, еfЂ h  КЄ  КН  ,‘ 9fЂ Kь2НЁ`ЄЬ !  ¬Ъ~ Біjи4  eWР еfФР$B  9Y  B Yґ¤ " Y¶( " Y¶D›[ VР B Y¶`К! Ђ¬Р ‚БaЮЂ еfЦp6НЂ2Ї@ „ іm( ЊFНёа1Ш#  ` е›s ·h " FАШ-и ЃЂ–mЭ fЮР°F6 @АЛ6ш 3oа D №D Ђ е›А @ e›BАB Р e›DЂY   „ іhИ6‘Ђ„AЂ Л”B YµXў}	@@+6ЬЂ0DT VН· *В! ,ЪL ,ЪњЂ,ЪЄНЁЂ,ЪЮ К§ЂB  rН¦@!sь2Н«а,+! ,Ъё ,Ъъ#іl ­›XЂY¶4…kЂD ` е›b@B @ e›fЂB Ђ e›h@ElЫ НµЂ,Єr! ,ЫPеfЂ 6№ЂІ©И„ іmИЊFН№Ђ,Ыў+ЉЩ·•}АD ` е›u \ў  rНјЂ.Vh  Б`іnР6ЧЂІ©ђ„ іo`D іh”B  8Ьў ЖеЃЂ7(„  q№D  ЌК!Ґ@N7K‚Б`°XtШBяІXvРZrГє b  rН­Ђ!sь2Нѕ ,Є¦* ЂЪђНї ,ЄЂ! ,Ъ ,Ъј ,ЪК|ZІ©и…юяr€H@(†Ѓ 9Y  ‚БЃЂ–mlЃ –mЉЃЂ–m‘r€HА(†Ѓ 9Y¶ 	‚Б`€@АЛ6М@Ђ Л6Ч@Ђ Л”B Y¶Ф" Y·" Y· 	К! ,Ыћ ,Ы®#іnр4  іhа„ іoD іo€ЊFе‚ –mш€ЩґF#r€A@Л6ѓЃіh€D №D А е›E В @ e›H В Ђ eК! Ђ·Ё	›LЂЩґФ›N Шw@Bя№D$ ”C@Ђ¬ЫHБ`°DT  U@ АлofХ@&UЋP 0 ъж Щµ|•]ЂШv8Bя№D$ ”C@Ђ¬ЪљБ`°DT ‡U@Д ”BB 9D4КН°`lB Yґњ" Y¶”" Y¶°›[ЂШWUA lЪўН¶Аl« ! Ђ¬Р ѓ-Р–и€@ Lg Ў—''ЄF  2"2’
j,gў—FP@’9t` #ў§&ў©Ж  *:*rj4fМ$F`Ђ2jz"љ*dgА',*/Є ЖNАТ‰tg	)—Fk@2љ*ўz¤dФ)ўЄ&ў¦ЖfАкљ‚
,eдЄ("©)FO rў‚љў
¤t*(/§Ё"Жo@rў‚ъљ*,g4+Є#&Ґ©О   …•УС`eEф4Дщ@ Х$  Ђ *  !Ђ¬Р ‚+fЂ Є$! ,Р ›G  А eљ  U/рЙсjВєАКНЎ [6‰ 2Є „ іhш ЊFНЁ Ъ” +fУ°h  КєА rН© p 2Н«АQ  гr€AЂ”B 8ЬўpЖеЂ 7(†Г 8Э,‚БfЂ Р КН  !“ь2НЄ «` ! ,ЪК еfЂ 6НЂ3j *Э _пцH„ rі@ ЉЂ @@Л6ТЂДlЫ” 6 ЖА	n° „ іnx D іnШ D. іo6Ч 2Ё0„ іoH”B 9Y  ‚#fЮАm± eQ эю"  С  9fЯ`m€Ьў  rНЈ@,ЪH#іi8•љ  0Y   „ іi`6ќЂЌЂ1° U@ 1ђ@†\њћ©  И€КH)Ё±ђpЉ\a© ИКjЉ	кq’`Ћ]  Ии©ЙЁЄqЂ 
ЋЉњљЌЏ ИиЄ‰h«1“ађ]Њ ЙhЙЉЄi“@ў]ю КhЄ€Iк‘“ ¦ Њ¤Љ‹“ К‰кЄ
±“`Ё ¦Ё‚© КЉиi‰с›р®ЁЊљ–§8  …•Q“Ф eE•фdщ@ ХЂ B 9Y  љ  2Ёё „  rі@ $B Y   D іhа”CJАn‘6„Ђ2©° …юяd€@ЂЛ6‘ЂДlЪv 6 €ЖА 9fФ Ќ›S  @ dl ЌЂ “- ЁeЙЙк‘Ђ €Њ¤‚љ‹  HеСЂ ЋЉњљЉ§  Ёи©ЙЁС•ђ] ЄЉЄJQР Ё ’ѕЊџ КЉ
j€*“Ђ  …•С“Ф eEхфdщ@ ФМ     0•љ  0Y  *ЌЂ@ +4  `ІD •›B@,Р •PЂ @ ељ  9D @ е›KЂ¬Р ‚Біhh6’ 2Є` …юяd€@ЂЛ6› A  Л6ЁЂ3j *µЂ@@+6ђ 0Yµl›PАT|Bя№D$ ”C@Ђ¬Р ‚Б`€Ё  ЄЂ 	ЂЧ0ЮН­Ђ«~ *  `хМ@7іlЂ*УЂ0нш …юяr€H@(†Ѓ 9Yµш‚Б`€Ё Г @ („„ r€h•›m ,„ іjА D іn° D іnисjВ Ђ"  rНјЂ16ш ДnVmх і@ Ѓ –mы fРђ€4  Dc` „ rі@ ґ|B Yґ0" FАШ !  1–ђ
†\њћ©  И€КH)Ё±™рЉ\a  HеСЂ ЋЉњљЉ§  Ёи©ЙЁС’@ђ]: ЙЛ
‹к€1џрў]М Єj(h±‘p
Ё Љ¤Ґ КЉ	лиЙс–PЁ ¦Ё‚©Кк€Й©jsЂ  …•ђУаeEфd4Й@ ЦД   P („ і@ m ѓ –h  W?Г'Е«
§ @ЂЛ6‡ 3i( D №Yґ  FН   @ е›L ўКН  ,[„E@ l‘ 9fУ° €( fХ0(†± 8Э"6h  К­аыэ‡QА @ е›VЂb6mt  c` „ rі@ Ќ›Y VT Bя°к8 „ іkИ ЊFНі@1•›gАlЪh !  u3PЛ““Х#  I52* ‘ЛЈ  95N0 QСS“QЈ4 	 є3R ”KЈ(`M-%A:•СђУ#0 ]Q5-Np  …•‘PQ eEх$T@ Хи   I   вХ…GАR@Р
 #I@(X4  і@ U їџм™hш ЄHCАў0 rН  ў0 rНҐ ±Tђ ђ 3@ UF ЃЂ–m0 aФђTђ љ Ё •љ  0X,Tђ(ЈЂ:ЕT  2"’ U@Tђ ® 9ET љ  ¤Ѓ | U$ ­ ±U  €¤ЂЂ° U@ 1—@„‡ ИIi+йк‘`
†\њћ©7 ЁeК©Љ‘”а† ІљЉ›  И€КH)Ё±Ђ Ћ]  Ии©ЙЁЄqЂ 
ЋЉњљЌA IС–`¦] КЉкHЁ3Ђ  …•Ф’U eEхu$™@ ЦD B Y  ¬U$
     *Ќ D +4  `ІD ` е›A@ў©  	 r€A Л6ЏЂ9Y  ‚БI )¬B Yґ¬ 2"’ SPTђ( Ђ9D ` е›O@   ЉHQ R@Ђ
¤ лЃ –mL €¤Ѓ T B Yµt VН  V4љ  Щµ°•_А/чы%љ  ЩµШ•c@/чы&[ !  1–„‡r ИIiлиi‘ „–ћѕћЎ„ ЁeЙЙк‘ђА
†\ЄЋ©/ Иj)Ё©±Ђ €Њ¤‚љ‹  HеСЂ ЋЉњљЉ§  Ёи©ЙЁС–Ђђ]O JeС‘`
Ё Љ¤Ґ  КЉккI3Ђ  …ђ’ТSФ`d$ґ•фх	@ Х< U$   R@@
 *’    љ  2ЁШ ЄHAА  6†Ђ3@ U+ I (¬U$     6Ћ 2©Ш ЄHHЂb© h fСђm, eT° "¤Аыэ’Н  1“`„‡  ИIi+йк”А„–¤Љ‚‰) ЁeК©€±“ђ
†\Є©  И€КH)Ё±“АЉ\a  HеСЂ ЋЉњљЉ§  Ёи©ЙЁС”PЁЌ2 JЉЂ  …ђ’Ф‘PQ d$µ$TI@ Ц0     R@`  К*’ PP(†Ѓ 9Y  ‚БP h  К¦аЄ  еP +4  `°DlР •MА/чы&Zn *’ Pђ(ЄЃ 3@ ђ њ 9ERA  Ц*’	ЂT` ЛEљ  2Єи „( rі@ $U$ ©@±TђLЇ \ў© @B qіiш ЉHYАR@`
Ь еI +€6µЂ¤Ѓ@Ф U$ Ї`±TђD± DR@@
ь !  1`„‡ ИIjHЁ(‘’а
†\њћ©O ЁeК©Љ‘Ђ €Њ¤‚љ‹ hҐЖЂ Ћ]  Ии©ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(FLDETS)
*/
#include	"dd.h"
#include	"gtape.h"

#define		FIXED 0
#define		VARIABLE 1

/*======================================================================*/
STATUS                                   /*				*/
file_dets()                              /* print details of tape files	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTMAN
Revision history:
13/06/88 BR491(1) - Test for 'Valid Bit Not Set' introduced - ICFO
07/06/88 Keyboard buffer flushed before character read from
         operator - ICFO
27/10/87 Block size is reported correctly when a zero length file
         is analysed following a normal file - ICFO
         Test to see if the operator presses 'Esc' added - ICFO
20/04/87 Created DAR
*/

{

LOCAL
UWORD	bsize,		/* hold block sizes				*/
	bcount,		/* counts no of block in file			*/
	maxsze,		/* holds max block size				*/
	filenum,	/* file number					*/
	retval;		/* return val from tape functions		*/

LOCAL
LONG	fsize;		/* holds file size				*/

LOCAL
BOOLEAN	eov,		/* end of volume/bored operator flag		*/
	eof,		/* end of file flag				*/
	fstblk;		/* set to true if it is the first block through	*/

LOCAL
STATUS	bktype;		/* holds block type				*/

LOCAL
BYTE	status,
	dumbuf[20];

EXTERN
BYTE	*tpmes[];

BYTE	mtread();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (tpstat(ONLINE) == FALSE)  return(tperr(0));

if (tpstat(BOT) == FALSE) {
    tape_chat(0,22,11,NULL,0);
    rewind(FALSE);
}

chat(19,20,NULL,NULL);

eov = FALSE;

filenum = 0;

/* check for initialised tape with no data				*/
if (space(1,'B',&retval) != 0 && space(1,'B',&retval) != 0)  eov = TRUE;
rewind(FALSE);

while (eov == FALSE) {
    clrs();

/* analysing please wait						*/
    tape_chat(0,9,11,0,fsize = bcount = bsize = maxsze = 0);

    eof = FALSE;
    bktype = FIXED;
    fstblk = TRUE;
    while (eof == FALSE) {
	status = mtread(20,dumbuf,&bsize);

/* Test if the operator has pressed 'Esc'				*/
	if (const() == ESC)  CLEANUP;

	if ((status & 0x01) != 0) {
	    tperr(12);			/* Tape unit reports error	*/
	    CLEANUP;
	}

	if (status != 0 && ((status & 0x44) == 0)){
	    eof = TRUE;
	    if ((status = space(1,'B',&retval)) != 0) eov = TRUE;
	    space(-1,'B',&retval);
	}
	else {
	    bsize *= -1;
	    bsize += 20;
	    ++bcount;
	    if (fstblk == FALSE) {
		if (bsize != maxsze) bktype = VARIABLE;
		if (bsize > maxsze) maxsze = bsize;
	    }
	    else {
		maxsze = bsize;
		fstblk = FALSE;
	    }
	    fsize += bsize;
	}
    }

/* now at end of file							*/
    clrs();
    putstr("\n\n");
    putstr(tpmes[10]);	/* tape file number				*/
    putnum(++filenum);

    putstr("\n\n");
    putstr(tpmes[14]);	/* block type					*/
    if (bktype == FIXED) putstr(tpmes[16]);
    else		 putstr(tpmes[15]);

    putstr("\n\n");
    if (bktype ЙЁЄqЂ 
ЋЉњљЌ ЙЄЉHЁ(‘—Ђ¦]‚ JЉ•ђ
Ё Љ¤Ґ( КЉ	+й)уЂ  …ђ’УУФ`d$ґхфх	@ ХP U$   R@@
 ! Ђ¬Р ‚|ZІЁё …юяdЉ¤ЂЂК*’Ђ  QФђTЋ 3@ +4  `°X"©   uЉ¤‚ Ђ 2"’ RРTђDЂ:ЕRA0
p rЉ¤ЂАФЖН  R@ 
‚ !  R@Ђ
ђ !  1”а„‡  ИIiлйк’0
†\¦°©  И€КH)Ё±Ђ Ћ]  Ии©ЙЁЄqЂ 
ЋЉњљЌE JeС’p¦ЉЁљЉ›< JЉђ°Ё ¦Ё‚©8  …“У“ТаdфдД4„№@ Х” B 9Y  љ  2« „ і@  €8 fС0(„  q№D ЌК! nQ  гr€@ ”CNАn–‚Б`€@`+6‚Ђ0Yґ$•X@   EКяџ¬*ј !їЩ,:Ђ-a Ђ КHC.NOTЊ§ЂT4фе5HА DFRAMEЊ  $rиА GENMESЊ  TtTдФhИРH.ЋЂ dфдД4„ёК(TPSTATњ   …ђ’УРУаd$ґхф4Й@ Ц\ U$   ‹VUЊ I   h  ]?Г,Р •GАR@р
 +fС0h  К©`©   rЉ¤Ѓ@К:’ Qђm rі@ ‚*’ R XЄHNА") @? Ђ ) PC I *H”U$ ҐАQФђTЁ 3i€•›M@,ЄHS b© €T єЕRA0
К rЉ¤Ђ@„КН  ,(„  rі@ FНЈ « !їЩ2ШАTђ4·ЂДR@Р !  1™„‡  ИIiлиi‘0
†\њћ©W ЁeКk
‘Ђ €Њ¤‚љ‹  hҐЖЂ Ћ]  Ии©ЙЁЄqЂ 
ЋЉњљЌs ЙЄЉкI*‘•°¦ЉЁљЉ›j JЉ—РЁ ћѕ’џ8  …“–`dе…EхD@ ЧАЉЕ‚ –h   ,Ъ НЎА±YсjВЄА0 rНў   26ЖА  9fСрm/ ѓ –h  TїГ,Р •RА P§ BА+4  `°X,‘ 9r€A@Л6™ ДlЪА #іk(4  Ђ —(„ іkP6јЂA  Л6ѕ 3kh „ іl6ЖЂAЂ Л6њЂUПрЙсjВІ "@ rНІ p 2НґаQ  гr€A`”B 8Ьў0ЖеЂ 7(†зЂ8Э,‚БЂ Vh  Б‚ –m® ѓЂ–mб r€@ ”B 8ЬўЂЖеЂ 7(„  q№D4$Жй`°X,4  fЂ Р  "е†O‹V&їЯм:¦ ! ,ЫР еfЂ 6  2©ш…юяaХ0  9fТ°(„  rі@ FН¦Ђ,Єє!їШuLљ  A Л6ў „AА Л6ІЂ№D  ЌК!ЂnQ  гr€@ ”B  8Ьўгt°X,‡^ЂД Ђ е›[ B а e›fЂ\ў Же„@7(„ q№D `ЌК!  nQВqєX,‚! ,ЫB ,ЫНє`"івХ…}АD Ђ е›uЂ\¬Р ‚#fХ UчїЯм:¦-чЂАVh  Біo`*†_пцS Ђ VmЩ `€A Л6сЂ„AА Л6ЊЃ9D  ЌК! nQ@ гr€@ ”B  8Ьў‚гt°X,›CАYґH›E@B.WшdшµaUа!эюГЄ`@ rН¤ NVm/`€Щґ	•]А„/чы©ЂA Л6±Ѓ9D  •›S X,6¶2¬Ё…юяaХ0	lЁ„  rі@ ­›bЂ™TАB 9Yµ@‚! ,Ъш ,ЫbеЂ 7(„ q№D! ЌК!  nQ  гr€nИЌТБ`°X,mGfФ &mM№_б“вХ…}Ђ„/чы©ЂA Л6Ь9Yµњ	‚#fЩр&UїЯм:¦ ! ,ЫцеЂ Vm„`°DlЪКҐ bыэ‡TАvT	›WЂD Ђ е›E В а e›N Ьў ЖеѓА7(„  q№D  ЌК!  nQ`qєX,‚! ,Ъ~#іkPD ЌЂ"1° B Yµј" Yµь›aЂЕgЕ«
УЃ€@АЛ6ДЃ„BЂ ИШ # /чы©ЂA Л6Л€ДlЫX#№D @ е›l@Щ¶ B Y¶м›q@В Р eК! ,ЫђН·Аb@ rНєЂa` 2Н»АnQнqєXuL2DPЛ““Х#& q1IN0 ‘”ђSQc<а9MQA=N3. ‘ЛЈ  95N0 QСS“QЈ< YQ-f3К’Ј<@Y-1UM": “–Хc?аY=91!.3®”KЈ" YI]%928”СU“Х#5 UQAIJ34•ХU#;аYU91=3ш•Х“RФз   …•ТU eDUф9@ Ч8            Ђ *  )Р  Л”B Y   ¤"  Yґlљ  A Л6‘Ђ¬Є¦ *  1  „h eК! ,ЪZ )Ср Л6Ј 3i0 „ іjpсjКЇАЄ  #P HFЃ \ў@ rН« ђЌJ іk€6ЁЂ@ЂЛ6јЂ¬«R *  1  „h eК! ,Ы )ЧP Л6О 3kа „  r€@ (ЄЂ ДT К! @Q( 9fЪ@+4  `°X,&0 ‘”ђSQc8А%1=0  ‘ЛЈ  95N0 QСS“QЈ8@	 є3N ”KЈЎ@QA}3@UQTз   …•TТ eE4„I@ ЧШ            Ђ *  )Р  Л”B Y   Dh №D!  е›FА-Л6“Ђ3@ ( 9fТРвХ•YАT  F"  ђЌ №D @ е›MА#@ eК! ,Ъ  )h†Yµp›L  Ђ е›XЂ‹VUњ P ЉЂ 
B4 2еЃ –ml Ќ —(„ іl( ҐўfЩme ЃЂ–m— >-YWD U@ b*  )Р  Л”B Y¶„ "4 \ўP rН·@–€e›qЂ¶h B  9D  ”U@ b*  еР („ іn`•љ  0X,“  И€КH)Ё±ћа€’‚ћЏ  HеСЂ ЋЉњљЉ§  Ёи©ЙЁСћ ђ]П J%СР Ё †ђ‚©8  …•СQRаeEх4TY@ Чx       9fЂ   2НЎ`16‰ Ё  „ іhё D іi D іi@ ЉЃ @@Л6—Ђ3iИ D і@  ЉҐюfЂ ЄЄ *  Ъ” Н  U  B YґрКН  ,‘U  Ђ@Р …c    е›X b6my €ЩµшЦ*  Р ›UЂW  B Y¶›eА А e›PА*—шe›TАW B Y¶h " Y¶И " Y¶д›j ¶4›qЂW| B Y· К! Ђ¬Р ‚БP  ‹шюН  TB Y·L " Y·АК!  nQ гr€@ ”B  8Ьў ЖеСЂҐ‚Б`°X" EA t°B  Ё  „ іoё”U@ nVh  Б`€Щ·•R@D/чы$U@Ђ P4  eU°U fФ mЙ eY0 9fУ€8 fЦ`(„  q№D @ЌК!  nQ  гr€@ ”CcЂ\n–‚Б`€@@Л6¶Ђ№ET VеfЂ Ќ›V@YVАBяІD   е›f Y¶Ф" \ўЄ Н     е›n Db6mК€ЬўЄ  Нё`" “o €eИи±• †\©§ЁeЙЙк‘ћ`
†\Ё¦©Љ ЁeКЁк‘Ђ €Њ¤‚љ‹\hҐЖљЋ]  Ии©ЙЁЄqЂ 
ЋЉњљЌПIСќЂў]Ы КhЄ€Iк‘–@¦ЉЁЉћҐЎЄii*Q“ ¦–’ Ќ КЉкhЁіЂ  …•‘TХ eEх$U9@ Х B Y   ЊFН    2НЎ@¶h  К¤`КН  ,‘ 9fС+4  `€ЩґT…V  @ е›J  А e›NАў0 rНЁ@7(†©Ђ8Э,6Ђ3@ Ub їЯм‘  ЙЊ« T2ддхHА DFRAMEЊ¬Ђ4RгЙ`FSTPOSЊ  $rиА GENMESЊ  TtTдФhКPH.ЊЏЂUEU%(и TP_RESњ   …”СU“Х e4UD$хI@ Цґ B 9Y  љ  2« „ і@ [6„Ђ2ЄИ „ іh D іi”B  8ЬўЖеЃЂ7(„  q№D  ЌК!© 7K‚Б`°D  •љ  0Xu„ B 9YµLѓ-a Ѓ –m( €ЩµК! ,ЪЦ #іk6ј 3@ h  ! ,Ъц #іl@ ЊF6 €ЖА 9fШРm› ѓ@‘°F6 @ Ld\Ў—''ЄF  2"2’
j,eшў—F  9t` #ў§&ў©Ж  *:*rj4fx$F`@‰tex)"«¤§"G@ 2љ*ўz¤d*()Є ЄN   …”СUSС e4UDTх)@ Х,  ЂЂ–h  еЂ@Vh  Б`€Щ  *Џ _пцH„ r€H@(†Ђ 9Y  ‚БЉЩґT•SА ”BB 9D4 КНҐ`V+fУ0h  К±@ КН  " rН а16± Ђb1° B Yµњ " YµМ F#rіkР Ќљ  @ H„ іl  D іlx”B  8Ьў8ЖеЃЂ7(„  q№D  ЌК!¶а7K‚Б`°D  •›VЂ" rНІА16дЂ3np ¬V+>-YT€љ  \ЇрЙсjВЅ`ыэ’! ,Ыў  ,Ыа #№Y·Ь FН°Ђ rНї Q еfЂ Ќ›S@T|BяІXw B Yґ F#fТpЌК! ,ЪX ,Ъl#іiи6ЂЂ€@ LdXЎ—''ЄFw *zrљ¤` "#) ¦ўЖT )q„` #—F  2:*rj*њ` Јў§&ЈFPЂRAte(—Fp@2’*єJr$d<)ўЄ!'ЄG@Ђ2љ*ў*z”d@©Ґ¤Ё#FQ@*љ‚
,а  …TТТT U4ґ•)@ ХИ        E@@   ељ  ¬ЄЬ ! ,Ъ  еђЂQ rі@ ‚}P Х  fЂ Е«
ўЂ@@ИШ #  @ е›G ЈЄ  Н¦ Q	 еfЂ E@@lР •ZАuё‡BАT“c ЁeЙЙк‘•
†\¦°©  И€КH)Ё±Ђ Ћ]  Ии©ЙЁЄqЂ 
ЋЉњљЌJ IС•ђ¦ЉЉ–ЉҐ Єii*Q’Ђ
¦ ‚†‹8  …TТТT U4ґ•i@ Ч      РP 9fЂ  љ  2ЁШ ЄЂЂ3@ h  Кј@К!# ў еfЂ ъ2  ±[6ЊЂ2«  „ №Yґ( VН   @ е›Q@b6mP €Ь¬ЪЄ #fФђ 9fХ°mf ѓ@‘°F6 @ („„ r€h•›KЂ,	сjК¶   rН­ 16И Ђb1° B Y== FIXED)  putstr(tpmes[12]);
    else		  putstr(tpmes[13]);
    putnum(maxsze);

    putstr("\n\n");
    putstr(tpmes[17]);
    putnum(bcount);

    putstr("\n\n");
    putstr(tpmes[18]);
    lputnum(fsize);

    putstr("\n\n\n");
    putstr(tpmes[19]);

    kflush();
    if (getkey() == ESC)  CLEANUP;
}

cleanup:

if (eov == TRUE) {
    if (filenum == 0) {
	tape_chat(0,20,21,0,0);
	kflush();
	getkey();
    }
    else {
	tape_chat(0,20,22,11,0);
	rewind(FALSE);
    }
}
else {
    tape_chat(0,24,22,11,0);
    rewind(FALSE);
}

tape_chat(0,23,21,0,0);
kflush();
getkey();
clrs();

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(FSTPOS)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                    /*				*/
fstpos(control)                           /* wind back to start of file	*/
struct	_ctrl	*control;			/* Control structure	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/06/88 Arguments passed in 'control' structure - ICFO
08/06/88 Listing brought up to latest standards - ICFO
         Optimised - ICFO
13/05/87 Created DAR
*/

{

LOCAL
WORD	retval;

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (tpstat(BOT) == FALSE)  space(-1,'F',&retval);
if (tpstat(BOT) == FALSE)  space(1,'F',&retval);

/* position at start block if ness					*/
return(skipb(control,
		   (control->bc->bk_curnum = control->tp->st_block) - 1));

}

/*=====================================================================*/
ought up to latest standards - ICFO
         Optimised - ICFO
13/05/87 Created DAR
*/

{

LOCAL
WORD	retval;

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (tpstat(BOT) == FALSE)  space(-1,'F',&retval);
if (tpstat(BOT) == FALSE)  space(1,'F',&retval);

/* position at start block if ness					*/
return(skipb(control,
		   (control->bcееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее¶T шµeZаэю"  ;љ ! ,ЫB еP h  е‘ЂVh  Б`°DT Bя№D$ ”C@А¬Ы Б`°Xt U@@1‘ †\©: ЁeЙЙк‘›Р
†\¦°©  И€КH)Ё±‘АЉ\a  HеСЂ ЋЉњљЉ§  Ёи©ЙЁС›`ђ]_ J%СњP¦ЉЉ–ЉҐ Єii*Сќ 
¦ ‚†‹8  …”СRСT” e4TTґU)@ Цр B Y  сjВў  ’! ,Р  "ѕ†Y  *Ђ@ЂЛ6‚Ђ	ЂЧ1ЮНЈЂР •Y /чы”BB 9D ` еКН  ,„ іhЁ ЊFН©а`Њl ЃЂVh  Бd€@АЛ6Є 3kH D іi0 ERяіix*ЕЂ@ +4  `ЉЩµи›LЂVh B 9YµЂ‚ЙЃ –ms  ®`	Ѕ›c Vа B 9Y¶X‚Г·` “‰ ЁeЙЙк‘Ђ €Њ¤‚љ‹Ё hҐЖ™рЋ]  Ии©ЙЁЄqЂ 
ЋЉњљЌl IСР ¦ЉЉ–ЉҐE Єj(h±› 
Ё Љ¤Ґ„ КЉ
j€*“Ђ  …•RSРаeE•ф”щ@ Х¤B Y  4  eQp 9fРPm fЂ ЄB !  "  rНў@`хМD7іhЁ*г @ЂЛ6“ 	ЂЧ0ЮНЈ Є  ! ¬Р ‚ЙЂ@Q	 е‚ —+4  `°X,Ъ„ К­а‡\Ђ   €  їЯоQ	 е‚ —+6Ї 0X,эюеђЂQ  9rіl‚БIЂ   €  Н  VД U$   b© Pњ fЪ md e\  еfФАвЂ_пцHЄHj ў  rН§ Р •yА @ е›sААлofЫ mе e_`„ еfЫА$B Y·p " @3@ Х‚ЂVmт `ІGR@АX Н  +§шe›KАT°B Y·м "  3@ mи eSЂTђ<€ іhР6–ЂІЄ8„ rіhX’! ,ЪH& \А{6њЂІ«(„ rіj‡Z D  &3Ћ ђђг%@1№1R2lPЛ““Х#"`5№MaR2PЛ•Х#5а№U1R0 ‘”ђSQc:@	є2ЄСKЊ#  	є0 ‘СS“QTг  952’Ј2АMA2ж •Ј&`)QB2ѕUT”Ј  QA%}%>p  …•ТSРаeEхф”щ@ Х B Y  4  eQp 9fРPm fЂ ЄB !  "  rНў@`хМ7іhА*џЂAЂ+4  `°к „  dЖE@*rrz¤` "#) ¦ўЖKА)q„` #—F  2:*rj*њ` Јў§&ЈFIЂAtdдЄ("©)G@ 2ў‚zъJ|а  …•ХU eE5DI@ Хx            
 rі@ „ і@ HFЂ YґlК:Ў`Р љ  3@ U; Ђ@:| !  T0 B YґЊ V+џ¬*ґ *ЎЂЧpЮ"ЎЂЄ ЙЊ–Ђ$иЙPC.SXTЊ  dDe$ФXЙЂE.0Њ  $rиА GENMESЊ  TtTдФhК0H.Њ‰Ђd”еT•(иpTPSTATњ   …•Х“RФаeuDdФµ9@ ЦL     TК*  Q 9rі@ [4  џ¬« ! Ђў  еfЂ ЉЃ [ПрЛ4  eT@ еfЂ [6™Ђ3@ UM aСаU ·џб–mB eVP еfУР6ЄЂ3j(*» @ +6ЇЂ0YµЊ›YЂV( BяєЬ"*  бP [%‡C   їЂF] *rrz¤` "#) ¦ўЖ]А)q„` #—F  2:*rj*њ` Јў§&ЈFDЂAtdX(—F\ 2ў‚љў
¤dњ«Ј&ЗA 2єў2jZња  …“СU dДtUDД™@ Фђ   fЂ   rН  ў  rНЎ@Vh  Б`€Ё 4  P Ldx!Є©/§ЈF@А2Є’ъzt` #—FEЂ2:*ўbJtdH$G@Ђ2b:*ўbLа  …‘”ХФаde5Eх9@ Хд   ЂЂVh  БfЂ ЄD !їЬў0К!  Vh  Б`°D  •›AА,Ъ КЁ@К!# ў  еfСР‚! ,Р К! ,ЪЋ Н©аh 2еЃЂ–mR Ѓ –m^ ‚ –me fЂ ·+4  `°Y1’°
†\њћ©  И€КH)Ё±Р Њ¦Ё ћ§  HеСЂ ЋЉњљЉ§  Ёи©ЙЁС–Ађ]o J%С—@
¦–’ …= Єj(h±’pЁ ¦Ё‚©8  …”СU`e4UEEY@ Ф        л ]аМ{Ђ/° „ і@  ‰Ш fСp(„ іhр”CЂ¬Р ‚Б`€Щ   Љѓ @  P@ ‹мюН  WH‡V@T F" Ђ:Ђ * ЂђЌ іi0•љ  0DT  FН  V$ UA ! fЦ („ rі@ ’*  Q  9fЧА”B Y  ЌК* А7(„ іlђЌК!¶@7K‚Б`€Ё ЄЂ 9Y  U@ЂlЪЬ К№аыэ’Г©а ’U$Дт°И U$Дт°М U$Дт°Р U$Дт°Ф U$Дт°Ш D# #8А№9=R2ЋPЛ•Х#  I52j СKЊ#0Ђ1IJ2\‘“‘ХХ#7АI36 ‘ЛЈ  95N0 QСS“QЈ5 	 є2МS“#ў@MQQAp  …ђУФ’V d4х$„U‰@ ХL B Y  •љ  0B/гы4  iS  9fРPЊl ЂЂ–m r€@АЛ6’Ђ9Y  ў}	0кx „ іih”B Yґьљ  4OЎ!  ЙЊ€ T2еE5Hи CORHEXЊҐ $rиК8H.ЊЂT„Dф8ИHSTRLENњ   …‘ХР““`duDґ$дЩ@ Ч          B  Ё  „ і@  P U rЉЁ4  rі@ DъfЂ Є® * @ЪF ZїГ'Е«
¦Ђ@  P ° U@Ђb* ГЈ`ХpU  fУpm. eXU  fХ° €А Н  Uш U@ µњ "9 3@ m^ fЧрU‘ P ЉЂ 0кё ЄЂ 9Y  EAЂT VН  W  UAЂ,шeҐm /чы$UAЂ  #4  P`U dЖeЂ"
ўzLeґ!—#ЄF_ "rb¤fм!—&Є¦*Fh@*rrz¤fў—F]Ђ9tt #Є%Ў'&ЖDАAtdњ*'ЄЁ("О   …“•SSS dеTФДTй@ ФР   Ђ@*  ! .Vh  л‚ЂР љ  3@ U0 aТРU  €Ё „ 0й ЄЂ 2c" №UZ26 СKЊ#  	є2 ’Ј @9U51:20 ”K§   …•RQS•`eT„ФTеY@ ХИ     @  €  I Ђ(( ЉHB    ељ  ¬*b ! T  RЎА—(ЄHBА  ¤Ђ
¤ЂЂ¤ E$ ¤Ђ E@ !j rЉ¤ЂАИ›K T К!  ¬Р ‚БP („ іhЁ Ќљ  2«p …юяaЧU dЖOА2"2’
j,eЊ"—F  9teH#ў§&ў§F  2:*rj*њ` Јў§&ЈFWАAte(—FQ *ў‚j*њt*¤&ў§*О   …’TФТQУ d•4”tдщ@ ЦШ   Ђ Q еЃАQ  еЂ Vh  Б`°X,h  Н  ¬Р ‚[їГ'Е«*› @ H„  P U  fЂ «d !  ў(К! ўИК!  ¬Ъ. Б`°X,m fТ +6“ 0B*wшdшµeWђ  ЙЂАVh  БP m@ eY   еfЂ   еfЧа­›a@Vј B 9Y¶<‚!  T ‡O  &38PЛ““Х#  	є2К‘СUСVc @%M%9>2Д’С“TТ#+@QA}2Т•ХTc4АQAIJ3.•ХU'   …‘ТS’U dDхф”д™@ ХЂ B 9D!@”B  9D  •љ  0X,„  rі@ „ rі@ Ќљ  2©ђ …юяd€@ +6Ћ 0D  ”B 9D!P”B  9D  •љ  0X,љ  3@   ЙЊ”ЂT2ддхHИ€CHATЊ  dDe$ФXи DO_INIЊ  $rиА GENMESЊ  TtTдФhКРGETKEYЊ«ЂdґdЕU4€ЙёREWINDЊ§ЂeDUф8Й WTFMKSњ   …‘“Uаdd”ДUфI@ Ч                                                @`+4  `і@ UB Ђ Vh  Бd€@@+6 0YґР•]   ”B 9D °”B  9D  •љ  0X,B  9Y  B 9D!@”B  9D  •љ  0X,„  Pа  " АК!! ў еfЂ љ  2®  „ r€H@(†„ 9Y¶ђ‚Б`іmP6б 2®Ђ „ Pа  еfЧЄ‡ 3jX*Љі@   е‚@Q, еЂ Q  " Ђ*  " @Р  CBЂ  ЄН¬ ±0 9|єД   Љ€ @  Ђ@*$ *ў Ыё КЁ B К!ўаQ  rі@ ‚}Q`h  rїГ'Е«
ЄЂ°и к‹ 3@ 0 ъж ›Щ·•\ЂD А•›OЂ,:(:ўАЪІН¬@,«:ўАЪм& \ДC{6•ЂіkИ*и €@  Ђ@Q	 еРЂ+6Ю 0X,иК‹ 3lp*ЭЂ€@  їЯоQ	 еРЂ+6У °X,BP  ‹эюН  T  U@ !@ dE@ T F" @Є$ Н±`,Є>* ЂQU  fЂ Є! ЂTP UA bЄ  Н  TpU@ T‡JА…T  EA    Љ‰ hP4  bµET ›@@Y   †… 3h8“Ђіo †Ю№Y  U$   ¬ЪљБP`Љѓ 9Y  Co Ь¬ЪЄБI *€•›Z@"Є( |Z°¬8ЄH@[@њ¬ЪвБaШр!TђxѕЃ9Y¶	‚!·ЂnVmЊ`ЉЁ сjВµ@B© А€rіl ‡lЂ…RA @еfЪ@&Є‚ 9Yµ„	‚!·ЂnVmЇ`Љ¤„@¬	КН·аLU rіmёCo Ь¬ЫЋБI	 .•›uА" НҐаLV«4  `°D6ьКН»аLTђнЃ9Y·Р	‚Н     EКяџ¬*"ГўЂl;°-Pа[6шЂІ«ђЄѓ ¬*–!  ў К!
Ђў К!  ¬ЪБ`°X,m fР06oЂ QP е…ЂQ, еЂ Vm;`°X,„  rіnЁ‡eЂД  ”B 9D!`”B 9D  •›X Ш,‚!  ¬ЪШБЂ Q\ е…@Q  еЂ Vm‡`°X,6ЎЃіj06Ј2A@  …•RХ‘ eT…DхdI@ Х B Y  •љ  0DlР •EА/чы$B YґК! ,Р К! ,Ъ8 еfЂ FНЎАЄЂ !їЩ"0 rНҐЂ0 2е‚ –mE Ѓ –mQ €Щµ`љ  @ LdЬЎ—''ЄF  2"2’
j,dђ#—F  2:*rj*њ` Јў§&ЈFW@Atd$'§&!¤%ЖX ‰t` Є&$Ў+F  2ў‚bJґdА*(/§Ё"З@ 2ЄBўzІ$а  ћ               UHTOVD  $$$                    GETVFD  C     Ф              GTKBNН  C     Ш              GTFTAD  C     Ч              GTSDAT  C     	Щ              GTSDIR  C     Ъ              GTSPCE  C     Ы              ISSIGО  C     Э              ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(GTKBNM)
*/
#include	"portab.h"

/*======================================================================*/
UWORD             /*							*/
gtkbnm(s)         /* special version of atoi, string may have 'K' in it */
BYTE	*s;	/* source string to be translated			*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	TLIB library
Revision history:
08/06/88 Listing brought up to standard and optimised - ICFO
14/04/87 Created DAR
*/

{

LOCAL
BYTE	*ptr1,	/* Used to avoid too many accesses to argument		*/
	*ptr;	/* used to access array members				*/

LOCAL
BOOLEAN	kcalc;	/* is a Kb calculation necessary			*/

LOCAL
UWORD	rv;	/* return value						*/

UWORD	atoi();	/* ASCII to integer translator				*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

kcalc = FALSE;	/* Kb calculation not reqd				*/
ptr1 = ptr = s;	/* poi(
 FuАrrjЄb¤ddЎ—''ЄF`ЂjrљВ¤dD
Ў—*¦*Fa@"B
¤fд!¦))ЖQАjzrљ¤` "#) ¦ўЖl Z)q„t¬#$¦"ЇўF  9t` #ў§&ў©Ж  *:*rj4fШ#ўЄ%ў¬ЖMАЄB©rdfМ%Ј&*©¤FNЂЄar
"$g&&'§#—FzАІb‚Єўr¬dф&Є)" ўFЂRqtg<(*Є'*¦Ж І‚Єўљў”fL)"«¤§"FP Іљbzr9tg ©Ё ЎўЖjАтў
‚*ъe°Є("©)F~ Єў‚j*њe*()Є ЄN   …UT” UEU%)@ Фd CE@¬Р ‚! ,Р КН  ,’© Ё Њ  dDe$ФXА G.Њ  dtTдФU8А GENMFЊ†Ђ$‚иИ€NFERRЊ‚Ђe4UDU%(и TPERRњ   ћееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(TPOPEN)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                           /*			*/
tp_open(control,mode,lev)                        /* Open a tape for I/O */
struct	_ctrl	*control;		/* Control structure		*/
BYTE	mode;				/* Open mode = 'R' or 'W'	*/
struct	lvl	*lev;			/* AMIE Level structure		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- General Unheadered Tape Library
Revision history:
19/06/94 Correction to repositioning algorithm for OUTPUT and not at
         BOT - ICFO
08/05/90 Correction to repositioning algorithm for INPUT and not at
         BOT - ICFO
22/11/89 New positioning algorithm when reading and tape is not
         at BOT - ICFO
20/11/89 Bug fixed in positioning algorithm when tape was not
         at BOT - ICFO
19/nt to start of string				*/

/* check entry for byte or Kb calculation				*/
while ((*ptr = toupper(*ptr)) != NULL) {
    if (*ptr == 'K') {
	kcalc = TRUE;		/* Kb translation reqd			*/
	*ptr = 0;		/* terminate string at the 'K'		*/
    }
    ++ptr;
}

/* strip off any leading non numerics inc signs				*/
while (*ptr1 != NULL  && (*ptr1 < '0' || *ptr1 > '9'))  ++ptr1;

rv = atoi(ptr1);	/* translate the number				*/

/* multiply up to Kb total if necessary					*/
if (kcalc == TRUE) {
    if (rv >= 64)  return(0xffff);	/* but not silly values		*/
    rv *= 1024;
}

return(rv);	/* return number					*/

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(ISSIGN)
*/
#include	"portab.h"
#include	"gtape.h"

/*======================================================================*/
BOOLEAN                          /*					*/
isignon()                        /* request go ahead for initialisation	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHTMAN
Revision History:
08/06/88 'kflush' introduced and code optimised.  Listing brought up to
         standard - ICFO
27/10/87 First question now requires 'I' not 'Y'
*/

{

LOCAL
BOOLEAN	ready;		/* is tape unit ready to go			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* 'press 'I' to initialise any other to exit'				*/
tape_chat(0,4,7,0,0);

/* get user response							*/
/* if response is 'I' go into init sequence				*/
kflush();
if (toupper(getkey()) != 'I')  return(FALSE);

ready = FALSE;
while (ready == FALSE) {

/* please load tape & place unit online					*/
    tape_chat(0,5,6,25,0);

/* if response is 'Y' then check out tape unit				*/
    kflush();
    if (toupper(getkey()) != 'Y')  return(FALSE);
    if ((ready = tpstat(ONLINE)) == FALSE)  tperr(0);
    if (tpstat(WPROT) == TRUE) {
	tperr(1);
	ready = FALSE;
    }
}

return(TRUE);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее10/88 Changes to positioning algorithm - ICFO
28/06/88 Code to allow for not rewinding at the start of a run
         added - ICFO
24/06/88 Updating of block controller moved to before 'tp_seek' because
         'seteod' which 'tp_seek' calles uses the values set up - ICFO
23/06/88 Code to seek to start moved to here from file open code - ICFO
20/06/88 Arguments passed in 'control' structure - ICFO
14/06/88 Listing brought up to standard - ICFO
         Allocation of block buffer removed so it can be overlaid - ICFO
         Control structures passed as arguments - ICFO
30/10/87 Does not rewind or seek to start of file if /NR switch set
06/04/87 Created DAR
*/

{

LOCAL
WORD	status,			/* Return status from 'space'		*/
	retval;			/* Dummy because we only skip one block	*/

LOCAL
BOOLEAN	at_bot;			/* TRUE if tape at BOT at start of run	*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* clear control structures						*/
setmem(control->bc,sizeof(struct _bc),0);
setmem(control->tf,sizeof(struct _tf),0);

/* check if unit is online						*/
if (tpstat(ONLINE) == FALSE)  return(tperr(0));

/* check that we can write to the tape					*/
if (mode == 'W' && tpstat(WPROT) == TRUE)  return(tperr(1));

/* set I/O mode to variable blocklength					*/
modsel(0);

/* rewind tape if Writing OR allowed to rewind by the absence of 	*/
/* the /NR switch							*/
if (control->tp->no_rewind == FALSE)  setbot(control,TRUE);
else {
    if (tpstat(BOT) == FALSE) {	/* NOT at BOT				*/
	control->tf->tf_num = 1;/* Prevent seek to start if no rewind	*/
	control->bc->bk_curnum = 1;
    }
}

/* update the block controller						*/
control->bc->bk_stat = TRUE;
control->bc->bk_size = control->tp->bksize;
control->bc->bk_omode = mode;

/************************************************************************/
/*									*/
/* The search to start position is performed as follows:-		*/
/*									*/
/* 1) If  the tape is at BOT and / or the NR (No Rewind) switch is  not */
/*    set then space forward as defined by the SF (Start File), EF (End */
/*    File), SB (Start Block) and EB (End Block) switches.		*/
/*									*/
/* 2) If the mode is INPUT and the tape is NOT at BOT and the NR switch */
/*    is  set then space backwards one block and space forward over  SK */
/*    (Skip Files) file marks.						*/
/*									*/
/* 3) If  the mode is OUTPUT and the tape is NOT at BOT space backwards */
/*    until a block is found which is not a File Mark.   Space forwards */
/*    over  this  block (good practice any way to  position  the  heads */
/*    correctly in the inter block gap).   If the 'concatenate' flag is */
/*    NOT set write a File Mark to terminate the previous file.  If the */
/*    concatenate  flag IS set this will position the tape correctly to */
/*    add data to the file.						*/
/*									*/
/************************************************************************/

if ((at_bot = tpstat(BOT)) == TRUE || control->tp->no_rewind == FALSE) {
    if (mode == 'R' || control->tp->st_file  != 1
		    || control->tp->st_block != 1) {

	while (tp_seek(control) == FAIL) {
	    if (control->tf->tf_stat == EORD && nxt_tape(control,lev)
			    == SUCCESS)  (*control->tape_chat)(0,4,6,0,0);
	    else return(FAIL);
	}
    }
}

/* If we are reading and NOT at BOT skip forward a number of files if	*/
/* so requested								*/
else if (mode == 'R' && at_bot == FALSE) {
    if (control->tp->sk_file != 0) {
	space(-1,'B',&retval);		/* Skip back one block		*/
	space(control->tp->sk_file,'F',&retval);
	control->tp->end_file =
			 control->tp->end_file - control->tp->st_file + 1;
	control->tp->st_file =
    		control->tf->tf_num =
				control->bc->bk_curnum =
						control->tp->st_block = 1;
    }
}

/* If we are not now at BOT ensure that we are at the end of a file.	*/
/* Create an end if necessary						*/
else {
    status = space(-1,'B',&retval);
    while ((status & 0x02) != 0) {
	if ((status & 0x40) != 0)  break;	/* BOT hit		*/
	status = space(-1,'B',&retval);
    }
    space(1,'B',&retval);
    if (control->tp->end_file != 0 || at_bot == TRUE)  wtfmks(1);
}

return(SUCCESS);

}

/*======================================================================*/
k = 1;
    }
}

/* If we are not now at BOT ensure that we are at the end of a file.	*/
/* Create an end if necessary						*/
else {
    status = space(-1,'B',&retval);
    while ((status & 0x02) != 0) {
	if ((status & 0x40) != 0)  break;	/* BOT hееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(LGETLN)
*/
#include	"portab.h"

/*======================================================================*/
STATUS                     /*						*/
lgetlin(s,chrs)            /* special version of getlin for UHT drivers	*/
BYTE	*s;			/* source string to be translated	*/
UWORD	chrs;			/* size of buffer			*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB library
Revision history:
08/06/88 Listing brought up to standard - ICFO
18/04/87 Created DAR
*/

{

LOCAL
WORD	rv;	/* return value						*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

cur_on();
rv = getlin(s,chrs);
cur_off();

return(rv);	/* return number					*/

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RS” $$8	QTPЃUQTаeT…D”е	@ ФP                                                                                                                     B Y   Eжяџ¬+
 ! ,ЪЪ еfЂ H„ іkи D( ЌЂB1° B Y¶(‡s D4  EV 4< EVЂ4T EW    ЉІ @ f РА'(†— 9D! •љ  0X,T і@ Uз РА'(„\ rі@ ’!« Q 9fЩ („¤ r€ip•љ  0X,Ќ›u T4BяІXt 
Z -ђЂQX r€@АЛ6ш 9Y  ‚БU@+4  `°и@„n r€jА”B YґtКН¤ ,’! ў° еЃЂ–m>rіj‚Бd€F (†¬ 9D ` е›U@\¬ЪІБ`°Y2Ч`д еХЂ(„ іk`•›\ X,$B Y¶" FАсШ ! Ђў° еЃЂ–m’rіl8‚БdЛm e¶Ђ,:!  ў К! ¬Р ‚Б`°и@4  іа   Ђ(ЂD @`
b TЂPЇЂ‚@Ш ®А °Ќ - 0m AАh   ;n!  %RAP\M)Њ@њР\¦®’Ё‡  HHq› „–’ѕћЎЁeЙЙк‘’°†¦ѕЁ±  И€КH)Ё±њ@Љ¤¤ѕђѓв ЁЙ€ЄJQЂ Ћ]  Ии©ЙЁЄqЂ 
ЋЉњљЌЄIСњ ћ њѕЁ±Ѓ КH‹и€*‘ља¤Єњћ¬™ё К€*«иqРрЁЌ  Є‰‰(JССPЁЎ  КЉ	‰(JСТа
Ё љЉ§ь К©	)Й*‘ЦЂЄђЁ’њЎ8  ћ TЂPЇЂ‚@Ш ®А °Ќ - 0m AАh   `°и@„n r€jА”B YґtКН¤ ,’! ў° еЃЂ–m>rіj‚Бd€F (†¬ 9D ` е›U@\¬ЪІБ`°Y2Ч`д еХЂ(„ іk`•›\ X,$B Y¶" FАееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(NUMLEN)
*/
#include	"portab.h"

/*======================================================================*/
WORD                                         /*				*/
numlen(num)                                  /* calc length of a number	*/
UWORD	num;	/* number to be looked at				*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	TLIB
Revision history:
08/06/88 Listing brought up to standard and 'len++' changed to '++len'
         to save space and for speed - ICFO
24/04/87 Created DAR
*/

{

LOCAL
WORD	len;

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

for (len = 1; (num /= 10) != 0; ++len);

return(len);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•ђT‘–аec$dхc)@ Х„          B Y  •љ  0DT  U@  ` e›C@T U@Ђ)p eК! ,Ъ> Н  ,Р  U@Ђ(ђ dlP  ЉX     е›L@ўЄ  еfЂ „  dЖ  2"2’
j,` #—F  2:*rj*њ` Јў§&ЈFT@AtdР&&'§#—FD@"Љ:*¤edЁЄўЄўЖN 2љbzr9t` Є&$Ў+GB 2±’2z±”а  ћ                            EJECT   REL   Z               DBUG    MS1   ¶              LTCDPЙNPREL   *°Х            DBUGLNK SUB                 BTCDP   ERR   Љ              LLOYDПV5REL   ‹              AMIE    FLE   ©               	LAPACМOGPRC   
L               ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(NXTTPE)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                     /*						*/
nxt_tape(control,lev)      /* do we load another tape & continue on Y/N */
struct	_ctrl	*control;			/* Control structure	*/
struct	lvl	*lev;		/* pointer to AMIE level descriptor	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
23/06/88 INPUT and OUTPUT function 'harmonized' (in the best EEC
         traditions) - ICFO
20/06/88 Arguments passed in 'control' structure - ICFO
13/06/88 BR490 Messages changed and messages cleared once new
         tape is on line - ICFO
         BR490 (footnote) - new tape checked for Write Protect - ICFO
         BR462(3) - argument added to 'setbot' - ICFO
08/06/88 'nxttpe' split into two versions, one for INPUT and one
         for OUTPUT - ICFO
06/04/87 Created DAR
*/

{

UWORD	tfile,		/* stores file number				*/
	tblock;		/* stores block number				*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* if action at end of tape not continue (2) return FAIL		*/
if (control->tp->eot_action == 2) {
    lev->err_action = DISCONN;
    return(tperr((control->bc->bk_omode == 'W') ? 5 : 22));
}

/* store curent position						*/
tfile = control->tf->tf_num;
tblock = control->bc->bk_curnum;

if (control->bc->bk_omode == 'R') {

/* 'end of tape hit rewinding ready for next tape'			*/
    (*control->tape_chat)(0,11,3,6,0);

    rewind(FALSE);

/* 'unload current tape'						*/
    (*control->tape_chat)(0,8,16,0,0);
    unload();
    kflush();
    if (getkey() == ESC)  return(FAIL);

/* 'put next tape in & put online'					*/
    if (onlchk(control) == FAIL)  return(FAIL);

/* open up a new tape							*/
    if (setbot(control,FALSE) == FAIL)  return(FAIL);

    clrs();
    (*control->tape_chat)(0,15,0,0,0);	/* Transfer continuing		*/
}

else {		/* If we get to here we muct be writing			*/

/* 'end of tape hit rewinding ready for next tape'			*/
    (*control->tape_chat)(0,17,3,6,0);

/* wind back to start of file if restart reqd & truncate		*/
    if (control->tp->eot_action == 1)  if (fstpos(control) == FAIL)
							     return(FAIL);

/* finish off the tape with 3 filemarks					*/
    if (wtfmks(3) == FAIL)  return(FAIL);

    rewind(FALSE);

/* 'unload current tape'						*/
    (*control->tape_chat)(0,8,16,0,0);
    unload();
    kflush();
    if (getkey() == ESC)  return(FAIL);

/* ' put next tape in & put online'					*/
    if (onlchk(control) == FAIL)  return(FAIL);

/* open up a new tape							*/
    if (setbot(control,FALSE) == FAIL)  return(FAIL);

    while (tpstat(WPROT) == TRUE) {
	tperr(1);			/* Tape is write protected	*/

/* 'unload current tape'						*/
	(*control->tape_chat)(0,8,16,0,0);
	unload();
	kflush();
	if (getkey() == ESC)  return(FAIL);

/* ' put next tape in & put online'					*/
	if (onlchk(control) == FAIL)  return(FAIL);

/* open up a new tape							*/
	if (setbot(control,FALSE) == FAIL)  return(FAIL);
    }

    clrs();
    (*control->tape_chat)(0,15,0,0,0);	/* Transfer Continuing		*/

/* given that we do not restart - flag that the file is spanned 	*/
    control->tf->tf_span = TRUE;
}


/* if we require a restart set it up					*/
if (control->tp->eot_action == 1) {
    lev->err_action = RESTART;
    return(FAIL);
}

control->tf->tf_num = tfile;
control->bc->bk_curnum = tblock;

return((*control->bk_open)());

}

/*======================================================================*/
control->tape_chat)(0,15,0,0,0);	/* Transfer Continuing		*/

/* given that we do not restart - flag that the file is spanned 	*/
    control->tf->tf_span = TRUE;
}


/* if we require a restart set it up					*/
if (control->tp->eot_action == 1) {
 /*
.pa
.he                                                               UHT(ONLCHK)
*/

#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                       /*						*/
onlchk(control)              /* request to put tape online if it is not	*/
struct	_ctrl	*control;			/* Control structure	*/
/*======================================================================*/
/*USE
portability level 1
Parent module UHTLIB
Revision history
20/06/88 Arguments passed in 'control' structure - ICFO
08/06/88 Listing brought up to standard - ICFO
18/04/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (tpstat(ONLINE) == FALSE) {
    (*control->tape_chat)(0,1,10,0,0);
    while (tpstat(ONLINE) == FALSE)  if (const() == ESC)  return(FAIL);
}

return(SUCCESS);

}

/*======================================================================*/
/*
.he                                                          VAR2FX(VARFXOV1)
.pa
*/
#include	"dd.h"			/* declare AMIE setup		*/
#include	"var2fx.h"		/* globals and structures etc	*/

#define	STRFIL	"VAR2FX.MS1"		/* strings file			*/
#define	STRNUM	11			/* number of strings in file	*/

#define MAXSW	7			/* max switches expected	*/

BYTE	*strings[STRNUM];		/* For messages			*/

/*======================================================================*/
STATUS 					        /*			*/
v2fov1(sw,rd,lev)                               /* Process switches	*/
BYTE	*sw;			/* Switch string			*/
struct	rds	*rd;		/* Pointer to structure to return values*/
struct	lvl	*lev;		/* Pointer to AMIE Level structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	VAR2FX Processor
Version		03.02
AMIE Version	05.10
Revision History:-
29/05/94 V03.03 issued - ICFO
07/12/89 V03.02 issued - ICFO
         References to 'genmf.instr' removed - ICFO
10/10/88 V03.01 issued - ICFO
06/07/88 V03.00 issued (version number changed to keep in
         step with documentation) - ICFO
09/09/87 Created from FSOV1.C
*/

{

/* Switch processing module of the Field Separator for the AMIE	system.	*/
/* It is only used at connect time and then the code can be thrown	*/
/* away, so it is compiled as an independant overlay			*/

/* Returns SUCCESS or FAIL						*/
/* on FAIL an error message will already have been displayed		*/

WORD	setswt(),			/* Functions called		*/
	fndswt();
BYTE	fld_fd();

LOCAL
BYTE	*swnames[MAXSW],		/* pointers to switch names	*/
	*swvals[MAXSW];			/* pointers to switch values	*/

LOCAL
STATUS	rv;				/* Return value			*/

LOCAL
WORD	num,				/* number of switches in list	*/
	strid,				/* Strings ID			*/
	rssw,ehsw,ecsw,pcsw,icsw,rasw,dfsw;/* switch indexes		*/

VOID	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

rssw = ehsw = ecsw = pcsw = icsw = rasw = dfsw = FAIL;
if ((num = setswt(MAXSW,sw,swnames,swvals)) != 0) {

/* We got at least 1 switch 						*/
	rssw = fndswt(num,swnames,"RS");
	ehsw = fndswt(num,swnames,"EH");
	ecsw = fndswt(num,swnames,"EC");
	pcsw = fndswt(num,swnames,"PC");
	icsw = fndswt(num,swnames,"IC");
	rasw = fndswt(num,swnames,"RA");
	dfsw = fndswt(num,swnames,"DF");
}

if (dfsw != FAIL) {			/* Set defaults			*/
	rd->r_size = 80;
	rd->fix_eh = TRUE;	/* Terminator not included		*/
	rd->fix_spn = 0;	/* Span so at least all data is copied	*/
	rd->fix_end = 0x0a;	/* Line feed record terminator		*/
	rd->fix_pad = NULL;	/* Space as padding character		*/
	rd->fix_ign = 0x0d;	/* Ignore all carriage returns		*/
}

rv = FAIL;

/* Read in the strings							*/
if ((strid = opn_txt(STRFIL,strings,STRNUM)) == FAIL)
						  return(flerr(STRFIL,3));

/* Handle possible EC:							*/
if (dfsw == FAIL || ecsw != FAIL ) {
	if ((rd->fix_end =
		fld_fd((ecsw == FAIL) ? NULLPTR : swvals[ecsw],0))
						 == (BYTE) FAIL)  CLEANUP;
if (rd->fix_end == NULL) rd->fix_end = 0x0a;
}

/* Handle possible PC:							*/
if (dfsw == FAIL || pcsw != FAIL ) {
	if ((rd->fix_pad =
		fld_fd((pcsw == FAIL) ? NULLPTR : swvals[pcsw],1))
						 == (BYTE) FAIL)  CLEANUP;
}

/* Handle possible IC:							*/
if (dfsw == FAIL || icsw != FAIL ) {
	if ((rd->fix_ign =
		fld_fd((icsw == FAIL) ? NULLPTR : swvals[icsw],2))
						 == (BYTE) FAIL)  CLEANUP;
if (rd->fix_ign == NULL) rd->fix_ign = 0x0d;
}

/* Handle possible RS:							*/
if (dfsw == FAIL || rssw != FAIL ) {
	if (fld_rs((rssw == FAIL) ? NULLPTR : swvals[rssw],rd) == FAIL)
								  CLEANUP;
}

/* Handle possible RA:							*/
if (dfsw == FAIL || rasw != FAIL ) {
	if (fld_sp((rasw == FAIL) ? NULLPTR : swvals[rasw],rd,lev)
							== FAIL)  CLEANUP;
}

/* Handle possible EH:							*/
if (dfsw == FAIL || ehsw != FAIL ) {
	if (fld_eh((ehsw == FAIL) ? NULLPTR : swvals[ehsw],rd,lev)
							== FAIL)  CLEANUP;
}

rv = (SUCCESS);

cleanup:

cls_txt(strid);

return(rv);

}

/*======================================================================*/
/*
.he                                                A.M.I.E(VARFXOV1 / FLD_FD)
.pa
*/
/*======================================================================*/
BYTE 					/*				*/
fld_fd(s,sw)				/* handle EC:, PC:, IC: switches*/
BYTE	s[];				/* switch arg or NULLPTR if none*/
WORD	sw;				/* 0 = EC:, 1 = PC:, 2 = IC:	*/
/*======================================================================*/

/* Returns SUCCESS (or FAIL if user aborts)				*/

{

LOCAL
BYTE	iline[5];				/* input line		*/

LOCAL
BYTE	rval;				/* return value			*/

STATIC
BYTE	*error[] = {
		"VAR2FX - EC:",
		"VAR2FX - PC:",
		"VAR2FX - IC:"
	} ;

BYTE	eofesd();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (s != NULLPTR  && strlen(s) > 0) {
	if ((rval = eofesd(s)) == (BYTE) FAIL)  flerr(error[sw],23);
	return(rval);
}

/* Set up instruction string						*/
dialogue(0,0,1,&strings[3 + sw],4);
cur_oееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.he                                                               UHT(UHTOV7)
.pa
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                 /*				*/
uhtov7(control,lev)                    /* Overlay SELECT_FILE for INPUT */
struct	_ctrl	*control;			/* Control structure	*/
struct	lvl	*lev;				/* AMIE Level structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHT INPUT
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
         'tplibv'added - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
20/06/88 Started - ICFO
*/

{

VOID	tplibv(),
	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (control->tp->end_file == 0 && (control->tf->tf_stat == EORD)) {
    lev->err_action = RELEASE;
    return(FAIL);
}

if (control->tp->end_file > 0
		     && control->curfile == (control->tp->end_file + 1)) {
    lev->err_action = RELEASE;
    return(FAIL);
}

/* so we are not finished - do we load another tape			*/
return((control->tf->tf_stat == EORD && nxt_tape(control,lev) == FAIL)
							? FAIL : SUCCESS);
					
}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееn();
rval = getline(iline,5);
cur_of();
if (rval != (BYTE) SUCCESS)  return(FAIL);

if ((rval = eofesd(iline)) == FAIL)  return(nferr(12));

return(rval);				

}

/*======================================================================*/
/*
.he                                                A.M.I.E(VARFXOV1 / EOFESD)
.pa
*/
/*======================================================================*/
BYTE 					/*				*/
eofesd(s)				/* decode single byte switches	*/
BYTE	*s;				/* switch arg 			*/
/*======================================================================*/

{

LOCAL
BYTE	delim,				/* ASCII delimiter character	*/
	stype,				/* A or H type			*/
	tmp;

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/
/* Test for illegal string specifier					*/
if (strlen(s) == NULL)  return(NULL);

if ((stype = toupper(*s++)) != 'A'  &&  stype != 'H') return((BYTE) FAIL);

if (stype == 'A')		/* set ASCII delimiter			*/
	if ((delim = *s++) == '\0')  return ((BYTE) FAIL);
	
switch (stype) {
/* Get a single ASCII string						*/
	case 'A': return(*s);


/* Get a single HEX string						*/
	case 'H': return(get2hex(s));
}						/* End of 'switch' 	*/

}

/*======================================================================*/
/*
.he                                               A.M.I.E(VARFXOV1 / GET2HEX)
.pa
*/
/*======================================================================*/
WORD 					/*				*/
get2hex(source)				/* cnvrt 2 dig ascii to BYTE val*/
BYTE	source[];			/* string where hex number is	*/
/*======================================================================*/

/* Returns SUCCESS with *result containing value else FAIL on error	*/

{

STATIC
BYTE	match[]  = "?",
	hexdig[] = "0123456789ABCDEF";
LOCAL
WORD	res,		/* build result here			*/
	i,		/* temp					*/
	num;		/* digit match result			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/
for (i = 0, res = 0 ; i < 2 ; ++i) {
	match[0] = toupper(source[i]);
	if ((num = index(hexdig,match)) == FAIL)  return((WORD) FAIL);
	else res = res * 16 + num;
}

return(res & 0xff);

}

/*======================================================================*/
/*
.he                                                A.M.I.E(VARFXOV1 / FLD_RS)
.pa
*/
/*======================================================================*/
STATUS 					/*				*/
fld_rs(s,rd)    			/* Handle RS: switch		*/
BYTE	s[];				/* Switch arg or NULLPTR if none*/
struct	rds	*rd;		/* Pointer to structure to return values*/
/*======================================================================*/

{

LOCAL
BYTE	iline[6];				/* input line		*/

LOCAL
STATUS	rval;				/* return value			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (s != NULLPTR  && strlen(s) > 0)  return(fldrsd(s,rd));

/* Set up instruction string						*/
dialogue(0,0,1,&strings[2],5);
cur_on();
rval = getline(iline,6);
cur_of();
if (rval != SUCCESS)  return(FAIL);

if (strlen(iline) == 0)  return(SUCCESS);

return(fldrsd(iline,rd));			/* SUCCESS or FAIL	*/

}

/*======================================================================*/
/*
.he                                                A.M.I.E(VARFXOV1 / FLDRSD)
.pa
*/
/*======================================================================*/
STATUS                               /*					*/
fldrsd(s,rd)                         /* Create an integer from a number */
BYTE	s[];				/* Switch arg or NULLPTR if none*/
struct	rds	*rd;		/* Pointer to structure to return values*/
/*======================================================================*/

/* Converts a string of numbers into an array of binary numbers		*/
/* Returns integers and the number of integers in the structure		*/

{

LOCAL
LONG	number;		/* Number being processed			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

number = 0L;
while (isdigit(*s)) number = number * 10L + (LONG) (*s++ - '0');
rd->r_size = number;

return(SUCCESS);

}

/*======================================================================*/
/*
.he                                                          VARFXOV1(FLD_SP)
.pa
*/
/*======================================================================*/
STATUS                                            /*			*/
fld_sp(s,rd,lev)                                  /* Handles RA: switch */
BYTE	s[];				/* Switch arg or NULLPTR if none*/
struct	rds	*rd;		/* Pointer to structure to return values*/
struct	lvl	*lev;		/* Pointer to AMIE LEvel structure	*/
/*======================================================================*/

{

LOCAL
WORD	rval;				/* return value			*/

LOCAL
struct	menfram	mf;		/* Structure for the menu		*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (s != NULLPTR  && strlen(s) > 0) {
	if ((*s = toupper(*s)) != 'S' && *s != 'T' && *s != 'E')
					 return(flerr("VAR2FX - RA:",23));
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.he                                                               UHT(RUNOVL)
.pa
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                    /*				*/
runovl(b,control,lev)                     /* Load and run a UHT overlay */
BYTE	b;				/* Overlay number as character	*/
struct	_ctrl	*control;			/* Control structure	*/
struct	lvl	*lev;		/* Pointer to AMIE Level structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHT INPUT and Output Drivers
Revision History:
16/06/88 Started
*/

{

/* This function relies on the generic name being 3 bytes long (ie UHT)	*/

STATIC
BYTE	ov_name[] = "UHT.OV?";

LOCAL
STATUS	(*ov_go)(),
	rv;

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

ov_name[6] = b;					/* Select the overlay	*/
if ((ov_go = ldprl(ov_name)) == FAIL)  return(flerr(ov_name,4));
rv = (*ov_go)(control,lev);			/* Execute it		*/
free(ov_go);					/* Free its memory	*/
return(rv);					/* Return return value	*/

}

/*======================================================================*/
IC
BYTE	ov_name[] = "UHT.OV?";

LOCAL
STATUS	(*ov_go)(),
	rv;

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

ov_name[6] = b;					/* Select the overlay	*/
if ((ov_go = ldprl(ov_name)) == FAIL)  return(flerr(ov_name,4)ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее	rd->fix_spn = (*s == 'S') ? 0 : (*s == 'T') ? 1 : 2;
	return(SUCCESS);
}

/* Set up the menu frame						*/
mf.title = strings[0];		/* Span / Truncate long records		*/
/*mf.instr[0] = lev->gmsgs[52];	/* Arrowed keys move pointers	!!!!!!!!*/
/*mf.instr[1] = lev->gmsgs[53];	/* Space enters selection	!!!!!!!!*/
mf.options = &strings[6];	/* 6, 7 & 8 are the options		*/
mf.maxopt = 3;			/* 3 options				*/
mf.ansframe = NULLPTR;		/* Only one answer required		*/
mf.maxrvals = 1;		/* Only one answer required		*/
mf.inc = 2;			/* Double space the menu		*/

/* Display the menu and get the response				*/
rd->fix_spn = (menu(&mf,TRUE,0));

return(SUCCESS);

}

/*======================================================================*/
/*
.he                                                          VARFXOV1(FLD_EH)
.pa
*/
/*======================================================================*/
STATUS                                            /*			*/
fld_eh(s,rd,lev)                                  /* Handles EH: switch */
BYTE	s[];				/* Switch arg or NULLPTR if none*/
struct	rds	*rd;		/* Pointer to structure to return values*/
struct	lvl	*lev;		/* Pointer to AMIE LEvel structure	*/
/*======================================================================*/

{

LOCAL
WORD	rval;				/* return value			*/

LOCAL
struct	menfram	mf;		/* Structure for the menu		*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (s != NULLPTR  && strlen(s) > 0) {
	if ((*s = toupper(*s)) != 'I' && *s != 'N')
					 return(flerr("VAR2FX - EH:",23));
	rd->fix_eh = (BOOLEAN) (*s == 'N');
	return(SUCCESS);
}

/* Set up the menu frame						*/
mf.title = strings[1];		/* End Handling				*/
/*mf.instr[0] = lev->gmsgs[52];	/* Arrowed keys move pointers	!!!!!!!!*/
/*mf.instr[1] = lev->gmsgs[53];	/* Space enters selection	!!!!!!!!*/
mf.options = &strings[9];	/* 9 & 10 are the options		*/
mf.maxopt = 2;			/* 2 options				*/
mf.ansframe = NULLPTR;		/* Only one answer required		*/
mf.maxrvals = 1;		/* Only one answer required		*/
mf.inc = 2;			/* Double space the menu		*/

/* Display the menu and get the response				*/
rd->fix_eh = !(menu(&mf,TRUE,0));	/* Note the "!"			*/

return(SUCCESS);

}

/*======================================================================*/
trings[9];	/* 9 & 10 are the options		*/
mf.maxopt = 2;			/* 2 options				*/
mf.ansframe = NULLPTR;		/* Only one answer requirееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(UHTOV3)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                     /*				*/
uhtov3(td,mode,deflt,swtch)                /* Set up tape block padding */
struct	_tpdesc	*td;		/* Target tape descriptor		*/
BYTE	mode;			/* Open mode of tape			*/
BOOLEAN	deflt;			/* Take default if none specified Y/N	*/
struct	_sw	*swtch;		/* Switch names and values		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	TDES tape descriptor init
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
         "PR" and "PO" switches analysed by one function - ICFO
         "PC" and "PB" switches analysed by one function - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
09/06/88 Listing brought up to standard - ICFO
29/04/87 ICFO - This whole thing made into an overlay
         It used to be SETPAD
         ICFO - Last block padding byte requested if last block is to
         be padded NOT when it isn't!!
14/04/87 DAR - Created
*/

{

/************************************************************************/
/*									*/
/* This overlay handles switches:- PR (Pre Data Padding)		*/
/*				   PO (Post Data Padding)		*/
/*				   PC (Pre / Post Block Pad Character	*/
/*				   PB (Last Block Padding Character)	*/
/*									*/
/************************************************************************/

STATIC
WORD	getpad();	/* Get the number of padding bytes		*/

STATIC
BYTE	getchr();	/* Get the padding character			*/

VOID	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Get pre data padding							*/
if ((td->pre_pad = getpad(td,deflt,swtch,"PR",18,8)) == (WORD) FAIL)
							     return(FAIL);

/* Get post data padding						*/
if ((td->post_pad = getpad(td,deflt,swtch,"PO",19,9)) == (WORD) FAIL)
							     return(FAIL);

/* Is sum of pre & post data padding >= blocksize			*/
if ((td->pre_pad + td->post_pad) >= td->bksize) {

/* ..yes so error & run this function from scratch by RECURSION		*/
    tperr(20);
    return(uhtov3(td,mode,deflt,swtch));
}

/* Define pre/post block padding char					*/
if ((td->pre_pad > 0 || td->post_pad > 0) && mode == 'W') {

    if ((td->dpad_chr = getchr(td,deflt,swtch,"PC",10)) == (BYTE) FAIL)
							     return(FAIL);
}

/* Get last block padding char if we are writing to fixed length blocks	*/
/* with short blocks not allowed					*/
if (mode == 'W' && td->bktype == 'F' && td->short_block == TRUE) {

    if ((td->bpad_chr = getchr(td,deflt,swtch,"PB",13)) == (BYTE) FAIL)
							     return(FAIL);
}

return(SUCCESS);

}

/*======================================================================*/
/*
.he                                                      UHT(UHTOV3 / GETPAD)
.pa
*/
/*======================================================================*/
STATIC WORD                                /*				*/
getpad(td,deflt,swtch,sw_name,e_no,m_no)   /* Set up tape block padding */
struct	_tpdesc	*td;		/* Target tape descriptor		*/
BOOLEAN	deflt;			/* Take default if none specified Y/N	*/
struct	_sw	*swtch;		/* Switch names and values		*/
BYTE	*sw_name;		/* Name of switch to find		*/
WORD	e_no,			/* Error Message Number			*/
	m_no;			/* Message Number			*/
/*======================================================================*/

{

LOCAL
BOOLEAN	defined;	/* Flags whether a thing is defined or not	*/

LOCAL
BYTE	gstring[10];	/* Holds ASCII numeric values		ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееSource data exausted, short record terminates output
Input record too longVAR2FX  MS1                 AMDUMЧ50REL   Ї               VARFXBLDSUB                 VARFXLN1SUB   Х              VARFXLNKSUB   	              VARFXPRCC    
З      TARINP  C     (            VARFXOV2C                   е940069     	  ЂRlmnopqsWTBLNK  C                   DELAS   C     µ              LLOYDOV0C     #Єp            ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее	*/

LOCAL
WORD	n_char,		/* Number of characters				*/
	index;		/* Index into switch array			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

defined = FALSE;

if ((index = fndswt(swtch->swtot,swtch->swnames,sw_name)) != FAIL ) {
    if (*(swtch->swvals[index]) != 0) {
	n_char = gtkbnm(swtch->swvals[index]);
	if (n_char < td->bksize)  defined = TRUE;
	else			  tperr(e_no);
    }
}

else if (deflt == TRUE) {
    n_char = 0;
    defined = TRUE;
}

while (defined == FALSE) {
    tpchat(0,m_no,5,23,5,swtch);/* Enter no of pre block padding bytes	*/
    if (lgetlin(gstring,6))  return((WORD) FAIL);

/* Set deflt if RET only						*/
    if (gstring[0] == 0)  n_char = 0;

/* Else translate number						*/
    else		  n_char = gtkbnm(gstring);
    defined = TRUE;

/* Error if padding bytes >= blocksize					*/
    if (n_char >= td->bksize) {
	tperr(e_no);
	defined = FALSE;
    }
}

return(n_char);

}

/*======================================================================*/
/*
.he                                                      UHT(UHTOV3 / GETCHR)
.pa
*/
/*======================================================================*/
STATIC BYTE                                /*				*/
getchr(td,deflt,swtch,sw_name,m_no) /* Set up tape block padding chars. */
struct	_tpdesc	*td;		/* Target tape descriptor		*/
BOOLEAN	deflt;			/* Take default if none specified Y/N	*/
struct	_sw	*swtch;		/* Switch names and values		*/
BYTE	*sw_name;		/* Name of switch to find		*/
WORD	m_no;			/* Message Number			*/
/*======================================================================*/

{

LOCAL
BOOLEAN	defined;	/* Flags whether a thing is defined or not	*/

LOCAL
BYTE	chr,		/* Character to be returned			*/
	gstring[10];	/* Holds ASCII numeric values			*/

LOCAL
WORD	index;		/* Index into switch array			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

defined = FALSE;

/* Is it defined in the switch list					*/
if ((index = fndswt(swtch->swtot,swtch->swnames,sw_name)) != FAIL) {
    if (*(swtch->swvals[index]) != 0) {
	if ((corhex(swtch->swvals[index],&chr)) == FAIL)  tperr(21);
	else defined = TRUE;
    }
}

/* Not defined in switch list so do we take a default			*/
else {
    if (deflt == TRUE) {
	chr = 0;				/* Yes set to 0		*/
	defined = TRUE;
    }
}

/* Not defined anywhere so ask operator					*/
while (defined == FALSE) {
    tpchat(0,m_no,11,12,2,swtch);
    if (lgetlin(gstring,3))  return((BYTE) FAIL);
    if (gstring[0] == 0) {
	chr = 0;
	defined = TRUE;
    }
    else {
	if ((corhex(gstring,&chr)) == FAIL)  tperr(21);
	else				     defined = TRUE;
    }
}

return(chr & 0xff);

}

/*======================================================================*/
t defined anywhere so ask operator					*/
while (defined == FALSE) {
    tpchat(0,m_no,11,12,2,swtch);
    if (lgetlin(gstrinееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(SEKERR)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                     /*				*/
seekerr(control,status,type)               /* analyse tape search error */
struct	_ctrl	*control;			/* Control structure	*/
BYTE	status;			/* status returned from space func	*/
WORD	type;			/* F for filemarks, B for block seeks	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/06/88 Arguments passed in 'control' structure - ICFO
08/06/88 Listing brought up to standard and optimised - ICFO
06/04/87 Created DAR
*/

{

/* used to analyse results of a seek. The combinations of possible 	*/
/* errors and the response to them is charted in the UHT maintainence	*/
/* doc under 'Seek error handling'					*/

/* - - /*
.he                                                         A.M.I.E(VAR2FX.H)
.pa
*/
/*======================================================================*/
/*                          VAR2FX.H					*/
/*======================================================================*/

/* record modification descriptor					*/
struct rds {
	LONG	r_size;		/* Size of output record		*/
	WORD	fix_spn;	/* 0 if long records spanned		*/
				/* 1 if to be truncated			*/
				/* 2 if error on long record		*/
	BYTE	fix_end;	/* End of input record character	*/
	BYTE	fix_ign;	/* Character to ingore			*/
	BYTE	fix_pad;	/* Record padding character		*/
	BOOLEAN	fix_eh;		/* TRUE if terminator to be included	*/
				/* FALSE otherwise			*/
} ;

/*======================================================================*/
cord		*/
	WORD	fix_spn;	/* 0 if long records spanned		*/
				/* 1 if to be truncated			*/
				/* 2 if error on long record		*ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееSpan or Truncate long records
End handling
Please input record length (default = 80)
Please input record end character (default = <lf>)
Please input padding character (default = NULL)
Please input the character to be ignored (default = <cr>)
Create spanned records
Truncate long records
Error if long record seen
Exclude record end character
Include record end character
е940069     	  ЂRlmnopqsWTBLNK  C                   DELAS   C     µ              LLOYDOV0C     #Єp            ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (status == 0)  return(SUCCESS);

/* if reading or writing & we did a block seek that hit a filemark FAIL	*/
if (type == 'B' && (((WORD) status & 0x44) == 0)) {

/* jump back into erroring file (keeps file no valid)			*/
    space(-1,'B',&type);

/* flag file at EOF							*/
    control->tf->tf_stat = TEOF;

    return(tperr(6));		/* 'unexpected filemark hit'		*/
}

/* check out possible errors exclusive to writing			*/
if (control->bc->bk_omode == 'W' && tpstat(EOT) == TRUE) return(tperr(5));

/* check out the hardware errors					*/
return(((status & 0x01) != 0) ? tperr(12) : SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(SETBOT)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                              /*			*/
setbot(control,wait)                                /* wind tape to BOT */
struct	_ctrl	*control;			/* Control structure	*/
BOOLEAN	wait;		/* TRUE if to wait for BOT before continuing	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/06/88 Arguments passed in 'control' structure - ICFO
13/06/88 BR462(2) and BR462(3) - argument 'wait' added - ICFO
08/06/88 Listing brought up to standard and optimised - ICFO
06/04/87 Created DAR
*/

{
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (tpstat(BOT) == FALSE) {

    if (wait == TRUE) {

/* initiate a rewind with no immediate return				*/
	(*control->tape_chat)(0,3,6,0,0);/* rewinding tape please wait	*/
	rewind(FALSE);
    }
    else rewind(TRUE);			/* Immediate return		*/
}

/* reset tape file status						*/
control->tf->tf_stat = (BOOLEAN) (control->tf->tf_stat != FALSE);

control->tf->tf_num = 1;	/* current file = 1			*/
control->bc->bk_curnum = 1;	/* current block = 1			*/

return(SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееpip m:=b:varfxbl1.sub[g14
pip m:=b:var2fx.h[g14
x varfxbl1 prc
x varfxbl1 ov1
x varfxbl1 ov2
era var2fx.h
era varfxbl1.sub
era varfxbld.sub
VARFXLNKSUB   	              VARFXPRCC    
З      TARINP  C     (            VARFXOV2C                   VAR2FШ  OV1                 WTBLNK  C                   DELAS   C     µ              LLOYDOV0C     #Єp            ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(SETEOD)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                  /*				*/
seteord(control)                        /* wind to end of existing data */
struct	_ctrl	*control;			/* Control structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHTLIB - General unheadered tape library
Revision History:
19/10/88 Initial rewind now waits for completion - ICFO
20/06/88 Arguments passed in 'control' structure - ICFO
13/06/88 BR462(3) - argument added to 'setbot' - ICFO
10/06/88 BR462(1) and BR467 'tp->st_file' updated to avoid problem.
         System then thinks it was told to start at a particular
         file - ICFO
08/06/88 Listing brought up to standard - ICFO
*/

{

LOCAL
WORD	retval;		/* holds return status from space()		*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* wind to start of tape						*/
if (setbot(control,TRUE) == FAIL)  return(FAIL);

/* is EORD at the very start of the tape test with 2 block skips	*/
if (space(1,'B',&retval) == 2 && space(1,'B',&retval) == 2) {
    rewind(FALSE);
    control->tf->tf_stat = EORD;
    ++control->tp->st_file;
    return(SUCCESS);
}

/* message - winding to end of recorded data				*/
(*control->tape_chat)(0,7,6,0,0);

rewind(FALSE);

/* wind on to end of current data					*/

while (control->tf->tf_stat != EORD) {

/* check for bored operators pressing ESC				*/
    if (const() == ESC)  return(FAIL);

/* Count the file skipped over						*/
    ++control->tp->st_file;

/* skip past next filemark						*/
    if (skipf(control,1) == FAIL)  return(FAIL);
}

/* Set the current file number to the actual file number we have	*/
/* skipped to								*/
control->tf->tf_num = control->tp->st_file;

return(SUCCESS);

}

/*======================================================================*/
 if (const() == ESC)  return(FAIL);

/* Count the file skipped over						*/
    ++control->tp->st_file;

/* skip past next filemark						*/
    if (skipf(control,1) == FAIL)  return(FAIL);
}

/* Set the current file number to the actual file number we have	*/
/* skipped to								*/
control->tf->tf_num = control->tp->st_file;

return(SUCCESS);

}

/*===============ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееpip m:=b:varfx$1.rel[g14
link var2fx.$1=varfx$1[op,gv2f$1,l8000],amdum,tlib.irl[s]
era varfx$1.rel
prlpat var2fx.$1 $2 $3 $4 $5
prltrm var2fx.$1
xp b:[g14]=var2fx.$1
era varfx$1.srt
symsort var2fx
era var2fx.sym
era var2fx.srt
VARFXLNKSUB   	              VARFXPRCC    
З      TARINP  C     (            VARFXOV2C                   VAR2FШ  OV1                 WTBLNK  C                   DELAS   C     µ              LLOYDOV0C     #Єp            ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХЋ`eT…Dхc™@ Ц4 B Y  6‚ЂAЂ Л4  «џб–h  ВЄ   rНЎ Ъ@  ,Ъ TїГ,Ъ, К©А  rН¤`  2Н§`  2НЁ@Р ›S µ<•`  @ е›R@ ` eКН«Ђ6h  ! ,ЪИ #іkx ЊFеfЧ@6ґ @ЂЛ6Ѕ 9Y  “1 ЁeЙЙк‘Ђ €Њ¤‚љ‹R hҐЖ’ Ћ]  Ии©ЙЁЄqЂ 
ЋЉњљЌ… IС—аў]  Є‰‰(JСЂ Ё ’„­‰ КЉиИi‘Р ЄђЁћ¬s8  ћ 6‚ЂAЂ Л4  «џб–h  ВЄ   rНЎ Ъ@  ,Ъ TїГ,Ъ, К©А  rН¤`  2Н§`  2НЁ@Р ›S µ<•`  @ е›R@TPICLSE CX    p              TPIFCLS CX    	q              TPIFOРN C     r              TPIIOГK C     s              ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееpip m:=b:varfxln1.sub[g14
x varfxln1 prc $1 $2 64 $3
x varfxln1 ov1 $1 $2 64 $3
x varfxln1 ov2 $1 $2 64 $3
era varfxln1.sub
era varfxlnk.sub
VARFXLNKSUB                    VARFXPRCC    
З      TARINP  C     (            VARFXOV2C                   VAR2FШ  OV1                 WTBLNK  C                   DELAS   C     µ              LLOYDOV0C     #Єp            ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                                UHT(SKIPB)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                                   /*		*/
skipb(control,blocks)                                    /* skip blocks */
struct	_ctrl	*control;			/* Control structure	*/
WORD	blocks;				/* Number of filemarks to skip	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/06/88 Arguments passed in 'control' structure - ICFO
07/06/88 Corrected to fit on 80 column paper - ICFO
06/04/87 Created DAR
*/

{

LOCAL
BYTE	status;		/* return status from space()			*/

LOCAL
WORD	rv,retval;	/* return value					*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* keep trying to skip blocks while there are still some left		*/
rv = SUCCESS;

while (blocks != 0) {

/* try to space as many as poss						*/
    status = space(blocks,'B',&retval);

    if (status == 0)  blocks = 0;

/* continue seeking if seekerr thinks status is ok			*/
    if ((rv = seekerr(control,status,'B')) == FAIL)  break;
}

return(rv);

}

/*======================================================================*/
- - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* keep trying to skip blocks while there are still some left		*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                                UHT(SKIPF)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                           /*			*/
skipf(control,fmks)                              /* skip fmks filemarks */
struct	_ctrl	*control;			/* Control structure	*/
WORD	fmks;			/* Number of  of filemarks to skip	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/06/88 Arguments passed in 'control' structure - ICFO
08/06/88 Listing brought up to standard - ICFO
06/04/87 Created DAR
*/

{

LOCAL
BYTE	status;		/* return status from space()			*/

LOCAL
WORD	rv,		/* function return value			*/
	n;

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

while (fmks > 0 && rv == SUCCESS) {
    if ((status = space(1,'F',&n)) /*
.pa
.he                                                          VAR2FX(VARFXPRC)
*/
#include 	"dd.h"		/* Declares AMID globals & structures	*/
#include 	"var2fx.h"	/* Record utility header		*/

struct	rds	rd;	/* record descriptor structure			*/

UWORD	ipktchs = 0,	/* bytes left in input packet			*/
	opktspce = 0;	/* space left in outqut packet			*/

LONG	currec,		/* current record no				*/
	dbytes;		/* record body counter				*/

BYTE	*irptr,		/* input record pointer				*/
	*orptr;		/* output record pointer			*/

/* Pointers to packets - set to FAIL to flag that they are not in use	*/
struct pkthdr	*opkt = FAIL,	/* pointer to output packet		*/
		*ipkt = FAIL;	/* pointer to input packet		*/

BOOLEAN	op_used;	/* only one packet to be taken from pool per	*/
			/* DATA call this flags whether an output pkt	*/
			/* has been taken or not			*/

BOOLEAN	rec_done;	/* flags that record has beeo sent		*/

QUEUE	inq,		/* input queue					*/
	dumpq,		/* puu used packets here			*/
	outq;		/* output queue					*/

/*======================================================================*/
STATUS                                 /*				*/
v2fprc(comd,lev)                       /* Start of var to fixed utility */
WORD	comd;				/* command to be actioned	*/
struct	lvl	*lev;			/* Level descriptor		*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX - Variable to fixed record converter
Version		03.03
AMIE version	05.10
Revision History:-
29/05/94 V03.03 issued - ICFO
	 In 'opn_opkt' the restriction of one packet per DATA
	 call has been removed to allow records greater than 512
	 bytes to be handled.  This necessitated computing
	 'lev->expf' at CONNECT from the record size as input.
07/12/89 V03.02 issued - ICFO
10/10/88 V03.01 issued - ICFO
         The last packet could be empty so it is only passed on if
         it is not (see DO_DATA) - ICFO
06/07/88 V03.00 issued (version number changed to keep in
         step with documentation) - ICFO
21/05/88 V01.02
         VERS and AMVERS removed - ICFO
         Default Record Size is now 80 not -1 - ICFO
         General messages 11 and 12 changed to 52 and 53 - ICFO
04/09/87 Started
*/


{

VOID	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (comd == DATA)  return(do_data());	/* stripped out for speed	*/

/* Action the command passed from the copy cnntroller			*/
switch (comd) {

    case CONNECT:	/* establish transfer connection & init driver	*/
			/* NB expansion factor c`lc by init overlay	*/
	lev->levchk = -1;
/*	lev->expf = 4*//*3*//*;*/
	if (fsinit(lev) == FAIL) return(FAIL);
	lev->expf = 3 + rd.r_size / 512;     /* 512 is size of a packet */

/*move(5,0);
putstr("Record size = ");
lputnum(rd.r_size);
putstr("\n   End character is - ");
puthex(rd.fix_end);
putstr("\nIgnore character is - ");
puthex(rd.fix_ign);
putstr("\n   Pad character is - ");
puthex(rd.fix_pad);
putstr("\nEnd handling is - ");
putnum(rd.fix_eh);
putstr("\nRecord attributes are - ");
putnum(rd.fix_spn);
getkey();							!!!!!!!!*/


	break;

    case RESTART:	/* restart the data transfer from beginning	*/
    case RELEASE:	/* transfer termination sequences		*/
    case DISCONN:
    case ABORT:
    case ABORT_DATA:		/* abort data transfer			*/
	rec_done = TRUE;
	cls_ipkt();		/* dump the packets			*/
	cls_opkt();

	break;

    case READ_ATTR:	/* read VFS attributes & pass across to output	*/
	outq = lev->out_q;
	dumpq = lev->discard;
	inq = lev->in_q;
	return(fs_attr());

    case BEGIN_DATA:
	rec_done = FALSE;
	currec = 1L;
 	recdets();		/* prime record controllers		*/
	opn_opkt();
	break;

}

return(SUCCESS);

}

/*======================================================================*/
/*
.pa
.he                                                        A.M.I.E(DEBUGGERS)
*/
#ifdef DBUG

/*======================================================================*/
bug()	/* debug all useful values					*/
/*======================================================================*/
{
cls();
putstr("\nsource header = ");
lputnum(rd.sh_size(;
putstr("\nsource trailer = ");
lputnum(rd.st_size);
putsts("\ndest header = ");
lputnum(rd.dh_size);
putstr("\ndest trailer = ");
putnum(rd.dt_size);
putstr("\nmaxrec = ");
lputnum(rd.maxrec);
putstr("\nrecord size = ");
lputnum(rd.r_size);
putstr("\noutput header = |");
xputstr(dhead,rd.dh_size);
putstr("|\noutput trailer = ");
xputstr(dtail,rd.dt_size);	
putstr("|");
putstr("\nihbytes = ");
lputnum(ihbytes);
putstr("\nohbytes = ");
lputnum(ohbytes);
putstr("\ndbytes = ");
lputnum(dbytes);
putstr("\notbytes = ");
putnum(otbytes);
putstr("\nitbytes = ");
putnum(itbytes);
lputstr("\ninput packet is ");
if(ipkt == FAIL)  lputstr("none");
else {
    pp(ipkt);
    lputstr("\ninput packet has = ");
    lsputnum(ipktchs);
}

lputstr("\nottput packet is ");
if(opkt == FAIL) lputstr("none");
else {    pp(opkt);
== 2) {
	--fmks;
	++control->tf->tf_num;
	control->bc->bk_curnum = 1;
    }

/* Are we at EORD - determine by trying to read a data block		*/
    if (space(1,'B',&n) != 0) {
	control->tf->tf_stat = EORD;
	if (fmks != 0)  rv = FAIL;
    }

/* Check error status							*/
    else rv = seekerr(control,status,'F');

    space(-1,'B',&n);		/* position at block 1 again		*/
}

return(rv);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(TAPCHT)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
VOID                                     /*				*/
tpchat(title,mes1,mes2,mes3,anslen,swtch)/* tape specific dialog routine*/
WORD	title,	/* message title					*/
	mes1,	/* 3 message pointers					*/
	mes2,	/*							*/
	mes3,	/*							*/
	anslen;	/* length of answer reqd				*/
struct	_sw	*swtch;	/* Switch names and values			*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
08/06/88 ICFO - Optimised
29/10/87 ICFO - Created from 'tape_chat' by the passing of 'swtch'
         as an argument
06/04/87 DAR - Created
*/

{

LOCAL
WORD	line;	/* line counter						*/

LOCAL
BYTE	*cframe[4];	/* dialog output strings			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

cframe[line = 0] = swtch->tapmes[title];
if (mes1 != 0)  cframe[++line] = swtch->tapmes[mes1];
if (mes2 != 0)  cframe[++line] = swtch->tapmes[mes2];
if (mes3 != 0)  cframe[++line] = swtch->tapmes[mes3];

dialog(0,0,++line,cframe,anslen);

}

/*======================================================================*/
line counter						*/

LOCAL
BYTE	*cframe[4];	/* dialog output strings			*/

/* - - - - - - - - - - - - - - - - - - - - - - ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее    lputstr("\noutput packet has = ");
    lsputnum(opkt-?d_bytes);
    lputstr(" taken -  free = ");
    lsputnum(opkt->d_freesp);
}

}

pp(p)
struct memdesc *p;
{
p = (BYTE *)p - rizeof(struct memdesc);
bdos(5,p->mtype);
}

xputstr(pts,size)
BYTE	*ptr;
WORD	size;
{
while(size--) xprint(*ptr++);
}

xprint(c)
char c;
{
if(c <= ' '){
    putvid('<');
    puthex(c);
    putvid('>');
}

else putvid(c);
}

#endif
/*======================================================================*/
/*
.pa
.he                                                          A.M.I.E(DO_DATA)
*/
/*======================================================================*/
STATUS                                    /*				*/
do_data()                                 /* execute main data sequence	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX - Variable to fixed record converter
Revision History:-
10/10/88 The last packet could be empty so it is only passed on if
         it is not - ICFO
10/09/87 Main loop re-written for converting variable to fixed records
07/09/87 Added to for Field Separator Procersor
21/07/87 Created DAR
*/

{

LOCAL
WORD	d1bytes,	/* Local copy of dbytes				*/
	c;		/* character argument				*/

BYTE	getipc();	/* Get a character from the input packet	*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* clear the output packet flag, allows 1 pkt to be got from pool	*/
op_used = FALSE;

/* if no output packet in place get one					*/
if (opkt == FAIL)  opn_opkt();	/* open next output packet		*/

/* Get any data bytes & send them					*/
while (dbytes != 0) {

/* Read input byte							*/
    if ((c = getipc()) < 0)  CLEANUP;

/* Test if the end of the input record has been reached			*/
    if (c == rd.fix_end)  break;

/* Test if this is the character to be ignored				*/
    if (c == rd.fix_ign)  continue;	/* Violates Timeclaim standards*/

/* As putopc must put a char dec value here				*/
    --dbytes;

/* Write output byte							*/
    if ((c = putopkt(c)) == FAIL)  CLEANUP;
}

/* If the input record is longer than the output then take the 		*/
/* appropriate action							*/
if (dbytes == 0) {
    switch (rd.fix_spn) {

	case 0:	break;				/* Span long records	*/

	case 1:					/* Truncate long records*/
	    while (c != rd.fix_end) {
		if ((c = getipc()) < 0) CLEANUP;
	    }
	    break;

	case 2:
	    return(fserr(1));			/* Error on long records*/
    }
}

/* If the terminator is to be output then make room for it		*/
d1bytes = dbytes;
if (dbytes != 0 && rd.fix_eh == FALSE)  --d1bytes;

/* Pad the remaining part of the output record				*/
while (d1bytes != 0) {
    if ((c = putopkt(rd.fix_pad)) == FAIL)  CLEANUP;
    --d1bytes;
}

/* Now output the terminator if so requested				*/
if (dbytes != 0 && rd.fix_eh == FALSE
			   && (c = putopkt(rd.fix_end)) == FAIL)  CLEANUP;

/* This record is complete start on next				*/
rec_done = TRUE;
cls_opkt();
rec_done = FALSE;

/* Set values for next record						*/
recdets();

cleanup:

if (c == -2) {	/* EOF hit						*/
    rec_done = TRUE;			/* flag end of record hit	*/
    if (opkt->d_bytes != 0)  cls_opkt();/* close output packet		*/
    opkt = ipkt;			/* put EOF packet on output	*/
    cls_opkt();
    ipkt = FAIL;			/* close input packet		*/
    rec_done = FALSE;		/* set record flag for next transfer	*/

/* If we have written a short block issue warning			*/
    if(dbytes < rd.r_size)  fserr(0);
}

return(SUCCESS);

}	

/*=====================================================================*/
/*
.pa
.he                                                          A.M.I.E(RECDETS)
*/
/*======================================================================*/
VOID                             /*					*/
recdets()                        /* Initialise record control variables */
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX - Variable to fixed record converter
Revision History:-
04/09/87 Converted from RECUTL
21/07/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Set working counters & pointers from initial switch values		*/
dbytes = rd.r_size;

}

/*======================================================================*/
/*
.pa
.he                                                         A.M.I.E(OPN_IPKT)
*/
/*======================================================================*/
STATUS                                    /*				*/
opn_ipkt()                                /* open packet on input queue	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX - Variable to fixed record converter
Revision History:-
21/07/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/*ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                           AMIE (TP_FOPEN)
.po6
*/
#include dd.h
#include gtape.h

EXTERN
struct
_bc	bc;		/* block control structure			*/

EXTERN
struct
_tf	tf;		/* tape file control structure			*/


/*======================================================================*/
tp_fopen()	/* open up tape file					*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
6/4/87		Created DAR
*/
{

/* assumes that the tape is now set to the start position &the position	*/
/* variables are set to current file and block				*/

/* check tape unit ready						*/
if(tpstat(ONLINE) == FALSE) return(tperr(0));

/* open up the first block						*/
return(bkopen());
}
/*===================== END OF TP_FOPEN ================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее get packet - if none return fail					*/
if ((ipkt = qget(inq)) == FAIL)  return(-1);

/* if packet is EOF packet return EOF value				*/
if (ipkt->d_bytes == -1)  return(-2);

/* point input pointer to start of packet data area			*/
irptr = ipkt->d_start;

/* set no of input packet chars available				*/
ipktchs = ipkt->d_bytes;

return(SUCCESS);

}

/*======================================================================*/
/*
.pa
.he                                                         A.M.I.E(CLS_IPKT)
*/
/*======================================================================*/
VOID                                              /*			*/
cls_ipkt()	                                  /* close input packet	*/
/*======================================================================*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* if packet not closed put it on the dumping queue			*/
if (ipkt != FAIL)  queue(dumpq,ipkt);

/* set no of chars available to 0					*/
ipktchs = 0;

/* flag packet as closed						*/
ipkt = FAIL;

}

/*======================================================================*/
/*
.pa
.he                                                           A.M.I.E(GETIPC)
*/
/*======================================================================*/
BYTE                                      /*				*/
getipc()                                  /* get char from input stream	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX - Variable to fixed record converter
Revision History:-
21/07/87 Created DAR
*/

{

LOCAL
STATUS	rv;		/* return value					*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

while (ipktchs == 0) {	/* no data present so get some more		*/
    cls_ipkt();		/* close current input packet			*/

/* open next input packet						*/
    if ((rv = opn_ipkt()) < 0)  return(rv);
}

--ipktchs;	/* decrease byte count in packet			*/
	
return(*irptr++ & 0xff);	/* return next character non sign ext	*/

}

/*======================================================================*/
/*
.pa
.he                                                         A.M.I.E(OPN_OPKT)
*/
/*======================================================================*/
STATUS                                            /*			*/
opn_opkt()                                        /* open output packet */
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX - Variable to fixed record converter
Revision History:-
29/05/94 The restriction of one packet per DATA call has been removed to 
         allow records greater than 512 bytes to be handled.
21/07/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* only one packet allowed from pool per data call			*/
/*if (op_used)  return(FAIL);*/

opkt = qget(0);		/* get empty packet from poolq			*/
orptr = opkt->d_start;		/* point to data area			*/
opktspc = opkt->d_freesp;	/* calc space in packet			*/
op_used = TRUE;			/* flag packet used			*/

return(SUCCESS);

}

/*======================================================================*/
/*
.pa
.he                                                         A.M.I.E(CLS_OPKT)
*/
/*======================================================================*/
VOID                                             /*			*/
cls_opkt()                                       /* close output packet */
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX - 
Revision History:-
21/07/87 Created DAR
*/

{

/* possible span status table						*/
STATIC
WORD	span_tab[] = {1,2,0,3};

/* set spanning to one of these based on value of 'decision'		*/
STATIC
WORD	span_reset[] = {TRUE,TRUE,FALSE,FALSE};

STATIC
BOOLEAN	spanning = FALSE;	/* spanning record flag			*/

/* used to calc the type of span					*/
WORD	decision;

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (opkt != FAIL) {

/* make decision an index into span_tab					*/
/* possible values:							*/
/*									*/
/*	record		spanning	type to		spanning	*/
/*	finished	flag start	set		flag at end	*/
/*									*/
/*	FALSE		FALSE		1 (start seg)	TRUE		*/
/*									*/
/*	FALSE		TRUE		2 (cont seg)	TRUE		*/
/*									*/
/*	TRUE		FALSE		0 (no span)	FALSE		*/
/*									*/
/*	TRUE		TRUE		3 (end seg)	FALSE		*/


    decision = rec_done ? 2 : 0;			/* set bit 1	*/
    decision = spanning ? decision | 1 : decision;	/* & bit 0	*/

/* set record type to correct spanning status				*/
    opkt->d_rtype = span_tab[decision];

/* adjust spanning flag based on decision				*/
    spanning = span_reset[decision];

/* put the output record on the output Queue				*/
    queue(outq,opkt);

/* flag opkt as closed							*/
    opkt = FAIL;
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(TPCHAT)
*/
#include	"dd.h"

/*======================================================================*/
VOID                                    /*				*/
tape_chat(title,mes1,mes2,mes3,anslen)	/* tape specific dialog routine	*/
WORD	title,	/* message title					*/
	mes1,	/* 3 message pointers					*/
	mes2,	/*							*/
	mes3;	/*							*/
WORD	anslen;	/* length of answer reqd				*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
08/06 88 Listing brought up to standard and optimised - ICFO
06/04/87 Created DAR
*/

{

LOCAL
WORD	line;	/* line counter						*/

LOCAL
BYTE	*cframe[4];	/* dialog output strings			*/

EXTERN
BYTE	*tpmes[];	/* array of external tape messages		*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

cframe[line = 0] = tpmes[title];
if(mes1) cframe[++line] = tpmes[mes1];
if(mes2) cframe[++line] = tpmes[mes2];
if(mes3) cframe[++line] = tpmes[mes3];

dialog(0,0,++line,cframe,anslen);

}

/*======================================================================*/
ne counter						*/

LOCAL
BYTE	*cframe[4];	/* dialog output strings			*/

EXTERN
BYTE	*tpmes[];	/* array of external tape messages		*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

cframe[line = 0] = tpmes[title];
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
}

/* No return value							*/

}

/*======================================================================*/
/*
.pa
.he                                                          A.M.I.E(PUTOPKT)
*/
/*======================================================================*/
STATUS                                   /*				*/
putopkt(c)                               /* write char to output stream */
BYTE	c;				/* Character to write		*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX - Field separator insertor
Revision History:-
21/07/87 Created DAR
*/

{

/* this function must always write the char given 			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

*orptr++ = c;

++opkt->d_bytes;

if (--opkt->d_freesp == 0) {	/* no data present so get some more	*/

    cls_opkt();		/* close current output packet			*/

/* open next output packet						*/
    if(opn_opkt() == FAIL) return(FAIL);
}

return(SUCCESS);

}

/*======================================================================*/
/*
.he                                                           A.M.I.E(FSINIT)
.pa
*/
/*======================================================================*/
STATUS                                /*				*/
fsinit(lev)                           /* run record description overlay	*/
struct	lvl	*lev;			/* AMIE Level descriptor	*/
/*======================================================================*/

{

LOCAL
WORD	(*ov_go)(),	/* pointer to a function			*/
	rv;		/* return value from function			*/

BYTE	*ldprl();	/* prl file loader rets pointer to func		*/

/* name of general record descriptor overlay				*/
STATIC
BYTE	*ru_name = "VAR2FX.OV1";

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* load the overlay file						*/

if ((ov_go = ldprl(ru_name)) == (BYTE *) FAIL)  return(flerr(ru_name,4));

/* execute the overlay and return its own return value			*/
rv = (*ov_go)(lev->switches,&rd,lev);

spfree(ov_go);	/* free overlay area					*/

return(rv);

}

/*======================================================================*/
/*
.pa
.he                                                          A.M.I.E(FS_ATTR)
*/
/*======================================================================*/
STATUS                                    /*				*/
fs_attr()                                 /* get source file attributes */
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX - Variable to fixed record converter
Revision History:-
08/09/87 Call old routine as an overlay
07/09/87 Sets / checks record size
05/05/87 Created DAR
*/

{

LOCAL
WORD	(*ov_go)(),	/* pointer to a function			*/
	rv;		/* return value from function			*/

BYTE	*ldprl();	/* prl file loader rets pointer to func		*/

/* name of general record descriptor overlay				*/
STATIC
BYTE	*ru_name = "VAR2FX.OV2";

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* load the overlay file						*/

if ((ov_go = ldprl(ru_name)) == (BYTE *) FAIL)  return(flerr(ru_name,4));

/* execute the overlay and return its own return value			*/
rv = (*ov_go)(&rd,inq,outq);

spfree(ov_go);	/* free overlay area					*/

return(rv);

}

/*======================================================================*/
/*
.pa
.he                                                            A.M.I.E(RUERR)
*/
/*======================================================================*/
STATUS
fserr(code)	/* output recutl error					*/
WORD	code;
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX.PRC
Revision history:
20/07/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

seterr("VAR2FX");

return(nferr(code));

}

/*======================================================================*/
r(code)	/* output recutl error					*/
WORD	code;
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX.PRC
Revision history:
20/07/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

seterr("VAR2FX");

return(nferr(code));

}

/*=====================ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(TPCLSE)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                      /*				*/
tp_close(control)                           /* close tape after I/O ops	*/
struct	_ctrl	*control;			/* Control structure	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
28/06/88 For OUTPUT only rewind if /NR switch allows - ICFO
23/06/88 Code rearranged a bit for efficiency - ICFO
21/06/88 Input and output recombined as the function now lives in an
         overlay - ICFO
20/06/88 Arguments passed in 'control' structure - ICFO
14/06/88 'kflush' added - ICFO
13/06/88 BR462(3) - argument added to 'setbot' and rewind doesn't wait
         for BOT - ICFO
08/06/88 'tp_close' split into two, one for INPUT and 1 for OUTPUT - ICFO
30/10/87 ICFO - Dialogue to allow tape marks to be written on error
         where tape is rather than being backspaced to the end of the
         previous file
06/04/87 DAR - Created
*/

{

LOCAL
WORD	rv;		/* return value					*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

rv = SUCCESS;		/* prime the return value			*/

if (tpstat(ONLINE) == TRUE) {

    if (control->bc->bk_omode == 'W') {	/* Writing			*/

/* attempt to close volume if online					*/
/* if in middle of writing file space back to start			*/
	if (tpstat(ONLINE) == TRUE && control->tf->tf_stat == TRUE) {
	    (*control->tape_chat)(0,12,13,14,0);

/* wind to start of file unless told to keep data written so far	*/
	    kflush();
	    if (toupper(getkey()) == 'N' && fstpos(control) == FAIL)
							     return(FAIL);

/* write 3 filemarks as EOV marker					*/
	    rv = wtfmks(3);
	    control->tf->tf_stat = FALSE;

	}
    }

/* Rewind to BOT							*/
    if (control->tp->no_rewind == FALSE && setbot(control,TRUE) == FAIL)
								rv = FAIL;
}

/* free off the block buffer						*/
control->bc->bk_base = spfree(control->bc->bk_base);

/* set block status to closed						*/
control->bc->bk_stat = FALSE;

/* return status to caller						*/
return(rv);

}

/*======================================================================*/
r					*/
	    rv = wtfmks(3);
	    control->tf->tf_stat = FALSE;

	}
    }

/* Rewind to BOT							*/
    if (control->tееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                                UHT(TPERR)
*/
#include 	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                   /*				*/
tperr(no)                                /* output a general tape error */
WORD	no;						/* error no	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
08/06/88 Listing brought up to standard - ICFO
06/04/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* identify UHT.ERR as current error file				*/
seterr("UHT");
return(nferr(no));

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.he                                                          VAR2FX(VARFXOV2)
.pa
*/
#include	"dd.h"
#include	"var2fx.h"

/*======================================================================*/
STATUS                                    /*				*/
v2fov2(rd,inq,outq)                       /* Get source file attributes */
struct	rds	*rd;		/* Pointer to structure of return values*/
QUEUE	inq,			/* Input queue				*/
	outq;			/* Output queue				*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	VAR2FX - Variable to fixed length convertor
Version		03.03
AMIE Version	05.10
Revision History:-
29/05/94 V03.03 issued - ICFO
07/12/89 V03.02 issued - ICFO
10/10/88 V03.01 issued - ICFO
06/07/88 V03.00 issued (version number changed to keep in
         step with documentation) - ICFO
09/09/87 Created from FIELDS.OV2
*/

{

LOCAL
struct	pkthdr	*vfdpkt;	/* pointer to packet containing a VFD	*/

LOCAL
struct	tvfd	*vfd;		/* pointer to the virtual file		*/
				/* descriptor				*/

LOCAL
LONG	recsiz;			/* New record size			*/

VOID	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* get vfd packet							*/
vfdpkt = qget(inq);

/* point to start of data area						*/
vfd = vfdpkt->d_start;

/* Set up the output record size					*/
vfd->v_recsize = rd->r_size;

vfd->v_struct = 1;	/* data is record based				*/
vfd->v_rstyp = 0;	/* fixed record size				*/

/* put VFD on the output Q						*/
queue(outq,vfdpkt);

return(SUCCESS);

}

/*======================================================================*/

/* point to start of data area						*/
vfd = vfdpkt->d_start;

/* Set up the output record size					*/
vfd->v_recsize = rd->r_size;

vfd->v_struct = 1;	/* data is record based				*/
vfd->v_rstyp = 0;	/* fixed record size				*/

/* put VFD on theееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее \                                                                                                                             Copyright Timeclaim Ltd 1988 05.2003.02@ DEVELOP ЬФ                                                                            ГIЂ                                                                      !яя"GЂ"EЂ"CЂ"AЂ"?Ђ"=Ђ";Ђ! е! 9Нл"е!Ђе!'ЂеНЄББББ"7ЂН2"КЃ*7Ђе!Ђе!H‰еН+БББ";Ђ*7Ђе!Ђе!K‰еН+БББ"=Ђ*7Ђе!Ђе!N‰еН+БББ"?Ђ*7Ђе!Ђе!Q‰еН+БББ"AЂ*7Ђе!Ђе!T‰еН+БББ"CЂ*7Ђе!Ђе!W‰еН+БББ"EЂ*7Ђе!Ђе!Z‰еН+БББ"GЂ*GЂ#Н2"КwЃ! 9Нл"Нµ0P   ! 9Нл"	 6#6 ! 9Нл" 6 #6 ! 9Нл" 6
! 9Нл" 6 ! 9Нл" 6!яя"5Ђ!]‰е!Ђе! еН*БББ"9Ђ#НN"К§Ѓ!]‰е! еН‡ББЙ*GЂ#НN"ВёЃ*?Ђ#Н2"Н2"К‚! 9Нл" е*?Ђ#НN"КЪЃ!  ГеЃ*?Ђ)'ЂНл"е!  еНэѓББС}е!яяН:"КяЃГеѓ! 9Нл" Не"|µВ‚! 9Нл" 6
*GЂ#НN"В0‚*AЂ#Н2"Н2"Кw‚! 9Нл" е*AЂ#НN"КR‚!  Г]‚*AЂ)'ЂНл"е! еНэѓББС}е!яяН:"Кw‚Геѓ*GЂ#НN"В€‚*CЂ#Н2"Н2"Кп‚! 9Нл" е*CЂ#НN"КЄ‚!  Гµ‚*CЂ)'ЂНл"е! еНэѓББС}е!яяН:"КП‚Геѓ! 9Нл" Не"|µВп‚! 9Нл" 6*GЂ#НN"В ѓ*;Ђ#Н2"ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(TPFCLS)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                   /*				*/
tp_fclose(control)                       /* close the current tape file */
struct	_ctrl	*control;			/* Control structure	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
23/06/88 Concatenation code removed and code to space over file
         marks removed to open code - ICFO
21/06/88 Input and output made into one function because it is
         overlaid - ICFO
20/06/88 Arguments passed in 'control' structure - ICFO
13/06/88 BR462(2) - File marks written etc only if files are NOT
         to be concatenated - ICFO
08/06/88 'tp_fclose' split into two, one for INPUT and one
         for OUTPUT - ICFO
06/04/87 Created DAR
*/

{

WORD	retval;			/* Return value from 'space'		*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

if (control->bc->bk_omode == 'R') {

/* Increment the current block number					*/
    ++control->bc->bk_curnum;

/* skip past next file marker						*/
    return(skipf(control,1));
}

if ((*control->bk_clse)() == FAIL)  return(FAIL);

/* close the file							*/
/* flag the tape file as closed						*/
control->tf->tf_stat = FALSE;

if (wtfmks(3) == FAIL)  return(FAIL);

++control->tf->tf_num;			/* Increment file number	*/

return(SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееН2"К9ѓ*;Ђ#НN"Кѓ!  Г!ѓ*;Ђ)'ЂНл"е! 9Нл"еН†ББ#НN"К9ѓГеѓ*GЂ#НN"ВJѓ*EЂ#Н2"Н2"КЊѓ*EЂ#НN"К`ѓ!  Гkѓ*EЂ)'ЂНл"е! 9Нл"е! 9Нл"еН:‡БББ#НN"КЊѓГеѓ*GЂ#НN"Вќѓ*=Ђ#Н2"Н2"КЯѓ*=Ђ#НN"Кіѓ!  Гѕѓ*=Ђ)'ЂНл"е! 9Нл"е! 9Нл"еНf€БББ#НN"КЯѓГеѓ!  "5Ђ*9ЂеН~Б*5ЂЙ      h‰u‰‚‰!  е! 9Нл"НX"К „! 9Нл"еНw.Б  Нw"Н2"К`„! 9Нл"еНЩ„Б}2цѓе!яяН:"КY„! 9Нл")чѓНл"е! еН‡ББ:цѓНж"Й!  е!  е! е! 9Нл"###)Ђе! еНWБББББН(!сѓе! еНЇ‰ББ}2цѓН&(!  е:цѓНж"НX"Кі„!яяЙ!сѓеНЩ„Б}2цѓ#НN"КП„! еНpБЙ:цѓНж"Й   ! 9Нл"еНw.Б|µВо„!  Й! 9еНл"#Нр"+Не"еНР#Б}2Ч„їяН2"К…:Ч„Нж"ёяН2"Н2"К(…!яяЙ:Ч„Нж"їя|µВU…! 9еНл"#Нр"+Не"}2Ц„НN"КU…!яяЙ:Ч„Нж"Гy…! 9Нл"Не"Й! 9Нл"еН …БЙГ†…Нш"^…A i…H   Й? 0123456789ABCDEF       !  "њ…!  "љ…*њ…юН“"Ъ†ГЕ…*њ…#"њ…Г¬…! 9Нл"л*њ…Не"еНР#Б}2‡…!‰…е!‡…еН­ЉББ"ћ…#НN"Кы…!яяЙГ
†*љ…))))л*ћ…"љ…Г»…*љ…& Й        !  е! 9Нл"НX"К>†! 9Нл"еНw.Б  Нw"Н2"КZ†! 9Нл"е! 9Нл"еНА†ББЙ!  е!  е! е!Ђе! еНWБББББН(!†е! еНЇ‰ББ"†Н&(*†Н2"К™†!яяЙ!†еНw.Б|µВЄ†!  Й!†е! 9Нл"еНА†ББЙ    !ј†Нµ0    ! 9Нл"Не"еНL‹Б|µК‡!ј†Н¬0ЕХ
   Н
/ЕХ! 9еНл"#Нр"+Не"РяН%1НЃ0!ј†Нє0ГК†! 9Нл"е!ј†Н¬0бНє0!  Й                !  е! 9Нл"НX"К]‡! 9Нл"еНw.Б  Нw"Н2"К€! 9Нл"е! 9Нл"Не"еНР#БС}­яН2"К‡! 9Нл"Не"¬яН2"Н2"КЇ‡! 9Нл"Не"»яН2"Н2"КГ‡!Џ‰е! еН‡ББЙ! 9Нл" е! 9Нл"Не"­яНN"Кй‡!  Г€! 9Нл"Не"¬яНN"К€! Г€! Нр"!  Й*Ђ",‡!Ђ".‡! "0‡!  "2‡! "4‡! "8‡! 9Нл" е!,‡е! е!  еНsБББНр"!  Й                !  е! 9Нл"НX"К‰€! 9Нл"еНw.Б  Нw"Н2"Кь€! 9Нл"е! 9Нл"Не"еНР#БС}·яН2"КД€! 9Нл"Не"ІяН2"Н2"КШ€!њ‰е! еН‡ББЙ! 9Нл"	 е! 9Нл"Не"ІяНN"Нр"!  Й*Ђ"X€!Ђ"Z€! "\€!  "^€! "`€! "d€! 9Нл"	 е!X€е! е!  еНsБББНN"Нр"!  ЙRS EH EC PC IC RA DF VAR2FX.MS1 VAR2FX - EC: VAR2FX - PC: VAR2FX - IC: VAR2FX - RA: VAR2FX - EH:       ! 9еНл"+Нр"! 9Нл""­‰!  "©‰*­‰еНо("«‰С}*«‰  Нv"Вн‰*«‰ Нg"Н2"КwЉ*«‰Г[Љ*©‰+"©‰#|µВ	ЉГ»‰*­‰+"­‰!ЈЉеН„'БГtЉ! 9Нл"6 *©‰+"©‰#|µК<Љ!ЈЉеН„'БГ$Љ*«‰ея|µВLЉ! ЙГ»‰*­‰6 !  ЙГtЉНш"щ‰ щ‰ Љ $Љ OЉ   ГџЉ! 9Нл"л*©‰Нv"КџЉ*­‰#"­‰+Не"еН)Б*©‰#"©‰ГЛ‰Й        !  "§Љ! 9Нл"л*§ЉНе"|µКH‹ГХЉ*§Љ#"§Љ+ГіЉ*§Љ"©Љ!  "«Љ! 9Нл"л*«ЉНе"Н2"К‹*©Љ#"©Љ+л! 9Нл"Не"е! 9Нл"л*«ЉНе"Н:"Н2"К-‹*«Љ#"«ЉГбЉ! 9Нл"л*«ЉНе"|µВE‹*§ЉЙГКЉ!яяЙ! 9~!  ю0Шю:Р,Й         I$Ђ	 H€D@" ‘€Ђ$D @          	 @ђ @ђ HЂ   @ @ђ HЂ @ђ HЂ   @ @ђЃ€ ђ$ A"   ’Ђ$$@  @	 Ё    „      @ B @  @   ђ     Ѓ  „@   $H 	$I        Ђ ‚ Ђ  Ђ                    	      Ђ  $‚ Ђ               H     IA                   $  $‘‘   ђ@! A" "@  H‰ Ђ€   $H ‘   ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•ђT‘– %$H%A-Q"OPKTSPЃђХT”‘PаdD%•DU8%IAQJORPTRЃФХ D•µH=A}UMREC_DOЂТS”`TETХ=UQFV2FPRCЃ‘ЧСU de4”д•H1M}%BCLS_OPЃ‘”ЧРU e$T4DUH=A9}=BGETIPCЃ”UФаTe4U%(=A9}%BP 5‘                              чыэю           @ЂЛ4  јЯб“вХ…O@ґH’! ,Ъ\ Гј  rНЁ@  26€ЖПс 9fФА €H  Дc` „ іjа•›l"6h  КЇАыэ’ГЎ@2Ш	l¶[ ! ЂT„›QЂЩ·ј‡BЂD   е›[  А e›e@Tњ B Y¶p " Y¶ EI@   е›k@   e›mАTЊ›DЃY"  EH@    Ррh  Нї LЫDГЎ@,:Н  *8  `@   X АЂ А  І  ђЗ      Й      "ЈаЄ6 #fЧPU%fЪ 9i(„  r€h4  fЂ Р •gАYµ°ED B  4  eT ¦P`h  еQ h  К« ,;>: аЪњеQ mUeW %С0m-bµD 4  fЂ & НєаЄ еfЦPFЉ€ €Щґt•g Xv	‡I@D  ”CDАµР›L Y  *Ђ
Ё чЂ°и ¶мuAЂµ„К*ў ,Р •x Yµ°ED B  6Ў І®иУ0нШЂ@ +6Ї‚°Y,: НјАа  ·` г   	h †‰Ђ3m8¬ECЂD  ”CDАґ	›jЂYґМ•HА…T$›e Y  *
Ёp¬ECЂe¦ BЄ|ZІЄРк„ 3mш•›YA"* #fТ&UPaЪ`!U€Ёp@ (†‰Ђ3hђ6ЉЃ3hА*№Ѓ
ЁH6¤3i *ЕЃЁ06ћ9Yµ”‚"ў "6mqfЧ@&U”aЪ`! "¤ ЫЮ!  T„›~@…T@F#>-XWФB © ЄЌЂ3mрсjКёЂLЫЮ*Ј *6 НЅаbыьEG@   ЉђЂh6±1Zў  Н» LР •}@„  •›WБX2ЯP!  ЙР mеС0m…dЉ©•љ  0DTt FН± LЄ8!їЩ"Є: Н·@B3вХ…K Д/зы$UG@ ` e›H ДT\ UG@ґРEBА  $UG@lЫК« bЄJ еQР+4  `°D   Љ…Ђ_пс dЂ ЦА1U >-XV4›QЂЩґEZЂВ  6кЂІ¬PЄµІXu°UBАb* *ўа1 і@ 0’*ЈаЕ«*Ч€_пцH„  rіhXEFАTl " YґфEF@Tl F#fЬ1 Ђ@*> !        А            *Ѕ nQU іjX*°
©сjКЎ`‚‡CЃ   ЉцЃЉЇXсjК¤`‚«Ъ}{ Mм:L*Ѕ b+Ъ*Ј`  2е^Р1HFнЃ†Y·0љ  
Їh¤#xАГ,Ъt"Ѕ`bЄN еQ°+6¬Ѓ°X"ыьEFА%¬ ЋнdЉЁИ ЊEF@nQ 9fЩР6‰ф$*Ј`VmHіiи ЄЌЂДnVm}іl!сjВґАЊЫЮНґ@b6meZ`AэюЙ–У@ H    W@QU®rі@ ЉХ9D/чы6ґ І® ЄЧ9D @•љ  0X,‘UЄr€@ЂЛ6ЕC  Л6о8Ьў  гr€A Л6с‚8Ьўфгt°X,¬Z G+4  `Љ­`#$    +ш(Є€№Y¶Ф‚"ЎЂ®QэюНё ЊЄj
*ў ®Q еfЬаF’*ЎЂ®Q  q№ETЊЖеRp”CSA\n–‚"ЎАўЄ
еfРPVЄ‡ІD6(КН  " rНѕ ЋVh  Бd•€%!‘°.'•† ±¤2#Дт°И V ”†DbА3а‹”ХТUг0 q№R3:	PЛ““Х#/ U№MaR3РPУ“#ЁАy1M}%B;ЮђУЧУФ#ЎаUII:&‘–UTг  I5:$‘ЧСU#¤ U5AF2D
‘KЈ? mёВ3ZTKЌ#& µ1IJ:ѕQ”СT”Ј¶ ™M%9%R:$‘”ЧРU#.`‰є0 ‘СS“QTг  95ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                              UHT(TPICLSE)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                      /*				*/
tpi_close(control)                          /* close tape after I/O ops	*/
struct	_ctrl	*control;			/* Control structure	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/06/88 Arguments passed in 'control' structure - ICFO
13/06/88 BR462(3) - argument added to 'setbot' and rewind doesn't wait
         for BOT - ICFO
08/06/88 'tp_close' split intotwo, one for INPUT and 1 for OUTPUT - ICFO
30/10/87 ICFO - Dialogue to allow tape marks to be written on error
         where tape is rather than being backspaced to the end of the
         previous file
06/04/87 DAR - Created
*/

{

LOCAL
WORD	rv;		/* return value					*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

rv = SUCCESS;	/* prime the return value				*/

/* attempt to close volume if online					*/
if (tpstat(ONLINE) == TRUE && control->tp->no_rewind == FALSE
			   && setbot(control,TRUE) == FAIL)  rv = FAIL;

/* free off the block buffer						*/
control->bc->bk_base = spfree(control->bc->bk_base);

/* set block status to closed						*/
control->bc->bk_stat = FALSE;

/* return status to caller						*/
return(rv);

}

/*======================================================================*/
e				*/

/* attempt to close volume if online					*/
if (tpstat(ONLINE) == TRUE && control->tp->no_rewind == FALSE
			   && setbot(control,TRUE) == FAIL)  rv = FAIL;

/* free off the block buffer						*/
control->bc->bk_base = spfree(control->bc->bk_base);

/* set block status to closed						*/
control->bc->bk_stat = FALSE;

/* return status to caller						*/
return(rvееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее:Ш‘СUTг-Ђ© є2шRKђ“#, Q$ё№2:F ТS”cЈ %A-R:’TХТ#ўа%IAQJ2юS”ХPЈ"аµ1AI23ъ“У‘ЛЈ8А)8є2РS‘TKЌ#. µ9IJ:6ФХ#Ў =A-QMB:“Ф—ТT#ґ@y=A9}=B:>“ФХTСcЈ =IAQJ:NХUc¬ ™AUQ=A.3”KЈ6`qER2¬	TUQUQc  	I;т”‘PСU#¤ I}>2И”СUT”Ј `yM1=9є2°”Ф”‘Qc  Q1%	Z:R•Њ‘”ђз   ћ Q$ё№2:F ТS”cЈ %A-R:’TХТ#ўа%IAQJ2юS”ХPЈ"аµ1AI23ъ“У‘ЛЈ8А)8є2РS‘TKЌ#. µ9IJ:6ФХ#Ў =A-QMееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее d                                                                                                                              Copyright Timeclaim Ltd 1988 05.2003.02@ DEVELOP ЬФ                                                                            ГЂ        ! 9Нл"еН“Б"Ђ*Ђ Нл""Ђ*Ђ— е! 9Нл"Н¬0бНє0*Ђ‰ 6*Ђ– 6 ! 9Нл"е*ЂеНББ!  Й   H@  Ђ @ VARFXРRCREL   Ў               VAR2FШ  OV2                    EDITAS  C     Ґ              LTCDP   INP   E—!"          ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                              UHT(TPIFCLS)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                   /*				*/
tpi_fclose(control)                      /* close the current tape file */
struct	_ctrl	*control;			/* Control structure	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/06/88 Arguments passed in 'control' structure - ICFO
08/06/88 'tp_fclose' split into two, one for INPUT and one
         for OUTPUT - ICFO
06/04/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Increment the current block number					*/
++control->bc->bk_curnum;

/* skip past next file marker						*/
return(skipf(control,1));

}

/*======================================================================*/
 split into two, one for INPUT and one
         for OUTPUT - ICFO
06/04/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Increment the current block number					*/
++control->bc->bk_curnum;

/* skip past next file marker						*/
return(skipf(control,1));

}

/*=======================================================ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее D                                                                                                                             Copyright Timeclaim Ltd 1989 05.2003.02@ DEVELOP ‚                                                                            Г,Ђ                           яяяя          ! 9Нл"уя|µВ@ЂНЃЙ! 9Нл"ГиЂ! 9Нл" 6я#6я! 9Нл" 6#6 ! 9Нл"еН§„Б#НN"КЃЂ!яяЙГЃ! "$ЂНIѓНжѓГЃ! 9Нл" Нл""*Ђ! 9Нл" Нл""(Ђ! 9Нл"
 Нл""&ЂН	…Й!  "$Ђ   !ЂНє0Нь‚НҐѓГЃГЃНш"JЂ  „Ђ „Ђ „Ђ „Ђ „Ђ “Ђ	 КЂ   !  Й    !  ""Ђ*Ђ#НN"К(ЃНҐѓ!  е!ЂН¬0Нм…НЙ0КўЃНoѓ"Ѓ  Нv"КMЃГ©‚:	ЂНж"е*ЃН:"К`ЃГўЃ:
ЂНж"е*ЃН:"КsЃГ(Ѓ!ЂН¬0ЕХ! Н%1Н~0!ЂНє0*ЃеН\„Б"Ѓ#НN"КџЃГ©‚Г(Ѓ!  е!ЂН¬0Нм…НВ0К‚*ЂГтЃГ‚:	ЂНж"е*ЃНX"КгЃНoѓ"Ѓ  Нv"КаЃГ©‚ГѕЃГ‚! еНV…БЙГ‚Нш"»Ѓ  ѕЃ жЃ   !ЂН¬0л"Ѓ!  е!ЂН¬0Нм…НЙ0К&‚*ЂНN"Н2"К3‚*Ѓ+"Ѓ*Ѓ|µК]‚:ЂНж"еН\„Б"Ѓ#НN"КS‚Г©‚*Ѓ+"ЃГ3‚!  е!ЂН¬0Нм…НЙ0Кv‚*ЂНN"Н2"КЋ‚:	ЂНж"еН\„Б"Ѓ#НN"Н2"К—‚Г©‚! "$ЂНжѓ!  "$ЂНь‚*Ѓ##|µВш‚! "$Ђ*ЂНл"|µКЗ‚Нжѓ* Ђ"ЂНжѓ!яя" Ђ!  "$Ђ!ЂН¬0ЕХ!ЂН¬0Н€…Кш‚!  еНV…Б!  Й!ЂН¬0!ЂНє0Й*&ЂеН“Б" Ђ#НN"Кѓ!яяЙ* ЂНл"#|µВ/ѓ!юяЙ* Ђ Нл""Ђ* ЂНл""Ђ!  Й* Ђ#Н2"К`ѓ*(Ђе* ЂеНББ!  "Ђ!яя" ЂЙ  *Ђ|µВђѓНIѓН	ѓ"mѓ  Нv"КЌѓ*mѓЙГoѓ*Ђ+"Ђ*Ђ#"Ђ+Не"& Й!  еН“Б"Ђ*Ђ Нл""Ђ*Ђ##Нл""Ђ! ""Ђ!  Й               *дѓе*Ђ#Н2"КW„*$Ђ|µК„! Г„!  "дѓ*вѓ|µК„*дѓ}цoГ„*дѓ"дѓ*Ђ е*дѓ)ТѓНл"Нр"*дѓ)ЪѓНл""вѓ**Ђе*ЂеНББ!яя"Ђб"дѓЙ*Ђ#"Ђ+е! 9Не"С}*ЂеНл"#Нр"*Ђ##еНл"+Нр"|µВќ„НжѓНҐѓ#НN"Кќ„!яяЙ!  Й    k…*Ґ„еНzБ"Ў„е!яяН:"КК„*Ґ„е! еН‡ББЙ*Ў„е! 9Нл" Нл"ге!Ђге! 9Нл"ге!с„гйБББ"Ј„*Ў„еНу*Б*Ј„Й    v…*…еНzБ"…е!яяН:"К,…*…е! еН‡ББЙ*…е!Ђге*&Ђге**Ђге!D…гйБББ"…*…еНу*Б*…Й!Ѓ…еН|Б! 9Нл"еНpБЙVAR2FX.OV1 VAR2FX.OV2 VAR2FX ! Нш0! еН»…бхН	1ВЎ…сГ©…с! Т©…-СББХ-Й! Нш0! Г‘…! 9~“_#~љW#~™O#~hgGх|­тЩ…с?ЙсЙЙге!1Гс…ге!1Гс…ге!%1ЕХе! 9Н¬0бХ†Хе`iЙ! 9Нє0бСБЙе!51Г"†е!31Г"†е!31ЕХе!
 9Н¬0бНB†DM! 9^#V#Нє0СБбсЙйЙ        @    I    Ѓ ‚I€€€Ђ $	$ЂI	 A$ €@‚	$Ѓђ	$B"A $$Ѓ$HA @	ђ ђI	 @ @$@BI ‘"D  	   €A! I " € "  @ @Ђ@@   Ђ@@ђЂ!@HЂ      Ѓ              VAR2FX ! Нш0! еН»…бхН	1ВЎ…сГ©…с! Т©…-СББХ-Й! Нш0! Г‘…! 9~“_#~љW#~™O#~hgGх|­тЩ…с?ЙсЙЙге!1Гс…ге!1Гс…ге!%1ЕХе! 9Н¬0бХ†Хе`iЙ! 9Нє0бСБЙе!51Г"†е!31Г"†е!31ЕХе!
 9Н¬0бНB†DM! 9^#V#Нє0СБбсЙйЙ        @    I    Ѓ ‚I€€€Ђ $	$ЂI	 A$ €@‚	$Ѓђ	$B"A $$Ѓ$HA @	ђ ђI	 @ @$@BI ‘"D  	   €A! I " € "  @ @Ђ@@   Ђ@@ђЂ!@HЂ      Ѓ      ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                              UHT(TPIFOPN)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                             /*			*/
tpi_fopen(control,lev)                             /* open up tape file */
struct	_ctrl	*control;		/* Control structure		*/
struct	lvl	*lev;			/* level descriptor		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
23/06/88 Seeking to start of file moved to tape open code - ICFO
20/06/88 Arguments passed in 'control' structure - ICFO
14/06/88 Call to 'tp_seek' changed to 'tpi_seek' - ICFO
08/06/88 'tpfopn' split in to two, one for INPUT, one for OUTPUT - ICFO
06/04/87 Created DAR
*/

{

/* assumes that the tape is now set to the start position & position	*/
/* variables are set to current file and block				*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* check tape unit ready						*/
if (tpstat(ONLINE) == FALSE)  return(tperr(0));

/* open up the first block						*/
if ((*control->bk_open)() == FAIL)  return(FAIL);

/* flag tape file as open						*/
control->tf->tf_stat = TRUE;

/* flag file as unspanned						*/
control->tf->tf_span = FALSE;

return(SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                              UHT(TPIIOCK)
*/
#include	"dd.h"
#include	"gtape.h"

EXTERN
struct	_bc	bc;

EXTERN
struct	_tpdesc	tp;

EXTERN
struct	_tf	tf;

/*======================================================================*/
STATUS                                        /*			*/
tpi_iochk(status,bytlen)                      /* check status of I/O op */
UWORD	status;		/* status word returned from I/O op		*/
WORD	bytlen;		/* byte error count for read ops		*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
13/06/88 BR unnumbered (dated 15/02/88) - If fail is not because of end
         condition a message is now output - ICFO
08/06/88 'tp_iochk' split into two, one for INPUT, one for OUTPUT - ICFO
06/04/87 Created DAR
*/

{

/* used to sort out any errors encountered in block I/O. The scheme by	*/
/* which th…•ђT‘–аe5E$”дxXЙ=XЖFLD_FDЃ‘“Ф”аddДEх51}"EOFESDЃ‘СU’`ddДE%4I@ Ц$                                                                              эю"ЁЂ*„ "Ё *| "§Ђ*t "§ 8К! ,Р К!ўАQ$ rі@ ‚БS@h  Кў "Єh еС`(†ў„№Y  ‚БSЂU4 r€h°”CR\¬Ы Б`°DTи UM ў, еФ°—+6Т 0X,< S@(†‹ 9D58%КН· EOЂTРК!ўАQQ	rіnp‚БT U4 r€h°”CU\¬ЫЖ Б`°DU UM ў, еХp—+6ь 0X,D T@6ѕЂ2« „ іk84  (    9fТ@€$  Dc` „ іiђD ЌЂ1° B Yµ" FАЎ 9fХ €    @ е›WАB p dlїЯв*d !«A.Q  r€A`+4  `°X"*l #fЂ «H!«A.Q еfЂ $UQ lЫ"В¶ "Єx #fС mіeQА! 9fЦА€ rЉ©а Ќ›j@YW\B  0пЄћ 
B4ђ 2Нё .Q  еfЯ 6ў}	9D/чы4  e_АвЃ –mаЃЂ–h  |Z°Ёа„ іhD ЌЃRСА!UD іn`
–Ѓ
©р Ќ›mЂYґ¬	•] „ @ е›E ‚ Ђ eК*§А6m!eTр!  Г«@BЄ| )Т@ Л6њ9D •›~ЂШ,‰ф$еїЯмЫиК®ЂL;Д-tT@6ў0¬(Є  Щґё	›`А™W°B Yµ`" \ўЄЂ #fЧђ&U§Ђ ;d*Ё ђЌ$ іlЂ”B 9Y·и‚БhџBNQэюН­ЂL«Гј@b  rН¶ A8 2НЎ GЕ«
ц@ЂЛ6иЃ@а ИШ-мT@6О0ЇиЄњ Щ¶	›~А™TШUN lЫвКў`b ‡GЂЕTа R¤Ђ–mдr€@АЛ6Ћ№Yґ`‚Біh@*›°пґШUQ lЪ\ВЁаbЄ„ #fЯа&mEeXђ1UB іiШ*®Ѓ€@ hT HF’ YґђК! ,ЪМеЃЂ–mnrіiё;‚Біjђ*ДЃ°п¶$UQ lЫВі@bЄt #fФЂ6me]А1U: іlp*Ш€@ »S HF’ YµШК! ,ЫrеЃЂ–mБrіkC‚Біm(*о°п·pB  ©ђ Є› 9Y  ULЂ       VPљд_ВD  ”B Y·$љ  2Ёи „ іh#•љ  0B  4  fЩ°6U]Ѓ –mrіn°#ъ2ѕ`nQэюНёЂLЄ¬! ,ЪP)Я@0Л6Ў9D!p•›gАX,ХуfЂ ‘  еЂ Q е‚ –mJ€ДbђЌ  №D @•љ  0X,љ  op”B 9Y  ‚}_06h  !  Ј«жН«@ЊЪК¶ ‚ыэ’!ЅАnVmЦ`џFWМFНєЂl«! ¬Р ‚Й_06m¤dЂ   9fЦаG+6Љ0O‹VлЂ ‘ 9rіnШ Ќљ  
Щ·`	КН  'С•ФЇЯб–meQ°QХФfЭ @ЉбюfРђVmeRPQэюЙ]@FmЇЯб“вХ…TЃD   еКНѕ ‚6mхіoИ!фetБ¶ш•TЃD/чы&Z¤
:єЂЊЪR
Г®Аў rН§@¬Ъ„
ЙЂЂ–m`rіlи+’Г°`¬Р ­‚ђ@ђ   #р Аb2ЌЈaёаrA!И„R0         "і ў  EeБEVd"ю?і@ Х
aЬ QU™€¬И+Ф‚€@@Л6µ‚єЕVd2Н¬`®Vmэ`џFVCaЃ\ў
еfЂ ЉН‚€Щµ$•~D/чы%‡AБ…V\R)Љ]b«6
YpVёYpQ0’         !  ў0 rНёа¬ЫNК§`В  rН¤ ОVmЯ`„@ mfСАVUWЃ –m.r€@ЂЛ6Ј9Y¶ф‚Бd€@ („  r€@ (†‚ 9D P•›_Ѓ,‚Н°А‚ еЃЂVm‘`°DTX›fЃTX›O™VXBяІD4@КН¦@МвХ…iБ„  $CDњў  rН©АОVmЅ`°Y     !· МЪN      rН¶ МЫћ
еfЂ вХ•DAД6дљ  1ZЎP   3@ +TB \¬Ы#fУаQ[6зѓZрЛ4  fЂ rН  wB Y·РК!· МЫѕбfРАq  Й                  Ђ Q  9fС`vm$eU q 9fФ w+6Нѓ0B  6њѓ3lh3*…@АЛ6¦ѓ№D Ђ е›YAЩ·рКНє`¬‰ф$VїГ,Ъ¶КІ в0 rН­ мЪаV?Г,ЪюНІ`м«X! ,ЫН±ЂбЫь2НІАмЫTКё ве…АVmR`°Y"  rНґ б  2е‚ –mЕfЪ0pЉµюfЮАVUжЂ :! ,ЫўНєЂбcь2Н»`мЄ ! Ђt B K@В·аB  2ET  EJAД40 EJБД 0 Љ–ѓ€@ /Ђ@*b! TФB Y·¬" \ўRеЂ@Q  еfЂ ›A  $                  B  9D Ђ е›LВµ•a‚ ` е›[¬ЪўБЂ Ъ°Нµ м«т! ,Ъте‚ –m‘fЮаw+6є°Z'РђEnяіl8C*а„@АЛ6М„3lа@EdяіmXC6Я„2®Ё@†М„№D!p•›nБШ,H„ іmЁ@D №D Ђ е›v‚¶а "І†Y·Ф›SB  $U@ЂUT CDЂU\ B ЄИ@„  U°Ѓ "«Ў EXB @ е›y‚ ђ eК!ЄЎQ еЂ VmG`°X,ЫаНѕa ’R)Ђ¤Ђ† (А’ ¤A А±¤2#ДТД V ”†DbАЂZ "ђЗ@±¤2#С@†: €%!‘° €	$1Р ¬A)€ЕЃ ґ@R ЋЂb	HdF,ў) t Њ»‚ве5t•D8М DC.LTЊћФ2ддхHК°-C.SXTЊШФ2еE5HП8CLS_TXЊГѓd5U%ффhЛ 6CUR_ONЊ  dDe$ФXЛ`6DIALOGЊњ$RиОCE.0ЋлdTфdU4Hни6FLDRSDЋ±„ddДEфT€пРFLD_FDЋЊddДEх%8йё>FLD_SPЊиTdДU%(ИhFNDSWTЊф„$rиА GENMESЊ  TtTдФhми.GET2HEЊїѓdtUDД”иЙJH.ЊЃѓФ„’д$ИП-INDEXЊйѓd•4D”tИ0=L.ADDЊхTВдХTИИи>LLONG.Њ›ДФTеXЛxBN.ЊдTдdU%(М8OPN_TXЊџ„ҐиЛSETSWTЊђѓе4ДфдrиО4ST4.ЋЂ e5E$”дxЛиFSTRLENЊ  UDД”%hН FTOUPPEЋЈ ec$dхcА  ћ_FНѕa ’R)Ђ¤Ђ† (А’ ¤A А±¤2#ДТД V ”†DbАЂZ "ђЗ@±¤2#С@†: €%!‘° €	$1Р ¬A)€ЕЃ ґ@R ЋЂb	HdF,ў) t Њ»‚ве5t•D8М DC.LTЊћФ2ддхHК°-C.SXTЊШФ2еE5HП8CLS_TXЊГѓd5U%ффhЛ 6CUR_ONЊ  dDe$ФXЛ`6DIALOGЊњ$RиОCE.0ЋлdTфdU4Hни6FLDRSDЋ±„ddДEфT€пРFLD_Fееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееpip m:=b:varfx$1.c[g14
c varfx$1
era varfx$1.c
m80 =varfx$1
era varfx$1.mac
xp b:[g14]=varfx$1.rel
era varfx$1.rel
APOLLП  OV1   ·              DBUG    REL   %ёЅ            BU      REL   є              BU1     REL   
»              DBUG    HRD    ї              DBUG    MAN   А              VARFXПV1REL   ў               RD2LF   C     ™              VARFXBL1SUB                    REPACЛ  C     ›              еVAR2FШ  OV1   Б              еVAR2FШ  OV2   В              ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееe errors are handled is charted in the UHT maintainence file	*/
/* in a section titled block I/O error handling				*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* if status & bytlen both = 0 then all was OK				*/
if (status == 0 && bytlen == 0)  return(SUCCESS);

/* check out possible errors on reading					*/

/* if read op has hit a filemark return FAIL set EOF or EORD		*/
if ((status & 0x44) == 0) {

/* Check for parity failure						*/
    if ((status & 0x01) != 0)  return(tperr(12));

/* try to read data block if not able then EORD hit			*/
    tf.tf_stat = (space(1,'B',&status) != 0) ? EORD : TEOF;

/* reposition back in file						*/
    space(-1,'B',&status);
    space(-1,'B',&status);

    return(tp.end_block > 0 && tp.end_block > bc.bk_curnum) ? tperr(6)
							    : FAIL;
}

/* if we got a residue of full blocksize with an ILI flag set then tape	*/
/* is blank								*/
if (bytlen == bc.bk_size && (status & 4) != 0)  return(tperr(33));

/* if we got too long block then fail					*/
if (bytlen < 0)  return(tperr(10));

/* if reading fixed len blocks & block was short check it out		*/
/* if we do not allow short blocks return fail				*/
if (tp.bktype == 'F' && bytlen > 0 && tp.short_block == FALSE)
							return(tperr(11));

/* check out parity							*/
return(((status & 0x01) != 0) ? tperr(12) : SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                              UHT(TPOFOPN)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                             /*			*/
tpo_fopen(control,lev)                             /* open up tape file */
struct	_ctrl	*control;		/* Control structure		*/
struct	lvl	*lev;			/* level descriptor		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
19/06/94 Filemark is written only if the concatenate file flag is NOT set
20/10/88 Algorithm for skipping back over trailing filemarks has been
         rewritten in the same way as that in 'tpopen' - ICFO
23/06/88 Code changed to allow for concatenation of files and spacing
         over file marks to be done at open file rather than at close
         file - ICFO
20/06/88 Arguments passed in 'control' structure - ICFO
14/06/88 Call to 'tp_seek' changed to 'tpo_seek' - ICFO
08/06/88 'tpfopn' split in to two, one for INPUT, one for OUTPUT - ICFO
06/04/87 Created DAR
*/

{

/* assumes that the tape is now set to the start position & position	*/
/* variables are set to current file and block				*/

LOCAL
WORD	status,			/* Return value from 'space'		*/
	retval;			/* Return value from 'space'		*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* check tape unit ready						*/
if (tpstat(ONLINE) == FALSE)  return(tperr(0));

/* if we are at EOT check multivol action				*/
if (tpstat(EOT) != 0 && nxt_tape(control,lev) == FAIL)  return(FAIL);

/* Space back to just after the first file mark unless this if the 	*/
/* first file of a session (in which case the tape will have been 	*/
/* positioned in 'tpopen') or the tape is at BOT			*/
if (control->st_sess == FALSE && tpstat(BOT) == FALSE) {	
/*    space(-1,'B',&retval);	/* Cannot space -2 because the file ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееx build1 amie  b:  3 05.20 w50 w50
x link1  amie  b:  3 05.20 svc svc
; AMST must be after AMIE
x build1 amst  b:  1 w50 w50 w50
x build1 amst  b:  1 svc svc svc
x build1 amex  b:  2 03.03
x build1 amex  b:  2 03.03 L L
x build1 edas  b:  2 01.15
x build1 eject b:  2 02.00
; ***** REMEMBER TO SET 'BASIC.SUB' VERSION NUMBER *****
x build1 sys   b:  4 03.15
x build1 copy  b:  5 02.03
x build1 utl   b:  6 01.02
; ***** REMEMBER TO SET 'BASIC.SUB' VERSION NUMBER *****
x build1 fmt   b:  7 01.05
x build1 lane  b:  8 02.01
x build1 apac  b:  9 04.01 B B
x build1 apac  b:  9 04.01 L L
x build1 emma  b: 10 02.01
x build1 apolo b: 11 01.01
x build1 dbug  b: 13 02.00
x build1 varfx b: 14 03.03K
x build1 tar   b: 15 05.04
x build1 bbcdf b: 17 02.01
x build1 hplif b: 18 01.02
x build1 rdos  b: 19 04.01
x build1 sqchk b: 21 01.01 svc
x link1  sqchk b: 21 01.01 w50
x build1 lloyd b: 22 02.04
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее...	*/
/*    space(-1,'B',&retval);	/* ... mark will terminate after the ...*/
/*    if (control->tp->end_file == 0) {	/* ... first one		*/
/*	space(-1,'B',&retval);						*/
/*	--control->tf->tf_num;						*/
/*    }								!!!!!!!!*/
    status = space(-1,'B',&retval);
    while ((status & 0x02) != 0) {
	if ((status & 0x40) != 0)  break;	/* Will this leave a ...*/
	status = space(-1,'B',&retval);		/* ..spare block at BOT?*/
    }
    space(1,'B',&retval);
    if (control->tp->end_file == 0)  --control->tf->tf_num;
    else {  /* Do not concatenate files */
        control->bc->bk_curnum = 1;
        wtfmks(1);
    }
}

control->st_sess = FALSE;

return(SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                              UHT(TPOIOCK)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                        /*			*/
tpo_iochk(status,bytlen)                      /* check status of I/O op */
UWORD	status;		/* status word returned from I/O op		*/
WORD	bytlen;		/* byte error count for read ops		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
08/06/88 'tp_iochk' split into two, one for INPUT, one for OUTPUT - ICFO
06/04/87 Created DAR
*/

{

/* used to sort out any errors encountered in block I/O. The scheme by	*/
/* which the errors are handled is charted in the UHT maintainence file	*/
/* in a section titled block I/O error handling				*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* if status & bytlen both = 0 then all was OK				*/
if (status == 0 && bytlen == 0)  return(SUCCESS);

/* NB WRITING PAST EOT ALLOWED AT THIS LEVEL				*/

/* check out parity							*/
return(((status & 0x01) != 0) ? tperr(12) : SUCCESS);

}

/*======================================================================*/
on titled block I/O error handling				*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* if ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееx build1 chcon c:  1 02.00
x build1 cpm   c:  2 04.00
x build1 ctos  c:  3 02.01
x build1 ddisc c:  4 02.01
x build1 diag  c:  5 03.03
x build1 eof   c:  6 02.02
x build1 field c:  7 03.01
x build1 field c:  7 03.01 B B
x build1 gcos  c:  8 02.01
x build1 ibmde c:  9 07.04
x build1 icl   c: 10 02.05
x build1 ms    c: 11 05.03
x build1 par   c: 12 03.01
x build1 rcutl c: 13 04.01
x build1 rs232 c: 14 03.00
x build1 uht   c: 15 05.03
x build1 wang  c: 16 01.01
x build1 cpn   c: 17 01.00
x build1 mod   c: 18 01.01
; TCDP must be after UHT
;x build1 tcdp  b: 12 03.08	Does not (and need not) compile any more
x build1 tcdp  b: 12 03.11 B B
x build1 tcdp  b: 12 03.11 L L
x build1 ibmde c:  9 07.04
x build1 icl   c: 10 02.05
x build1 ms    c: 11 05.03
x build1 par   c: 12 03.01
x build1 rcutl c: 13 04.01
x build1 rs232 c: 14 03.00
x build1 uht   c: 15 05.03
x build1 wang  c: 16 01.01
x build1 cpn   c: 17 01.00
x buееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХђ`eT…Dхd@ Ф B Y   D( ЌЃв1° B YґК! ,Ъ* еfЂ &0 ‘”ђSQc  	є0 ‘СS“QTг  952: ’Ј  Q1%	Z0 •P•Ј$ QA}IN: •RХђg   ћ                                                                                                               BKIOPЕN C     d              UHMENХ  C     
}              UHT     ERR   	~              UHTOVґ  REL                 UHT     OV8   Ђ              UHTOVВ  REL                 UHTBL±  SUB   ‚              UHTBLІ  SUB   ѓ              ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(TPREAD)
*/
#include	"dd.h"
#include	"gtape.h"

EXTERN
struct	_bc	bc;

/*======================================================================*/
STATUS                                    /*				*/
tp_read(buf,bytes)                        /* read tape data into buffer */
BYTE	*buf;		/* target buffer for data			*/
UWORD	bytes;		/* no of bytes reqd				*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
08/07/88 Listing brought up to standard and optimised - ICFO
06/04/87 Created DAR
*/

{

LOCAL
UWORD	taken;		/* no of bytes read from block			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* if there are no more bytes left in the current block get a		*/
/* new block if poss							*/

if (bc.bk_data == 0) {

/* close the current block						*/
    ++bc.bk_curnum;

/* open the next block							*/
    if (bki_open() == FAIL)  return(-2);		/* EOF hit	*/
}

/* read the smallest of 'bytes' or 'bk_data'				*/
/* copy bytes to target buffer						*/
cpymem(bc.bk_ptr,buf,(taken = (bytes < bc.bk_data) ? bytes : bc.bk_data));

/* update block control variables					*/
bc.bk_free += taken;
bc.bk_data -= taken;
bc.bk_ptr += taken;

return(taken);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(TPREST)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                              /*					*/
tp_restart(control,lev)             /* restart tape file transfer again */
struct	_ctrl	*control;			/* Control structure	*/
struct	lvl	*lev;				/* level descriptor	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
20/06/88 Arguments passed in 'control' structure - ICFO
08/06/88 'tp_restart' split into two, one for INPUT and one
         for OUTPUT - ICFO
10/04/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* if the file has been spanned forget it				*/
if (control->tf->tf_span == TRUE)  return(tperr(34));

/* seek to start of file						*/
/* reopen the file for Iееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/O						*/
if (fstpos(control) == FAIL || (*control->bk_open)(control) == FAIL)
							     return(FAIL);

return(SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                              UHT(TPSEEK)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                    /*				*/
tp_seek(control)                          /* seek to position on a tape */
struct	_ctrl	*control;			/* Control structure	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
19/10/88 Call to 'setbot' cannot return anything but SUCCESS and the
         argument changed to TRUE to force it to wait for
         completion - ICFO
23/06/88 INPUT and OUTPUT functions recombined - ICFO
22/06/88 Things concerning writing removed - ICFO
20/06/88 Arguments passed in 'control' structure - ICFO
14/06/88 Split into 2 functions.  One for INPUT without the call
         to 'seteod' and one for OUTPUT with the call - ICFO
13/06/88 BR462(3) - argument added to 'setbot' - ICFO
09/06/88 Listing brought up to standard and optimised - ICFO
30/10/87 Rewind suppressed if /NR switch is set
06/04/87 Created DAR
*/

{

LOCAL
WORD	file,		/* File number					*/
	block;		/* Block number					*/

LOCAL
BOOLEAN	mesup;		/* has seek to start message been put up	*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

file = control->tp->st_file;
block = control->tp->st_block;

/* set to end of data if file 0 is requested				*/
if (control->bc->bk_omode == 'W' && file == 0)  return(seteord(control));

/* if file is 1 (or 0) start at BOT					*/
if ((file <= 1 || file < control->tf->tf_num)
     && (control->bc->bk_omode == 'W' || control->tp->no_rewind == FALSE))
						     setbot(control,TRUE);

/* output 'winding to start pos' if we have to skip files		*/
if (file > 1) {
    (*control->tape_chat)(0,4,0,0,0);
    mesup = TRUE;		/* flag message displayed		*/
}
else mesup = FALSE;		/* message not displayedееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее		*/

/* Skip to requested file						*/
if (skipf(control,file - 1) == FAIL)  return(FAIL);

/* Calculate the block offset.						*/
/* If we have a respectable block skip to do put up the message if not	*/
/* already there							*/
if (block > 5 && mesup == FALSE)  (*control->tape_chat)(0,4,0,0,0);

/* seek to the block							*/
if (skipb(control,block - 1) == FAIL)  return(FAIL);

control->bc->bk_curnum = block;
control->tf->tf_num = file;

return(SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(TPSTAT)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
BOOLEAN                             /*					*/
tpstat(fn)                          /* is a tape system status flag set	*/
STATUS	fn;					/* tape status required	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
09/06/88 Listing brought up to standard and optimised - ICFO
06/04/87 Created DAR
*/

{

/* This function assumes that TRUE is not FALSE as well as FALSE is not	*/
/* TRUE.  This correct as TRUE is defined in 'portab' as 1 and FALSE is	*/
/* defined as 0.							*/

STATIC
WORD	mask[5] = {
		0x1,			/* write protect flag		*/
		0x10,			/* EOT flag			*/
		0x8,			/* BOT flag			*/
		0x4,			/* tape not ready		*/
		0x2			/* fixed block mode		*/
	};

LOCAL
BYTE	lstat[2];	/* contains status returned from inquire	*/

LOCAL
BOOLEAN	rv;		/* return value to calling func			*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

inquir(lstat);		/* call low level status function		*/

/* mask out all but reqd check bit from 2nd status byte			*/
/* make reply either TRUE or FALSE					*/
rv = ((mask[fn] & (WORD) lstat[1]) != 0) ? TRUE : FALSE;

/* turn tape not ready Y/N to tape online Y/N				*/
if (fn == ONLINE)  rv ^= TRUE;

return(rv);

}

/*======================================================================*/
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

inquir(lstat);		/* call low level status function		*/

/* mask out all but reqd check bit from 2nd status byte			*/
/* make reply either TRUE or FALSE					*/
rv = ((mask[fn] & (WORD) lstat[1]) != 0) ? TRUE : FALSE;

/* turn tape not ready Y/N to tape online Y/N				*/
if (fn == ONLINE)  rv ^= TRUE;

retееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                              UHT(TPWRITE)
*/
#include	"dd.h"
#include	"gtape.h"

EXTERN
struct	_bc	bc;

/*======================================================================*/
STATUS                                   /*				*/
tp_write(buf,bytes,go)                   /* write tape data from buffer */
BYTE	*buf;			/* target buffer for data		*/
UWORD	bytes;			/* no of bytes reqd			*/
BOOLEAN	go;			/* write out the AMIE data yes/no	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
09/06/88 Listing brought up to standard - ICFO
20/04/87 modified in testing - DAR
06/04/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* if input record larger than blocksize error				*/
if (bytes > bc.bk_free)  return(tperr(32));

/* copy bytes into block						*/
cpymem(buf,bc.bk_ptr,bytes);

/* update block control variables					*/
bc.bk_ptr += bytes;
bc.bk_free -= bytes;
bc.bk_data += bytes;

if (go == TRUE) {

/* close the current block						*/
    if (bko_close() == FAIL)  return(FAIL);

/* open the next block							*/
    if (bko_open() == FAIL)  return(FAIL);
}

return(SUCCESS);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                              UHT(BKIOPEN)
*/
#include	"dd.h"
#include	"gtape.h"

EXTERN
struct	_bc	bc;

EXTERN
struct	_tpdesc	tp;

EXTERN
struct	_tf	tf;

/*======================================================================*/
STATUS                                     /*				*/
bki_open()                                 /* Open block area for INPUT */
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	UHTLIB	- General Unheadered Tape Library
Revision history:
28/06/88 'bkread' separated out again because TCDP needs it separate
         from 'bki_open' - ICFO
24/06/88 End point detection changed so that the user can copy for
         example from File 6 Block 3 to File 7 Block 2 - ICFO
20/06/88 'bkread' made 'static' and moved to 'bkiopen' so that I can
         pass arguments as local static to save time - ICFO
07/06/88 Created from 'bk_open' - ICFO
         'bkread' returns FAIL if the incoming record is < number of
         padding bytes - ICFO
06/04/87 Created DAR
*/

{

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Set block pointer to start of block data area			*/
bc.bk_ptr = bc.bk_base;

/* Check if we are at any specified end point				*/
if (tp.end_block > 0 && tp.end_file > 0 && tf.tf_num >= tp.end_file 
					 && bc.bk_curnum > tp.end_block) {
    tf.tf_stat = TEOF;
    return(FAIL);
}

return(bkread());

}

/*======================================================================*/
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Set block pointer to start of block data area			*/
bc.bk_ptr = bc.bk_base;

/* Check if we are at any specified end point				*/
if (tp.end_block > 0 && tp.end_file > 0 && tf.tf_num >= tp.end_file 
					 && bc.bk_curnum > tp.end_block) {
    tf.tf_stat = TEOF;
    return(FAIL);
}

return(bkread());

}

ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(UHMENU)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
WORD                                               /*			*/
uhmenu(target)                                     /* utility main menu */
WORD	target;			/* 0 for SOURCE, 1 for DESTINATION	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	UHTMAN
Revision History:-
09/06/88 Optimised - ICFO
27/10/87 Facility to initialise the SOURCE tape has been removed - ICFO
20/04/87 Created DAR
*/

{

LOCAL
WORD	opts,		/* Number of options on the menu		*/
	n;		/* choice returned from menu			*/

EXTERN
BYTE	*tpmes[];	/* tape messages				*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

dframe[0]=tpmes[0];	/* set up options				*/
dframe[1]=tpmes[1];
if (target == SOURCE) {
	dframe[opts = 2] = tpmes[3];ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
}
else {
	dframe[2]=tpmes[2];
	dframe[opts = 3]=tpmes[3];
}

return(((n = genmen(opts,0)) == target + 1) ? FAIL : n);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееTape unit not online
Tape is write protected
Tape unit hardware error
Unable to locate tape starting position
Unexpected BOT tape marker hit
Unexpected EOT tape marker hit
Premature end of tape file
Tape Rewind failure
Tape search error
Tape blocksize too large for memory
Oversize tape block hit
Undersize tape block hit
Tape unit reports error
Tape filemark output error
Tape operation aborted
Tape read error
Tape write error
Invalid tape switch list
Pre block padding greater than/equal to blocksize
Post block padding greater than/equal to blocksize
Sum of pre & post block padding greater/equal to blocksize
Invalid character entry
Unexpected end of tape data hit
Tape positioning error
Invalid number entry
End file no less than start file no.
Invalid blocksize
Invalid pad byte entry
Invalid file number
Invalid block number
Start block no less than end block no
Blocksize too small
Input record larger than blocksize
Blank tape section found
Illegal restart on multivolume file denied
id character entry
Unexpected end of tape data hit
Tape positioning error
Invalid number entry
End file no less than start file no.
Invalid blocksize
Invalid pad byte entry
Invalid file number
Invalid block number
Start block no less than end block no
Blocksize too small
Input record larger than blocksize
Blank tape section found
Illegal restart on multivolume file denееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХЌ eT…DхcI@ ХМ(                    Ђ *  ! ,Р  "v YґtК! ,ЪH еЦ@§+4  `°X"*  #fЂ «д ! ,ЪX  .QU  ґC,Ъђ Н  ¬Р ‚]їГ,Р •^  ` е›V@*—шe›Y@ґш•e@ Ђ е›UЂb1° F6 @  aЮр  9fШ0ЌК! ,Ы4  .QU  ґC,ЫH еfЂ h  ! ,Ыd #іn D  fЂ «Ж ! ,ЫЊ #іn° D fЂ Ът КЅа ED %Ѕа:(! ,Ы¶ +fЧ`U‚ –mч €ЖАШ ! ЂT@Z(-Q mы eS ! 9fЦр ЉҐюfСЂU4ѓА:n!  T B  9D а”B 9ETК! ¬Р ‚" @Q0 9fРP+4  u€AЂЛеЦ! АQU €Ё•љ  0X'Е«*Б €_пцHкѓ 3@ +6®Ђ0B+·шe›J@YV”B Yґ€"©†Y¶H›y WB YµlF# c` „ Q &P`m†>-XWxB Y¶АF# Dc`щЂ€A Л6й €ДnQ rіm°›nЂ Ђ е›xАDb6mшЂ@Р •FЂ„ Ђ е›@Db6mЂ ЊЫВ НґА,ЄL! ЂT@ZL*ў ЫFК¦аBаКН  ,:(! ,Ъ$ #` Њl ЃЂ–mњ«џб“вХ…tБ   Љ€ @@Л6џЃNА Л6ІЃ9D @ е›[ њўОеfУ@‚"  6meRа1 9fЧ@ €h rЉЁ  ҐўfЩ &mOrіlP"»†YґЁ	•rА„ Ђ е›gЂ‚ @ dl ЌЂ ED t¬B Y¶Ь" \ў  rНє AР 2еP KD2Н»ЂNVmн`іo€„ іoPD іoИD  fЬАU‚ –m Ѓ –mЂ ЊЪ0Н°АLЄV! ЂT@ZVГЄ@b  rНўаb¶m­eU 1  9fУ00€  c` „ Q 	jђЄ€ 
ЩґЬ•\ Д Ђ е›P@В @ e›X@В  6ѓіi *КЃ€A Л6ґ„@Ђ Л6ЅЃ№D   е›`ЂДb6mЉhіkp6ёЃІ­H„2 rіi B  ЁЂ¶¤UD µ\•t  ”B 9D!°”B 9D  #•›SАX"* еѓ –mЏrіjш¬B _.± rЉЁ ЊE@Ђ¬ЪкБ`џ¬«ф!їЩ#Є НёА.VmҐ`„WoрЛ6ЦЃ°ЁА кѓ 3oр6…3l°*›‚A Л6йЃ„@Ђ ИШ #   Љ€ 0оh „ іi D №D4КНЅАLmт‚ –m<Ѓ –mSЂ ЊЪ:КЇ ‚@ rН«@Ѓ  2Н­@Ѓ ›dАЩґd•b  Љ€ 0мЂ „8 rіm UD lЪ,К· ‚@ rН® Ѓ  2НіаЋQ( 9fЪ`AЌ›kЃ,ЪоНЇ@Њ«љ!Ђ¬ЫБЂ * -НaЪђ6¦‚ –mіЃ ‘іьF6€@@Л6мNА Л6ф9D @ е›{БўФеfЧА&‚"  6mєeRQ  9fЯp@€  c`У€@ЂЛ6‰‚ЉЩ¶T•PЃD Ђ е›IЃB @ dlЌЂ;L
!  ўшК!ЂўёК!  ў` rН¦Ђ®VmЧu€AЂЛеЦН  ¬ЪБP@ ‹•юfТ VUЃїЯм‘  9fХ°P€ rЉЁ  ENяіkА+*Р€@ ЈЂ@Ъ	-¦–У€A Л6Г„A  ИШ#  Ђ е›jБDb6m»їЯб–•LЂ *  ! ,ЫЂ
; ,ЫЁ
еЃ –mЫr€khS•›Б,ЉЂ Щґ$•WA„ Ђ е›xБB Ђ eК! ,Ыю
 .QU  ґC,ЪеfФЂF6Т€A Л6ЊѓA  Л6”@ m·eTаa  9fТр`€  fУр`€ Н¬ ЊЫк
К«@В ED vB YµVНІ ¬«! ,ЪД #`Њl Ђ@* -Ѓ–Аѓ
ЁЂ6і2Є`8„  r€B („. r€@ („ Ђrіn8E@Ђў` rН® ОVm_u€AЂЛеЦ! АQU €Ё•›{@Ш,вХ•tЃ„/чы$uAЂґLшµa_ a  9fЪ°`€   Dc`ѓѓ€A Л6сA  Л”CAЂ¬Ъ:БfТa  9fЯP`€  fРАp€ Н©ЂМЄd! ,Ъ& ,ЪF  ґФ›SБ™UB ЁЂ¤ѓ€C +6в0XvZ! ,ЪT #` Њl ЃЂ–mЎ«џб–m…eWаq  9fХp€ fЧ vm3fЧАvU`
Ђ *  ! ,Ът; ,ЫеЃ –m–r€kЂS•›zБX,ЉЂ Щµь•V   е›gЃВ!  eК*  –€e›nЃЩµ„КН­ ¬ЉнюfЦЂvUх‚ –mИ‚Ђ‘° F6 @  aХPЃ  9fЮp€( r€@ЂЛ6э„C@ Л”U@ -Л6ѓ9Yґ‚Н  в@ rНўЃP 2Н¤a ›LЩU$ B YґЁ "
 Yґи " @3hИ;6ШІЄЁ@„ Q 	jЁCѕ@ЂЛ6 „
Щ·\•_ Ђ е›WB   dl ЌЂ ED %ЇЃЄ  +fЦ†Uљ‚ –mk‚Ђ–m‹Ђ Ъ`Н©A«|! ,Ы$#іm(C”B
 Y¶Ё " Y¶И!љ  3lШC*т„A Л6Ь„A@ Л6д„9D   е›t Ђ e›v,Ы0Н·б«т! ¬ЪЊБЂ * -щQ mЃeV Ў  е„@QH е…АQ еfЩрfЉЃ 9D А е›wВ¬Ы^лѓ —Л¬CAЂўЄ #P +6вѓ0X'Е«*Ґ€_пцHкѓ 3n°3•›sБШ!Ыь2НїЎ*Р: АЪњН«A,ЫМК°б"@ rН¤a!P 26 ЖА "ў ;А! ,Ъж .Q rіhАC›G Ђ е›cB   e›hВB 6Ј„2®HH„ іmPHD іmРHD  fЮ0†mi	e]Ђ‘ "ў ;А!Ђ¬ЫаБ–рЉЁЂ ­›Y‚YWш$B Y·$"
 Y·ј$"  3n8K6еІ©P„ іo°HЊFНЎ!NQ( 9fРа € fС`¦mјfЯр–UI
‚ –m
‚Ђ–m-
r€A@ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееЛ6љA  Л6ћ4Y·р%›HВ™Ut(B 9Y·t%‚!  T@‡~B%¬B ’S# ¤`Њ )ђЂR30UТc<Ў5№9=R2ЖPЛ”Ц#65№U2PЛ•Sc(бU№U1R0 ‘”ђSQc$Iє2”СKЊ#4Ащ9M]R3–‘ЛЈ  95N0 QСS“QЈ- №Q-f2†’Ј'Ў91Q1&2.“•SSSЈ3Ѓ)Dє0 UP•Ј*A9Q=UAA2N•ТU#*ЃUQAIJ:$•RХЌ'   ћ Л6ћ4Y·р%›HВ™Ut(B 9Y·t%‚!  T@‡~B%¬B ’S# ¤`Њ )ђЂR30UТc<Ў5№9=R2ЖPЛ”Ц#65№U2PЛ•Sc(бU№U1R0 ‘”ђSQееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее D                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ! 9Нл"Нл" Не"®яНN"ВTЂ! 9Нл"Нл" Не"©яНN"КQЂ! 9Нл" Нл" Нл"Н2"Н2"Н2"КѓЂ! 9Нл" еНл"#Нр"! 9Нл"##Нл"##еНл"#Нр"! 9Нл"еН’ЂБЙ  *ђЂе! 9Нл"Нл" Не"®я|µВЮЂ! 9Нл"Нл" еНл"#Нр"! 9Нл"е! еНFЃББлб"ђЂлЙ! 9Нл"
 Нл"е!тЂгй#НN"КяЂ!яяГЧЂ! 9Нл"##Нл"6 #6 ! еНEѓБ#НN"К%Ѓ!яяГЧЂ! 9Нл"##Нл"##еНл"#Нр"!  ГЧЂ     ! 9Нл"  Нw"К\Ѓ*BЃНN"Н2"К#‚! е!F е!DЃеН#„БББ}2AЃ++НN"КµЃ! 9еНл"+Нр"! 9Нл"##Нл"##еНл"#Нр"! 9Нл"Нл" 6#6 ! е!B е!DЃеН#„БББ|µКтЃ! 9Нл"##Нл"6#6 ! 9Нл"|µКпЃ!яя"BЃГ‚! 9Нл"е:AЃНж"е!F еН'‚БББ"BЃ!яяе!B е!DЃеН#„БББГFЃ*BЃЙ! 9Не"|µВ7‚!  Й! 9Нл"ѕяНN"КX‚! 9Не"& }жDoНN"Н2"К‹‚!яяе!B е! 9еН#„БББ! 9Нл"##Нл"6#6 ! еНФѓБЙ! 9Нл"Нл" Не"©яНN"КІ‚! еНс‚Б+НN"Н2"КБ‚! еНФѓБЙ! 9Не"& }жoН2"КЯ‚! еНФѓБГв‚!  Й         !н‚еН„Б! 9Нл")г‚Нл"е:о‚Нж"Н("Н2"Кѓ! Г!ѓ!  "п‚! 9Нл"+++|µВ=ѓ*п‚}оo"п‚*п‚Й    *Cѓе*Aѓе! 9еНл"+Нр"#|µКОѓ! е!AѓеНх„ББ"CѓЮяНN"К…ѓ! еНс‚Б+НN"Н2"КЋѓГ_ѓ*CѓЮяНN"К¦ѓ! еНс‚БНN"Н2"К·ѓ! еНс‚БНN"Н2"КЛѓ!яялб"Aѓб"CѓлЙГMѓ!  ГАѓ!йѓеН|Б! 9Нл"еНpБЙUHT                    ЙНA…! }2нѓ! "рѓ! 9Нл""фѓНb…Й    НA…! }2нѓ:оѓНж""„! 9е! 9Не"еНР#БС}ѕяНN"КZ„!  Гt„! 9Не"єяНN"Кq„! Гt„! }2оѓ! 9Нл""рѓ  Нv"К‘„!я Г”„!  }2пѓНb…"!„& }жoе! 9Нл"е!  Нр"НX"Ки„! 9Нл"е*ыѓеН<†БНр":шѓНж"& }ж@oН2"Ки„*!„}ц@o"!„*„}2оѓ*!„Й  НA…! }2нѓ! 9Нл""рѓНb…"у„& }жoе! 9Нл"е!  Нр"НX"К=…! 9Нл"е*ыѓеН<†БНр"*у„Й!пѓе!пѓе!нѓНУ" ХНУ"е!  еН.БББЙ!нѓT]###F#Np+qbkНѕ…НШ…Н†Ыеж(bk 	~#foЫеж Н†Н&†bkНм…8ТИеНѕ…!5†НШ…Н†bk	 	Н†bkНм…бЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙН†ЫежАЫежИ~/Уж#мН†Ыж/х>= эН†Ыж/ 	wс& oж(7Й}§ЙЫеж ъЙН†ЫежИЫж/w#сН†ЫежИ~/Уж#с   
 ЙБбеЕLeiЙ      Ђ   @             ‚     Ђ Ђ@Ѓ          ‚@ €$         Ђ    "    $	 B Ѓ $Ђ @ „      Ђ$	   @  Ѓ @ Ѓ$   Ђ Ѓ"A ’   @Ѓ   	   „	$          @ Ђ   bk 	~#foЫеж Н†Н&†bkНм…8ТИеНѕ…!5†НШ…Н†bk	 	Н†bkНм…бЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙН†ЫежАЫежИ~/Уж#мН†Ыж/х>= эН†Ыж/ 	wс& oж(7Й}§ЙЫеж ъЙН†ЫежИЫж/w#сН†ЫежИ~/Уж#с   
 ЙБбеЕLeiЙ      Ђ   @             ‚     Ђ Ђ@Ѓ          ‚@ €$         Ђ    "    $	 B Ѓ $Ђ @ „      Ђ$	   @  Ѓ @ Ѓ$   Ђ Ѓ"A ’   @Ѓ   	   „	$    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХђаeT…Dхd9@ Фь B Y  ”B YґКН  , 9fРРЌ›FЂАШ ! ,Ъ> #іiX D ЌЂ1° B  2c  I50  ‘ЛЈ  95N0 QСS“QЈ& 	 є0 UP•Ј  QA1%	Z2"•ЧС“г  U!Q=Yp  ћ                                                                                   BKIOPЕN C     d              UHMENХ  C     
}              UHT     ERR   	~              UHTOVґ  REL                 UHT     OV8   Ђ              UHTOVC  $$$                    UHTBL±  SUB   ‚              UHTBLІ  SUB   ѓ              ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееpip m:=c:$1.c[g15
c $1
era $1.c
m80 =$1
era $1.mac
lib uhtlib[i]=uhtlib.irl,$1
era $1.rel
TPOPEО  C     "8P_          UHTINР  C     '09`          UHTOV±  C     :            UHTOVґ  C     =<=>a        WTFMKУ  C     ?              SETEOД  C     @D            ONLCHЛ  C     A              UHTOVё  C     ,              SEKERТ  C                    TPICLУE C                   SETTPЕ  C     F              UHTOV№  C     	-              ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееpip m:=c:uht$1.c[g15
c uht$1
era uht$1.c
m80 =uht$1
era uht$1.mac
xp c:[g15]=uht$1.rel
era uht$1.rel
TPOPEО  C     "8P_          UHTINР  C     '09`          UHTOV±  C     :            UHTOVґ  C     =<=>a        WTFMKУ  C     ?              SETEOД  C     @D            ONLCHЛ  C     A              UHTOVё  C     ,              SEKERТ  C                    TPICLУE C                   SETTPЕ  C     F              UHTOV№  C     	-              ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееpip m:=c:uhtln1.sub[g15
pip m:=c:uhtlib.irl[g15
x uhtln1 inp $1 $2 64 $3
x uhtln1 out $1 $2 64 $3
x uhtln1 man $1 $2 64 $3
x uhtln1 ov0 $1 $2 64 $3
x uhtln1 ov1 $1 $2 64 $3
x uhtln1 ov2 $1 $2 64 $3
x uhtln1 ov3 $1 $2 64 $3
x uhtln1 ov4 $1 $2 64 $3
x uhtln1 ov5 $1 $2 64 $3
x uhtln1 ov6 $1 $2 64 $3
x uhtln1 ov7 $1 $2 64 $3
x uhtln1 ov8 $1 $2 64 $3
x uhtln1 ov9 $1 $2 64 $3
x uhtln1 ovA $1 $2 64 $3
x uhtln1 ovB $1 $2 64 $3
x uhtln1 ovC $1 $2 64 $3
x uhtln1 ovD $1 $2 64 $3
era uhtlib.irl
era uhtln1.sub
era uhtlnk.sub
x uhtln1 ov0 $1 $2 64 $3
x uhtln1 ov1 $1 $2 64 $3
x uhtln1 ov2 $1 $2 64 $3
x uhtln1 ov3 $1 $2 64 $3
x uhtln1 ov4 $1 $2 64 $3
x uhtln1 ov5 $1 $2 64 $3
x uhtln1 ov6 $1 $2 64 $3
x uhtln1 ov7 $1 $2 64 $3
x uhtln1 ov8 $1 $2 64 $3
x uhtln1 ov9 $1 $2 64 $3
x uhtln1 ovA $1 $2 64 $3
x uhtln1 ovB $1 $2 64 $3
x uhtln1 ovC $1 $2 64 $3
x uhtln1 ovD $1 $2 64 $3
era uhtlib.irl
era ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее ‰
                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГkЂ                                                                                                        ! 9Нл"уя|µВ€Ђ! 9Нл"еН!‚БЙ! 9Нл" 6#6 ! 9Нл"ГПЃ!Ђ"[Ђ!Ђ"]Ђ!Ђ"_Ђ!Щ„"gЂ!ѕ…"iЂ!‚е!1Ђе! еН*БББ"WЂ#НN"КкЂ!‚е!. еН‡ББЙ![Ђе! 9Нл"е!R е!1ЂеН}ѓББББ#НN"КЃ!яяЙГ‚!B е![Ђе! 9Нл"еН&ѓБББ*WЂеН~БГ‚!7 е![Ђе! 9Нл"еН&ѓБББЙ!8 е![Ђе! 9Нл"еН&ѓБББЙ!0 е![Ђе! 9Нл"еН&ѓБББЙ!9 е![Ђе! 9Нл"еН&ѓБББЙ! 9Нл" 6#6 !A е![Ђе! 9Нл"еН&ѓБББЙГ‚!  е!  е!  еНзБББГ‚Нш"ўЂ  Ѓ Ѓ Ѓ 4Ѓ KЃ
 bЃ	 yЃ yЃ ђЃ ·Ѓ ·Ѓ ·Ѓ   ГєЃ!  ЙUHT.MS1           ! 9Нл"
 Нл"еН“Б"‚##Нл""‚*‚ Нл"е*‚еНa„ББ"‚#НN"Кv‚! 9Нл" 6#6 ! еНл‡БЙ*‚##|µВ‹‚*‚6я#6яГѓ*‚+НN"Кі‚*‚е*‚Н:""‚|µК­‚! Г°‚! ГО‚*‚е*‚Н:""‚|µКЛ‚! ГО‚!  "‚*‚еНл"л*‚Нр"*‚##еНл"е*‚НУ"Нр"*‚ е*‚Нр"! 9Нл" Нл"е*‚еНББЙUHT.OV?     ! 9Не"}2 ѓ!ѓеНzБ""ѓ#НN"КQѓ!ѓе! еН‡ББЙ*"ѓе! 9Нл"ге! 9Нл"ге!lѓгйББ"$ѓ*"ѓеНу*Б*$ѓЙ! 9Нл"е! 9Нл"е! 9Не"е! 9Нл"еНфѓББББ#НN"КЇѓ!яяЙ! 9Нл"Нл"##е!
 9Нл" Нл" Нл"еНо)БНр"е!яяН:"Кмѓ!	 еНл‡БЙ!  Й    !W„еНzБ"рѓе!яяН:"К„!W„е! еН‡ББЙ*рѓе!
 9Нл"ге!
 9Нл"ге!
 9Не"ге!
 9Нл"ге!D„гйББББ"тѓ*рѓеНу*Б*тѓЙUHT.OV1   *Ђ|µВ~„*Ђ#"ЂНЩ„#НN"К~„!юяЙ*Ђе! 9Нл"е! 9Нл"л*ЂН¬"КҐ„! 9Нл"ГЁ„*Ђ"_„еНќ-БББ*Ђл*_„"Ђ*Ђе*_„НУ""Ђ*Ђл*_„"Ђ*_„Й*Ђ"Ђ*"Ђ  Н¬"Кф„*Ђ  Н¬"Н2"К…*Ђл*ЂНљ"Н2"К…*"Ђл*ЂН¬"Н2"К$…! "Ђ!яяЙН,…Й    *	Ђе*Ђе!*…еН€БББ"(…Н2"К_…*(…е**…еН‚†ББ#НN"К_…!яяЙ*	Ђе**…НУ""Ђе*)Ђл*+ЂСН¬"К……! еНл‡БЙ*)Ђл*+Ђе*ЂгНУ""Ђ*	Ђе*ЂНУ""Ђ*Ђл*)Ђ"Ђ!  Й          !  "ґ…)¶…е! 9Нл")1ЂНл"Нр"! 9Нл"|µК†*ґ…#"ґ…)¶…е!
 9Нл")1ЂНл"Нр"! 9Нл"|µК2†*ґ…#"ґ…)¶…е! 9Нл")1ЂНл"Нр"! 9Нл"|µК]†*ґ…#"ґ…)¶…е! 9Нл")1ЂНл"Нр"!  е!  е*ґ…#"ґ…е!¶…е!
 9Нл"еНWБББББЙ! 9Нл"НN"К™†! 9Нл"НN"Н2"КЈ†!  Й! 9Нл"& }жDoНN"КH‡! 9Нл"& }жoН2"КТ†! еНл‡БЙ! е!B е! 9еН¶€БББН2"Кс†! Гф†! "Ђ!яяе!B е! 9еН¶€БББ!яяе!B е! 9еН¶€БББ*"Ђ  Н¬"К3‡*Ђл*"ЂН¬"Н2"КD‡! еНл‡БГG‡!яяЙ*	Ђе! 9Нл"Н:"Кi‡! 9Нл"& }жoН2"Н2"Кx‡!! еНл‡БЙ! 9Нл" ЂН“"Ъ‘‡!
 еНл‡БЙ:$ЂНж"єяНN"К®‡! 9Нл"  Нw"Н2"Кє‡*'ЂНN"Н2"КЙ‡! еНл‡БЙ! 9Нл"& }жoН2"Кз‡! еНл‡БГк‡!  Й! €еН|Б! 9Нл"еНpБЙUHT                    Й  Н†‰! }2€! 9Нл""€! 9Нл""€Н§‰"€& }жoе! 9Нл"е!  Нр"НX"К®€! 9Нл"е*€еНЃЉБе*€)#СН#Нр":€Нж"& }ж@oН2"К’€*€}ц@o"€:€Нж"& }ж oН2"К®€*€}цo"€*€Й    Н†‰! }2€:€Нж""І€! 9е! 9Не"еНР#БС}ѕяНN"Кн€!  Г‰! 9Не"єяНN"К‰! Г‰! }2€! 9Нл""€  Нv"К$‰!я Г'‰!  }2€Н§‰"ґ€& }жoе! 9Нл"е!  Нр"НX"К{‰! 9Нл"е*€еНЃЉБНр":€Нж"& }ж@oН2"К{‰*ґ€}ц@o"ґ€*І€}2€*ґ€Й!€е!€е!€НУ" ХНУ"е!  еН.БББЙ!€T]###F#Np+qbkНЉНЉНUЉЫеж(bk 	~#foЫеж Н\ЉНkЉbkН1Љ8ТИеНЉ!zЉНЉНUЉbk	 	Н\ЉbkН1ЉбЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙНUЉЫежАЫежИ~/Уж#мНUЉЫж/х>= эНUЉЫж/ 	wс& oж(7Й}§ЙЫеж ъЙНUЉЫежИЫж/w#сНUЉЫежИ~/Уж#с   
 ЙБбеЕLeiЙ                   I$’I"   Ђ @  @ Ђ     @      @„  Ѓ $	B$A ђ       ђ$   @ђ            @ ђ @    @$ ‘ @Ђ  	 ‰H‰@$ HЂHЂA" ‚D@ D!Ѓ"	    "   $D   €Ђ         Ѓ  @ ‚   A ‘ Ѓ  Ђ   Ђ   "     $   Ђ Ђ H ЂЃ Ђ    $Ђ   @ ђ$H€Ђ  @ I   „ I Ђ            ЉбЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙНUЉЫежАЫежИ~/Уж#мНUЉЫж/х>= эНUЉЫж/ 	wс& oж(7Й}§ЙЫеж ъЙНUЉЫежИЫж/w#сНUЉЫежИ~/Уж#с   
 ЙБбеЕLeiЙ                   I$’I"   Ђ @  @ Ђ     @      @„  Ѓ $	B$A ђ       ђ$   @ђ      ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее N                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ! 9Нл" Нл" Нл"НN"К3Ђ! 9Нл"##Нл"Нл"+++НN"Н2"КMЂ! 9Нл" 6#6 !яяЙ! 9Нл" Нл" Нл"  Н¬"К“Ђ! 9Нл" Нл"е! 9Нл" Нл" Нл"#Н:"Н2"К­Ђ! 9Нл" 6#6 !яяЙ! 9Нл"##Нл"Нл"+++НN"КЮЂ! 9Нл"е! 9Нл"еНоЂББ#НN"Н2"КкЂ!яяГнЂ!  ЙЕЕ! 9Нл" Нл"Нл"++|µВDЃ! 9Нл" 6#6 ! 9Нл"Нл" Не"©яНN"К9Ѓ! Г<Ѓ! еНх†БББЙ! 9е!
 9Нл"##Нл"##Нл"Нр"!  9е!
 9Нл"Нл" Нл"Нр"! 9Нл"Нл" Не"®я|µВѓ‚! 9Нл" Нл"е!  ге! ге! ге! ге!  ге!ЅЃгйБББББ!  еНЧ€Б! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!чЃгйБББББНп‰НРН±(ея|µВ‚!яяГAЃ! 9Нл"еН‡Б#НN"К-‚!яяГAЃ! 9Нл"е!  еНЮ„ББ#НN"КK‚!яяГAЃНѕ'! 9Нл" Нл"е!  ге! ге!  ге!  ге!  ге!{‚гйБББББГh„! 9Нл" Нл"е!  ге! ге! ге! ге!  ге!°‚гйБББББ! 9Нл" Нл"Нл"+|µВе‚! 9Нл"еН~†Б#НN"Ке‚!яяГAЃ! еНн…Б#НN"Къ‚!яяГAЃ!  еНЧ€Б! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!/ѓгйБББББНп‰НРН±(ея|µВLѓ!яяГAЃ! 9Нл"еН‡Б#НN"Кeѓ!яяГAЃ! 9Нл"е!  еНЮ„ББ#НN"Кѓѓ!яяГAЃ!  еН™…Б+НN"К„! еНх†Б! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!ЗѓгйБББББНп‰НРН±(ея|µВдѓ!яяГAЃ! 9Нл"еН‡Б#НN"Кэѓ!яяГAЃ! 9Нл"е!  еНЮ„ББ#НN"К„!яяГAЃГѓѓНѕ'! 9Нл" Нл"е!  ге! ге!  ге!  ге!  ге!N„гйБББББ! 9Нл"##Нл" 6#6 ! 9Нл" Нл"Нл"+|µВ•„! 9Нл" 6#6 !яяГAЃ! 9Нл"##Нл"##е! 9Нл"Нр"! 9Нл"Нл" е! 9Нл"Нр"! 9Нл" Нл"е!Ы„гйГAЃ! еН™…БНN"К?…! 9Нл"+НN"К7…! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!'…гйБББББ!  еНЧ€БГ?…! еНЧ€Б! 9Нл"##Нл"е! 9Нл"##Нл"Нл"Н2"Нр"! 9Нл"##Нл"##6#6 ! 9Нл"Нл" 6#6 !  Й         !•…еНµ€Б! 9Нл")‹…Нл"е:–…Нж"Н("Н2"КЖ…! ГЙ…!  "—…! 9Нл"+++|µВе…*—…}оo"—…*—…Й    *л…е*й…е! 9еНл"+Нр"#|µКv†! е!й…еНя‰ББ"л…ЮяНN"К-†! еН™…Б+НN"Н2"К6†Г†*л…ЮяНN"КN†! еН™…БНN"Н2"К_†! еН™…БНN"Н2"Кs†!яялб"й…б"л…лЙГх…!  Гh†  ! еН™…БНN"Кћ†!яяе!F е!|†еН‰БББ! еН™…БНN"Кѕ†! е!F е!|†еН‰БББ! 9Нл"е! 9Нл"Нл" е! 9Нл" Нл" Нл"Нр"+еНx‡ББЙ!
‡еН|Б! 9Нл"еНpБЙUHT ! еН™…БНN"Кo‡! 9Нл" Нл"е!  ге! ге!
 ге!  ге!  ге!I‡гйБББББ! еН™…БНN"Кo‡Н‘(ея|µВl‡!яяЙГN‡!  Й     !  "t‡! 9Нл"|µКб‡! 9Нл"е!B е!v‡еН‰БББ}2s‡:s‡Нж"|µВё‡! 96 #6 ! 9Нл"е:s‡Нж"е!B еНе‡БББ"t‡#НN"КЮ‡Гб‡Г~‡*t‡Й! 9Не"|µВх‡!  Й! 9Нл"ѕяНN"К€! 9Не"& }жDoНN"Н2"КI€!яяе!B е! 9еН‰БББ! 9Нл"##Нл"6#6 ! еНх†БЙ! 9Нл"Нл" Не"©яНN"Кp€! еН™…Б+НN"Н2"К€! еНх†БЙ! 9Не"& }жoН2"Кќ€! еНх†БГ €!  Й                   ЙНKЉ! }2Ў€! "¤€! 9Нл""Ё€НlЉЙ    *Х€е*У€еНKЉ! }2Ў€:ў€Нж""Х€! 9Нл"Н2"}2ў€НlЉ"У€*Х€}2ў€*У€лб"У€б"Х€лЙ    НKЉ! }2Ў€:ў€Нж""‰! 9е! 9Не"еНР#БС}ѕяНN"КV‰!  Гp‰! 9Не"єяНN"Кm‰! Гp‰! }2ў€! 9Нл""¤€  Нv"КЌ‰!я Гђ‰!  }2Ј€НlЉ"‰& }жoе! 9Нл"е!  Нр"НX"Кд‰! 9Нл"е*Ї€еНF‹БНр":¬€Нж"& }ж@oН2"Кд‰*‰}ц@o"‰*‰}2ў€*‰ЙНKЉ! }2Ў€НlЉЙ  НKЉ! }2Ў€! 9Нл""¤€НlЉ"э‰& }жoе! 9Нл"е!  Нр"НX"КGЉ! 9Нл"е*Ї€еНF‹БНр"*э‰Й!Ј€е!Ј€е!Ў€НУ" ХНУ"е!  еН.БББЙ!Ў€T]###F#Np+qbkНИЉНвЉН‹Ыеж(bk 	~#foЫеж Н!‹Н0‹bkНцЉ8ТИеНИЉ!?‹НвЉН‹bk	 	Н!‹bkНцЉбЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙН‹ЫежАЫежИ~/Уж#мН‹Ыж/х>= эН‹Ыж/ 	wс& oж(7Й}§ЙЫеж ъЙН‹ЫежИЫж/w#сН‹ЫежИ~/Уж#с   
 ЙБбеЕLeiЙ      Ђ           Ђ      @        Ѓ                Ђ            Ђ        @Ђ       @@Ђ      $                    „ @     "             $	 B Ѓ $Ђ @ „        A          @ €   $ђ Ђ            @€  @D@ђ@$‰Ђ@ђ@   @    H$@ђ@Ђ$Ђ   DD   H  !I „     Ђ        ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее j                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            Г;Ђ                                                        !ЙЂе!Ђе! еН*БББ"9Ђ#НN"КeЂ!ЙЂе!. еН‡ББЙ! 9Нл"еНХЂБ"7Ђ#Н2"КЅЂ! 9Нл"|µВЋЂ*7Ђ)"7Ђ*7ЂГ­ЂН„‚ГєЂНEЃ+НN"К§ЂНщЃГєЂГєЂНш"”Ђ  љЂ   ГeЂ*9ЂеН~Б!  ЙUHT.MS3     *Ђ"1*Ђ"3! 9Нл"|µВЃ! "СЂ)1е*	ЂНр"ГЃ*Ђ"5! "СЂ)1е*	ЂНр"*СЂе!  еН»!ББ"УЂе! 9Нл"#Н:"К?Ѓ!яяГBЃ*УЂЙ  !  е! е! е!  е!  еН?†БББББНРН±(еНР#Б·я|µКyЃ!  Й!  "CЃ*CЃНN"КхЃ!  е! е! е! е!  еН?†БББББНРН±(еНР#Б§я|µКјЃ!  Й! еН‡Б"CЃНN"КХЃ!  еН†Б!  еН‡Б+НN"КтЃ! еН†Б!  "CЃГЃ! Й! е! е!  е!  еН!ББББ!  еНД€Б! еНe‡Б#НN"К+‚!яяЙ!  еНД€Б!  е! е! е!  е!  еН?†БББББНРН±(!  Й                                           ! еН‡БНN"К›‚!  еН†БЙ! еН‡БНN"КН‚!  е! е! е!  е!  еН?†БББББ!  еНД€Б! е! е!  е!  еН!ББББ!  "g‚!  "_‚! е!B е!a‚еН‰БееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееББН2"Кѓ! е!B е!a‚еН‰БББН2"Н2"К)ѓ! "g‚!  еНД€Б*g‚НN"Кm…Нѕ'!  е!	 е! е!  е!  "]‚"Y‚"[‚Н1!c‚Нє0ЕХН?†л! 9щл!  "i‚!  "m‚! "k‚*i‚НN"Кћ„! е!p‚е!Y‚еН(€БББ}2o‚Н‘(ея|µВ®ѓГm…:o‚Нж"& }жoН2"КЛѓ! еН†БГm…:o‚Нж"Н2"Кжѓ:o‚Нж"& }жDoНN"Н2"К)„! "i‚! е!B е!a‚еН‰БББ}2o‚Н2"К„! "g‚!яяе!B е!a‚еН‰БББГ›„*Y‚яяН#"Y‚*Y‚ "Y‚*[‚#"[‚*k‚НN"Кx„*]‚е*Y‚НX"Кb„! "m‚*]‚л*Y‚Н¬"Кu„*Y‚"]‚Г„„*Y‚"]‚!  "k‚!c‚Н¬0ЕХ*Y‚Н1НЃ0!c‚Нє0ГЂѓНѕ'!†еН„'Б*ЂеН„'Б*_‚#"_‚еНЁ‹Б!†еН„'Б*ЂеН„'Б*m‚|µВа„*#ЂеН„'БГи„*!ЂеН„'Б!†еН„'Б*m‚|µВ…*ЂеН„'БГ…*ЂеН„'Б*]‚еНЁ‹Б!†еН„'Б*%ЂеН„'Б*[‚еНЁ‹Б!†еН„'Б*'ЂеН„'Б!c‚Н¬0ЕХН%‹ББ!†еН„'Б*)ЂеН„'БНРН±(ея|µВj…Гm…Г1ѓ*g‚+НN"КЛ…*_‚|µВ¤…!  е! е! е!  е!  еН?†БББББНРН±(ГИ…!  е! е! е! е!  еН?†БББББ!  еНД€БГп…!  е! е! е! е!  еН?†БББББ!  еНД€Б!  е! е! е!  е!  еН?†БББББНРН±(Нѕ'Й

 


 !1†еН|Б! 9Нл"еНpБЙUHT           !  "5†)7†е! 9Нл")ЂНл"Нр"! 9Нл"|µК€†*5†#"5†)7†е!
 9Нл")ЂНл"Нр"! 9Нл"|µКі†*5†#"5†)7†е! 9Нл")ЂНл"Нр"! 9Нл"|µКЮ†*5†#"5†)7†е! 9Нл")ЂНл"Нр"!  е!  е*5†#"5†е!7†е!
 9Нл"еНWБББББЙ         !‡еН€Б! 9Нл")‡Нл"е:‡Нж"Н("Н2"К>‡! ГA‡!  "‡! 9Нл"+++|µВ]‡*‡}оo"‡*‡Й    *c‡е*a‡е! 9еНл"+Нр"#|µКо‡! е!a‡еНЮ‰ББ"c‡ЮяНN"КҐ‡! еН‡Б+НN"Н2"К®‡Г‡*c‡ЮяНN"КЖ‡! еН‡БНN"Н2"КЧ‡! еН‡БНN"Н2"Кл‡!яялб"a‡б"c‡лЙГm‡!  Га‡                   ЙН*Љ! }2ф‡! "ч‡! 9Нл""ы‡НKЉЙ  Н*Љ! }2ф‡! 9Нл""ч‡! 9Нл""ы‡НKЉ"&€& }жoе! 9Нл"е!  Нр"НX"Кј€! 9Нл"е*€еНЊБе* €)#СН#Нр":я‡Нж"& }ж@oН2"К €*&€}ц@o"&€:я‡Нж"& }ж oН2"Кј€*&€}цo"&€*&€Й    *В€е*А€еН*Љ! }2ф‡:х‡Нж""В€! 9Нл"Н2"}2х‡НKЉ"А€*В€}2х‡*А€лб"А€б"В€лЙ    Н*Љ! }2ф‡:х‡Нж""‰! 9е! 9Не"еНР#БС}ѕяНN"КC‰!  Г]‰! 9Не"єяНN"КZ‰! Г]‰! }2х‡! 9Нл""ч‡  Нv"Кz‰!я Г}‰!  }2ц‡НKЉ"
‰& }жoе! 9Нл"е!  Нр"НX"КС‰! 9Нл"е*€еНЊБНр":я‡Нж"& }ж@oН2"КС‰*
‰}ц@o"
‰*‰}2х‡*
‰Й  Н*Љ! }2ф‡! 9Нл""ч‡НKЉ"Ь‰& }жoе! 9Нл"е!  Нр"НX"К&Љ! 9Нл"е*€еНЊБНр"*Ь‰Й!ц‡е!ц‡е!ф‡НУ" ХНУ"е!  еН.БББЙ!ф‡T]###F#Np+qbkН§ЉНБЉНщЉЫеж(bk 	~#foЫеж Н ‹Н‹bkНХЉ8ТИеН§Љ!‹НБЉНщЉbk	 	Н ‹bkНХЉбЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙНщЉЫежАЫежИ~/Уж#мНщЉЫж/х>= эНщЉЫж/ 	wс& oж(7Й}§ЙЫеж ъЙНщЉЫежИЫж/w#сНщЉЫежИ~/Уж#с   
 Й! 9Н¬0ЕХ!  Н%1НЊКU‹!- еН)Б! 9е! 9Н¬0НЋ0бНє0! 9Н¬0ЕХ!	 Н%1НЊКѓ‹! 9Н¬0ЕХ!
 Н%1Нv/ЕХН%‹ББ! 9Н¬0ЕХ!
 Н%1Нq/ЕХ!0 Н%1НЃ0ЕХН)ББЙ! 9Нл" ЂН“"ЪТ‹!- еН)Б! 9е! 9Нл"НЭ"Нр"! 9Нл"цН“"Тх‹! 9Нл"л!
 Н3#еНЁ‹Б! 9Нл"л!
 Н3#л0 еН)БЙБбеЕLeiЙ! Нш0! еНIЊбхН	1В/ЊсГ7Њс! Т7Њ-СББХ-Й! Нш0! ГЊ! 9~“_#~љW#~™O#~hgGх|­тgЊс?ЙсЙЙ       @@  D’HHD	    H @ ‚@    A     " H    @  @        @Ђ@Ђ     A " "  Ѓ@  $‚ A Ѓ $Ђ$@ @Ѓ ђ	D‚DH‚I$	  ! $DD   IB         @        Ђ  ‘ Ђ "  D@  €Ђ     $	 B Ѓ $Ђ @ „   A H @ђ   D  Ѓ  H"‚ 	$HD‚     @Ђ @’   @Ѓ @‘ Ѓ I    @€€   ђ  B’          @   @    @  Ђ          @       "  Ђ   ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее њ                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ          ‡Ѓ! 9Нл"
 Нл"еН“Б"	Ђ Нл""Ђе!« е!  еН.БББ*Ђ"Ђе*ЂеНЊЃББ*ЂНе"Бя|µКgЂ*Ђ#"ЂГNЂ*Ђ##"Ђ! 9Нл" Нл""Ђ!  "Ђ*ЂэН“"ЪКЂГџЂ*Ђ#"ЂГ†Ђ*Ђ+"Ђ#е*Ђл!
 Н3#л0 С}*Ђл!
 Н3#"ЂГ•Ђ*Ђ– е! 9Нл" Нл" Не"єяНN"КчЂ!  ГъЂ! С}*Ђ— е! 9Нл" Нл" Нл"е! 9Нл" Нл" Нл"НУ"е! 9Нл" Нл" Нл"НУ"Н1бНє0*	Ђ6«#6 *	Ђ##еНл"UяНр"! 9Нл" Нл"е*	ЂеНББ!  ЙT??? БбСХеЕ+#~·В“ЃЙ     ‘Ђ	B ЂID  H    ‚                 ГЂ          ‡Ѓ! 9Нл"
 Нл"еН“Б"	Ђ Нл""Ђе!« е!  еН.БББ*Ђ"Ђе*ЂеНЊЃББ*ЂНе"Бя|µКgЂ*Ђ#"ЂГNЂ*Ђ##"Ђ! 9Нл" Нл""Ђ!  "Ђ*ЂэН“"ЪКЂГџЂ*Ђ#"ЂГ†Ђ*Ђ+"Ђ#е*Ђл!
 Н3#л0 С}*Ђл!
 Н3#"ЂГ•Ђ*Ђ– е! 9Нл" Нл" Не"єяНN"КчЂ!  ГъЂ! С}*Ђееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее ъ                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГѓЂ                                                                                                                                ! 9Нл""Ђ! 9Нл" 6 #6 ! 9Нл" 6 #6 ! 9Нл" е! 9Не"©яНN"КРЂ! ГУЂ! Нр"! 9Нл" Нл"|µВтЂ! еНб‚БЙ! е! 9Нл" Нл"е!Ђе!%ЂеНЄББББ"ЃЂ!РЃе!?Ђе!! еН*БББ"Ђ#НN"КAЃ!РЃе!. еН‡ББЙ! 9Нл" Нл"е! 9Не"е!ЂеНтЃБББ"Ђ*ЂеН~Б*ЂН2"КzЃ!яяЙ!ШЃеНzБ"	Ђ#НN"КљЃ!ШЃе! еН‡ББЙ*	Ђе!
 9Нл"ге! 9Не"ге! 9Нл"ге!ѕЃгйБББ"Ђ*	ЂеНу*Б*ЂЙUHT.MS2 UHT.OVD         ¶‚ѕ‚Ж‚О‚Ц‚! 9Нл"v Нл"е! 9Нл"е!Ю‚еН+БББ#Н2""жЃ!  "дЃ*дЃыН“"ЪІ‚Г9‚*дЃ#"дЃГ ‚*дЃ)иЃНл"еНzБ"аЃ#НN"Кi‚*дЃ)иЃНл"е! еН‡ББЙ*аЃе! 9Нл"ге! 9Не"ге*жЃге!
 9Нл"ге!’‚гйББББ"вЃ*аЃеНу*Б*вЃ#НN"КЇ‚!яяЙГ/‚!  ЙUHT.OV2 UHT.OV3 UHT.OV4 UHT.OV5 UHT.OV6 DF !ц‚еН|Б! 9Нл"еНpБЙUHT                         A   Ѓ  D $    "	       U@   A D‘ $@   @ ђ @        Б"	Ђ#НN"КљЃ!ШЃе! еН‡ББЙ*	Ђе!
 9Нл"ге! 9Не"ге! 9Нл"ге!ѕЃгйБББ"Ђ*	ЂеНу*Б*ЂЙUHT.MS2 UHT.OVD         ¶‚ѕ‚Ж‚О‚Ц‚! 9Нл"v Нл"е! 9Нл"е!Ю‚еН+БББ#Н2""жЃ!  "дЃ*дЃыН“"ЪІ‚Г9‚*дЃ#"дЃГ ‚*дЃ)иЃНл"еНzБ"аЃ#НN"Кi‚*дЃ)иЃНл"е! еН‡ББЙ*аЃе! 9Нл"ге! 9Не"ге*жЃге!
 9Нл"ге!’‚гйББББ"вЃ*аЃеНу*Б*вЃ#НN"КЇ‚!яяЙГ/‚!  ЙUHT.OV2 UHT.OV3 UHT.OV4 UHT.OV5 UHT.OV6 DF !ц‚еН|Б! 9Нл"еНpБЙUHT       ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее ¶                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ! 9Нл" 6#6 ! 9Нл"е! 9Нл"еН)ЂББЙ! 9Нл"##Нл" Нл"+НN"КLЂ!" еНЃБЙ! 9Нл"еН‘ЂБ#НN"ВЃЂ! 9Нл" Нл"е! 9Нл"ге!|ЂгйБ#НN"Н2"К‹Ђ!яяЙ!  Й  ! еН]‚БНN"К±Ђ!яяе!F е!ЏЂеНг‚БББ! еН]‚БНN"КСЂ! е!F е!ЏЂеНг‚БББ! 9Нл"е! 9Нл"Нл" е! 9Нл" Нл" Нл"Нр"+еН&ЃББЙ!ЃеН|Б! 9Нл"еНpБЙUHT      !  ""Ѓ! 9Нл"|µКЏЃ! 9Нл"е!B е!$ЃеНг‚БББ}2!Ѓ:!ЃНж"|µВfЃ! 96 #6 ! 9Нл"е:!ЃНж"е!B еН“ЃБББ""Ѓ#НN"КЊЃГЏЃГ,Ѓ*"ЃЙ! 9Не"|µВЈЃ!  Й! 9Нл"ѕяНN"КДЃ! 9Не"& }жDoНN"Н2"КчЃ!яяе!B е! 9еНг‚БББ! 9Нл"##Нл"6#6 ! еНЃБЙ! 9Нл"Нл" Не"©яНN"К‚! еН]‚Б+НN"Н2"К-‚! еНЃБЙ! 9Не"& }жoН2"КK‚! еНЃБГN‚!  Й         !Y‚еНБ‚Б! 9Нл")O‚Нл"е:Z‚Нж"Н("Н2"КЉ‚! ГЌ‚!  "[‚! 9Нл"+++|µВ©‚*[‚}оo"[‚*[‚Й                   ЙНіѓ! }2­‚! "°‚! 9Нл""ґ‚НФѓЙ    Ніѓ! }2­‚:®‚Нж""Я‚! 9е! 9Не"еНР#БС}ѕяНN"Кѓ!  Г4ѓ! 9Не"єяНN"К1ѓ! Г4ѓ! }2®‚! 9Нл""°‚  Нv"КQѓ!я ГTѓ!  }2Ї‚НФѓ"б‚& }жoе! 9Нл"е!  Нр"НX"КЁѓ! 9Нл"е*»‚еН®„БНр":ё‚Нж"& }ж@oН2"КЁѓ*б‚}ц@o"б‚*Я‚}2®‚*б‚Й!Ї‚е!Ї‚е!­‚НУ" ХНУ"е!  еН.БББЙ!­‚T]###F#Np+qbkН0„НJ„Н‚„Ыеж(bk 	~#foЫеж Н‰„Н„bkН^„8ТИеН0„!§„НJ„Н‚„bk	 	Н‰„bkН^„бЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙН‚„ЫежАЫежИ~/Уж#мН‚„Ыж/х>= эН‚„Ыж/ 	wс& oж(7Й}§ЙЫеж ъЙН‚„ЫежИЫж/w#сН‚„ЫежИ~/Уж#с   
 ЙБбеЕLeiЙ        @   @  D D            H  Ђ@’@    @ @     @Ђ     A @ђ   Ђ$	   @  Ѓ @ Ѓ$   Ђ Ѓ"DD   H  !I „     Ђ        е*»‚еН®„БНр":ё‚Нж"& }ж@oН2"КЁѓ*б‚}ц@o"б‚*Я‚}2®‚*б‚Й!Ї‚е!Ї‚е!­‚НУ" ХНУ"е!  еН.БББЙ!­‚T]###F#Np+qbkН0„НJ„Н‚„Ыеж(bk 	~#foЫеж Н‰„Н„bkН^„8ТИеН0„!§„НJ„Н‚„bk	 	Н‰„bkН^„бЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙН‚„ЫежАЫежИ~/Уж#мН‚„Ыж/х>= эН‚„Ыж/ 	wс& oж(7Й}§ЙЫеж ъЙН‚„ЫежИЫж/w#сН‚„ЫежИ~/Уж#с   
 ЙБбеЕLeiЙ        @   @  D D            H  Ђ@’@    @ @     @Ђ   ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее u                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ                    ! 9Нл"v Нл"е! 9Нл"е!Є„еН+БББ"Ђ#Н2"КqЂ! 9Нл" е! 9Нл" е*Ђ)СНл"Не"еНР#БС}ГЊЂ! 9Нл"+НN"КЊЂ! 9Нл" 6F! 9Нл" Не"єяН2"К№Ђ! 9Нл" Не"ЄяН2"Н2"К1Ѓ!  е! е! е! е!  е! 9Нл"еНЅ„л! 9щл! 9Нл" еН±(еНР#БС}еяНN"К
Ѓ!яяЙ! 9Нл" Не"уя|µВ.Ѓ! 9Нл" 6FГЊЂ!  "Ђ! 9Нл"v Нл"е! 9Нл"е!­„еН+БББ"Ђ#Н2"К‚! 9Нл" е*Ђ)СНл"Не"Н2"К‚! 9Нл" е! 9Нл" е*Ђ)СНл"еНХ…БНр"! 9Нл" Нл"яїТЖЃ!	 еНЕ†Б! 9Нл" Нл"фяЪгЃ! еНЕ†Б! 9Нл" Нл" Нљ"К‚! 9Нл" Нл" @Н™"Н2"К‚! "ЂГA‚! 9Нл"+НN"КA‚! 9Нл" 6P#6 ! "Ђ*ЂНN"К~ѓ! @еН“†Б"Ђ! 9Нл" Не"єя|µВ•‚!  е! е! е! е*Ђе! 9Нл"еНЅ„л! 9щлГ»‚!  е! е! е! е*Ђе! 9Нл"еНЅ„л! 9щл!	Ђе*Ђ#"ЂеН«…ББ|µКХ‚!яяЙ:	ЂНж"|µВу‚! 9Нл" 6P#6 Г
ѓ! 9Нл" е!	ЂеНХ…БНр"! 9Нл" Нл"яїТ'ѓ!	 еНЕ†Б! 9Нл" Нл"фяЪDѓ! еНЕ†Б! 9Нл" Нл" Нљ"Кoѓ! 9Нл" Нл" @Н™"Н2"К{ѓ! "ЂГA‚! 9Нл" Не"єя|µВ¦„! 9Нл" 6я#6я! 9Нл"v Нл"е! 9Нл"е!°„еН+БББ"Ђ#Н2"Кгѓ! 9Нл" 6#6 Г„! 9Нл"+НN"К„! 9Нл" 6 #6 ! 9Нл" Нл"#|µВ¦„! 9Не"©я|µВN„!  е! е! е! е!  е! 9Нл"еНЅ„л! 9щлГt„!  е! е! е! е!  е! 9Нл"еНЅ„л! 9щлН±("ЂеяНN"К€„!яяЙ! 9Нл" е*ЂеНР#Б§яНN"Нр"!  ЙBT BS SH           !  "і„)µ„е! 9Нл"4 е! 9Нл")СНл"Нр"!
 9Нл"|µК…*і„#"і„)µ„е! 9Нл"4 е! 9Нл")СНл"Нр"! 9Нл"|µКO…*і„#"і„)µ„е! 9Нл"4 е! 9Нл")СНл"Нр"! 9Нл"|µК„…*і„#"і„)µ„е! 9Нл"4 е!
 9Нл")СНл"Нр"!  е!  е*і„#"і„е!µ„е! 9Нл"еНWБББББЙ  Н(! 9Нл"е! 9Нл"еНд†ББ"©…Н&(*©…Й        !  "С…! 9Нл""П…"Н…*П…е*П…Не"еНР#БС}Н2"К$†*П…Не"µя|µВ†! "С…*П…6 *П…#"П…Ги…*Н…Не"Н2"КN†*Н…Не"0 Нv"ВK†*Н…Не"9 Нw"Н2"Н2"К^†*Н…#"Н…Г$†*Н…еНа‡Б"У…*С…+НN"КЌ†*У…АяТЃ†!яяЙ*У… Н#"У…*У…Й  ! "‘†! 9еНл"л!
 Н.#Нр"Н2"КБ†Гѕ†*‘†#"‘†Г™†Гґ†*‘†Й!Ъ†еН|Б! 9Нл"еНpБЙUHT       ! 9еНл"+Нр"! 9Нл""в†!  "Ю†*в†еНо("а†С}*а†  Нv"В"‡*а† Нg"Н2"К¬‡*а†Гђ‡*Ю†+"Ю†#|µВ>‡Гр†*в†+"в†!Ш‡еН„'БГ©‡! 9Нл"6 *Ю†+"Ю†#|µКq‡!Ш‡еН„'БГY‡*а†ея|µВЃ‡! ЙГр†*в†6 !  ЙГ©‡Нш".‡ .‡ P‡ Y‡ „‡   ГФ‡! 9Нл"л*Ю†Нv"КФ‡*в†#"в†+Не"еН)Б*Ю†#"Ю†Г ‡Й      ! "Ю‡!  "Ь‡! 9Нл"Не"Г€!яя"Ю‡! 9еНл"#Нр"Г€Нш"щ‡- я‡+   ! 9Нл"Не"0 Нg"К>€! 9Нл"Не"9 Нf"Н2"Кj€*Ь‡
 Н#е! 9еНл"#Нр"+Не"СРя"Ь‡Г€*Ю‡л*Ь‡Н#Й      Ђ @    Ђ                Ђ ‚   Ђ @ Ђ         @  @  H    ђ@€       D@Ѓ    D          $       Ѓ    Ђ           @      "     ‘    €Ђ    $D    "     „  	"  	’ @ $€ђ$	 Ђ  ’$‘      A A ђ$€$‰ Ђђ€€	  ‚ "       HЂ 9еНл"#Нр"Г€Нш"щ‡- я‡+   ! 9Нл"Не"0 Нg"К>€! 9Нл"Не"9 Нf"Н2"Кj€*Ь‡
 Н#е! 9еНл"#Нр"+Не"СРя"Ь‡Г€*Ю‡л*Ь‡Н#Й      Ђ @    Ђ                Ђ ‚   Ђ @ Ђ         @  @  H    ђ@€       D@Ѓ    D          $       Ѓ    Ђ        ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее B	                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ! 9Нл" е!
 9Нл"е! 9Нл"е! 9Нл"е!К„е! е! еН%‚л! 9щлНр"е!яяН:"КNЂ!яяЙ! 9Нл" е!
 9Нл"е! 9Нл"е! 9Нл"е!Н„е! е!	 еН%‚л! 9щлНр"е!яяН:"К™Ђ!яяЙ! 9Нл" Нл"е!
 9Нл" Нл"Се!
 9Нл" Нл"СН™"КюЂ! еН‡Б! 9Нл"е! 9Не"е! 9Нл"е! 9Нл"еНЂББББЙ! 9Нл" Нл"  Н¬"В)Ѓ! 9Нл" Нл"  Н¬"Н2"К=Ѓ! 9Не"©яНN"Н2"К€Ѓ! 9Нл" е!
 9Нл"е! 9Нл"е! 9Нл"е!Р„е!
 еНЌѓБББББС}е!яяН:"К€Ѓ!яяЙ! 9Не"©яНN"К®Ѓ! 9Нл" Не"єяНN"Н2"КЖЃ! 9Нл" Нл"+НN"Н2"К‚! 9Нл" е!
 9Нл"е! 9Нл"е! 9Нл"е!У„е! еНЌѓБББББС}е!яяН:"К‚!яяЙ!  Й                !  "‚! 9Нл"v Нл"е!
 9Нл"е!
 9Нл"еН+БББ"#‚#Н2"КЕ‚! 9Нл" е*#‚)СНл"Не"Н2"КВ‚! 9Нл" е*#‚)СНл"еНK†Б"!‚! 9Нл" Нл"л*!‚Н«"К¶‚! "‚ГВ‚! 9Нл"еН‡БГЯ‚!
 9Нл"+НN"КЯ‚!  "!‚! "‚*‚НN"Кzѓ!  е! 9Нл"е! е! е! еееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее! 9Нл"еНа„л! 9щл!‚е! еНО…ББ|µК(ѓ!яяЙ:‚Нж"|µВ<ѓ!  "!‚ГGѓ!‚еНK†Б"!‚! "‚! 9Нл" Нл"л*!‚Нљ"Кwѓ! 9Нл"еН‡Б!  "‚ГЯ‚*!‚Й               !  "~ѓ! 9Нл"v Нл"е! 9Нл"е! 9Нл"еН+БББ"‹ѓ#Н2"К„! 9Нл" е*‹ѓ)СНл"Не"Н2"К„! 9Нл" е*‹ѓ)СНл"е!ЂѓеНр…ББ#НN"К„! еН‡БГ„! "~ѓГ5„! 9Нл"+НN"К5„!  }2Ђѓ! "~ѓ*~ѓНN"КБ„!  е! 9Нл"е! е! е! е! 9Нл"еНа„л! 9щл!Ѓѓе! еНО…ББ|µК~„!яяЙ:ЃѓНж"|µВ™„!  }2Ђѓ! "~ѓГѕ„!Ѓѓе!ЂѓеНр…ББ#НN"Кё„! еН‡БГѕ„! "~ѓГ5„:ЂѓНж"& ЙPR PO PC PB           !  "Ц„)Ш„е! 9Нл"4 е! 9Нл")СНл"Нр"!
 9Нл"|µК=…*Ц„#"Ц„)Ш„е! 9Нл"4 е! 9Нл")СНл"Нр"! 9Нл"|µКr…*Ц„#"Ц„)Ш„е! 9Нл"4 е! 9Нл")СНл"Нр"! 9Нл"|µК§…*Ц„#"Ц„)Ш„е! 9Нл"4 е!
 9Нл")СНл"Нр"!  е!  е*Ц„#"Ц„е!Ш„е! 9Нл"еНWБББББЙ  Н(! 9Нл"е! 9Нл"еН&‡ББ"М…Н&(*М…Й! 9Нл"еНw.БюН“"Т*†! 9Нл"##6 ! 9Нл"е! 9Нл"еН!€БС}Г?†! 9Нл"е! 9Нл"Не"С}!  Й        !  "G†! 9Нл""E†"C†*E†е*E†Не"еНР#БС}Н2"Кљ†*E†Не"µя|µВђ†! "G†*E†6 *E†#"E†Г^†*C†Не"Н2"КД†*C†Не"0 Нv"ВБ†*C†Не"9 Нw"Н2"Н2"КФ†*C†#"C†Гљ†*C†еН­€Б"I†*G†+НN"К‡*I†АяТч†!яяЙ*I† Н#"I†*I†Й!‡еН|Б! 9Нл"еНpБЙUHT       ! 9еНл"+Нр"! 9Нл""$‡!  " ‡*$‡еНо(""‡С}*"‡  Нv"Вd‡*"‡ Нg"Н2"Ко‡*"‡ГТ‡* ‡+" ‡#|µВЂ‡Г2‡*$‡+"$‡!€еН„'БГл‡! 9Нл"6 * ‡+" ‡#|µКі‡!€еН„'БГ›‡*"‡ея|µВГ‡! ЙГ2‡*$‡6 !  ЙГл‡Нш"p‡ p‡ ’‡ ›‡ Ж‡   Г€! 9Нл"л* ‡Нv"К€*$‡#"$‡+Не"еН)Б* ‡#" ‡ГB‡Й     !  }2€! |µКў€! 9еНл"#Нр"+Не"еНР#Б"€A Нg"КZ€*€F Нf"Н2"Кj€*€щя"€*€0 Нv"В€*€? Нw"Н2"К€€Гў€:€Нж"))))л*€Ря}2€Г(€:€Нж"Й    ! "«€!  "©€! 9Нл"Не"ГЫ€!яя"«€! 9еНл"#Нр"Ги€Нш"Ж€- М€+   ! 9Нл"Не"0 Нg"К‰! 9Нл"Не"9 Нf"Н2"К7‰*©€
 Н#е! 9еНл"#Нр"+Не"СРя"©€Ги€*«€л*©€Н#Й     @  @     Ђ           Ђ           @@   Ђ                    @ Ђ  € $ €  ‚A       ’" H        @ Ђ  €‚@	    Ђ  @ЂЃ‘ђ   @    "     ‘    €Ђ    D@    ‚      @    Ђ$€ Ђ$"HЂ	  H’"@ђ @$@     H@$ I"	"@@A $ЂB"" ‚D DЂ   ђ HЂ	 H  Ђ !     ђ   D ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее t                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ                  !  "Ђ! 9Нл"v Нл"е! 9Нл"е!gЉеН+БББ"Ђ#Н2"КхЂ! 9Нл" е*Ђ)СНл"Не"еНР#Б»яНN"К{Ђ! 9Не"©яНN"Н2"КЂ! 9Нл"##6 #6 ! "ЂГтЂ! 9Нл"##е! 9Нл" е*Ђ)СНл"еНЯЊБНр"! 9Нл"##Нл"  Н¬"КжЂ! 9Нл"##Нл" Н™"Н2"КтЂ! "ЂГЃ! 9Нл"+НN"КЃ! 9Нл"##6#6 ! "Ђ*ЂНN"К=‚! 9Не"©яНN"К7Ѓ! Г:Ѓ!  "Ђ!  е! е! е*Ђе! еН’‹Б"Ђе! 9Нл"еНЂЉл! 9щл!	Ђе*Ђ#"ЂеНn‹ББ|µК…Ѓ!яяЙ:	ЂНж"еНР#Б»яНN"КЁЃ! 9Не"©яНN"Н2"КЕЃ! 9Нл"##6 #6 ! "ЂГ)‚:	ЂНж"|µВбЃ! 9Нл"##6#6 ГцЃ! 9Нл"##е!	ЂеНЯЊБНр"! 9Нл"##Нл" Нљ"К‚! 9Нл"##Нл" Н™"Н2"К)‚! "Ђ*ЂНN"К:‚! еНД‹БГЃ! 9Нл" 6 #6 ! 9Не"®я|µВЦ„!  "Ђ! 9Нл"v Нл"е! 9Нл"е!jЉеН+БББ"Ђ#Н2"К1ѓ! 9Нл" е*Ђ)СНл"Не"еНР#Б»яНN"КО‚! 9Нл" 6 #6 ! "ЂГ.ѓ! 9Нл" е! 9Нл" е*Ђ)СНл"еНЯЊБНр"! 9Нл" Нл"  Н¬"К"ѓ! 9Нл" Нл" Н™"Н2"К.ѓ! "ЂГUѓ! 9Нл"+НN"КUѓ! 9Нл" 6 #6 ! "Ђ*Ђ+НN"Кsѓ! 9Нл" Нл"  Н¬"Н2"Кѓ! 9Нл" Нл"е!
 9Нл"##Нл"СН¬"Н2"К¬ѓ! еНД‹Б!  "Ђ*ЂНN"КУ„!  е! е! е! е! еН’‹Б"Ђе! 9Нл"еНЂЉл! 9щл!	Ђе*Ђ#"ЂеНn‹ББ|µКэѓ!яяЙ:	ЂНж"еНР#Б»яНN"В„:	ЂНж"НN"Н2"К:„! 9Нл" 6 #6 ! "ЂГР„! 9Нл" е!	ЂеНЯЊБНр"! 9Нл" Нл" Н™"К|„! 9Нл" Нл"  Н¬"Н2"К‹„! "ЂГ“„! еНД‹Б*Ђ+НN"Кј„! 9Нл" Нл"е!
 9Нл"##Нл"СН¬"Н2"КР„! еНД‹Б!  "ЂГ¬ѓГ©…! 9Нл" 6я#6я! 9Нл"v Нл"е! 9Нл"е!mЉеН+БББ"Ђ#Н2"К$…! 9Нл" 6 #6 Г©…! 9Нл"+НN"КE…! 9Нл" 6#6 Г©…!  е! е! е! е!  е! 9Нл"еНЂЉл! 9щлН±(еНР#Б"ЂеяНN"К„…!яяЙ! 9Нл" е*Ђ§яНN"КЈ…!  Г¦…! Нр"! 9Нл" 6#6 ! 9Нл"##Нл"яяТO‡!  "Ђ! 9Нл"v Нл"е! 9Нл"е!pЉеН+БББ"Ђ#Н2"К`†! 9Нл" е! 9Нл" е*Ђ)СНл"еНЯЊБНр"! 9Нл" Нл"  Н¬"КQ†! 9Нл" Нл" ЂН™"Н2"К]†! "ЂГ„†! 9Нл"+НN"К„†! 9Нл" 6#6 ! "Ђ*ЂНN"КO‡!  е! е! е!  е! ЂеН’‹Б"Ђе! 9Нл"еНЂЉл! 9щл!	Ђе*Ђ#"ЂеНn‹ББ|µКХ†!яяЙ:	ЂНж"|µВу†! 9Нл" 6#6 Г
‡! 9Нл" е!ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее	ЂеНЯЊБНр"! 9Нл" Нл" ЂН™"К5‡! 9Нл" Нл"  Н¬"Н2"КD‡! "ЂГL‡! еНД‹БГ„†! 9Нл"
 6 #6 ! 9Не"®яНN"КЃ‡! 9Нл" Нл"Н2"Н2"КcЉ!  "Ђ! 9Нл"v Нл"е! 9Нл"е!sЉеН+БББ"Ђ#Н2"К[€! 9Нл" е*Ђ)СНл"Не"еНР#Б»яНN"Кш‡! 9Нл"
 6 #6 ! "ЂГX€! 9Нл"
 е! 9Нл" е*Ђ)СНл"еНЯЊБНр"! 9Нл"
 Нл"  Н¬"КL€! 9Нл"
 Нл" ЂН™"Н2"КX€! "ЂГ€! 9Нл"+НN"К€! 9Нл"
 6 #6 ! "Ђ*Ђ+НN"Кќ€! 9Нл"
 Нл"  Н¬"Н2"КБ€! 9Нл"##Нл"е!
 9Нл" Нл"Н:"Н2"Ки€! 9Нл"
 Нл"е!
 9Нл" Нл"СН¬"Н2"Кь€! еНД‹Б!  "Ђ*ЂНN"КcЉ!  е! е! е! е! ЂеН’‹Б"Ђе! 9Нл"еНЂЉл! 9щл!	Ђе*Ђ#"ЂеНn‹ББ|µКM‰!яяЙ:	ЂНж"еНР#Б»яНN"Вk‰:	ЂНж"НN"Н2"КЉ‰! 9Нл"
 6 #6 ! "ЂГг‰! 9Нл"
 е!	ЂеНЯЊБНр"! 9Нл"
 Нл" ЂН™"КМ‰! 9Нл"
 Нл"  Н¬"Н2"КЫ‰! "ЂГг‰! еНД‹Б*Ђ+НN"КЉ! 9Нл"
 Нл"  Н¬"Н2"К%Љ! 9Нл"##Нл"е!
 9Нл" Нл"Н:"Н2"КLЉ! 9Нл"
 Нл"е!
 9Нл" Нл"СН¬"Н2"К`Љ! еНД‹Б!  "ЂГь€!  ЙSF EF CF SB EB           !  "vЉ)xЉе! 9Нл"4 е! 9Нл")СНл"Нр"!
 9Нл"|µКЭЉ*vЉ#"vЉ)xЉе! 9Нл"4 е! 9Нл")СНл"Нр"! 9Нл"|µК‹*vЉ#"vЉ)xЉе! 9Нл"4 е! 9Нл")СНл"Нр"! 9Нл"|µКG‹*vЉ#"vЉ)xЉе! 9Нл"4 е!
 9Нл")СНл"Нр"!  е!  е*vЉ#"vЉе!xЉе! 9Нл"еНWБББББЙ  Н(! 9Нл"е! 9Нл"еНг‹ББ"l‹Н&(*l‹Й  ! "ђ‹! 9еНл"л!
 Н.#Нр"Н2"КА‹ГЅ‹*ђ‹#"ђ‹Г‹Гі‹*ђ‹Й!Щ‹еН|Б! 9Нл"еНpБЙUHT       ! 9еНл"+Нр"! 9Нл""б‹!  "Э‹*б‹еНо("Я‹С}*Я‹  Нv"В!Њ*Я‹ Нg"Н2"К«Њ*Я‹ГЏЊ*Э‹+"Э‹#|µВ=ЊГп‹*б‹+"б‹!ЧЊеН„'БГЁЊ! 9Нл"6 *Э‹+"Э‹#|µКpЊ!ЧЊеН„'БГXЊ*Я‹ея|µВЂЊ! ЙГп‹*б‹6 !  ЙГЁЊНш"-Њ -Њ OЊ XЊ ѓЊ   ГУЊ! 9Нл"л*Э‹Нv"КУЊ*б‹#"б‹+Не"еН)Б*Э‹#"Э‹Гя‹Й      ! "ЭЊ!  "ЫЊ! 9Нл"Не"ГЌ!яя"ЭЊ! 9еНл"#Нр"ГЌНш"шЊ- юЊ+   ! 9Нл"Не"0 Нg"К=Ќ! 9Нл"Не"9 Нf"Н2"КiЌ*ЫЊ
 Н#е! 9еНл"#Нр"+Не"СРя"ЫЊГЌ*ЭЊл*ЫЊН#Й           Ђ 	   Ђ     H   A  ‚  D@Ѓ  @   I  Ђ@      ђ@€           $   Ђ     Ђ  	   Ђ      D@Ѓ  H Ђ @ €     A D    @Ѓ$     @Ђ  @             @     @    	      D@Ѓ    D   Ђ   ђ"        Ѓ     	         A  Ђ @Ђ             D@Ѓ  H Ђ @ €     A D           @Ѓ    @    "     ‘    €Ђ    D@    ‚  $I"      ‚@‚ II "	 $  $   D    $   ‘    Ђ 	   Ђ     H   A  ‚  D@Ѓ  @   I  Ђ@      ђ@€           $   Ђ     Ђ  	   Ђ      D@Ѓ  H Ђ @ €     A D    @Ѓ$     @Ђ  @             @     @    	      D@Ѓ    D   Ђ   ђ"        Ѓ     	         A  Ђ @Ђ             D@Ѓ  H Ђ @ €     A D           @Ѓ    @    "     ‘    €Ђ    D@    ‚  $I"      ‚@‚ II "ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее З                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ                    !  "Ђ! 9Нл"v Нл"е! 9Нл"е!А„еН+БББ"Ђ#Н2"КkЂ! 9Нл" е*Ђ)СНл"Не"еНР#Б"ЂГЂ! 9Нл"+НN"КЂ!C "Ђ! 9Не"©яНN"КљЂ*Ђ®яНN"Н2"К©Ђ! "ЂГМЂ*ЂїяНN"ВАЂ*ЂЅяНN"Н2"КМЂ! "Ђ*ЂНN"КюЃ! 9Не"©яНN"КмЂ*ЂНN"Н2"КVЃ! 9Нл"4 4 Нл""1! 9Нл"4 * Нл""3! 9Нл"4 & Нл""5! 9Нл"4 ( Нл""7! е!  еН»!ББ"Ђ! 9Не"®яНN"КmЃ*ЂНN"Н2"КВЃ! 9Нл"4 4 Нл""1! 9Нл"4 2 Нл""3! 9Нл"4 0 Нл""5! е!  еН»!ББ"Ђ*ЂГкЃ!A "ЂГюЃ!C "ЂГюЃ!R "ЂГюЃ!яяЙГюЃНш"ИЃ  СЃ ЪЃ   ГгЃ*ЂГ4‚! 9Нл"6 #6 ГE‚! 9Нл"6#6 ГE‚! 9Нл"6#6 ГE‚ГE‚Нш"‚C ‚R "‚A   ! 9Нл" 6я#6я! 9Нл"v Нл"е! 9Нл"е!Г„еН+БББ"Ђ#Н2"К“‚! 9Нл" 6#6 Г±‚! 9Нл"+НN"К±‚! 9Нл" 6 #6 ! 9Нл" Нл"#|µВѓ!  е! е! е!  е!  е! 9Нл"еНУ„л! 9щлН±("ЂеяНN"Кя‚!яяЙ! 9Нл" е*ЂеНР#БІяНN"Нр"! 9Нл" Нл"НN"В?ѓ! 9Не"®яН2"Н2"КXѓ! 9Нл" 6 #6 Гј„!  "Ђ! 9Нл"v Нл"е! 9Нл"е!Ж„еН+БББ"Ђ#Н2"Ксѓ! 9Нл" е*Ђ)СНл"еНw.Б|µКоѓ! 9Нл" е! 9Нл" е*Ђ)СНл"еН2‡БНр"! 9Нл" Нл" ЂН“"Тоѓ! "ЂГ„! 9Нл"+НN"К„! 9Нл" 6 #6 ! "Ђ*ЂНN"Кј„! |µКј„!  е!  е! е!  е! еНе…Б"	Ђе! 9Нл"еНУ„л! 9щл!Ђе*	Ђ#"	ЂеНБ…ББ|µКn„!яяЙ! 9Нл" е:ЂНж"НN"КЊ„!  Г”„!ЂеН2‡БНр"! 9Нл" Нл" ЂН“"Т±„Гј„! еН†БГ„!  ЙEH NR SK           !  "Й„)Л„е! 9Нл"4 е! 9Нл")СНл"Нр"!
 9Нл"|µК0…*Й„#"Й„)Л„е! 9Нл"4 е! 9Нл")СНл"Нр"! 9Нл"|µКe…*Й„#"Й„)Л„е! 9Нл"4 е! 9Нл")СНл"Нр"! 9Нл"|µКљ…*Й„#"Й„)Л„е! 9Нл"4 е!
 9Нл")СНл"Нр"!  е!  е*Й„#"Й„е!Л„е! 9Нл"еНWБББББЙ  Н(! 9Нл"е! 9Нл"еН6†ББ"ї…Н&(*ї…Й  ! "г…! 9еНл"л!
 Н.#Нр"Н2"К†Г†*г…#"г…Гл…Г†*г…Й!,†еН|Б! 9Нл"еНpБЙUHT       ! 9еНл"+Нр"! 9Нл""4†!  "0†*4†еНо("2†С}*2†  Нv"Вt†*2† Нg"Н2"Кю†*2†Гв†*0†+"0†#|µВђ†ГB†*4†+"4†!*‡еН„'БГы†! 9Нл"6 *0†+"0†#|µКГ†!*‡еН„'БГ«†*2†ея|µВУ†! ЙГB†*4†6 !  ЙГы†Нш"Ђ† Ђ† ў† «† Ц†   Г&‡! 9Нл"л*0†Нv"К&‡*4†#"4†+Не"еН)Б*0†#"0†ГR†Й      ! "0‡!  ".‡! 9Нл"Не"Г`‡!яя"0‡! 9еНл"#Нр"Гm‡Нш"K‡- Q‡+   ! 9Нл"Не"0 Нg"Кђ‡! 9Нл"Не"9 Нf"Н2"Кј‡*.‡
 Н#е! 9еНл"#Нр"+Не"СРя".‡Гm‡*0‡л*.‡Н#Й      Ѓ    ‚  ђЂ Ђ@            @          I‚A B"ђ   @ ђ€Ђ     Ѓ    Ђ       Ђ      Ђ     @Ђ       Ђ  	  Ђ" @    Ѓ   €    D@    "     ‘    €    @   $‰$@     H@$ I"	"@@A $ЂB"" ‚D DЂ  ЂЂ   Ђ   ’ ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее V                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГЂ! 9Нл"еНЂБЙ  !  "Ђ! еН‚Б+НN"К"Ѓ! 9Нл"Нл" Не"©я|µВжЂ! еН‚Б+НN"КcЂ! 9Нл"##Нл"Нл"+НN"Н2"КжЂ! 9Нл" Нл"е!  ге! ге! ге! ге!  ге!–ЂгйБББББНРН±(еНР#БІяНN"КАЂ! 9Нл"еНщ‚Б#НN"Н2"ККЂ!яяЙ! еНh‚Б"Ђ! 9Нл"##Нл"6 #6 ! 9Нл" Нл" Нл"НN"КЃ! 9Нл"е! еНYЃББ#НN"Н2"К"Ѓ!яя"Ђ! 9Нл"Нл"##е! 9Нл"Нл"##Нл"еНу*БНр"! 9Нл"Нл"6 #6 *ЂЙ! еН‚БНN"КєЃ! 9Нл"+НN"КІЃ! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!ўЃгйБББББ!  еНн„БГєЃ! еНн„Б! 9Нл"##Нл"е! 9Нл"##Нл"Нл"Н2"Нр"! 9Нл"##Нл"##6#6 ! 9Нл"Нл" 6#6 !  Й         !‚еНЛ„Б! 9Нл")‚Нл"е:‚Нж"Н("Н2"КA‚! ГD‚!  "‚! 9Нл"+++|µВ`‚*‚}оo"‚*‚Й    *f‚е*d‚е! 9еНл"+Нр"#|µКс‚! е!d‚еН†ББ"f‚ЮяНN"КЁ‚! еН‚Б+НN"Н2"К±‚Г‚‚*f‚ЮяНN"КЙ‚! еН‚БНN"Н2"КЪ‚! еН‚БНN"Н2"Ко‚!яялб"d‚б"f‚лЙГp‚!  Гг‚  ! еН‚БНN"Кѓ!яяе!F е!ч‚еН5…БББ! еН‚БНN"К9ѓ! е!F е!ч‚еН5…БББ! 9Нл"е! 9Нл"Нл" е! 9Нл" Нл" Нл"Нр"+еНuѓББЙ     !  "qѓ! 9Нл"|µКЮѓ! 9Нл"е!B е!sѓеН5…БББ}2pѓ:pѓНж"|µВµѓ! 96 #6 ! 9Нл"е:pѓНж"е!B еНвѓБББ"qѓ#НN"КЫѓГЮѓГ{ѓ*qѓЙ! 9Не"|µВтѓ!  Й! 9Нл"ѕяНN"К„! 9Не"& }жDoНN"Н2"КF„!яяе!B е! 9еН5…БББ! 9Нл"##Нл"6#6 ! еНћ„БЙ! 9Нл"Нл" Не"©яНN"Кm„! еН‚Б+НN"Н2"К|„! еНћ„БЙ! 9Не"& }жoН2"Кљ„! еНћ„БГќ„!  Й!і„еН|Б! 9Нл"еНpБЙUHT                    ЙНS†! }2·„! "є„! 9Нл""ѕ„Нt†Й    *л„е*й„еНS†! }2·„:ё„Нж""л„! 9Нл"Н2"}2ё„Нt†"й„*л„}2ё„*й„лб"й„б"л„лЙ    НS†! }2·„:ё„Нж""1…! 9е! 9Не"еНР#БС}ѕяНN"Кl…!  Г†…! 9Не"єяНN"Кѓ…! Г†…! }2ё„! 9Нл""є„  Нv"КЈ…!я Г¦…!  }2№„Нt†"3…& }жoе! 9Нл"е!  Нр"НX"Къ…! 9Нл"е*Е„еНN‡БНр":В„Нж"& }ж@oН2"Къ…*3…}ц@o"3…*1…}2ё„*3…Й  НS†! }2·„! 9Нл""є„Нt†"†& }жoе! 9Нл"е!  Нр"НX"КO†! 9Нл"е*Е„еНN‡БНр"*†Й!№„е!№„е!·„НУ" ХНУ"е!  еН.БББЙ!·„T]###F#Np+qbkНР†Нк†Н"‡Ыеж(bk 	~#foЫеж Н)‡Н8‡bkНю†8ТИеНР†!G‡Нк†Н"‡bk	 	Н)‡bkНю†бЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙН"‡ЫежАЫежИ~/Уж#мН"‡Ыж/х>= эН"‡Ыж/ 	wс& oж(7Й}§ЙЫеж ъЙН"‡ЫежИЫж/w#сН"‡ЫежИ~/Уж#с   
 ЙБбеЕLeiЙ    Ѓ   Ђ         €     Ђ @           @Ђ             ‚ Ѓ "  @€@ ђ‚ D D         @ђ   Ѓ$Ђ     Ђ Ђ     Ѓ  @ @Ђ     	A ’$"A     @ I    @Ђ Hђ@Ђ$Ђ   DD   H  !I „     Ђ        +qbkНР†Нк†Н"‡Ыеж(bk 	~#foЫеж Н)‡Н8‡bkНю†8ТИеНР†!G‡Нк†Н"‡bk	 	Н)‡bkНю†бЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙН"‡ЫежАЫежИ~/Уж#мН"ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(UHTOV6)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                         /*			*/
uhtov6(td,mode,deflt,swtch)                    /* Display file settings */
struct	_tpdesc	*td;		/* Target tape descriptor		*/
BYTE	mode;			/* Open mode of tape			*/
BOOLEAN	deflt;			/* Take default if none specified Y/N	*/
struct	_sw	*swtch;		/* Switch names and values		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	TDES tape descriptor init
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
         Message for number of files to skip if not at BOT added - ICFO
14/09/89 V04.01 isееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееsued - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13/02/89 Mesages moved from UHT.MS2 to UHT.MS4 as they are required
         only in this overlay - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
10/06/88 BR455 'Start Block' is also output for OUTPUT - ICFO
09/06/88 ICFO - Listing brought up to standard
         'kflush' added before 'getkey'
29/10/87 ICFO - Many minor changes concerning messages then whole thing
         made into an overlay
         Used to be called DSPDTS
28/10/87 ICFO - Messages concerning short blocks changed
27/10/87 ICFO - Final message moved to 'lines per page - 1'
14/04/87 DAR - Created
*/

{

LOCAL
WORD	text,		/* Text Descriptor				*/
	c;		/* Used for 'getkey'				*/

LOCAL
BYTE	*messages[28];	/* Messages to be output			*/

VOID	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Do not output summary if the /DF switch is set			*/
if (deflt == TRUE)  return(SUCCESS);

/* Read in messages							*/
if ((text = opn_txt("UHT.MS4",messages,28)) == FAIL)
					      return(flerr("UHT.MS4",46));

clrs();
putstr("\n");						/* Title	*/
putstr(messages[0]);

putstr("\n\n");
putstr(messages[7]);					/* Block type	*/
if (td->bktype == 'F')  putstr(messages[8]);
else			putstr(messages[9]);

putstr("\n");						/* Block size	*/
if (td->bktype == 'F')  putstr(messages[10]);
else			putstr(messages[11]);
putnum(td->bksize);

putstr("\n");
putstr(messages[20]);					/* EOT action	*/
switch (td->eot_action) {

    case 0:
	if (mode == 'R')  putstr(swtch->tapmes[24]);
	else		  putstr(swtch->tapmes[19]);
	break;
    case 1:
	putstr(swtch->tapmes[20]);	/* Can 'restart' only for WRITE	*/
	break;
    case 2:
	if (mode == 'R')  putstr(swtch->tapmes[25]);
	else		  putstr(swtch->tapmes[21]);
}

putstr("\n");
putstr(messages[1]);					/* Start file	*/
if (td->st_file == 0)  putstr(messages[3]);
else		       putnum(td->st_file);

putstr("\n");
if (mode == 'R') {
    putstr(messages[2]);				/* End file	*/
    if (td->end_file == 0)  putstr(messages[3]);
    else		    putnum(td->end_file);
}
else {
    putstr(messages[24]);			/* Concatenate Files?	*/
    putvid(' ');
    putstr(genmes[24 + td->end_file]);
}

putstr("\n");
if (mode == 'R') {
    putstr(messages[27]);			/* # files to skip	*/
    putnum(td->sk_file);
    putstr("\n");
}

putstr(messages[4]);					/* Start block	*/
putnum(td->st_block);

if (mode == 'R') {
    putstr("\n");
    putstr(messages[5]);
    if (td->end_block == 0)  putstr(messages[6]);
    else		     putnum(td->end_block);
}

putstr("\n");				/* Number of header bytes	*/
putstr(messages[14]);
putnum(td->pre_pad);

putstr("\n");				/* Number of trailer bytes	*/
putstr(messages[15]);
putnum(td->post_pad);

if (mode == 'W' && td->pre_pad + td->post_pad != 0) {
    putstr("\n");
    putstr(messages[16]);
    puthex(td->dpad_chr);
    putstr(" HEX");
    if (td->dpad_chr > ' ' && td->dpad_chr < 0x7f) {
	putstr(" = <");
	putvid(td->dpad_chr);
	putvid('>');
    }
}

if (td->bktype == 'F') {
    putstr("\n");
    putstr(messages[19]);				/* Short block	*/
    if (mode == 'R') {
	if (td->short_block == TRUE)  putstr(messages[12]);
	else			      putstr(messages[13]);
    }
    else {
	if (td->short_block == TRUE)  putstr(messages[21]);
	else			      putstr(messages[22]);
    }
}

/* Short block padding							*/
if (td->bktype == 'F' && td->short_block == TRUE && mode == 'W') {
    putstr("\n");
    putstr(messages[17]);
    puthex(td->bpad_chr);
    putstr(" HEX");
    if (td->bpad_chr > ' ' && td->bpad_chr < 0x7f) {
	putstr(" = <");
	putvid(td->bpad_chr);
	putvid('>');
    }
}

/* Rewind after each run						*/
putstr("\n");
putstr(messages[23]);
putvid(' ');
if (td->no_rewind == TRUE)  putstr(genmes[25]);			/* No	*/
else                        putstr(genmes[24]);			/* Yes	*/

move(lppage() - 1,0);
putstr(messages[18]);

cls_txt(text);

kflush();
c = getkey();
clrs();

return((c == ESC) ? FAIL : SUCCESS);

}

/*======================================================================*/

	putvid('>');
    }
}

/* Rewind after each run						*/
putstr("\n");
putstr(messages[23]);
putvid(' ');
if (td->no_rewind == TRUE)  putstr(genmes[25]);			/* No	*/
else                        putstr(genmes[24]);			/* Yes	*/

move(lppage() - 1,0ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее T                                                                                                                             Copyright Timeclaim Ltd 1989 05.2005.03@ DEVELOP И:                                                                            ГiЂ                                                                                                      ! 9Нл"уя|µВ‹Ђ!YЂе! 9Нл"еН~‚ББЙ! 9Нл" 6#6 ! 9Нл"ГПЃ!Ђ"YЂ!Ђ"[Ђ!Ђ"]Ђ!Ј„"eЂ!ч„"cЂ!€‰"gЂ! "aЂ!‚е!1Ђе! еН*БББ"UЂ#НN"КщЂ!‚е!. еН‡ББЙ!YЂе! 9Нл"е!W е!1ЂеН0ѓББББ#НN"КЃ!яяЙГ‚!B е!YЂе! 9Нл"еН#‚БББ*UЂеН~БГ‚Г‚!C е!YЂе! 9Нл"еН#‚БББЙ! 9Нл" Нл"е! 9Нл"
 Нл"еН“БеНББЙ!9 е!YЂе! 9Нл"еН#‚БББЙ!A е!YЂе! 9Нл"еН#‚БББЙНЈ„Г‚!  е!  е!  еНзБББГ‚Нш"ҐЂ  "Ѓ "Ѓ "Ѓ CЃ FЃ
 ]Ѓ	 †Ѓ †Ѓ ќЃ ґЃ ·Ѓ ·Ѓ   ГєЃ!  ЙUHT.MS1 UHT.OV?     ! 9Не"}2‚!‚еНzБ"‚#НN"КN‚!‚е! еН‡ББЙ*‚е! 9Нл"ге! 9Нл"ге!i‚гйББ"!‚*‚еНу*Б*!‚Й    !  "|‚! 9Нл"
 Нл"еН“Б"z‚Нл"#НN"К§‚Гѓ*z‚ Нл"е*z‚Нл"е*z‚ Нл"НN"ВЩ‚*z‚ Нл"+++НN"Н2"еН„БББ"|‚#НN"Кѓ! еНJ‹Б+НN"Кѓ! 9Нл"е! 9Нл"еНЋ…ББ"|‚! 9Нл" Нл"е*z‚еНББ*|‚Й! 9Нл"е! 9Нл"е! 9Не"е! 9Нл"еН§ѓББББ#НN"Кbѓ!яяЙ! 9Нл"Нл"##е!
 9Нл" Нл" Нл"еНо)БНр"е!яяН:"Кџѓ!	 еН¦ЊБЙ!  Й    !
„еНzБ"Јѓе!яяН:"ККѓ!
„е! еН‡ББЙ*Јѓе!
 9Нл"ге!
 9Нл"ге!
 9Не"ге!
 9Нл"ге!чѓгйББББ"Ґѓ*ЈѓеНу*Б*ҐѓЙUHT.OV1 ! 9Нл"л*ЂН«"К,„!  еН¦ЊБЙ! 9Нл"е*Ђе! 9Нл"еНќ-БББ*Ђл! 9Нл""Ђ*Ђе! 9Нл"НУ""Ђ*Ђл! 9Нл""Ђ! 9Нл"+НN"Кџ„Нч„#НN"К‘„!яяЙНЈ„#НN"Кџ„!яяЙ!  Й*Ђ"Ђ! еНJ‹Б|µКє„!яяЙ*Ђе*)Ђе:-ЂНж"еН.БББ*Ђл*)Ђ"Ђ*)Ђл*+Ђе*	ЂгНУ""Ђ!  "Ђ!  Й*Ђ|µКѓ…:$ЂНж"єяНN"К…*'Ђ+НN"Н2"КB…*Ђе*Ђе:.ЂНж"еН.БББ*Ђл*Ђ"Ђ!  "Ђ*Ђе*+Ђе:-ЂНж"еН.БББ*Ђл*)Ђл*+Ђе*ЂеН†ЋББе!  еНщЉББ#НN"Кѓ…!яяЙ*Ђ#"Ђ!  ЙЕЕ! 9Нл" Нл"Нл"++|µВд…! 9Нл" 6#6 ! 9Нл"Нл" Не"©яНN"КЩ…! ГЬ…! еН¦ЊБББЙ! 9е!
 9Нл"##Нл"##Нл"Нр"!  9е!
 9Нл"Нл" Нл"Нр"! 9Нл"Нл" Не"®я|µВ#‡! 9Нл" Нл"е!  ге! ге! ге! ге!  ге!]†гйБББББ!  еНЭЋБ! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!—†гйБББББНхЏНРН±(ея|µВґ†!яяГб…! 9Нл"еНїЊБ#НN"КН†!яяГб…! 9Нл"е!  еНLЉББ#НN"Кл†!яяГб…Нѕ'! 9Нл" Нл"е!  ге! ге!  ге!  ге!  ге!‡гйБББББГ‰! 9Нл" Нл"е!  ге! ге! ге! ге!  ге!P‡гйБББББ! 9Нл" Нл"Нл"+|µВ…‡! 9Нл"еН/ЊБ#НN"К…‡!яяГб…! еНћ‹Б#НN"Кљ‡!яяГб…!  еНЭЋБ! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!П‡гйБББББНхЏНРН±(ея|µВм‡!яяГб…! 9Нл"еНїЊБ#НN"К€!яяГб…! 9Нл"е!  еНLЉББ#НN"К#€!яяГб…!  еНJ‹Б+НN"Кѕ€! еН¦ЊБ! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!g€гйБББББНхЏНРН±(ея|µВ„€!яяГб…! 9Нл"еНїЊБ#НN"Кќ€!яяГб…! 9Нл"е!  еНLЉББ#НN"К»€!яяГб…Г#€Нѕ'! 9Нл" Нл"е!  ге! ге!  ге!  ге!  ге!о€гйБББББ! 9Нл"##Нл" 6#6 ! 9Нл" Нл"Нл"+|µВ5‰! 9Нл" 6#6 !яяГб…! 9Нл"##Нл"##е! 9Нл"Нр"! 9Нл"Нл" е! 9Нл"Нр"! 9Нл" Нл"е!{‰гйГб…          !  "~‰)Ђ‰е! 9Нл")1ЂНл"Нр"! 9Нл"|µКС‰*~‰#"~‰)Ђ‰е!
 9Нл")1ЂНл"Нр"! 9Нл"|µКь‰*~‰#"~‰)Ђ‰е! 9Нл")1ЂНл"Нр"! 9Нл"|µК'Љ*~‰#"~‰)Ђ‰е! 9Нл")1ЂНл"Нр"!  е!  е*~‰#"~‰е!Ђ‰е!
 9Нл"еНWБББББЙ! еНJ‹БНN"К­Љ! 9Нл"+НN"КҐЉ! 9Нл" Нл"е!  ге! ге! ге!  ге!  ге!•ЉгйБББББ!  еНЭЋБГ­Љ! еНЭЋБ! 9Нл"##Нл"е! 9Нл"##Нл"Нл"Н2"Нр"! 9Нл"##Нл"##6#6 ! 9Нл"Нл" 6#6 !  Й! 9Нл"ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееНN"К‹! 9Нл"НN"Н2"К‹!  Й! 9Нл"& }жoН2"К8‹! еН¦ЊБГ;‹!  Й         !F‹еНfЋБ! 9Нл")<‹Нл"е:G‹Нж"Н("Н2"Кw‹! Гz‹!  "H‹! 9Нл"+++|µВ–‹*H‹}оo"H‹*H‹Й    *њ‹е*љ‹е! 9еНл"+Нр"#|µК'Њ! е!љ‹еНђББ"њ‹ЮяНN"КЮ‹! еНJ‹Б+НN"Н2"Кз‹Гё‹*њ‹ЮяНN"Кя‹! еНJ‹БНN"Н2"КЊ! еНJ‹БНN"Н2"К$Њ!яялб"љ‹б"њ‹лЙГ¦‹!  ГЊ  ! еНJ‹БНN"КOЊ!яяе!F е!-ЊеН%ЏБББ! еНJ‹БНN"КoЊ! е!F е!-ЊеН%ЏБББ! 9Нл"е! 9Нл"Нл" е! 9Нл" Нл" Нл"Нр"+еН)ЌББЙ!»ЊеН|Б! 9Нл"еНpБЙUHT ! еНJ‹БНN"К Ќ! 9Нл" Нл"е!  ге! ге!
 ге!  ге!  ге!ъЊгйБББББ! еНJ‹БНN"К ЌН‘(ея|µВЌ!яяЙГяЊ!  Й     !  "%Ќ! 9Нл"|µК’Ќ! 9Нл"е!B е!'ЌеН%ЏБББ}2$Ќ:$ЌНж"|µВiЌ! 96 #6 ! 9Нл"е:$ЌНж"е!B еН–ЌБББ"%Ќ#НN"КЏЌГ’ЌГ/Ќ*%ЌЙ! 9Не"|µВ¦Ќ!  Й! 9Нл"ѕяНN"КЗЌ! 9Не"& }жDoНN"Н2"КъЌ!яяе!B е! 9еН%ЏБББ! 9Нл"##Нл"6#6 ! еН¦ЊБЙ! 9Нл"Нл" Не"©яНN"К!Ћ! еНJ‹Б+НN"Н2"К0Ћ! еН¦ЊБЙ! 9Не"& }жoН2"КNЋ! еН¦ЊБГQЋ!  Й                   ЙНQђ! }2RЋ! "UЋ! 9Нл""YЋНrђЙ  НQђ!
 }2RЋ! 9Нл""UЋ! 9Нл""YЋНrђ"„Ћ& }жoН2"КЕЋ:]ЋНж"& }ж@oН2"Н2"КХЋ*„Ћ}ц@o"„Ћ*„ЋЙ    *ЫЋе*ЩЋеНQђ! }2RЋ:SЋНж""ЫЋ! 9Нл"Н2"}2SЋНrђ"ЩЋ*ЫЋ}2SЋ*ЩЋлб"ЩЋб"ЫЋлЙ    НQђ! }2RЋ:SЋНж""!Џ! 9е! 9Не"еНР#БС}ѕяНN"К\Џ!  ГvЏ! 9Не"єяНN"КsЏ! ГvЏ! }2SЋ! 9Нл""UЋ  Нv"К“Џ!я Г–Џ!  }2TЋНrђ"#Џ& }жoе! 9Нл"е!  Нр"НX"КкЏ! 9Нл"е*`ЋеНL‘БНр":]ЋНж"& }ж@oН2"КкЏ*#Џ}ц@o"#Џ*!Џ}2SЋ*#ЏЙНQђ! }2RЋНrђЙ  НQђ! }2RЋ! 9Нл""UЋНrђ"ђ& }жoе! 9Нл"е!  Нр"НX"КMђ! 9Нл"е*`ЋеНL‘БНр"*ђЙ!TЋе!TЋе!RЋНУ" ХНУ"е!  еН.БББЙ!RЋT]###F#Np+qbkНОђНиђН ‘Ыеж(bk 	~#foЫеж Н'‘Н6‘bkНьђ8ТИеНОђ!E‘НиђН ‘bk	 	Н'‘bkНьђбЙЫеж(ъ>/Уж>УеЫеж ъ>чУеЙН ‘ЫежАЫежИ~/Уж#мН ‘Ыж/х>= эН ‘Ыж/ 	wс& oж(7Й}§ЙЫеж ъЙН ‘ЫежИЫж/w#сН ‘ЫежИ~/Уж#с   
 ЙБбеЕLeiЙ               ђ   	$’I$‚D $    @Ђ $ Ђ      Ђ@     ЂЃ  Ђ ЂЂ  @@ ђ               @@     ЂЂ  @  Ђ	 Ђ $ Ѓ€ DH„ B@@" H€ D!@        Ѓ                Ђ            Ђ        @Ђ       @@Ђ      $                    „ @  H€ @ 	  "   D@   @       €               Ђ ‚ Ђ€ ! @Ђ@ B       Ђ        Ѓ    D	  H @            D   Ѓ Ѓ @@Ђ $	A ’$"A     @ I    @Ђ H‘A ’   @Ѓ   	   „	$          @ Ђ         Ђ@     ЂЃ  Ђ ЂЂ  @@ ђ               @@     ЂЂ  @  Ђ	 Ђ $ Ѓ€ DH„ B@@" H€ D!@        Ѓ                Ђ            Ђ        @Ђ       @@Ђ      $                    „ @  H€ @ 	  "   D@   @       €               Ђ ‚ Ђ€ ! @Ђ@ B       Ђ        Ѓ    D	ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХЌ eT…Dхci@ Фђ                                                                    @ ељ  
Щ  *§ @ H††ѓ9D4К! ¬Р ‚Б`€Ё  Ќ›Q@Uа CCAњўpКН  ,K4  СPg+4  `ЉЁ •›` ".еfШЂЄ‰ 9Y¶@‚! ,Ъ‚  ,Р  "є†O‹VЅ Q@+6М 0Xw UEЂ¬Ыn БСPg+6б 0D Ђ е›h  А e›iА+§шdшµa^рU rіnP‡}АThКНЅ   9fЭ  €4 fЯА+4  `€hЁ3•›} "ЄX еfРр„ іh6ЏЂ°оH„ іnИ E\яџ¬*ў! ,ЪD !Ђ 2Н§Ђ.Vm`°л@„ іj8Dh „DА Л6« №Yµ,‚Г»@" rН¬ !  2 ,ЪаеfЦPн €@АЛ6– „UПрЙсjВµа" rНЇ`!  2 ,Ы4еfЧрг €@@Л6ТЂ„FЂ ИDT іm •›j@X,;ґН  )8 ZА@ 
   *еfЬ0Єѓ 9Y·|‚! ,Ы~#іox	сjВ АBЄ еfЮp‹ЃA Л6ъ €ДlЪеfРp†Љѓ9Yґ 	‚! ,ЫW?Г'Е«
µЃ
Ё@•›G "@ rНў A  2Н§ЂGЕ«
ЄЃ
ЁP•›M ,:Р! ,Ъ† ,ЪґеfС@&Н
© •›SА" КН  "@ rН¬ A  2Н° AА 2)Ђ –m‡rіkЂCEAњ¬Ы.БЃЂ–m$«џб“вХ…u@…TиКНіаL  9fЩ0 € fЫр'+6ІЃ0D4TКН¶аLU rіnђB Y·" Y·€	КН№@L 9fЪp Љ№ю>-XUCEAњ¬ЫґБPа+6‚Ѓ°D Ђ е›z@‚   e›E@П‹V.Q +6†Ѓ°XuB Yґp"
 YґМКНЅ Lj†Љѓ9Yґ ‚*¤ VmF`€A Л6ќ„B  Л6«№Yґш‚!ў ОVmN`Љ©•›Z@Ш"@ rН« a 2НЇ nVma`€@АЛ6ъЃU/рЛ6ІЂ2­Р„ іl D" іlи”B
 Y¶ђ" Y¶°ўfЂ ЫpК§а‚*еfЧ6Є’ 9Y·‚! ,Ыf
Ђ,ЫеfЂ rіnhB Y·T" Y·p"  3@ U‚ –mр…@–mчџАР ›nАЩTьCGБњ¬ЫРБ‚ –m…@–mrіkАB> 9YґРѓ-?‚ –m)ѓ –m0®џб“вХ…rA4TКН¤ ЊU* rіjШ#B Yµ,"®†O‹VЎ‚ –mDѓА–m{іl*Л
Ёа•›XБ,;<*ЈАVmђ`°оH „ іl D іm0 ­›aЃWUKЂ¬Ы6БaЬђAU0 rіmШ#[’	-Й‚ –m­ѓ –mk®џб–m±e_0A  9fЬа@€< fЮ`A[6о3hё#*ѓ‚€@АЛ6к‚U/рЛ6ш‚3o #*Ж€hЁ3•›qЃ"ЄL еfС V„ іoh D, іoр#•›x Ш"4еfС V„ іi(D, іiH(D@ fЯР6Uc‚ –m=…Ђ–mDџАЪ(НЎ ¬«
!ЈаОVm5`€A Л6Є„BА Л6­‚№Yґр‚! ¬Ы
Б–Ж€hЁ3•›[ЃX"Єd еfЩV„@ rіlH+B YµШ" Y¶¤VН  ¬«€
*’ Xр'+6М‚°Xw0U$0 ·@®Vmѕ`і@ [”B  9Y  ‚*Ґ VmЙ`ЉЁ •љ  0Y  4  P my P  ‹•юfЫ@VU	їЯм:!  %RAP\M)Ќ    ( ҐЂ Ђz  #9@8№M]%Q2ВЛ‘Х#)@±№1R3ьPЛ““Х#>Ђ±1IN3ОђУЧХ#  I52И
СKЊ#.`1IJ2ъ
‘ЛЈ8 №95N0 QСS“QЈ=А№Q-f3`
’Ј=`№-1UM"3љ“QСc:А±5=Y2¶“Ф—Х#% №AUQ!b3”U•Sc;а№AUQMQJ3B”U’Q#  Q1%	Z:x•RХЌ§   ћfЫ@VU	їЯм:!  %RAP\M)Ќ    ( ҐЂ Ђz  #9@8№M]%Q2ВЛ‘Х#)@±№1R3ьPЛ““Х#>Ђ±1IN3ОђУЧХ#  I52И
СKЊ#.`1IJ2€hЁ3•›[ЃX"Єd еfЩV„@ rіlH+B YµШ" Y¶¤VН  ¬«€
*’ Xр'+6М‚°Xw0U$0 ·@®Vmѕ`і@ [”B  9Y  ‚*Ґ VmЙ`ЉЁ •љ  0Y  4  P my P  ‹•юfЫ@VU	їЯм:!  %RAP\M)Ќ    ( ҐЂ Ђz  #9@8№M]%Q2ВЛ‘Х#)@±№1R3ьPЛ““Х#>Ђ±1IN3ОђУЧХ#  I52И
СKЊ#.`1IJ2ъ
‘ЛЈ8 №95N0 QСS“QЈ=А№Q-f3`
’Ј=`№-1UM"3љ“QСc:А±5=Y2¶“Ф—Х#% №AUQ!b3”U•Sc;а№AUQMQJ3B”U’Q#  Q1%	Z:x•RХееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(WTDATA)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                       /*						*/
wt_data(control,lev)         /* write packets of data from input stream */
struct	_ctrl	*control;			/* Control structure	*/
struct	lvl	*lev;		/* level descriptor for this driver	*/
/*======================================================================*/
/*USE
Portability   = level 1
Parent module = UHTOUT
Revision History:-
21/06/88 Arguments passed in 'control' structure - ICFO
09/06/88 Listing brought up to standard and optimised - ICFO
20/04/87 Created - DAR
*/

{

LOCAL
struct	pkthdr	*spkt;	/* pointer to a structured packet		*/

LOCAL
STATUS	rv;		/* return value					*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

rv = SUCCESS;

/* terminate file if it is an EOF packet				*/
if ((spkt = qget(lev->in_q)ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее)->d_bytes == -1)  CLEANUP;
	
/* write the record into the buffer (output it if complete)		*/
if ((rv = tp_write(spkt->d_start,spkt->d_bytes,
	((BOOLEAN) (spkt->d_rtype == 0 || spkt->d_rtype == 3)))) == FAIL){
    if (tpstat(EOT) == TRUE)  rv = nxt_tape(control,lev);
}

cleanup:

/* put empty packet onto output queue					*/
queue(lev->out_q,spkt);

return(rv);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(WTFMKS)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                      /*				*/
wtfmks(no)                                  /* no of filemarks to write */
UWORD	no;				/* no of filemarks to write	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTLIB	- general unheaded tape library
Revision history:
09/06/88 Listing brought up to standard and optimised - ICFO
06/04/87 Created DAR
*/

{

WORD	retval,			/* dummy param to wfm / no use here	*/
	status;			/* returned status from wfm func	*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* repeat call to wfm func ..this is a funny one, if unit has just	*/
/* wound to BOT it does not like to write filemarks for a little time	*/
/* this repeat call is issued until command not complete flag is clear	*/

while (no-- != 0) {
    while((status = wfm(1,&retval)) == 0x22 && tpstat(BOT) == TRUE) ;
    if (status == 0x22
	&& (tpstat(BOT) == FALSE) && (tpstat(EOT) == FALSE)) return(FAIL);
}

return(SUCCESS);

}

/*======================================================================*/
 has just	*/
/* wound to BOT it does not like to write filemarks for a little time	*/
/* this repeat call is issued until commееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(UHTOV0)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                           /*			*/
uhtov0(control,lev)                              /* Set up virtual file */
struct	_ctrl	*control;	/* Control structure			*/
struct	lvl	*lev;		/* Pointer to drivers level structure	*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent module	UHTINP
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
13/10/88 V03.00 issued - ICFO
         Records are not now structured - ICFO
08/07/88 V02.00 issued - ICFO
22/06/88 Arguments passed in 'control' structure - ICFO
14/06/88 'curfile' passed as argument so it can be overlaid - ICFO
         Made into an overlay from 'in_attr' - ICFO
10/06/88 BR456 - Record size is now 'blocksize - padding bytes' - ICFO
08/06/88 Optimised and listing brought up to standard - ICFO
10/04/87 Created DAR
*/

{

LOCAL
WORD	n,		/* general loop counter				*/
	num;		/* helps create file name extension		*/
LOCAL
BYTE	*ptr;		/* general pointer used in vfd zeroing & naming	*/

LOCAL
struct	pkthdr	*vfdpkt;	/* pointer to packet containing a VFD	*/

LOCAL
struct	tvfd	*vfd;		/* pointer to virtual file descriptor	*/

STATIC
BYTE	*fname = "T???";	/* filename template			*/

VOID	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* get empty packet from pool & create a VFD in it			*/
/* point VFD at start of data area					*/
/* zero all structure elements ie set to all default			*/
setmem((vfd = (vfdpkt = qget(lev->in_q))->d_start),sizeof(struct tvfd),0);

/* put filename into descriptor						*/
strcpy(ptr = vfd->v_ifile,fname);/* copy input filename to virtual fd	*/

/* put in actual file number						*/
/* find end char of extension						*/
while(*ptr != '?')  ++ptr;
ptr += 2;

num = control->curfile;	/* use current file number as extension		*/

/* put file number into extension					*/
for (n = 0; n < 3; ++n) {
    *ptr-- = num % 10 + '0';
    num /= 10;
}

/* if blocksize is fixed flag records as same else they are variable	*/
vfd->v_rstyp = (control->tp->bktype == 'F') ? 0 : 1;

/* record size is blocksize						*/
/* Allow for pre and post block padding bytes				*/
vfd->v_recsize = (LONG) (control->tp->bksize
			  - control->tp->pre_pad - control->tp->post_pad);

/* adjust packet variables						*/
vfdpkt->d_bytes = sizeof(struct tvfd);
vfdpkt->d_freesp -= sizeof(struct tvfd);

/* put VFD on the output Q						*/
queееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееue(lev->out_q,vfdpkt);

return(SUCCESS);

}

/*======================================================================*/
 ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(UHTOV4)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                              /*					*/
uhtov4(td,mode,deflt,swtch)         /* Set up tape position controllers */
struct	_tpdesc	*td;		/* Target tape descriptor		*/
BYTE	mode;			/* Open mode of tape			*/
BOOLEAN	deflt;			/* Take default if none specified Y/N	*/
struct	_sw	*swtch;		/* Switch names and values		*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	TDES tape descriptor init
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
         Commentary added and changed - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
24/06/88 A little optimising and test for end block < start block
         only if start file = end file - ICFO
13/06/88 BR462(2) - 'CF' switch added - ICFO
10/06/88 BR455 - Switch 'SB' also applies to OUTPUT - ICFO
09/06/88 Listing brought up to standard - ICFO
29/10/87 ICFO - 'swtch' passed as an argument and whole thing made
         into an overlay
         This was called SETPOS
14/04/87 DAR - Created
*/

{

/************************************************************************/
/*									*/
/* This overlay handles switches:- SF (Start File)			*/
/*				   EF (End File)			*/
/*				   CF (Concatenate Files)		*/
/*				   SB (Start Block)			*/
/*				   EB (End Block)			*/
/*									*/
/************************************************************************/

LOCAL
WORD	index,		/* Indexes into switch content array		*/
	nl,		/* Number length				*/
	n;		/* Utility					*/

LOCAL
BYTE	gstring[10];	/* Stores ASCII number strings			*/

LOCAL
BOOLEAN	defined;	/* Flags whether an object is yet defined	*/

VOID	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Get start file no							*/
defined = FALSE;

/* If switch exists then set it to switch value				*/
if ((index = fndswt(swtch->swtot,swtch->swnames,"SF")) != FAIL) {
    if (toupper(*(swtch->swvals[index])) == 'E' && mode == 'W') {
	td->st_file = 0;
	defined = TRUE;
    }
    else {
	td->st_file = atoi(swtch->swvals[index]);
	if (td->st_file > 0 && td->st_file <= MAXFILE)  defined = TRUE;
    }
}

/* Or take a default if reqd						*/
else if (deflt == TRUE) {
    td->st_file = 1;
    defined = TRUE;
}

/* While start file is invalid						*/
while (defined == FALSE) {

/* If writing add EORD option to messages				*/
    n = (mode == 'W') ? 15 : 0;

/* Get length of max file number allowed & add 1 			*/
    tpchat(0,14,23,n,nl = numlen(MAXFILE),swtch);
    if (lgetlin(gstring,++nl))  return(FAIL);

/* Start at EORD given							*/
    if ((toupper(gstring[0])) == 'E' && mode == 'W') {
	td->st_file = 0;
	defined = TRUE;
    }
    else {

/* If RET only set default to 1						*/
	if (gstring[0] == 0)  td->st_file = 1;

/* Or translate number if not						*/
	else td->st_file = atoi(gstring);

/* Is it in range 1 - MAXFILE						*/
	if (td->st_file >= 1 && td->st_file <= MAXFILE)  defined = TRUE;
    }

if (defined == FALSE)  tperr(28);

}

/* Get end file no if reading						*/
td->end_file = 0;				/* Prime to EORD	*/

if (mode == 'R') {
    defined = FALSE;

/* If switch exists then set it to switch value				*/
    if ((index = fndswt(swtch->swtot,swtch->swnames,"EF")) != FAIL) {

/* Is it an 'E' if so take end to be EORD				*/
	if (toupper(*(swtch->swvals[index])) == 'E') {
	    td->end_file = 0;
	    defined = TRUE;
	}
	else {				/* It shouldееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее be a number	*/
	    td->end_file = atoi(swtch->swvals[index]);
	    if (td->end_file > 0 && td->end_file <= MAXFILE)
							   defined = TRUE;
	}
    }

/* Or take a default if reqd						*/
    else if (deflt == TRUE) {
	td->end_file = 0;
	defined = TRUE;
    }

/* Is it less than the start file					*/
    if (defined == TRUE && td->end_file > 0
					 && (td->end_file < td->st_file)){
	tperr(25);
	defined = FALSE;
    }

/* While end file is invalid						*/
    while (defined == FALSE) {

/* Get length of max file number allowed & add 1 			*/
	tpchat(0,22,27,23,nl = numlen(MAXFILE),swtch);
	if (lgetlin(gstring,++nl))  return(FAIL);

/* End at EORD given							*/
	if ((toupper(gstring[0])) == 'E' || gstring[0] == 0) {
	    td->end_file = 0;
	    defined = TRUE;
	}
	else {
	    td->end_file = atoi(gstring);

/* Is it in range 1 - MAXFILE						*/
	    if (td->end_file <= MAXFILE && td->end_file > 0)
							   defined = TRUE;
	    else tperr(28);
		
/* Is it less than the start file					*/
	    if (defined == TRUE	&& (td->end_file < td->st_file)) {
		tperr(25);
		defined = FALSE;
	    }
	}
    }
}
else {				/* WRITING - look for 'CF' switch	*/
    td->end_file = -1;
    if ((index = fndswt(swtch->swtot,swtch->swnames,"CF")) != FAIL)
							 td->end_file = 0;
    else if (deflt == TRUE)  td->end_file = 1;
    else {
	tpchat(0,31,7,23,0,swtch);
	if ((n = toupper(getkey())) == ESC)  return(FAIL);
	td->end_file = (n == 'Y') ? 0 : 1;
    }
}

td->st_block = 1;			/* Prime the start block	*/

/* If reading or writing & start pos not at EORD we ask for a start blk	*/
if (td->st_file > 0) {

/* Get start block no							*/
    defined = FALSE;

/* If switch exists then set it to switch value				*/
    if ((index = fndswt(swtch->swtot,swtch->swnames,"SB")) != FAIL) {
	td->st_block = atoi(swtch->swvals[index]);
	if (td->st_block > 0 && td->st_block <= MAXBLOCK)  defined = TRUE;
    }

/* Or take a default if reqd						*/
    else if (deflt == TRUE) {
	td->st_block = 1;
	defined = TRUE;
    }

/* While start block is invalid						*/
    while (defined == FALSE) {

/* Get length of max block number allowed & add 1 			*/
	tpchat(0,16,23,0,nl = numlen(MAXBLOCK),swtch);
	if (lgetlin(gstring,++nl))  return(FAIL);

/* Take default on RET only						*/
	if (gstring[0] == 0)  td->st_block = 1;
	else td->st_block = atoi(gstring);

/* Is it in range 0 - MAXBLOCK						*/
	if (td->st_block <= MAXBLOCK && td->st_block > 0)  defined = TRUE;
	else tperr(29);
    }
}

td->end_block = 0;

/* If reading we may require an end block if not specified to end at 	*/
/* End of Recorded Information						*/
if (mode == 'R' && td->end_file != 0) {
    defined = FALSE;

/* If switch exists then set it to switch value				*/
    if ((index = fndswt(swtch->swtot,swtch->swnames,"EB")) != FAIL) {

/* Is it an 'E' if so take end to be EORD				*/
	if (toupper(*(swtch->swvals[index])) == 'E') {
	    td->end_block = 0;
	    defined = TRUE;
	}
	else {
	    td->end_block = atoi(swtch->swvals[index]);
	    if (td->end_block > 0 && td->end_block <= MAXBLOCK)
							   defined = TRUE;
	}	
    }

/* Or take a default if reqd EOF					*/
    else if (deflt == TRUE) {
	td->end_block = 0;
	defined = TRUE;
    }

/* Is it less than the start block					*/
    if (defined == TRUE && td->end_block > 0
	 && td->st_file == td->end_file && td->end_block < td->st_block) {
	tperr(30);
	defined = FALSE;
    }

/* While end block is invalid						*/
    while (defined == FALSE) {

/* Get length of max block number allowed & add 1 			*/
	tpchat(0,17,18,23,nl = numlen(MAXBLOCK),swtch);
	if (lgetlin(gstring,++nl))  return(FAIL);

/* End at EOF given							*/
	if ((toupper(gstring[0])) == 'E' || gstring[0] == 0) {
	    td->end_block = 0;
	    defined = TRUE;
	}
	else {				/* Translate entry from kbd	*/
	    td->end_block = atoi(gstring);

/* Is it in range 1 - MAXBLOCK						*/
	    if (td->end_block <= MAXBLOCK
				    && td->end_block > 0)  defined = TRUE;
	    else tperr(29);
	}

/* Is it less than the start block					*/
	if (defined == TRUE && td->end_block > 0
	 && td->st_file == td->end_file && td->end_block < td->st_block) {
	    tperr(30);
	    defined = FALSE;
	}
    }
}

return(SUCCESS);

}

/*======================================================================*/
ring);

/* Is it in range 1 - MAXBLOCK						*/
	    if (td->end_block <= MAXBLOCK
				    && td->end_block > 0)  defined = Tееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХЌ`eT…DхcY@ Ч                         Љ‰ @@Л4  ќЂ–m r€@ЂЛ6“ 9D6фКН  ,ЉЂ Щ  *ґ @@Л6— C@ Л”U@ -Л6Ґ 3@ +4  `€Ёѕ @ЂЛ6¬ 
Щ  *ѕ H` –ѕ @АЛ6­ЂU/рЛ6ёЂ2¬ё ЄЃ UПрЛ6Д 3j *У @  aЬђU ЇЯб–m• a[РU Ї_б–m® fЩЂUЙ Ђ@*$-Й Q m» e_° 9fШ ЉҐюfЬРUй Q mЮ fЫаUSЂЂ–mm Ќ ђ€Р fЯ@  ! ,Ыю  !P 2НЎ ") ЂЂ–mЌ ђ€ fСађ‹Ђ€@@Л6”Ђ„FЂ ИDP іiЉHK D 0”B  9Y  ‚" Ђ0 rНєаsь2НјаЄФ*ў@ЪѕНЅ@«~! ,Ъ| !  2Н® "*‚! ,Ы  !ђ 2Н±@") ѓЂЂ–m•Ќ ђ€А fЩрђМ €@@(„  rіj`‚" ЂЄ Гја" E@ЂwмBC ЁэЂ€J@ aЯ°эюЙaЯ°h q@@ њ ]p   aЮ oШЄЃ 0й€„ іmPШ # uB YґlЌЂ:„! ,Ъ*6ЖАBaФ &mи  D0) (ш   A Л6’Bа ИЩю#?Д   е›QА‚'` e›UАњў  rН«АNQАrіi°‚БP 6µЂІ¬Ђ„ іk0D. ЌЂ"1°‡kЂ„ @ е›`Ђ…lЪРКµАB@ rНІ Aё 26 ЖА	mp„ іmD. іmЊшµaQ 1  е‡@Qx еЂ Q  еѓ –mєrі@ X„ ѕ]lР  E@Ђ.Wшe›f@™WрBяІD Ђ е›vА‚!p eК* @Vm_ `„VOрЛ6щЃ3@   9fР0€\ fСр6maSА1 9fХЂЉ№юfЧЂ&m:eUP1  9fТ`0€  c`Ь‚@  ЂЂ–mGќЂ–m`r€@ЂЛ6іЃ№D7КН­АLE@ lЪzКЅАb rН­аaР 2еP KD2Н±`nVh  Б>-YW¬B Y¶d" \ў  rНµ@aР 2еP KD2Н¶АnVh  БfСЂ1  9fЬ@0€ fЭ00€ Н  W¬B Ёђ·¬‡DЃ @ е›vЂЕlЪRКў@‚@ rНѕ`a0 26 ЖА "ў@С AU fЯp6U№Ђ@Е«*Ь‚@ („@ r€Bа(„  r€@ G+4  `€Ё0”B YґКН»аN±0 9|єД4 К* А1 rі@ шµeV°AэюЙ‚ –mDЃЂ—(к„ 3@ meXђA  ГІ ‚ еfЬЂ66ж€A Л6ё@А Л6М‚@mаiZаF№‡ Vh  БaС°ImИ$¶дB  2H¤Ђ8¤ )’А“ ,\¦®’Ё‡Ћ€*‰й1—аJ†\њћ©{ЁeКk
‘љ`J†\Ё¦©­И€КH)Ё±6Љ\awИЙИЉjк‘“04Ћ]ёИи©ЙЁ©СЂ ЋЉњљЉ§  Ёи©ЙЁСћђ,ЋЉЁ–Љі IС•аLЋЉЁ“8ЙК©©€©С™ Dў]ќКjЉI€©СЂ 
Ё’„­К‰кЄ
±”ЂLЁ †ђ‚©іЄЉЄJQС@ЄђЁћ¬k8  ћ@А ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(RUNTDO)
*/
#include	"dd.h"
#include	"gtape.h"

/*======================================================================*/
STATUS                                  /*				*/
runtdo(control,lev,mode,tpmess)         /* Run tape description overlay */
struct	_ctrl	*control;	/* Control structure			*/
struct	lvl	*lev;		/* Pointer to an AMIE Level structure	*/
BYTE	mode,			/* R for read or W for write		*/
	**tpmess;		/* Pointers to messages			*/
/*======================================================================*/
/*USE
Portability	Level 1
Parent Module	UHTLIB - Geveral unheadered tape library
Revision History:
20/06/88 Arguments passed in 'control' structure - ICFO
09/06/88 'lev' in arguments not just 'lev->switches'.  This is passed
         on to the overlay - ICFO
08/06/88 Listing brought up to standard - ICFO
*/

{

LOCAL
WORD	(*ov_go)(),			/* Pointer to a function	*/
	rv;				/* Return value from function	*/

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

/* Load the overlay file						*/
if ((ov_go = ldprl("UHT.OV1")) == (BYTE *) FAIL)
					       return(flerr("UHT.OV1",4));

/* Execute the overlay and return its own return value			*/
rv = (*ov_go)(control,lev,mode,tpmess);

spfree(ov_go);				/* Free overlay area		*/

return(rv);

}

/*======================================================================*/
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…•RХЌаeT…Dхcy@ Ч¬ B Y   D іh( D іh`4  eS  9fС0Ќ›H ґ” V+іh°4  eT  9fТЂ €P  Dc` …юяd€@ЂЛ6ќЂ@Ђ Л6§Ђ@Ђ Л6« @ h  КІ   rН« 0 2Н­ Q 9fЧ@ € fЧА € fШ04  fУUЄ ЂЂ–mЉ … ‘°F6 _пцH„ іlШ ЊFНµаЫh +ЉЩґё•vА @ е›mАў  rНёаVh  Б`€Щ¶ф›d@Wњ Bя°пP „  dЖv@*rrz¤eЊЎ—*¦*F  2"2’
j,f8"—Fw )q„` #—F  2:*rj*њ` Јў§&ЈFsАAtgL',*/Є Ж  *ўbJґ` *(&$Ў+G@ 2ЄBўz±ја  ћrН« 0 2Н­ Q 9fЧ@ € fЧА € fШ04  fУUЄ ЂЂ–mЉ … ‘°F6 _пцH„ іlШ ЊFНµаЫh +ЉЩґё•vА @ е›mАў  rееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/*
.pa
.he                                                               UHT(UHTOV1)
*/
#include	"dd.h"
#include	"gtape.h"

BYTE	**tpmes;		/* Pointer to messages for 'tape_chat'	*/

/*======================================================================*/
STATUS                       /*						*/
uhtov1(control,lev,mode,msg) /* create tape file descr. from switch info*/
struct	_ctrl	*control;	/* Control structure			*/
struct lvl *lev;		/* Pointer to an AMIE Level structure	*/
BYTE	mode,			/* R for read W for write		*/
	**msg;			/* Pointer to messages for 'tape_chat'	*/
/*======================================================================*/
/*USE
Portability	level 1
Parent module	UHTINP and UHTOUT - tape descriptor init
Module version	05.03
For AMIE	05.20
Revision History:-
19/06/94 V05.03 issued - ICFO
19/12/90 V05.02 issued - ICFO
         Rebuilt with V03.01 of the SCSI Tape Drivers - ICFO
08/05/90 V05.01 issued - ICFO
22/11/89 V05.00 issued - ICFO
14/09/89 V04.01 issued - ICFO
08/08/89 V04.00 issued because V03.01 required a change to the
         documentation so should have been V04.00 - ICFO
20/02/89 V03.01 issued - ICFO
         All tape handling moved to UHTOVD - ICFO
         Maximum number of switches reduced to 13 (see
         also GTAPE.H) - ICFO
13/02/89 Only 35 messages in UHT.MS2.  The rest moved to UHT.MS4 - ICFO
13/10/88 V03.00 issued - ICFO
08/07/88 V02.00 issued - ICFO
22/02/88 Arguments passed in 'control' structure - ICFO
14/06/88 'tp_open' moved to here and 'bc' and 'tf' passed as
         arguments - ICFO
13/06/88 59 messages - ICFO
09/07/88 Setting of 'lev->levchk' etc moved to here from root - ICFO
         'lev' passed in argument not just 'lev->switches' - ICFO
30/10/87 Bug Report 426 - ICFO
         To handle th additional switch (in UHTOV5 and 6) there are
         now 57 messages
28/10/87 Bug Reports 422 & 432 - ICFO
         The various stages of handling the switches are now in
         separate sub overlays
         Fix to SETTPE
                SETBLK - now UHTOV2
                SETPAD - now UHTOV3
                SETPOS - now UHTOV4
                SETEOT - now UHTOV5
                DSPDTS - now UHTOV6

28/10/87 This used to be called TPDES

         Bug Report 316 - ICFO
         Different messages are used for INPUT and OUTPUT concerning
         short blocks to make things easier to understand.  As a
         result there are now 53 messages in UHT.MS2.
         Fix to TPDES
                UHT.MS2
                SETBLK

06/04/87 DAR - Created
*/

{

LOCAL
WORD	rv,		/* Return value					*/
	text;		/* Text descriptor				*/

LOCAL
STATUS	(*ov_go)();	/* Pointer to UHTOVN				*/

LOCAL
struct	_sw	swtch;	/* Structure to hold the switch names and values*/

VOID	tlibv();

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/

tpmes = msg;			/* For 'tape_chat'			*/

lev->expf = 0;
lev->bfsize = 0;
lev->levchk = (mode == 'W') ? 6 : 1;

/* Fail if we have no switches						*/
if (lev->switches == 0)  return(tperr(17));

/* Set up switches ready for inquiry					*/
swtch.swtot = setswt(13,lev->switches,swtch.swnames,swtch.swvals);

/* Load the message text						*/
if ((text = opn_txt("UHT.MS2",swtch.tapmes,33)) == FAIL)
					      return(flerr("UHT.MS2",46));

/* Set up the tape descriptor						*/
rv = settpe(control->tp,mode,&swtch);

/* Free the local messages						*/
cls_txt(text);

/* Open the tape and set up the control structures			*/
if (rv != SUCCESS)  return(FAIL);

if ((ov_go = ldprl("UHT.OVD")) == FAIL)  return(flerr("UHT.OVD",4));
rv = (*ov_go)(control,mode,lev);
free(ov_go);

/* Return to caller							*/
return(rv);

}

/*======================================================================*/
Free the local messages						*/
cls_txt(text);

/* Open the tape and set up the control structures			*/
if (rv != SUCCESS)  …•RХђ eT…Dхd)@ Ф4 B Y  •љ  0Y1Ђ €Њ¤‚љ‹  HеСЂ ЋЉњљЉ§  Ёи©ЙЁСђPђ]  Є‰‰(JСЂ Ё ’„­	 КЉиi‰сР ЄђЁћ¬…8  ћ            	IBMDEOV0C     Vхшя          UHTOV1  C     Ћ              UHTOVB  $$$                    DIAGBМD SUB   Э              FLDPRГ  BAK  (° ± Я 	ГЪ    	IBMDEOV1C     /             UHT     MS2   	              	IBMDEOV2C    
      UHTOV2  C     '‘љ            BFIELДS OV1   “              BFIELДS OV2   
Ю              FLDPRГ  REL   д              ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееTape file definition
Block type?
F = Fixed  V = Variable length  DFLT F
Block size?  12 bytes to 16Kb  DFLT 80
Max block size? 12 bytes to 16Kb  DFLT 80
Enter as bytes or K eg 4K
Short last block allowed? DFLT NO
Y for Yes, another for No
No of pre block pad bytes? DFLT 0
No of post block pad bytes? DFLT 0
Pre/Post block pad byte? DFLT NUL
Single key enters ASCII
2 keys enter HEX value of byte
Last block pad char? DFLT NUL
Start file? 1 to 1024
or E = end of current files  DFLT 1
Start block number? 1 to 32768  DFLT 1
Last block number? 1 to 32768
or E = End of File  DFLT E
Continue file on new tape
Restart file on new tape
Abandon file & stop
End file number? 1 to 1024  DFLT End of tape files
<RET> for default
Continue reading from new tape
Abandon reading & stop
Action at end of tape?
or 'E' to stop after last file on tape
Pad last block? DFLT NO
Rewind tape after each group of files?
N for No, another for Yes
Concatenate input files? DFLT NO
Number of files to skip if not at BOT? 0 to 1024 DFLT = 0
on new tape
Abandon file & stop
End file number? 1 to 1024  DFLT End of tape files
<RET> for default
Continue reading from new tape
Abandon reading & stop
Action at end of tape?
or 'E' to stop after last file on tape
Pad last block? DFLT NO
Rewind tape after each group of files?
N for No, another for Yes
Concatenate input files? DFLT NO
Number of files to skip if not atееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееFMT MFM NO/FC 1*10*512 80T  -DEC RX50-  22264-22  &„C Fх0000120                 ‚сИTљэОW›}·k                              