ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее-CATALOG°1-                  BANNER  БSM   )              BANNER  ГOM                  CARMAINTВAS   ,              CRCK    ГOM   
               CRCKLISTГRC                  DEDUMP  БSM   9	
              DIRDUMP БSM   g            DIS     ГOM   (              DIS     ДOC                  DUMBCOPYБSM   -              DUMBCOPYГOM                  ERUN    ГOM   \             HELP    НAC                  HEXDUMP БSM   G             HITECH  Ъ80   ,              INST    ЖMI                  LETTER  ВAS   *               LETTER  ДAT   !               LETTER  ЙNT   "               LIB     ВAS   U#$%             MFT     БSM   Y&'(             MFT     ГOM   )               MFT     ДOC   *               MPRINT  БSM   \+,-             MPRINT  ГOM   .               PRINT   ВAS   /               PRINT   ЙNT   0               REMOV"  ГOM   1               SPIES   ВAS   2               SPIES   ЙNT   3               SPOOLNSHЙNS   4               STOIC   ГOM  56789           STOICCPMУTC  .:;<=>?          STOICEDTУTC   P@AB             STOICFLEУTC   `CDE             U-G-FORMМIB   	F               UK1     ДOC   G               -CATALOG°2-   H               CCP     БSM   fIJKL            CPMLIB  ДOC  ЂMNOPQRSTUVWXYZ[\CPMLIB  ДOC  z]^_`            CRCK    ГOM   
a               CRCKLISTГRC   b               ED111   БSM  ЂcdefghijklmnopqrED111   БSM  lstuv            ED111   ГOM   fwxyz            ED111   ЙMP   {               EDIT    НAC   |               HELP    НAC   }               TEXTED  ДOC  ~ЂЃ‚ѓ„…†       U-G-FORMМIB   	‡               UK2     ДOC   €               -CATALOG°3-   ‰               BM      ПBJ   
Љ               BM      УRC   ‹               BREAK   БSM   !ЊЌ              BREAK   ГOM   Ћ               CALC    ВAS   cЏђ‘’            CALC    ЙNT   #“”              CNOTES  РRN  U•–—™љ›         COMPILE ВAS   њќћџ ЎўЈ¤       COMPILE ЙNT   iҐ¦§Ё            CRCK    ГOM   
©               CRCKLISTГRC   Є               EDITOR  ВAS  "«¬­®Ї°          EDITOR  ЙNT   @±І              EDITOR1 ВAS  іґµ¶·           EDITOR1 ЙNT   4ё№              INIT    ВAS   є               INIT    ЙNT   »               LIST    БSM   &јЅ              LIST    ГOM   ѕ               PCALC   ВAS   
ї               PCALC   ЙNT   А               PROG    ВAS   <БВ              PROG    ЙNT   Г               еRUNOBJ  $$$    Д               ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееUK User Group Volume 1

DESCRIPTION: Miscellaneous Utilities.

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.01-	CONTENTS OF CP/M UK VOL. 1
1.1	6K	BANNER.ASM	Source of updated BANNER program from US vol.8.
1.2	1K	BANNER.COM	.COM of the above program.
1.3	6K	CARMAINT.BAS	Source of vehicle maintenance record program.
1.4	8K	DEDUMP.ASM	Dr.Lee's cunning file transfer program.
1.5	13K	DIRDUMP.ASM	Directory dump utility.
1.6	5K	DIS.COM		Uncle David's Dynamic Disassembler. (No source.)
1.7	4K	DIS.DOC		Documentation for the above.
1.8	5K	DUMBCOPY.ASM	Good sector-by-sector copier for 1 drive system.
1.9	1K	DUMBCOPY.COM	.COM of above program
1.10	12K	ERUN.COM	Included to run PRINT.INT
1.11	4K	HELP.MAC	Provides instructions to user on appeal!
1.12	9K	HEXDUMP.ASM	Converts .COM file to .HEX.
1.13	6K	HITECH.Z80	Driver routines for Hitech card + LUN table.
1.14	2K	INST.FMI	Instructions for updated PRINT.BAS.
1.15	6K	LETTER.BAS	Source of simple text formatting program.
1.16	1K	LETTER.DAT	Part of simple text formatting program.
1.17	3K	LETTER.INT	.INT file of above.
1.18	11K	LIB.BAS		Library of CBASIC I/O routines.
1.19	12K	MFT.ASM		Source of single drive copy routine.
1.20	2K	MFT.COM		.COM of above.
1.21	1K	MFT.DOC		Documentation of above.
1.22	12K	MPRINT.ASM	Multiple file print utility.
1.23	1K	MPRINT.COM	.COM of above.
1.24	1K	PRINT.BAS	Simple print utility for text formatter.
1.25	1K	PRINT.INT	.INT file of above
1.26	1K	REMOV".COM	Removes (") from a file (from US Lib.)
1.27	4K	SPIES.BAS	CBASIC version of the old DIGICO game.
1.28	3K	SPIES.INT	.INT of the above.
1.29	2K	SPOOLNSH.INS	Instructions for using SPOOLER with N.Star.
1.30	17K	STOIC.COM	STOIC compiled from US Lib.Vol.23.
1.31	22K	STOICCPM.STC	Source of CP/M file handling program for STOIC.
1.32	10K	STOICEDT.STC	Modified source of screen editor using above.
1.33	12K	STOICFLE.STC	Modified source of block STOIC file system.
1.34	2K	U-G-FORM.LIB	Nice form to send in with your software.
1.35	4K	UK1.DOC		Comments on some programs.
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее	ORG	100H
;
;
;*************************************************
;***                                           ***
;***   B A N N E R  P R I N T  &  P U N C H    ***
;***                                           ***
;*************************************************
;
;
; THIS PROGRAM ORIGINALLY WAS FROM THE INTEL
; 8008 LIBRARY I MODIFIED AND ADDED TO IT TILL
; IT NOW WORKS NICELY
; I/O PARAMETERS ARE PASSED THRU THE CP/M FUNCTION
; CALL FEATURE
; RON BOLEY    HANSEN ASSOCIATES   201-652-7055
;       212-947-0379
;
;MODIFIED FOR CP/M 1.4 and 2.2 BY DEREK FORDRED AND COLIN TODD 
;FOR UK CP/M USER GROUP 13/4/81.
;
;
BDOS	EQU	0005H
CNTRLC	EQU	03H
CR	EQU	0DH
LF	EQU	0AH
PUNF	EQU	4
INF	EQU	1
OUTF	EQU	2
LSTOT	EQU	5
;
;
;
START:
	LXI	H,MESSG1
	CALL	DISPWORD
WHICHONE:
	CALL	CONIN
	CPI	'P'
	JZ	CPBN
	CPI	'L'
	JZ	CBAN
	MVI	C,'?'
	CALL	CONOUT
	CALL	CRLF
	JMP	WHICHONE
CBAN:
	CALL	CRLF
	MVI	D,40H
	LXI	H,BUFF
	SHLD	BADR
	MOV	A,H
	MOV	B,L
	LXI	H,BADR
	MOV	M,B
	INX	H
	MOV	M,A
	MOV	H,A
	MOV	L,B
CB1:
	SHLD	CADR
	MOV	A,H
	MOV	B,L
	LXI	H,CADR
	MOV	M,B
	INX	H
	MOV	M,A
	MOV	H,A
	MOV	L,B
	CALL	CONIN
	CPI	CNTRLC
	JZ	GOSYS
	MOV	E,A
	LXI	H,CADR
	MOV	A,M
	INX	H
	MOV	H,M
	MOV	L,A
	MOV	A,E
	MOV	M,A
	CPI	CR
	JZ	EOP
	CALL	CONV
	JC	CB1
	CALL	BCH
	LXI	H,CADR
	MOV	A,M
	INX	H
	MOV	H,M
	MOV	L,A
	INX	H
	JMP	CB1
GOSYS:
	RET
EOP:
	CALL	EOL
	CALL	CRLF
	CALL	CRLF
	JMP	CBAN
LBAN:
	MOV	H,B
	MOV	L,C
	SHLD	BADR
	MOV	A,H
	MOV	B,L
	LXI	H,BADR
	MOV	M,B
	INX	H
	MOV	M,A
	MOV	H,A
	MOV	L,B
	CALL	CRLF
	MVI	D,40H
LB1:
	LHLD	BADR
	LXI	H,BADR
	MOV	A,M
	INX	H
	MOV	H,M
	MOV	L,A
LB2:
	MOV	A,M
	CPI	CR
	JZ	EOL
	CALL	CONV
	CNC	BCH
	LXI	H,CADR
	MOV	A,M
	INX	H
	MOV	H,M
	MOV	L,A
	INX	H
	JMP	LB2
EOL:
	CALL	CRLF
	MOV	A,D
	RAR
	ANI	7FH
	RZ
	MOV	D,A
	JMP	LB1
CPBN:
	CALL	CONIN
	CPI	CNTRLC
	JZ	GOSYS
	CALL	CONV
	CNC	PCH
	JMP	CPBN
PBAN:
	MOV	H,B
	MOV	L,C
PB1:
	MOV	A,M
	CPI	CR
	RZ
	CALL	CONV
	CNC	PCH
	LXI	H,CADR
	MOV	A,M
	INX	H
	MOV	H,M
	MOV	L,A
	INX	H
	JMP	PB1
CONV:
	MOV	E,A
	SHLD	CADR
	MOV	A,H
	MOV	B,L
	LXI	H,CADR
	MOV	M,B
	INX	H
	MOV	M,A
	MOV	H,A
	MOV	L,B
	MOV	A,E
	SUI	' '
	RC
	JZ	FND
	SUI	'*'-' '
	RC
	CPI	'Z'+1-'*'
	JNC	CNVER
	ADI	1
	MOV	B,A
	ADD A! ADD A
	ADD	B
FND:
	ADI	GRAF AND 0FFH
	MOV	L,A
	MVI	A,GRAF SHR 8
	ACI	0
	MOV	H,A
	RET
CNVER:
	ADI	0FFH
	RET
BCH:
	MVI	C,5
BCH1:
	SHLD	GADR
	MOV	A,H
	MOV	B,L
	LXI	H,GADR
	MOV	M,B
	INX	H
	MOV	M,A
	MOV	H,A
	MOV	L,B
	MOV	A,M
	ANA	A
	JM	BCH3
	MOV	B,E
	ANA	D
	JNZ	BCH2
	MVI	B,' '
BCH2:
	PUSH	B
	MOV	C,B
	CALL LSTOUT
	POP	B
	LXI	H,GADR
	MOV	A,M
	INX	H
	MOV	H,M
	MOV	L,A
	INX	H
	DCR	C
	JNZ	BCH1
BCH3:
	MVI	B,' '
	PUSH	B
	MOV	C,B
	CALL LSTOUT
	CALL LSTOUT
	CALL LSTOUT
	POP	B
	RET
CRLF:
	MVI	C,CR
	CALL LSTOUT
	MVI	C,LF
	CALL LSTOUT
	RET
PCH:
	MVI	C,5
PCH1:
	SHLD	GADR
	MOV	A,H
	MOV	B,L
	LXI	H,GADR
	MOV	M,B
	INX	H
	MOV	M,A
	MOV	H,A
	MOV	L,B
	MOV	A,M
	ANA	A
	JM	PCH2
	MOV	B,A
	PUSH	B
	MOV	C,B
	CALL	PUNCH
	POP	B
	LXI	H,GADR
	MOV	A,M
	INX	H
	MOV	H,M
	MOV	L,A
	INX	H
	DCR	C
	JNZ	PCH1
PCH2:
	MVI	C,0
	CALL	PUNCH
	JMP	PUNCH
CONOUT:
	PUSH	H!PUSH	B!PUSH	D
	MOV	E,C
	MVI	C,OUTF
	CALL	BDOS
	POP D!POP B!POP H
	RET
LSTOUT:
	PUSH H!PUSH B!PUSH D
	MOV	E,C
	MVI	C,LSTOT
	CALL	BDOS
	POP D!POP B!POP H
	RET
CONIN:
	PUSH	H!PUSH	B!PUSH	D
	MVI	C,INF
	CALL	BDOS
	POP	D!POP	B!POP	H
	RET
PUNCH:
	PUSH H!PUSH B!PUSH D
	MOV	E,C
	MVI	C,PUNF
	CALL	BDOS
	POP D!POP B!POP H
	RET
GRAF:
	DB	00H,00H,00H,00H,00H
	DB	14H,08H,14H,80H,80H
	DB	08H,1CH,08H,80H,80H
	DB	03H,80H,80H,80H,80H
	DB	08H,08H,08H,80H,80H
	DB	01H,80H,80H,80H,80H
	DB	03H,04H,08H,10H,60H
	DB	3EH,41H,41H,41H,3EH
	DB	11H,31H,7FH,01H,01H
	DB	21H,43H,45H,49H,31H
	DB	22H,41H,49H,49H,36H
	DB	0CH,14H,24H,7FH,04H
	DB	7AH,49H,49H,49H,46H
	DB	3EH,49H,49H,49H,26H
	DB	43H,44H,48H,50H,60H
	DB	36H,49H,49H,49H,36H
	DB	30H,49H,49H,49H,3EH
	DB	12H,80H,80H,80H,80H
	DB	13H,80H,80H,80H,80H
	DB	08H,14H,22H,41H,41H
	DB	14H,14H,14H,80H,80H
	DB	41H,41H,22H,14H,08H
	DB	20H,40H,45H,48H,30H
	DB	7FH,40H,4FH,41H,7FH
	DB	3FH,48H,48H,48H,3FH
	DB	7FH,49H,49H,49H,36H
	DB	7FH,41H,41H,41H,41H
	DB	7FH,41H,41H,41H,3EH
	DB	7FH,49H,49H,49H,41H
	DB	7FH,48H,48H,48H,40H
	DB	7FH,41H,41H,49H,4FH
	DB	7FH,08H,08H,08H,7FH
	DB	41H,7FH,41H,80H,80H
	DB	03H,01H,01H,01H,7FH
	DB	7FH,08H,14H,22H,41H
	DB	7FH,01H,01H,01H,01H
	DB	7FH,20H,10H,20H,7FH
	DB	7FH,30H,08H,06H,7FH
	DB	7FH,41H,41H,41H,7FH
	DB	7FH,48H,48H,48H,78H
	DB	7FH,41H,45H,43H,7FH
	DB	7FH,48H,4CH,4AH,79H
	DB	32H,49H,49H,49H,26H
	DB	40H,40H,7FH,40H,40H
	DB	7FH,01H,01H,01H,7FH
	DB	70H,0CH,03H,0CH,70H
	DB	7FH,02H,04H,02H,7FH
	DB	63H,14H,08H,14H,63H
	DB	60H,10H,0FH,10H,60H
	DB	43H,45H,49H,51H,61H
BADR:
	DS	2
CADR:
	DS	2
GADR:
	DS	2
BUFF:
	DS	40
DISPWORD:
	MOV	A,M
	ORA	A
	RZ
	INX	H
	MOV	C,A
	CALL	CONOUT
	JMP	DISPWORD
MESSG1:
	DB	CR,LF
	DB	'THIS PROGRAM WILL PRINT OR PUNCH A BANNER'
	DB	' ACROSS A PAPER TAPE OR LINE PRINTER'
	DB	CR,LF
	DB	'LISTING.  PLEASE TYPE WHICH DEVICE YOU WISH TO USE'
	DB	CR,LF
	DB	'TYPE [ P ] FOR THE PUNCH [ L ] FOR THE LIST'
	DB	CR,LF,00H
;
;
	END	100H
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя   M   AM                                                                                         
	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	
яяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее!мНбН юPК№юLК?Н†НLГНL@!№"і|E!іp#wgh"µ|E!µp#wghН юКk_!µ~#fo{wюКlНбЪ3Н!µ~#fo#Г3ЙН­НLНLГ`i"і|E!іp#wghНL@*і!і~#fo~юК­НбФ!µ~#fo#Г–НLzжИWГЊН юКkНбФWГ№`i~юИНбФW!µ~#fo#ГМ_"µ|E!µp#wgh{Ц ШКЦ
Шю1ТЖG‡‡ЂЖ№o>О gЙЖяЙ"·|E!·p#wgh~§ъ=CўВ+ ЕHН“Б!·~#fo#В ЕHН“Н“Н“БЙН“
Н“Й"·|E!·p#wgh~§ъ~GЕHН¬Б!·~#fo#ВY Н¬Г¬еЕХYН СБбЙеЕХYН СБбЙеЕХН СБбЙеЕХYН СБбЙ     ЂЂЂЂЂЂЂЂЂЂЂЂЂЂ`>AAA>1!CEI1"AII6$zIIIF>III&CDHP`6III60III>ЂЂЂЂЂЂЂЂ"AAЂЂAA" @EH0@OA?HHH?III6AAAAAAA>IIIAHHH@AAIOAAЂЂ"A  0AAAHHHxAECHLJy2III&@@@@ppcc``CEIQa СБбЙ     ЂЂЂЂЂЂЂЂЂЂЂЂЂЂ`>AAA>~·И#OН†Гб
THIS PROGRAM WILL PRINT OR PUNCH A BANNER ACROSS A PAPER TAPE OR LINE PRINTER
LISTING.  PLEASE TYPE WHICH DEVICE YOU WISH TO USE
TYPE [ P ] FOR THE PUNCH [ L ] FOR THE LIST
                                                                                                  ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее	REM CARMAINT Issue 1, 10 Jan. 1981, Copyright K.A.Bennett.
	VDU.CLEAR.SCR$ = CHR$(126)+CHR$(28)
	FOR1$ = "&  #####         #####"
	FOR2$ = "&  #####         #####     &"
	NAME$  =  "VEHICLES"
	FILE NAME$(16)
	IF END #1 THEN 20
	IF END #2 THEN 20
	CLOSE 1
	PRINT VDU.CLEAR.SCR$
	PRINT TAB(30); "CARMAINT"
	PRINT
	PRINT TAB(30); "-------"
	PRINT
	PRINT "A PROGRAM TO RECORD THE MAINTENANCE HISTORY FOR MOTOR"
	PRINT "VEHICLES AND TO PRODUCE A TASK LIST IF REQUIRED."
	PRINT:	PRINT
	PRINT TAB(10); "NOTE:"
	PRINT TAB(15);		"The program assumes that you will do the service"
	PRINT TAB(15);		"at the current mileage that you enter below."
	PRINT
	PRINT
	PRINT CHR$(7)
	INPUT "Today's date:";	DAT$
	PRINT : PRINT:
20 CONSOLE: PRINT VDU.CLEAR.SCR$
	PRINT
	PRINT "The following vehicle records are on file:"
	IF SIZE("VEHICLES.*") = 0 THEN 300
	PRINT
	OPEN "VEHICLES" RECL 16 AS 1
	READ #1,1;CARS%
	FOR  R = 2  TO  CARS%	:\
		READ #1,R;FILE.NAME$	:\
		PRINT TAB(20);  FILE.NAME$;: NEXT R
	CLOSE 1
25 PRINT
	PRINT CHR$(7)
	INPUT "Car model (Existing or additional)";CAR$
	CAR$ = CAR$ + "        "
	CAR$ = LEFT$(CAR$,8)
	OPEN "VEHICLES" RECL 16 AS 1
	READ #1,1;CARS%
	FOR R = 2 TO CARS%
		READ #1,R;FILE.NAME$
		IF FILE.NAME$ = CAR$ THEN GOTO 30 
	NEXT R
	PRINT "Not yet on record - Please enter service details." :\
	PRINT
	CLOSE 1: GOTO 300
30 CLOSE 1
	PRINT
	INPUT "Current mileage:";MILES
	PRINT "Choose by number:"
	PRINT
	PRINT TAB(30);"Complete schedule for "; CAR$; " (1)"
	PRINT TAB(30);"Required maintenance at"; MILES; "  (2)"
	PRINT TAB(30);"Create new vehicle schedule		(3)"
	PRINT TAB(30);"End the program				(4)"
	PRINT
	PRINT
	PRINT CHR$(7)
	INPUT "Operation required:"; WORK%
	IF WORK%	=	4	THEN STOP
	PRINT
	INPUT "Do you want a printed output (Y or N)"; PRINT$
	IF PRINT$	=	"Y"	THEN LPRINTER
	ON WORK% GOTO 100,200,300


100 REM COMPLETE SCHEDULE FOR SELECTED CAR
	PRINT VDU.CLEAR.SCR$
	PRINT TAB(10); "Maintenance schedule for ";CAR$;" on ";DAT$
	OPEN FILE.NAME$ RECL 128 AS 1
	READ #1,1;TASK%,OLD.DAT$,LAST.DONE
	CLOSE 1
	PRINT
	PRINT TAB(10); "Last service on ";OLD.DAT$;" at";LAST.DONE;"miles."
	PRINT
	GOSUB 1.00E10
	OPEN FILE.NAME$ RECL 128 AS 1
	FOR R = 2 TO TASK%
	READ #1,R;TASK$,INTERVAL%,LAST.DONE
	PRINT USING FOR1$; TASK$; INTERVAL%; LAST.DONE
	NEXT R
	FOR I = 1 TO 70: 	PRINT "*";: NEXT I
	CLOSE 1: CONSOLE
	PRINT
	PRINT CHR$(7)
	INPUT "Another vehicle? (Y) or E to end"; NEXT$
	IF	NEXT$   =   "Y"   THEN 20
	STOP


200 REM	MAINTENANCE REQUIRED ROUTINE
	COUNT% = 0
	PRINT VDU.CLEAR.SCR$
	INPUT "Is the work required to be completed now? (Y or N)";COMP$
	IF COMP$ <> "Y" AND  COMP$ <> "N" THEN 200
	IF PRINT$	=	"Y"	THEN LPRINTER
	PRINT TAB(10); "Required Maintenance for ";CAR$;" on ";DAT$; " at"; MILES
	OPEN FILE.NAME$ RECL 128 AS 1
	READ #1,1;TASK%,OLD.DAT$,LAST.DONE
	PRINT
	PRINT TAB(20); "Last service on ";OLD.DAT$;" at";LAST.DONE;"miles."
	IF COMP$ = "Y" THEN OLD.DAT$ = DAT$:\  LAST.DONE = MILES
	PRINT #1,1;TASK%, OLD.DAT$, LAST.DONE
	PRINT
	GOSUB 1.00E10
	RECORD.NO%  = 2
	WHILE RECORD.NO%  <  TASK% + 1
			READ #1,RECORD.NO%; TASK$, INTERVAL%, LAST.DONE
			IF 	MILES - LAST.DONE >= INTERVAL% THEN  	GOSUB 1.00E15
			RECORD.NO%  =  RECORD.NO% + 1
	WEND
	CLOSE 1
	IF COUNT% = 0 THEN 	PRINT "No sevice required at "; MILES
	FOR I = 1 TO 70:	PRINT "*";: NEXT I
	CONSOLE:PRINT
	PRINT CHR$(7)
	INPUT "Another vehicle? (Y) or E to end";NEXT2$
	IF	NEXT2$   =   "Y"   THEN 20
	STOP

300 REM CREATE DATA FILE FOR NEW VEHICLE
	PRINT VDU.CLEAR.SCR$
	CONSOLE
	PRINT TAB(40); "WARNING"
	PRINT TAB(40); "-------"
	PRINT
	PRINT TAB(10); "Do not re-use any name already on the file."
	PRINT:	PRINT
	PRINT "Note:  The program will assume that all items were last done"
	PRINT "       at the miles inserted below. If any item has never been"
	PRINT "       done insert free service mileage and then increase by"
	PRINT "       stepping through the intervals using option (2)."
	PRINT CHR$(7)
	INPUT "Create new maintenance schedule for vehicle (Up to 8 characters):";FILE.NAME$
	FILE.NAME$  =  FILE.NAME$ + "        "
	FILE.NAME$  =  LEFT$(FILE.NAME$,8)
	PRINT VDU.CLEAR.SCR$
	PRINT "Start input for ";FILE.NAME$
	PRINT
	CREATE FILE.NAME$ RECL 128 AS 1
	INPUT "Maintenance schedule start date:"; OLD.DAT$
	PRINT
	INPUT "Last complete service mileage:";LAST.DONE
	TASK% = 1
	RECORD.NO% = 2
310 PRINT "Describe task number";TASK%
	INPUT "Description (or E to end task input):"; TASK$
	IF TASK$	=	"E"	THEN 320
	TASK$ = TASK$ + "                              "
	TASK$ = LEFT$(TASK$,30)
	PRINT
	INPUT "Service interval (miles):";INTERVAL%
	PRINT #1,RECORD.NO%;TASK$,INTERVAL%,LAST.DONE
	TASK% = TASK%+1
	RECORD.NO%	=	RECORD.NO% + 1
	PRINT VDU.CLEAR.SCR$
	GOTO 310
320 PRINT #1,1;TASK%,OLD.DAT$,LAST.DONE
	CLOSE 1
	OPEN "VEHICLES" RECL 16 AS 1
	IF SIZE("VEHICLES.*") = 0 THEN 325
	READ #1,1;CARS%
	CARS%  =  CARS% + 1
	 PRINT #1,CARS%;FILE.NAME$
	PRINT #1,1;CARS%
	CLOSE 1: GOTO 20
325 PRINT #1,1;2
	PRINT #1,2;FILE.NAME$
	CLOSE 1:GOTO 20




1.00E15 REM PRINT ITEMS DUE
	COUNT% = COUNT% + 1
	PRINT USING FOR2$;  TASK$; INTERVAL%; LAST.DONE; "***"
	IF COMP$ = "Y" THEN LAST.DONE  =  MILES
	PRINT #1,RECORD.NO%; TASK$, INTERVAL%, LAST.DONE
	RETURN




1.00E10 REM SET OUT HEADINGS
	FOR I = 1 TO 70:PRINT "*";: NEXT I
	PRINT TAB(5);"Task                       Interval     Last Service"
	FOR I = 1 TO 69:PRINT "*";: NEXT I: PRINT "*"
	RETURN
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГCRCK.COM 4.2 10/6/80!  9"1Нd:] ю ВLН§++NO FILE NAME SPECIFIED++
$НWCRCK ver 4.2
CTL-S pauses, CTL-C aborts
 :m 2ІюFВ~ГЇ CRCKLIST$$$ Н–°ГшН–жД‚yж0°  –Г4х*«л*­}“|љЪ$!  "­л*«{•zњТ*©лН €Н ·ВхЂ *­"­ГЗ	Н сГ
DISK FULL: CRCFILE$Ђ Н !  "­л*©лс*­#"­ЙЇ2”2Ё!  "«!  "­€Н €Н <В~	fН Г
NO DIR SPACE: CRCFILE$1НЉТF:¶·К¤Н:++FILE NOT FOUND++$:ІюFВ<*­}жВё"«>хНІсВ¬€Н <Вр	ЩН Гр
CANNOT CLOSE CRCFILE$Г CRCKLISTCRC 
DISK FULL: CRCFILуН Г3е 	w#В$СН Й!€уНН§
DONE$!e Н К~!] w Н/!e Ђ Н/НW
--> FILE:  XXXXXXXX.XXX		CRC =  \ Н <В«Н:++OPEN FAILED++$!  "і! "П*П|ю КвН ·КУН юК@\ Н ·Вр!Ђ ~2µ#"ПН#Г·юВ:ґН@> Нk:іН@НdГ~Н:++FILE READ ERROR++$*і|жЂх):µ…oсК<|о g}о—o"іЙхНIсжю
ЪRЖЖ0Гkг~Нk#~·ВXгЙ>Нk>
ЕХеж_ХНСН бСБЙ:ІюFА{НІЙЂ Н Ї2h 2| :¶·КЙ!\ · Н/:\ 2Г!·\  Н/\ Н Гс!Г\  Н/\ Н !·\  Н/\ Н <7И=ж‡‡‡‡‡ЖЃo& еД Н/б]  Н/Ї2h 2| 2¶ЙН(АН(А~жю$#Й~#x±В/ЙС	Н :ІюFВ”*­}жВT"«>хНІсВH€Н <ВЊ	uН ГЊ
CANNOT CLOSE CRCFILE$€Н Н§

++ABORTED++$С	Н *щЙ                                                                                AP

                	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                   	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
--> FILE:  MFT     .COM		CRC = 10 CE

--> FILE:  DIS     .COM		CRC = A2 DB

--> FILE:  DIS     .DOC		CRC = 4A 73

--> FILE:  STOICCPM.STC		CRC = 17 3F

--> FILE:  MPRINT  .ASM		CRC = 16 61

--> FILE:  MPRINT  .COM		CRC = 2A B5

--> FILE:  UK1     .DOC		CRC = 39 E5

--> FILE:  BANNER3 .COM		CRC = 6D 35

--> FILE:  STOIC   .COM		CRC = F1 BC

--> FILE:  STOICFLE.STC		CRC = 70 59

--> FILE:  -CATALOG.01-		CRC = 10 2C

--> FILE:  STOICEDT.STC		CRC = B5 FE

--> FILE:  DEDUMP  .ASM		CRC = A0 30

--> FILE:  CARMAINT.BAS		CRC = 1D B8

--> FILE:  SPIES   .BAS		CRC = 03 44

--> FILE:  MFT     .DOC		CRC = 7B 42

--> FILE:  HITECH  .Z80		CRC = 91 73

--> FILE:  SPOOLNSH.INS		CRC = F5 D7

--> FILE:  DIRDUMP .ASM		CRC = 90 6A

--> FILE:  LETTER  .BAS		CRC = BD 51

--> FILE:  LETTER  .INT		CRC = A4 FE

--> FILE:  U-G-FORM.LIB		CRC = FD 46

--> FILE:  INST    .FMI		CRC = AB 05

--> FILE:  REMOV"  .COM		CRC = 84 96

--> FILE:  LETTER  .DAT		CRC = 0A 03

--> FILE:  ERUN    .COM		CRC = 32 83

--> FILE:  PRINT   .BAS		CRC = 2B 12

--> FILE:  PRINT   .INT		CRC = 06 E2

--> FILE:  LIB     .BAS		CRC = 54 00

--> FILE:  HELP    .MAC		CRC = BF 22

--> FILE:  SPIES   .INT		CRC = 59 2B

--> FILE:  HEXDUMP .ASM		CRC = 38 8E

--> FILE:  DUMBCOPY.COM		CRC = 29 D6

--> FILE:  DUMBCOPY.ASM		CRC = 84 DC

--> FILE:  MFT     .ASM		CRC = 7B 3C

--> FILE:  BANNER  .ASM		CRC = A2 BF

--> FILE:  CRCK    .COM		CRC = 2D 47

--> FILE:  BANNER  .COM		CRC = 66 D0
еееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееебеееббГббИ
HтрIy:Zdј<^^^^^^^^^^^^ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;This is the program by Dr Lee of Peterborough
; which appeared in the December  1980 edition
; of Computer Age. It is a method of transferring
; files between CP/M computers. Documentation is
; contained in the article "Transferring Files
; between two CP/M Machines". What makes it so
; cunning is the fact that the program needs only
; to be in the receiving computer as it uses
; the dump utility. Limitations include the
; fact that the transmitted program must be
; smaller than memory and the dump program
;must be altered if your list device is parallel
;and not serial     A.R.M.C. 1/5/81

        ORG        100H
 HIGMEM   EQU      32         ;POSITION IN MEMORY
                              ;TO PLACE PROGRAMME

;         ****** INSERTED USART ROUTINE ******
; (this initialises an U8251 on ports 7DH & 7CH
; not part of original programme. set to talk
; to a Horizon. Butcher this to suit)

          MVI      A,0D0H
          OUT      7DH
          NOP
          NOP
          NOP
          NOP
          NOP
          NOP
          OUT      7DH
          NOP
          NOP
          NOP
          NOP
          NOP
          NOP
          OUT      7DH
          NOP
          NOP
          NOP
          NOP
          NOP
          NOP
          MVI      A,40H
          OUT      7DH
          NOP
          NOP
          NOP
          NOP
          NOP
          NOP
          MVI      A,0CEH
          OUT      7DH
          NOP
          NOP
          NOP
          NOP
          NOP
          NOP
          MVI      A,37H
          OUT      7DH
          NOP
          NOP
          NOP
          NOP
          NOP
          NOP
          MVI      A,05H
          OUT      78H
          NOP
          NOP
          NOP
          MVI      A,01H
          OUT      78H      ;SET BAUD RATE
          
;		   The original program continues from now


 BASE     EQU      HIGMEM*1024
          LXI      SP,BASE
          LXI      D,SIGNON
          MVI      C,9
          CALL     5
          JMP      BASE

 SIGNON:  DB       26,'TO USE THIS PROGRAMME:',0DH,0AH
          DB       'CONNECT CROSSED LEAD FROM '
          DB       'RECEIVING COMPUTERS READER',0DH,0AH
          DB       'PLUG TO OTHER COMPUTERS '
          DB       'PRINTER PLUG .',0DH,0AH
          DB       'ON THE OTHER MACHINE TYPE:',0DH,0AH
          DB       'DUMP FILENAME.COM',0DH,0AH
          DB       'FOLLOWED BY CONTROL P AND '
          DB       'RETURN',0DH,0AH,0AH,'$'
          ORG      BASE

          LXI      H,100H
 ST:      PUSH     H
 START:   CALL     READER    ;GET CHARACTER

          CPI      '>'       ;CHECK FOR TERMINATOR
          JZ       DONE      ;IF SO,JOB DONE
          CPI      020H
          JNZ      START     ;LOOP FOR SPACE
 
          MVI      B,16      ;BYTES PER LINE
          POP      H
 LOOP:    PUSH     B
          PUSH     H
          CALL     GETBYTE
          PUSH     PSW       ;SAVE IT
   
          CALL     READER    ;READ READER (SPACE OR TAB )
          MOV      E,A       ;SAVE IN E

          POP      PSW       ;RESTORE DATA
          POP      H         ;RESTORE POINTER
          MOV      M,A       ;PUT DATA IN RAM
          INX      H         ;BUMP POINTER
          POP      B         ;RESTORE COUNT
          DCR      B
          JNZ      LOOP      ;MORE DATA ON LINE
          MOV      A,E       ;RESTORE CR
          CPI      0DH       ;CHECK CORRECT
          JZ       ST        ;KEEP GOING
          LXI      D,MESSCR
          JMP      PRINT

 
MESSSAV:  DB       0DH,'TRANSFER FINISHED - '
          DB       'NO ERRORS DETECTED',0DH,0AH
          DB       'TYPE SAVE 00'
 NUM:     DB       '0 FILENAME.COM AND '
          DB       'PRESS RETURN',0DH,0AH,'$'
MESSCR:   DB       0DH,0AH,'ERROR - '
          DB       'BYTES DROPPED',0DH,0AH,'$'
MESSWR:   DB       0DH,0AH,'ERROR - '
          DB       'INVALID CHARACTER',0DH,0AH,'$'

 DONE:    POP      H         ;RESTORE POINTER
          DCX      H
          MOV      B,H       ;NO. OF RECORDS TO B
 COUNT:   LXI      H,NUM     ;POINT TO 000
                             ;IN PRINT STRING
 C1:      MOV      A,M       ;GET DIGIT
          INR      A         ;INCREMENT IT
          MOV      M,A       ;PUT IT BACK
          CPI      '9'+1
          JNZ      CONT      ;LOOP IF 9 OR LESS
          MVI      M,'0'     ;SET DIGIT TO ZERO
          DCX      H
          JMP      C1        ;INCREMENT NEXT DIGIT

 CONT:    DCR      B         ;ONE LESS RECORD
          JNZ      COUNT     ;NOT YET FINISHED

                             ;SET LEADING ZEROS
                             ;TO SPACES
          LXI      H,NUM-2
          MVI      A,'0'
 ZERO:    CMP      M         ;IS DIGIT ZERO?
          JNZ      PRIN      ;NOT A ZERO

          MVI      M,' '     ;SET ZERO TO SPACE
          INX      H
          JMP      ZERO      ;REPEAT

 PRIN:    LXI      D,MESSSAV ;MESSAGE 'TYPE SAVE'
 PRINT:   MVI      C,9
          CALL     5         ;PRINT MESSAGE
          JMP      0         ;BYE,BYE!

 ;            **SUBROUTINE TO GET ONE DATA BYTE**

 GETBYTE: CALL     GETHEX    ;GET FIRST NIBBLE
          ADD      A
          ADD      A
          ADD      A
          ADD      A         ;X 16
          PUSH     PSW       ;SAVE IT
          CALL     GETHEX    ;GET NEXT NIBBLE
          MOV      B,A       ;NEW NIBBLE TO B
          POP      PSW       ;OLD TO A
          ADD      B         ;ADD TOGETHER
          RET
 
;    **SUBROUTINE TO TURN ASCII CHAR TO BIN NIBBLE**

 GETHEX:  CALL     READER    ;READ CHARACTER
          ANI      07FH      ;STRIP PARITY
          CPI      030H
          JM       INVALID   ;CHAR < '0'
          SBI      030H
          CPI      10
          RM                 ;RETURN VALID 0-9
          CPI      'A'-030H-10
          JM       INVALID   ;'9' < CHAR < 'A'
          SBI      'A'-10-030H
          CPI      10H
          RM                 ;RETURN VALID A-F

                             ;CHAR > 'F'

                             ;INVALID CHARACTER
 INVALID: LXI      D,MESSWR
          JMP      PRINT     ;PRINT ERROR MESSAGE

; Thr following subroutine is altered from original
; and should be butchered to suit
                             ;SUBSTITUTE TO READ
                             ;A CHARACTER FROM READER
                             ;ND ECHO ON CONSOLE
READER:   IN      7DH        ;INPUT FROM SERIAL STATUS
          ANI     02         ;READY?
          JZ      READER     ;IF NOT THEN POLL
          IN      7CH        ;THEN READ PORT
          ANI     7FH        ;AND STRIP OFF PARITY



 ; **IF YOU HAVE A CP/M READER DEVICE REPLACE **
 ; **PREVIOUS ROUTINE WITH CODE TO READ THE   **
 ; **READER DEVICE, IE                        **
 ;READER: MVI      C,3       ;FDOS CALL TO READER
 ;	  CALL	   5	     ;AND DO IT


          PUSH     PSW       ;SAVE CHAR
          MOV      E,A
          MVI      C,2
          CALL     5         ;PRINT ON CONSOLE
          POP      PSW       ;RESTORE CHAR
          RET
          END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 
	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя   AP 

                                                                                            		яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее








	; ***********************************************
	; *						*
	; *		DIRDUMP VERSION 1.0		*
	; *						*
	; ***********************************************


PAGE



	; THIS PROGRAM CAN BE USED TO PROVIDE A COMPLETE DIRECTORY
	; DUMP OF A CP/M VERSION 2 DISK. THE DIRECTORY ENTRIES ARE
	; GROUPED UNDER THEIR USER NUMBERS. 

	; THE ORIGINAL USER PARTITION IS RESTORED AFTER USE, AS IS
	; THE ORIGINAL DRIVE.

	; IF THE DRIVE CODE IS OMMITED, THE CURRENT DRIVE IS ASSUMED.


	; FORMAT OF COMMAND:

	; DIRDUMP [<DRIVE NAME>][*]<CR>

	; WHERE <DRIVE NAME> IS A SINGLE LETTER (A TO P) FOLLOWED BY
	; A COLON, <CR> IS A CARRIAGE RETURN, AND ITEMS ENCLOSED IN
	; SQUARE BRACKETS ARE OPTIONAL AND MAY APPEAR IN ANY ORDER.

	; IF THE DRIVE NAME  IS OMMITED, THE CURRENTLY LOGGED DRIVE IS
	; ASSUMED.

	; IF THE ASTERISK IS PRESENT, THE OUTPUT IS DIRECTED TO THE
	; SYSTEM LIST DEVICE, OTHERWISE THE OUTPUT IS DIRECTED TO THE
	; SYSTEM CONSOLE DEVICE. NOTE THAT THE PARAMETERS CAN BE SPACED
	; APART TO MAKE THEM MORE READABLE.

	; FOR INSTANCE
	; DIRDUMP * C:<CR>
	; WOULD DUMP DIRECTORY OF DRIVE C TO THE PRINTER



PAGE

	; EQUIVALANCE TABLE:
	; =========== ======


BDOS		EQU 5		; BDOS ENTRY POINT
CONOUT		EQU 2		; CONSOLE OUTPUT FUNCTION CODE
LIST		EQU 5		; LIST OUTPUT FUNCTION CODE
SEARCH$FIRST	EQU 17		; SEARCH FOR FIRST FUNCTION CODE
SEARCH$NEXT	EQU 18		; SEARCH FOR NEXT FUNCTION CODE
GET$VERS	EQU 12		; RETURN VERSION NUMBER FUNCTION CODE
GET$USR		EQ 32		; GET/SET USR NUMBER FUNCTION CODE
SET$USR		EQU GET$USR
OP$MESS		EQU 9		; PRINT MESSAGE CODE
SET$DMA		EQU 26		; SET DMA BUFFER ADDRESS

SPACE		EQU 20H		; ASCII SPACE CODE

COMND$TAIL	EQU 80H		; ADDRESS OF DEFAULT DMA BUFFER


PAGE

	; CODE SECTION
	; ==== =======

	ASEG

	ORG	100H		; SET TO START OF TPA


	LXI	H,0		; CLEAR HL
	DAD	SP		; GET SP VALUE

	SHLD	OLD$STK		; SAVE IT

	LXI	SP,NEW$STK	; INITIATE NEW STACK

	LXI	D,SIGNON	; POINT TO SIGN ON MESSAGE
	MVI	C,OP$MESS	; SET BDOS CALL CODE

	CALL	BDOS		; GIVE A MESSAGE


	; STAGE 1:-
	; MAKE SURE WE ARE UNDER VERSION 2.0 OR GREATER.

	MVI	C,GET$VERS	; FIND OUT VERSION
	CALL	BDOS		; BY A BDOS CALL

	MOV	A,H		; IF (HL)=0 THEN WE ARE UNDER 1.4 OR EARLIER
	ORA	L
	JNZ	START		; IF MP/M OR CP/M V2.0+ THEN CONTINUE

	LXI	D,BAD$VERS	; POINT TO MESSAGE
	MVI	C,OP$MESS	; SET O/P MESSAGE CODE
	CALL	BDOS		; AND GO DO IT.

BAD$EXIT:
	LHLD	OLD$STK		; RESTORE CCP STACK
	SPHL

	RET			; AND RETURN TO CCP

BAD$VERS:

	DB	0AH,0DH
	DB	'NEEDS MP/M OR CP/M V2.0+ TO OPERATE'
	DB	0AH,0DH,7,'$'


SIGNON:
	DB	0AH,0DH
	DB	'DIRDUMP VERSION 1.0'
	DB	0AH,0DH
	DB	'======= ======= ==='
	DB	0AH,0AH,0AH,0DH,'$'


START:
	; STAGE 2:-
	; FIND OUT WHICH USER PARTITION WE ARE CURRENTLY IN AND
	; SAVE THE RESULT

	MVI	C,GET$USR	; FIND USER CODE
	MVI	E,-1		; REQUIERS 0FFH IN REG E
	CALL	BDOS

	STA	OLD$USR		; SAVE IT

	; STAGE 3:-
	; TEST THE COMMAND TAIL WHICH CP/M HAS SET UP FOR US IN
	; THE DEFAULT DMA BUFFER AT 80H. IF THE TAIL IS VALID
	; THEN WE CONTINUE, ELSE WE PRINT A MESSAGE AND EXIT.

	LXI	H,COMND$TAIL	; POINT TO DMA BUFFER

	MOV	A,M		; SHOULD BE A COUNT
	ORA	A		; IF ZERO THEN USE DEFAULT DRIVE
	JZ	DEFLT
LOOP1:
	INX	H		; ELSE FIND DRIVE NAME
	MOV	A,M		; GET CHARATER
	CPI	0		; ZERO=END OF MESSAGE- USE DEFAULT DRIVE
	JZ	DEFLT
	CPI	SPACE		; IGNORE SPACES
	JZ	LOOP1

	; AT THIS POINT WE SHOULD HAVE EITHER A DRIVE NAME
	; OR AN ASTERISK IN REGISTER A. IF IT IS A DRIVE NAME
	; THEN WE MUST TEST THAT IT IS VALID.
	; AND IF IT IS NOT, THEN WE TERMINATE THE PROGRAM.

	CPI	'*'		; TEST IF PRINT MARKER
	JZ	OP$PRINT	; YES- LEAP AWAY

	; ITS A DRIVE NAME 

	SUI	'A'		; TEST IF LESS THAN 'A'
	JC	DERROR		; IF SO THEN TERMINATE

	CPI	'Q'-'A'		; TEST IF GREATER THAN 'P'
	JNC	DERROR		; TERMINATE IF SO.

	INR	A		; ADJUST TO BDOS EXPECTED VALUE
	STA	DRIVE		; SAVE IN F.C.B. DRIVE AREA

	INX	H		; POINT TO NEXT CHARACTER IN COMMAND TAIL.
	MOV	A,M		; IT SHOULD BE A COLON
	CPI	':'
	JNZ	DERROR		; IF NOT THEN ERROR
LOOPX:
	INX	H		; PROCESS THE REST OF THE COMMAND TAIL
	MOV	A,M
	ORA	A		; TEST FOR END OF COMMAND TAIL
	JZ	DEFLT		; GOOD. CONTINUE EXECUTION
	CPI	SPACE		; IS IT A SPACE?
	JZ	LOOPX		; YES- IGNORE IT

	CPI	'*'		; PRINT MARKER?
	JZ	OP$PRINT	; YES- PROCESS IT

DERROR:
	; IF WE GET TO THIS POINT, THERE WAS AN ERROR IN
	; THE COMMAND TAIL. THIS COULD BE AN INVALID
	; DRIVE NAME OR AN INVALID CHARACTER.

	LXI	D,BAD$TAIL	; POINT TO MESSAGE
	MVI	C,OP$MESS	; SET MESSAGE OUTPUT CODE
	CALL	BDOS		; DO IT.

	JMP	BAD$EXIT	; EXIT TO CCP

BAD$TAIL:
	DB	0AH,0DH
	DB	'INVALID COMMAND TAIL -- OPERATION ABORTED'
	DB	0AH,0DH,7,'$'


OP$PRINT:
	; THE PRINT COMMAND HAS BEEN RECOGNISED IN THE COMMAND TAIL.
	; WE NOW SET THE LOCATION 'PRINT$DEVICE' TO CONTAIN THE
	; BDOS CODE FOR LIST OUTPUT (SEE ROUTINE 'PRINT' FOR DETAILS)

	LDA	PRINT$DEVICE	; TEST IF ALREADY MARKED
	CPI	LIST		; WILL BE SET TO 'LIST' IF SO
	JZ	DERROR		; MARK COMMAND ERROR ALREADY SET TO 'LIST'

	MVI	A,LIST
	STA	PRINT$DEVICE	; SAVE IN RAM
	JMP	LOOP1		; PROCESS THE REST OF THE COMMAND TAIL



 
PAGE

DEFLT:

	; STAGE 4:-
	; THE COMMAND TAIL HAS NOW BEEN PROCESSED, ALL THAT
	; WE HAVE TO DO NOW, IS TO SEARCH THE DIRECTORY UNDER
	; EACH USER CODE AND SAVE THE RESULTS IN A BUFFER.

	; WHEN THE BUFFER IS  FULL, WE PRINT IT. WE DO THIS UNTIL
	; THERE ARE NO MORE MATCHES UNER USER 15. THEN WE PERFORM
	; A WARM BOOT TO CP/M

	LXI	D,DMA$BUFF	; POINT TO NEW DMA BUFFER
	MVI	C,SETDMA	; CALL CODE
	CALL	BDOS

	XRA	A		; START IN USER PARTITION 0
	DCR	A
	STA	USER$NO		; SAVE IT

LOOP2:
	LDA	USER$NO
	CPI	15		; TEST IF WE HAVE JUST PROCESSED USER 15
	JZ	GOOD$EXIT	; YES- EXIT

	INR	A		; MARK AND SELECT NEXT USER PARTITION
	STA	USER$NO		; MARK

	MOV	E,A		; CODE TO E
	MVI	C,SET$USR	; CALL FUNCTION TO C
	CALL	BDOS		; SET USER PARTITION

	LXI	H,USER$MESS	; POINT TO USER NUMBER MESSAGE
	XRA	A		; INDICATE TO ADDBUFF THAT (HL) POINTS TO MESS.
	CALL	ADDBUFF		; ADD MESSAGE TO PRINT BUFFER

	LXI	H,NUMBERS	; POINT TO USER NUMBER ASCII TABLE

	LDA	USER$NO		; GET USER NUMBER
	ORA	A		; CLEAR THE CARRY FLAG

	RAL			; *2
	RAL			; *4 (BECAUSE EACH ENTRY IS 4 CHARS LONG)

	ADD	L		; ADD IN TO TABLE BASE ADDRESS
	JNC	$+4
	INR	H
	MOV	L,A		; (HL) POINTS TO USER NUMBER IN ASCII

	XRA	A		; MARK MESSAGE TO ADDBUFF

	CALL	ADDBUFF		; AND ADD TO PRINT BUFFER

	LXI	H,CRETS		; PONT TO CARRIAGE RETURNS
	CALL	ADDBUFF		; (A) IS ALREADY 0

	; NOW WE SET UP AND POINT TO THE FCB AND SEARCH FOR ANY MATCH


	LXI	D,FCB		; POINT TO FCB
	MVI	C,SEARCH$FIRST	; SET FUNCTION CODE
	CALL	BDOS

	INR	A		; TEST IF A MATCH HAS OCCURED
	JZ	EMPTY$USR	; NO- THIS PARTITION IS EMPTY

	DCR	A		; COLLECT THE FILENAME FROM THE DMA BUFFER
	ORA	A		; CLEAR THE CARRY FLAG
LOOP5:
	RAL			; (A)=(A)*2
	RAL			; 	 *4
	RAL			; 	 *8
	RAL			; 	 *16
	RAL			;	 *32

	LXI	H,DMA$BUFF	; POINT TO DMA BUFFER

	ADD	L		; ADD IN POSITIONAL OFFSET
	JNC	$+4		; IF NO CARRY THEN DO NOT INCREMENT H
	INR	H
	MOV	L,A		; (HL) POINTS TO MATCHED ENTRY IN BUFFER

	XRA	A		; INDICATE (HL) = FILENAME POINTER TO ADDBUFF
	INR	A
	CALL	ADDBUFF		; AND ADD IT TO PRINT BUFFER

	LXI	D,FCB		; POINT TO FCB
	MVI	C,SEARCH$NEXT	; SET FUNCTION CODE
	CALL	BDOS

	INR	A		; TEST IF MATCH DECLARED
	JZ	LOOP2		; NO- CHANGE USER PARTITION

	DCR	A		; MATCH DECLARED - ADD TO PRINT BUFFER
	ORA	A		; CLEAR THE CARRY FLAG
	JMP	LOOP5


USER$MESS:

	DB	0AH,0DH
	DB	'         Directory for user partition $'

NUMBERS:
	DB	'0: $'
	DB	'1: $'
	DB	'2: $'
	DB	'3: $'
	DB	'4: $'
	DB	'5: $'
	DB	'6: $'
	DB	'7: $'
	DB	'8: $'
	DB	'9: $'
	DB	'10:$'
	DB	'11:$'
	DB	'12:$'
	DB	'13:$'
	DB	'14:$'
	DB	'15:$'

CRETS:
	DB	0DH,0AH,0AH,'$'



PAGE


EMPTY$USR:
	; USER PARTITION IS EMPTY, SO WE PUT A MESSAGE TO SAY THIS IN
	; THE PRINT BUFFER.

	LXI	H,EMPTY$MESS	; POINT TO MESSAGE
	XRA	A		; MARK AS MESSAGE
	CALL	ADDBUFF		; ADD TO PRINT BUFFER

	JMP	LOOP2		; AND PROCESS NEXT USER PARTITION


EMPTY$MESS:
	DB	'             <<< PARTITION EMPTY >>>'
	DB	0AH,0DH,'$'



GOOD$EXIT:
	; EXIT FROM HERE WHEN WE HAVE FINISHED THE DUMP

	LXI	H,ENDMESS	; POINT TO MESSAGE
	XRA	A		; MARK AS MESSAGE
	CALL	ADDBUFF		; ADD TO BUFFER

	CALL	PRINT		; EMPTY THE BUFFER

	LDA	OLD$USR		; RESTORE ORIGINAL PARTITION
	MOV	E,A
	MVI	C,SET$USR
	CALL	BDOS

	JMP	0		; AND WARM BOOT TO CP/M


ENDMESS:
	DB	0AH,0AH,0DH
	DB	'            <<< END OF DIRECTORY >>>'
	DB	0AH,0DH
	DB	'$'


PAGE

ADDBUFF:
	; THIS ROUTINE ADDS INFORMATION TO THE PRINT BUFFER.
	; IF THE BUFFER IS FULL, IT IS PRINTED AND EMPTIED BEFORE
	; RETURNING TO THE CALLING ROUTINE

	; ON ENTRY:

	; (HL) IS EITHER A POINTER TO A MESSAGE TERMINATED WITH A '$'
	; OR A POINTER TO A BDOS MATCHED DIRECTORY ENTRY.

	; (A) IS EITHER 0 OR NOT 0.
	; IF (A)=0 THEN (HL) IS A MESSAGE POINTER
	; IF (A)= NOT 0 THEN (HL) IS A DIRECTORY MATCH POINTER

	; ON EXIT:
	; NO PARAMETERS

	; REGISTERS AFFECTED:
	; NONE


	PUSH	H		; SAVE STATUS
	PUSH	D
	PUSH	B
	PUSH	PSW

	XCHG			; PUT POINTER INTO DE
	ORA	A		; TEST IF MESSAGE
	JZ	ADDMESS		; YES- GO DO IT

	; IF WE GET TO THIS POINT, WE HAVE A DIRECTORY MATCH AT (DE)

	LHLD	BUFF$PTR	; GET BUFFER POINTER

	LDA	COLUMN		; TEST IF COLUMN IS ZERO
	ORA	A
	JZ	ADD$DIR		; YES- DONT INSERT FNAME SEPERATOR

	MVI	C,3		; SET COUNT
	MVI	M,SPACE
	INX	H
	DCR	C
	JNZ	$-4		; SPACE FILL

	MVI	M,':'		; SEPERATOR
	INX	H

	MVI	C,3		; SET COUNT
	MVI	M,SPACE
	INX	H
	DCR	C
	JNZ	$-4		; SPACE FILL
ADD$DIR:
	INX	D		; POINT TO FILENAME
	MVI	C,8		; SET A COPY COUNT

LOOP6:
	LDAX	D		; GET BYTE
	MOV	M,A		; COPY TO BUFFER

	INX	H
	INX	D		; UP THE POINTERS
	DCR	C		; DOWN THE COUNT
	JNZ	LOOP6		; COPY ALL

	MVI	M,'.'		; DOT TO EXTENSION
	INX	H

	MVI	C,3		; SET COUNT
LOOP7:
	LDAX	D		; GET BYTE
	MOV	M,A		; SAVE IT

	INX	H		; UP POINTERS
	INX	D
	DCR	C		; DOWN COUNT

	JNZ	LOOP7		; COPY ALL


	LDA	COLUMN		; TEST IF CR/LF NEEDED.

	INR	A		; INCREMENT TO NEXT
	STA	COLUMN		; SAVE COLUMN NUMBER

	CPI	4		; PUT CR/LF AT END OF FOURTH COLUMN
	JNZ	ADD$EXIT	; EXIT IF NOT

	MVI	M,0DH		; SET CARRIAGE RETURN CODE
	INX	H
	MVI	M,0AH		; SET LINE FEED CODE

	XRA	A		; SET COLUMN ZERO
	STA	COLUMN

	INX	H		; MARK NEXT FREE BYTE OF PRINT BUFFER
	JMP	ADD$EXIT


ADD$EXIT:
	SHLD	BUFF$PTR	; AND SAVE BUFFER POINTER

	XCHG			; PUT POINTER TO DE
	LHLD	BDOS+1		; GET TOP OF MEMORY VALUE FROM BDOS JUMP

	LXI	B,(NOT 200)+1	; DO NOT ALLOW BUFFER TO OVER-RUN AVAILABLE RAM
	DAD	B

	; (HL)=MEMTOP - 200
	; (DE)=TOP OF PRINT BUFFER

	MOV	A,L		; SUBTRACT (DE) FROM (HL)
	SUB	E		; AND PUT RESULT INTO HL
	MOV	L,A
	MOV	A,H
	SBB	D
	MOV	H,A		;  IF CARRY IS SET THEN WE MUST PRINT THE BUFF.

	CC	PRINT

	POP	PSW		; RESTORE STATUS
	POP	B
	POP	D
	POP	H
	RET			; RETURN TO CALLER


ADD$MESS:
	; (DE) IS A MESSAGE POINTER

	LHLD	BUFF$PTR	; GET BUFFER POINTER TO HL
LOOP8:
	LDAX	D		; GET BYTE OF MESSAGE
	CPI	'$'		; TEST FOR TERMINATOR
	JZ	ADM1		; YES- EXIT LOOP

	MOV	M,A		; SAVE THE CHARACTER
	INX	H
	INX	D		; UP THE POINTERS
	JMP	LOOP8		; COPY WHOLE MESSAGE

ADM1:
	XRA	A		; SET COLUMN 0
	STA	COLUMN
	JMP	ADD$EXIT	; EXIT


PAGE



PRINT:
	; THIS ROUTINE PRINTS OUT THE BUFFER AND RESETS THE BUFFER POINTER
	; TO START OF BUFFER

	; ON ENTRY:

	; END OF BUFFER STORED IN 'BUFF$PTR'
	; DESTINATION FOR OUTPUT GIVEN BY 'PRINT$DEVICE'
	; WHICH HOLDS THE BDOS CALL CODE FOR EITHER CONOUT
	; OR LIST


	; ON EXIT:

	; 'BUFF$PTR' SET TO START OF BUFFER

	; REGISTERS AFFECTED:
	; ALL


	LHLD	BUFF$PTR		; GET BUFFER POINTER
	LXI	D,BUFFER		; SUBTRACT BUFFER START FROM IT
	MOV	A,L			; & PUT RESULT INTO DE
	SUB	E
	MOV	E,A
	MOV	A,H
	SBB	D
	MOV	D,A

	LXI	H,BUFFER		; POINT BUFF$PTR TO START OF BUFF
	SHLD	BUFF$PTR

	; (DE) = COUNT
	; (HL) = BUFFER POINTER

LOOP9:
	MOV	A,D			; TEST IF COUNT=0
	ORA	E
	RZ				; YES- RETURN TO CALLER

	PUSH	H			; SAVE (DE) & (HL)
	PUSH	D

	MOV	E,M			; CHARACTER TO E
	LDA	PRINT$DEVICE		; GET CALL CODE FOR RELEVANT DEVICE
	MOV	C,A			; SET CALL CODE TO BDOS

	CALL	BDOS			; PRINT CHARACTER

	POP	D
	POP	H			; RESTORE COUNT AND POINTER

	DCX	D			; DECREMENT COUNT
	INX	H			; INCREMENT POINTER
	JMP	LOOP9			; CONTINUE FOR ALL


PAGE
	; FILE CONTROL BLOCK
	; ==== ======= =====

FCB:
DRIVE:		DB 0		; USE DEFAULT UNLESS SPECIFIED
FNAME:		DB '????????'	; WILDCARD FOR ANY FILENAME
FEXT:		DB '???'	; OR EXTENSION
	REPT 24
		DB 0
	ENDM


PAGE


	; DATA AREA
	; ==== ====

DMA$BUFF:	DS 128D		; BUFFER IS 128 BYTES LONG
OLD$STK:	DS 2		; CCP STACK POINTER SAVE AREA
		DS 100H		; NEW STACK SAVE AREA
NEW$STK:			; WHICH GOES BACKWARDS, REMEMBER.
OLD$USR:	DS 1		; USER PARTITION ON ENTRY TO THIS PROGRAM
USER$NO:	DB 0		; USER AREA UNDER SEARCH
COLUMN:		DB 0		; INITIALLY COLUMN 0 ON SCREEN
PRINT$DEVICE	DB CONOUT	; DEFAULT IS OUTPUT TO CONSOLE
BUFF$PTR:	DW BUFFER	; INITIALLY START OF BUFFER
BUFFER:		DB 0		; REST OF AVAILABLE RAM IS BUFFER

	END	100H


	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	
яяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееЙХЙ
        PROGRAM DIS to disassemble programs
        COPYWRITE D. POWYS-LYBBE 15 FEB 1980
        MML, 11 SUN STREET, LONDON. E.C.2.

        Program reads .COM file and forms a .DIS file

!  9"й
1h! !"е
!e 6C#6O#6M\ Н юяВь	Н Гz
*е
лН \ Н ·Вd*е
Ђ 	"е
ГяNEW .COM FILE
$ams*е
"/л  {‘ozg"1л6 #q#p#6#s#r#6 #s#rЙ  ?$
Add entry point (0000 to quit): $
$НЎ€Н•Й	Н ЙbН•eН•>2a!_#Н4ИТйyюPКПюNКФюWКЩюTКЮГ›>Гг>@Гг>HГг>DГг2aГ¬WН4Ъ›Вэz·ИГ›‚wW+Н4Ъ›Кч_Н4Ъ›В {·КчГ›ѓwВ'‚И_:aGНgГЎеХН ·К6Н СбюИжOюAТXЦ0Шю
?Йж_OЦAШЖ
ю?Й—2з
Н
Н3Н‹*/~ю К‹жВ…###ГtНАГq*/~ю КИжВџ###ГЋНRГq	ORG	0
BASE:	EQU	$
	ORG	00100H
 —2з
*/е!ҐНе	б~ю Кf
#юЂКю‚Кю@КтюHК2юJКWю К“юКTюК;юК"юКwНґ
ГЧН¦ГН«НДНтКЅН	НРЪ·Вj:и
·ВЧ~юЂКЧю‚КЧю КdюКdюКGж@GВdНґ
ГЧНЉ
Г:и
·КwНґ
ГЧ~юКюК±ю К±ю К’Нґ
ГНґ
ГЧеХ#лХНY	СНќ>0Нп	Н^	НФ	Сб###Г-НЯ	Г"НЯ	Гш^#V#е!  лбЙе#N#F!  	DMбzё{ША№ЙDW	0 DB	0 DW	X Н«НДНРеХНСВ—„ВҐ…=ВҐбе!иНе	бН€	НФ	НРЪ,КЧНґ
ГЧНЯ	ГыН«НДНРКые!гНе	бН^	НФ	НРДґ
ГЧН«НДНРКые!нНе	бН^	НФ	НРЪЌВ&~ю$КЉю*КЉГЧ###НЯ	Г]Н¦НДНРеХНСВИ>DНп	>SНп	>	Нп	|НІ	}НІ	>HНп	НФ	бГЧ—og>DНп	>BНп	>	Нп	>0Нп	Н°	>HНп	НЬКТЧ
#}юКя>,Нп	ГЪНФ	НЯ	ГИНФ	бГЧ.& ·АНЬИ#ЪГЧ
елХНY	СН‹>0Нп	Н^	НФ	бГjелХНY	СНќ>0Нп	Н^	НФ	бГjелХНn	СНќ>0Нп	Н€	НФ	б##ГЧORG	$
 Н«е!oНе	бГjBASE+ Нќе!…Не	бЙ	EQU	 е!—Не	бЙ>UГ­>XНп	ХT]Н^	С>:Нп	НЯ	Й~жцЂw#НДеХ!Љ_ FСбxжИxюККюКю#Кю1КюBКюCК*юSК4ГЧ
НgГКНg НЈЙю
ЪКХ_ НґСГК@НgГК^	еХog##"22 НgСбHНgГК~жыц
w#НДНg$НЈЙеХл^#V! НќЪЂ*1лНќТЋxю ВЋСГ›СogХлНґСбЙzјА{ЅЙе!  Х{•_zњWНґСбЙХеЕ*/~#N#F#ю КХzёЪХВє{№КсТє+r+s+PYБ—ё~pКиGЕ####N#F#ГХ+++~БёКиOжВл> Влxж Виyю К[ю$К[ю*КЖюЂК`ю‚К`ю@К¤юHК¤юDКЖюJКЖюКлюК[юКлюК[юКЊюКЊГЧ
xpГиxюКиюКиюЂКию‚К[ю@КиюHКиюDК[юJК[ГЧ
xю@КиюHКиюDКиюJКиГЧ
xюHК[ю@КиюDК[юJК[юК[юК[ГЧ
xюHКию@КиюDКиюJКиюК[юК[ГЧ
бСЙ###ЕГєеХ!Љ _~Oж 2и
yжМґ
G{СбЙеХ!Љ_ {·_zWВ	~ю К3	Нп	#В%	СбКU	КC	НY	ГU	ю
ТR	Ж0Нп	ГU	Нѓ	НФ	Й>XНп	Н°	Н°	>HНп	Й>XНп	Н°	>HНп	ю ВЧ
Й>XНп	Н°	х>HНп	сю Шю!ИюРG>;Нп	>'Нп	xНп	>'Нп	ЙЕGНВ	xНВ	xБЙжю
ЪО	Ж7ГР	Ж0Нп	Й>Нп	>
Нп	Й>	Нп	Й~#·ИНп	Ге	еХЕхW:з
!Ђ O 	ry2з
ьY
сБСбЙ!e 6D#6I#6S—#wВ
\ Н юяК8
z	Н Гz
\ Н юяВP
i	Н Гz
Ђ Н Й\ Н —2з
Й>Нп	:з
·ДY
\ Н *й
щЙ;WARN	DB
 е!
Не	бХеЕЎ
	Н БбСЙ! WARN !
$ERROR
 е!¬
Не	бХеЕЛ
	Н БбСЙ! ERROR !
$Нј
:з
ю Вf
Гk
~#·Нп	Ге	еХЕхW:з
!Ђ O 	ry2з
ьY
сБСбЙ!e 6D#6I#6S—#wВ
\ Н юяК8
z	Н Гz
\ Н юяВP
i	Н Гz
Ђ Н Й\ Н —2з
Й>НDIRECTORY FULL
$OLD .DIS FILE
$CB B CB B CSB SB CCB CB#B1 BBB BB BB1 BB BNOP BLXI	B, STAX	B INX	B BINR	B BDCR	B BMVI	B, RLC B DAD	B LDAX	B DCX	B INR	C DCR	C MVI	C, RRC  LXI	D, STAX	D INX	D INR	D DCR	D MVI	D, RAL  #BDAD	D BLDAX	D DCX	D BINR	E BDCR	E BMVI	E, RAR  B OP BLXI	H, SHLD	  INX	H BINR	H BDCR	H BMVI	H, DAA B DAD	H LHLD	  DCX	H INR	L DCR	L MVI	L, CMA  LXI	SP, STA	 D INX	SP INR	M DCR	M MVI	M, STC  #BDAD	SP LDA	 D DCX	SP INR	A BDCR	A BMVI	A, CMC  BMOV	B,B MOV	B,C MOV	B,D MOV	B,E MOV	B,H MOV	B,L MOV	B,M MOV	B,A MOV	C,B MOV	C,C MOV	C,D MOV	C,E MOV	C,H MOV	C,L MOV	C,M MOV	C,A MOV	D,B MOV	D,C MOV	D,D MOV	D,E MOV	D,H MOV	D,L MOV	D,M MOV	D,A MOV	E,B MOV	E,C MOV	E,D MOV	E,E MOV	E,H MOV	E,L MOV	E,M MOV	E,A MOV	H,B MOV	H,C MOV	H,D MOV	H,E MOV	H,H MOV	H,L MOV	H,M MOV	H,A MOV	L,B MOV	L,C MOV	L,D MOV	L,E MOV	L,H MOV	L,L MOV	L,M MOV	L,A MOV	M,B MOV	M,C MOV	M,D MOV	M,E MOV	M,H MOV	M,L HLT D,M MOV	M,A MOV	A,B MOV	A,C MOV	A,D MOV	A,E MOV	A,H MOV	A,L MOV	A,M MOV	A,A ADD	B B ADD	C C ADD	D D ADD	E E ADD	H H ADD	L L ADD	M M ADD	A A ADC	B B ADC	C C ADC	D D ADC	E E ADC	H H ADC	L L ADC	M M ADC	A A SUB	B B SUB	C C SUB	D D SUB	E E SUB	H H SUB	L L SUB	M M SUB	A A SBB	B B SBB	C C SBB	D D SBB	E E SBB	H H SBB	L L SBB	M M SBB	A A ANA	B B ANA	C C ANA	D D ANA	E E ANA	H H ANA	L L ANA	M M ANA	A A XRA	B B XRA	C C XRA	D D XRA	E E XRA	H H XRA	L L XRA	M M XRA	A A ORA	B B ORA	C C ORA	D D ORA	E E ORA	H H ORA	L L ORA	M M ORA	A A CMP	B B CMP	C C CMP	D D CMP	E E CMP	H H CMP	L L CMP	M M CMP	A A RNZ B B POP	B C JNZ	  D JMP	  E CNZ	  H PUSH	B  ADI	  M RST	0 A RZ 	B B RET C C JZ	 D D  RA	E E CZ	 H H CALL	 L ACI	  M RST	1 A RNC B B POP	D C JNC	  D OUT	  E CNC	  H PUSH	D  SUI	  M RST	2 A RC 	B B  MP	C C JC	 D D IN	 E E CC	 H H  MP	L L SBI	  M RST	3 A RPO B B POP	H C JPO	  D XTHL  E CPO	  H PUSH	H  ANI	  M RST	4 A RPE B B PCHL  C JPE	  D XCHG  E CPE	  H  ALL	 L XRI	  M RST	5 A RP  B B POP	PSW JP	   D DI 	  E CP	   H PUSH	PSWORI	  M RST	6 A RM 	B B SPHL  C JM	 D D EI  E E CM	 H H  MP	L L CPI	  M RST	7 A                                                                                                                       ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееMICROPLAN                                        MML Ltd.
=========                                        11 Sun Street
                                                 London E.C.2.
                                                 Tel: 01-247 0691
COPYRIGHT JULY 1980

------------------------------------------------------------------

			DIS
			===

Program DIS disassembles a .COM file into a .DIS file which may be
subsequently assembled.
The DIS file has the following features:
1.	All branch points are provided with a label
2.	Where permitted data blocks are split into DB, DW & DS
3.	All references before 0100H and after program are
	EQUATE statements
4.	Any unresolved block commences with a U type label

INSTRUCTIONS
------------

The program is run by entering
A>DIS filename

The program forces type .COM for the source filename
and writes dissasembled mnemonics to file type .DIS.
The program checks for non-existance of .DIS file type.

The program then requests for additional program entry points
DIS assumes that the first entry is at 0100H.

FIRST PASS
----------

In the first PASS enter 0000 and DIS will disassemble the file

In most files DIS is unable to resolve all of the .COM code and
in particular it cannot resolve the PCHL instruction.
All unresolved code will be given a label starting with a U,
and the code will be listed as a block of data.  Armed with a
list of mnemonics you should be able to establish if this unresolved
data is actually program code.

Examine the listing and see if you can decode the unresolved
areas, then destroy the .DIS file and run DIS again.

SECOND & SUBSEQUENT PASSES
--------------------------

On the second and subsequent passes, you may assist the disassembly
by entering the additional program entry points when
requested.  You may also notify DIS of other types of
code by preceeding the address with one of the folloing:

1.	P	Progam entry point (default)
2.	N	Data numeric entry point
3.	W	Data word address
4.	T	Data table of program jump address

The last type (T) is normally used by a PCHL instruction in
using a lookup table. It assumes the table is contiguous words
of program entry points.

Example
ADD ENTRY POINT (0000 TO QUIT): 02DA
ADD ENTRY POINT (0000 TO QUIT): T2F8C
ADD ENTRY POINT (0000 TO QUIT): 0000

ERRORS
------

A) FATAL ERRORS
   A fatal error occurs with an ERROR message on the terminal and
   the program terminates.
   This is normally caused by an eroneous instruction in the
   ADD ENTRY POINT address
   The solution is to recheck your entry points and re-run after
   erasing the .DIS file

B) SYNTAX ERRORS
   Other errors occur when there is a conflict between address
   references.  The .DIS file is marked with an ERROR message.
   Minor conflicts result in a WARN message.


ASSEMBLY SOURCE CODE
--------------------

Finally when you have resolved all blocks of the code,
PIP an .ASM file.

Using the editor check for the following:

1.	Any ERROR or WARN message produced by DIS
2.	Check if LXI instruction is referencing
	a) address (default)
	b) constant
	In the latter case change the address to a constant

The .ASM file is now suitable for modification

For use in MPM, the DIS produces the BASE bias for relocation
at a different address, and so long as all the constants in 2b
above have been resolved, the .ASM file can be used to produce
a reliable page relocatable file.

==============================================================
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1
;DUMB COPY ROUTINE
;=================
;
;BY DEREK FORDRED, 11 APRIL 1981
;MODIFIED TO MAKE IT INDEPENDENT OF THE
;SD SYSTEMS VERSAFLOPPY AS ORIGINALLY
;WRITTEN. BY ANDREW CLARKE, 11 MAY 1981
;
;THE FREE MEMORY CALCULATING ROUTINE IS 
;TAKEN FROM MFT.ASM (DR.DOBB'S).
;THE OPERATION OF THE PROGRAM IS SIMILAR TO MFT.
;EXCEPT THAT NO FILENAME IS REQUIRED WHEN
;RUNNING THE PROGRAM.
;
;NON-CPM DISKETTES CAN BE COPIED, AS LONG AS
;THEY ARE FORMATTED TO SUIT YOUR CONTROLLER
;
;
BDOS	EQU	5	;BDOS ENTRY POINT
CR	EQU	0DH
LF	EQU	0AH
NSECTOR	EQU	26	;NUMBER OF SECTORS TO TRACK
NBYTES	EQU	128	;NO.OF BYTES PER SECTOR
NTRACKS	EQU	77	;NO. OF TRACKS TO DRIVE
NSECT	EQU	NSECTOR*NTRACKS
			;NO. OF SECTORS PER DISK
CPM	EQU	0000H
;
;
;
	ORG	100H
;
COPY:	LXI	SP,STKPTR
	LXI	H,MSG1	;PRINT 'COPY VER 1.2'
	CALL	WASC
	SUB	A
	STA	UNIT	;ASSUME DRIVE A

;
;CALCULATE BUFFER SIZE = FWA(BDOS)-FWA(MBUF)
;
	LHLD	BDOS+1	;HL=BDOS+1-6
	LXI	D,-6
	DAD	D
	MOV	A,L
	ANI	80H	;HL=HL MOD 128
	MOV	L,A
	LXI	D,MBUF	;HL=HL-FWA(MBUF)
	CALL	SUBTR	;SUBTRACT HL-DE
	DAD	H	;HL=HL/128
	MOV	L,H
	MVI	A,0
	ACI	0
	MOV	H,A
	DCX	H	;HL=HL-1
	SHLD	SPACE	;SAVE BUFFER SIZE
	LXI	H,MSG2	;WRITE 'BUFFER SIZE = '
	CALL	WASC
	LHLD	SPACE	;WRITE SIZE OF BUFFER
	CALL	WDWC
	LXI	H,MSG3	;WRITE ' SECTORS'
	CALL	WASC
INIT:	XRA	A
	STA	ICB
	STA	OCB
	INR	A
	STA	ICB+1
	STA	OCB+1
	LXI	H,0
	SHLD	SECTORS
;
;ASK USER TO MOUNT INPUT DISK
;
COPY1:	LXI	H,MSG4	;WRITE 'MOUNT INPUT DISK, TYPE CR'
	CALL	WASC
	CALL	RACC	;READ RESPONSE
	CPI	CR	;WAIT FOR CR
	JNZ	COPY1
	CALL	WEOLC	;ECHO CR-LF
;
;
READ:	LDA	ICB	;INPUT DISK
	STA	TRK	;TRACK NUMBER
	LDA	ICB+1	;SECTOR NUMBER
	STA	SCTR	;
	LHLD    SPACE   ; NO. OF SECTORS TO TRANSFER
	SHLD	NREC
	LXI	H,MBUF
	SHLD	TADDR
	CALL	LOADER
	LDA	TRK
	STA	ICB
	LDA	SCTR
	STA	ICB+1
;
;
COPY2:	;ASK USER TO MOUNT OUTPUT DISK
	LXI	H,MSG5
	CALL	WASC
	CALL	RACC
	CPI	CR
	JNZ	COPY2
	CALL	WEOLC	;CR,LF
;
;WRITE MEMORY IMAGE TO OUTPUT DISK
;
WRITE:	LDA	OCB	;OUTPUT DISK
	STA	TRK
	LDA	OCB+1
	STA	SCTR
	LHLD	SPACE
	SHLD	NREC
	LXI	H,MBUF
	SHLD	TADDR
	CALL	SAVER
	LDA	SCTR
	CPI	26
	JNZ	WR5
	LDA	TRK
	INR	A
	STA	TRK
	XRA	A
WR5:	INR	A
	STA	SCTR
	STA	ICB+1
	STA	OCB+1
	LDA	TRK
	STA	OCB
	STA	ICB
	CALL	MULT	;CALCULATE SECTOR NUMBER
	CALL	CHECK	;CHECK IF NEAR END OF DISK
	JNZ	COPY1	;MORE TO DO
;
;COPY COMPLETE
;
ENCOP:	LXI	H,MSG6	;END COPY MESSAGE
	CALL	WASC
	JMP	CPM	;RETURN TO CPM
	;
MSG1:	DB	'COPY VER 1.2',CR,LF,0
MSG2:	DB	'BUFFER SIZE = ',0
MSG3:	DB	' SECTORS',CR,LF,0
MSG4:	DB	'MOUNT INPUT DISK,TYPE CR',0
MSG5:	DB	'MOUNT OUTPUT DISK, TYPE CR',0
MSG6:	DB	'END OF TRANSFER',CR,LF,0
MSG7:	DB	'ERROR,OVERRUN THE DISK',CR,LF,0
;
MULT:	LHLD	OCB	;L=TRK, H=SECTOR
	PUSH	H
	MVI	H,0	;HL=TRK
	DAD	H	;HL*2
	PUSH	H	;SAVE IT
	DAD	H	;HL*4
	DAD	H	;HL*8
	PUSH	H	;SAVE IT
	DAD	H	;HL*16
	POP	D
	DAD	D	;HL*24
	POP	D
	DAD	D	;HL*26
	POP	D	;DE CONTAINS SECTOR,TRK
	MOV	E,D	;E IS SECTOR
	MVI	D,00
	DCR	E
	DAD	D	;TOTAL SECTORS IN HL
	RET
;
;
CHECK:	CALL	WDWC	;PRINT NO. OF SECTS. COPIED
	PUSH	H
	LXI	H,MSG3	;PRINT ' SECTORS'
	CALL	WASC
	POP	D
	LXI	H,NSECT	;DE CONTAINS TOTAL SECTORS
			;COPIED SO FAR
			;HL CONTAINS TOTAL SECTORS
			;ON DISKETTE.
	CALL	SUBTR	;HL-DE
	ORA	L	;SET FLAGS
	RZ		;COPY COMPLETE
;
	PUSH	H	;SAVE SECTORS LFT TO COPY
	LHLD	SPACE
	XCHG		;SPACE IN DE
	POP	H	;SECTORS TO COPY
	PUSH	H
	CALL	SUBTR	;HL-DE
	POP	H
	RAL
	JC	NEAR	;NEAR END OF DISK
	MVI	A,0FFH
	ORA	A
	RET		;MORE THAN SIZE TO GO
;
;
NEAR:	SHLD	SPACE	;REDUCED NO. OF SECTORS
	MVI	A,0FFH
	RET
;
;
WASC:	MOV	A,M
	ORA	A
	RZ
	CALL	WACC
	INX	H
	JMP	WASC
;
;
WACC:	PUSH	H
	PUSH	D
	PUSH	B
	PUSH	PSW
	MVI	C,02
	MOV	E,A
	CALL	BDOS
	POP	PSW
	POP	B
	POP	D
	POP	H
	RET
;
SUBTR:	MOV	A,L
	SUB	E
	MOV	L,A
	MOV	A,H
	SBB	D
	MOV	H,A
	RET
;
;
STACK	DS	64
STKPTR	EQU	$
	DS	4
SPACE	DW	0
ICB	DW	0
OCB	DW	0
;
;
WDWC:	;WRITE DECIMAL WORD TO CONSOLE
	PUSH H!PUSH D!PUSH B
	MVI	B,0
	LXI	D,10000
	CALL	WNDD
	LXI	D,1000
	CALL	WNDD
	LXI	D,100
	CALL	WNDD
	LXI	D,10
	CALL	WNDD
	LXI	D,1
	MVI	B,1
	CALL	WNDD
	POP B!POP D!POP H
	RET
;
WNDD:	MVI	C,0
WNDD1:	MOV	A,L
	SUB	E
	MOV	L,A
	MOV	A,H
	SBB	D
	MOV	H,A
	JC	WNDD2
	INR	C
	JMP	WNDD1
;
WNDD2:	DAD	D
	MOV	A,C
	ORA	C
	JNZ	WNDD4
	MOV	A,B
	ORA	B
	JNZ	WNDD4
	MVI	A,' '
	JMP	WACC
;
WNDD4:	MVI	B,1
	MOV	A,C
	ADI	'0'
	JMP	WACC
;
WEOLC:	MVI	A,CR
	CALL	WACC
	MVI	A,LF
	JMP	WACC
;
RACC:	PUSH H!PUSH D!PUSH B
	MVI	C,01
	CALL	BDOS
	POP B!POP D!POP H
	RET

;THE FOLLOWING ARE DISK PARAMETERS
;IN A DATA TABLE
TADDR	EQU	$
UNIT	EQU	$+2
SCTR	EQU	$+3
TRK	EQU	$+4
NREC	EQU	$+5
	DS	7

BIOS:	LHLD	CPM+1	;MAKE BIOS CALL BY 
	DAD	D	;THE OFFSET IN DE
	PCHL

INCDEC:	LHLD	TADDR
	LXI	D,NBYTES
	DAD	D
	SHLD	TADDR	;INCREMENT TRANSFER ADDRESS

	LHLD	NREC
	DCX	H
	MOV	A,H
	ORA	L
	RZ		;RETURN WITH ZERO SET IF DONE
	SHLD	NREC	;OTHERWISE DECREMENT COUNT

	LXI	H,SCTR
	INR	M
	MVI	A,NSECTOR+1
	CMP	M
	RNZ
	MVI	M,1
	INX	H
	INR	M
	MVI	A,NTRACKS+1
	CMP	M
	RNZ		;INCREMENT AND CHECK FOR OVERRUN
	LXI	H,MSG7	;OVERRUN THE DISK!
	CALL	WASC
	JMP	CPM

TELL:	LXI	H,TADDR	;SET THE SECTOR,TRACK, AND DISK
	MOV	C,M
	INX	H
	MOV	B,M
	PUSH	H
	LXI	D,33	;SET THE DMA
	CALL	BIOS
	POP H!INX H!MOV C,M
	LXI	D,24	;SELECT THE DISK
	PUSH H!CALL BIOS
	POP H!INX H!MOV C,M
	LXI	D,30	;SET THE SECTOR
	PUSH H!CALL BIOS
	POP H!INX H!MOV C,M
	LXI	D,27	;SET THE TRACK
	CALL	BIOS
	RET

SAVER:	CALL	TELL
	LXI	D,39
	CALL	BIOS
	RNZ
	CALL	INCDEC
	JNZ	SAVER	
	RET

LOADER:	CALL	TELL
	LXI	D,36
	CALL	BIOS
	RNZ
	CALL	INCDEC	
	JNZ	LOADER
	RET

;	
SECTORS	DW	0000
MBUF	EQU	$
;
	END	100H

; ***E.O.F***OSE CRCFILE$€Н Н§

++ABORTED++$С	Н *щЙ                                                                                AP

                	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                   	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1!иНі—2…* ъя}жЂoНМ)l> О g+"!чНі*Н!НіЇ22<22!  "	!НіНwюВOНm:2‡:2†*"€!"ѓНш:‡2:†2!*НіНwюВ‡Нm:2‡:2†*"€!"ѓНз:†юВГ:‡<2‡Ї<2†22:‡22НpН‡ВO!EНіГ  COPY VER 1.2
 BUFFER SIZE =   SECTORS
 MOUNT INPUT DISK,TYPE CR MOUNT OUTPUT DISK, TYPE CR END OF TRANSFER
 ERROR,OVERRUN THE DISK
 *е& )е))е)СССZ ЙНе!НіС!ТНМµИе*лбеНМбЪ­>я·Й">яЙ~·ИНЅ#ГіеХЕх_Н сБСбЙ}“o|љgЙ2НpН‡ВO!EНіГ  COPY VER 1.2
 BUFFER SIZE =   SECTORS
 MOUNT       еХЕ 'НFиНFd НF
 НF НFБСбЙ }“o|љgЪUГHy±Вex°Вe> ГЅyЖ0ГЅ>НЅ>
ГЅеХЕН БСбЙ ЙН* й*ѓЂ "ѓ*€+|µИ"€!†4>ѕА6#4>NѕА!WНіГ  !ѓN#Fе! НЉб#N еНЉб#N еНЉб#N НЉЙНј' НЉАНЏВзЙНј$ НЉАНЏВшЙ                                                                                                                       яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГ)+ГЇ +Г Г Г  `iN#F#^#V#~#fo}ґИ+
Г! Гy·В:ГЯ!$Ц0w#В=>w!$НВ	ЙЕ!$Н‡
,0юКuю КdюрКdююВvбC$Ж0ю К…w#{ёВ{6 ЙЕСХНЯ НЏ	ГЦЕбеН
 Нy	ГЦуs Ѕж„{ЊЃYbъ€и…№ХНЯбw#p#q#rЙ!¬ 		N#F!сq#pлГ  Ї2Й!эqЫ Й!q{У ЙГ9	~#F#N#VЙк!хЕХеYНбСБсЙю Ию	Ию,ИюИюК<ЙН 
Н ЙН	юК*Н$ КA !‹6 #ВT Ѓ   ЃIЬЂ1r„   l7јs,w,p,q,rЙ!ЇwЙ>ЂЇ!¦оЂw!~§К{_,~,®,N,VГЄ~§К{_,~,N,VoцЂG­!НqЁGц{Й~§ДЗК{ЪъНЂx§ъЫ!~ЮwИНнНbЪъGц{ЙЇ–юФЗЪъК{OНСЪЫ!>яwЙ >ЂЇ^,®G,N,V!~-w{§КЊhxцЂG­.®.w.~§К·“Ъ<ъЊюЪ\ГЊт·юзЪ·s_!~.®wЇ“,^pC,^qK,^rSНъ!~§.ъЌ~‚W-~‰O-~€GТ¤GyOzW_.~ЖЪъwГ¤Ї“_~љW-~™O-~GЬ ф3т{НbЪъG!{–oxц{]Й!~.®-НqЁГЄ G,N,V,^!~§ИЂGЁxЂтйђИw,~© wy°ЙШЇЙ{_zWyOxЏGЙ .ЅъZQH •Вю§Иo§xGyOzW{_-ВЙ-~оЂwЇo“_}љW}™O}GЙ. x§ВSAJS_}ЦoВ5Й-{_zWyOxЏGтF}Ц !†wИ§Й!{§^ьrШx,®ГtААА{Ж_ЂwЙ!Нw!Йr!ЕsЇ_W!Нџ.Нњ.zYPFoЇOђЪ°JSЙOТ°§}ЏИo{_zWyOxGТ°{Ж _zО WyО ГЄ!~“w-~љw-~™wyy!Vw!dwz!Rw!`w{!Nw!\w x!Kw!Yw!gw!~,V,^§ъB.NИqkb_HЇНJxШ}o|gНнzЪ'}Г[kb_PHГ>Ц }Ю o|Ю g{Ю _> ЙЖ o|О g{О _> Г+Н6 * |Н}Н Н Н Й! еНЊ!kНsбН !kГжН„И!kНs§Ж@!oНsХ!kН !oНж!oНЦ!oНsСКТХГЇ!oН ЙЇ!ow!"Гу*M"o*O"q!"w ЕХЇGOНy	!sНs!kН !oНЅ*wй!sНж!MГ7!oНs!MН !sНж!oН!oНsСБz‘ИШWyђOГшЃ   ЃIЬЂ1rНЃ!QННЊ!{Нs!QНжНЏ	Ъъ Нy	!QНЅНЃ!{Н!{НsН„!QНъАКА!QН_!|~жЂоЂЁG{+НsН{Г‰!{Н !{НЅНЃ!kНsHНд!oН !{НЅюЃЪц!Їw,wНЊЙНЊИюЃЪ5!MН„Н5!Нs!QН _!Ђ~жЂ°G{!{Нs!{Н !НЙ!{Нs!{НЅ!MНН!MН!{Н„!{Нs!<Нs!{НЅНЃ!kНs НЩ!oН !НЅЙНЊ!kНs!y6 ЦЂъ©ютъw!k6ЂН !kНЅ!kНs8Нд!y5ъд!oН !oНЅ!4!MН!oНsГѕНЊЙНЊ!{Нs!y6 ЦЂъ	ютъw!{6ЂН !{НЅ!kНs*Нд!oН !{НЅ!{Нs!{НЅ!MНН!kНs!y5ъ~!kН !{НЅ<!{Нs!kН !kНЅ!4!MН!kНsГE!{Н ЙНЊтЇ!^6 !zsН„НЇ!z^!~s§В{!MН„ЙНи!kНЙН„КъЦЃ!yw>Ѓ!{Нs!{Н !MН!oНs!{Н !MН!oНж!{Нs!{НЅ!kНs	 НЩ!o4Н !{НЅ!{Нs!y~ HPНy	!UНЅ!{НЙ![N,F-НR	!P	Нo	![q,pЙ6	Нc	Нo	Нc	Нo	Й—yOxGИГc	—~ЃO,~€G-ЙkZQHG}оЂ!w,6Ђ,x§Г›!~§Кј	{Ж–ШюТј	Ж.F,N,VНъ.~§ф >°xAJSЙЇGOWЙ ^НP,6Ђ!r{юрКб	юыКб	юэВе	!rН\~ ююК#
юК.
ю
Т_
!#w!iНЅ.Нs,~ HPНy	.Н.~§Кб	-FpГб	!®wВб	Г_
Н\~GЦэ_К?
ЖxВA
,~ ю
Т_
G,~ю
ТX
Ox‡‡Ђ‡ЃG{§В_
ђG!N!qx!†КЊw!iт~
Нж>Гh
НЅШ>яГh
-НPНЊ!НsН\6р§К¶
_x§{т¦
6эю~!iЪї
юЃЪЛ
Нж!^sГЁ
НЅ!^sГ¦
Н„!mНюЃТЁ
!~_юЪе
“w>“,w{!†wъ!iНЅНЏ	Н\wЇНy	>яГо
!~6я§ъ"Н\6юГо
-¦КHыт1эOЇ‘яWЦ
Т3>Н\Нs!Г >рGOWГ<}D Q!НsЙ!^s,fkЙиd 
  Ђ   Ѓ   ЃЂ  яяяЋ њ Є ё В 	!e Н(ђя  IN LINE $ERROR $WARNING $1)1)НЦН±1)Н Н§ыv!ч)q*ч)& лНЙНЖ
НЖЙ!щ)p+q  Н/Тю*#)#"#)Гз*ш)л
НЙ*”)лНЙ*”)лНЙ*”)лНЙ*”)лНЙ*”)лНЙ*”)лНН0Й*м)лНЙ!ы)p+q*ъ)л	НЙ!э)p+q*ь)))Й!я)p+q! *6 >! *ѕЪГ!*60* *& f)	ю)НБ(Ъµ* *& f)	ю)НБ(л+s#r!*4Г†**MНЖ! *4ВxЙ!*r+s+p+q+СБp+qХ*НЙ!*r+s+q+СБp+qХ**+"*яяН®(µК**:
*w**#"*ГлЙ!*p+q**|OНЖ**}OНЖ> !%)НЧ(Т=•НQ*%)DMНmНЦЙ!*p+qНЦџНQ**DMННЙ!*p+qНЦ¦НQ**DMНЙ*)#")Й*)")л>Нµ(")л!)НЪ(Т >)НМ(")Й*)") ")л!)НЪ(Ъѕ*)")Й!*p+q)*Нї(џЙ!*p+q**N#FНї/Тъ**N#FНaл*)е**Бq#pЙ*)DM*)лН*Й*)DM*)лН*Й*)DM*Н*Н*)л*Н*Й*)DMНР*)N#F*)лН*Й*)~Ц ЦџЙ*)~Ц ЦџЙ*)> НЧ(µЦџЙ*)> НЧ(µЦџЙ*)#~Й*)#~Й!*q*)##:*wЙ:Т«FOН\*)лzН*!  "Й*)DMНЋ *)	е*)Сw*)##е*)#СwЙ!*q*)лНЯ**M*)лНТНЋЙ!*q*)лНЯ**M*)лНТН|НЋЙНЎ*)лnН*НмН¬Й!*p+q*)> w#6 **|*)##w**} *)	w*)DMНћЙ*)лНЯ*)лНТНDТnН|>ЙНrТ{Н|>ЙН|>Й!!*p+q*))""*!  "&*> "*НМ(µКф *"*	~ю Вз*"*л"*Нї(л>Нµ("$*л*&*"&*>  *НМ(µКз * *$*НП(Ъз*"*Й*"*^#Vл""*Г“>  *НМ(µКMNНA*&*Й!)*p+q> (*НМ(µВ !  Й*(*DMНЃ",* *,*	6*(*л*,* "0**,*е*0*гN#Fбq#p*,*N#F`i"2**,*е*0*лбs#r*2*s#r *0*	6 *0*##"0**0*е*,*лбs#r *,*",*е*(*л НЬ*,*Й!5*p+q>4*НМ(л#s#rл"4* *4*	6 Ны*4*##"4**4*^#Vл"4*> Н«(µКъ *4*	~ю ВъНы*4*"6*Й*4*^#Vл"8**8*> НЧ(µКA *8*	~ю ВA*8*е*4*гN#FСлq#p`i"8**8*е*4*лбs#rЙ! ":*Нt*)"=**)"?*!<*6*)~!<*ѕЪЉ*)N#Fе*:*лН(лб+s#rл":*Н|!<*4В\*=*")*?*")*:*DMНaе*)~<‡_ бDMН
"=*"A**)е*A*Б
w#6 !<*6*)~!<*ѕЪу*A*##"A**)е*A*гN#Fбq#pН|!<*4ВЗНЎ*)е*=*лбs#rЙ*)^#Vл"C*Н|*)^#Vл"G**C*N#F!F*q+6:F*!E*ѕЪXН|Н†*)е*C*^#VбN#FН(е*G*Б	"G*!E*4В'Н†*C*G*НБ(ЪmBSНA*C*##е*G*DMНaБ	е*)Бq#pЙ*C*##"C*Й!I*q*)DMНР:I*Т3 НЂ*)^#Vл"J**J*N#FНїТЮ*J*N#F`i"L**L*~=wюВЮ*J*N#FН¦*)N#F`i"L*НїТ3*L*~юяВ/*L*#"L**L*е*L*~<O Н
е*)Бq#p*L*~<_ НД*)N#F`i"L**L*4*)^#V*)DMН*Й*))НX(+л+s#rН|ЙНNТbНBГeН|Н|ЙНt*)^#Vл")Й*)##~ЙНwТЋ*)N#FН¦Й!O*p+q> N*НМ(µВ¤> Й*N*~Й!P*q:P*ТБ*)лvН*ГЖ*)6 ЙНXТТН|ЙНeТаНыН|Й*)N#FНЏ<2Q*Нf*)N#FНЏ2R*:R*!Q*†2S*Нf*)N#FЕ*S*M Н
"T*DM*Q*& лНД*)N#FЕ:Q*T*Нc(DM*R*& лНДН~Н|Н~*)е*T*лбs#r:S*=*T*wНЂЙџТqLSНAЙНXТ‚*)"X*ГЊ*)^#Vл"X*НeТњ*)"V*Г¦*)^#Vл"V**V*~2[*!Z*6 :[*!Z*ѕЪч*V*е*X*Б
ѕТПНэ>Й*V*е*X*~бѕТвНэ>Й*V*#"V**X*#"X*!Z*4ВІНэ>ЙН~Н|Н~Й!\*q!a*6 :\*юВ<ННrхНDБH±Т/SSНAН¬*)~2a*Н|Нrх*)N#FНЏ!a*–џБH±хНDБH±ТlН|Н~*)> w#6 ЙН¬*)е*)N#FНЏ!a*–#wбѕТЎ:\*юВљ:b*<*)wГЎ*):b*w:\*ю В¶*)^#Vл"_*Гг:\*юВЦ*):b*Нd(е*)~СНµ("_*Гг*):a*Нd(+"_**_*еН O Н
"]*еН _ БНД*)е*]*Б
wН|Н~*)е*]*лбs#rНЂЙ*)~<Й!c*q*)DMНЋ> !c*ѕТC*)DMНЋ!d*6 >!d*ѕЪа*c*M !С		^#Vлй*d*& л*)~/wГЩ*d*& л*)е*d*& л*)~Бе`i¦бwГЩ*d*& л*)е*d*& л*)~Бе`i¶бwГЩ*d*& л*)е*d*& л*)~Бе`i®бwГЩaq‘±!d*4ВH> !c*ѕТмН|*)DMНћЙ*)лНЯ„)НQ!e*6 :e*<2e*O !ѓ)	~ю К Г	*)ѓ)q#p`i:e*wЙ!Ђ "Ѓ)е„  НЬЙ!"f**f*~ю ВY*f*+"f*ГFНЦ!Ђ "Ѓ)f*Ѓ)Нї(Ъ‚*Ѓ)NНЖ *Ѓ)"Ѓ)ТbН0Й*)^#Vл"h*> Н«(µКФ!j*6*h*~!j*ѕЪФ*j*& л*h*е*Ѓ)Б
w*Ѓ)#"Ѓ)Н®(ТНН@!j*4ВћЙ*м)еЂ НЬЙ! *”)	~Й!k*q! *”)	:k*wЙНвЙНвцOНлЙНвжюOНлЙНв·ЙНвжщOНлЙНвцOНлЙНвцЂOНлЙНвЙ$ *”)	е*к)лбs#rЙ> –)НМ(µВ_FEНA*–)#")*у)")*х)")м)к)Нї(µК€НвцOНл*к)+"к)Н<Г»ЙНю ВўН#ЙН7/Т®НMЙНХН#  *”)	4ЙНыТНвжюТн  *”)	> ѕТд  *”)	5НвжыOНлН&ю КыWDНAН	Н7ТНГНХ*м)"к)Й*к)#"к)л!и)НЪ(џ/Й> о)НМ(µЖяџЙ!l*qН&*р)#"р)о)хНП(џБHЎТVREНAНТ`НЅН/хН7БHЎТzН–  *”)	5*к):l*wНяЙ*)>ѕТ”FMНA*)~ЙН…O !)		^#Vл"”)> Н«(µВєUFНA*)N !А)		^#Vл"–)Й& *”)"м)Ђ "и)$ *”)	^#Vл"к)" *”)	^#Vл"о)НGЙНюяВН0юяВEMНAЙ!o*6 :o*<2o*O !)		> НЧ(µК5Г¦ Н
"”)е*o*& ))	Бq#p& *”)"м)НG*”)#"m*е  НЬ*)^#Vл"p**p*##~ю:Вћ*p*#>¦*”)w*p*~==2r**p*##"p*ГҐ*p*~2r*>!r*ѕТі!r*6*p*#"p*!s*6яНRO *p*	~Ц.Жяџ!r*х:s*–џБHЎТвГї*p*е*m*DM*s*& лНДНR!r*ѕТ*s*& л*p*е *m*е!s*:r*–_ БНДНюНХ *”)$ е*”)	Бq#pН|*)" е*”)	гN#Fбq#pН|Й:s*<2s*Й*)"у)*)"х)ЙН™НН!  "р)!т)6Н|ЙН&/ТЉURНAНXхНrБH±ТћRIНA*)N#F+q#pН-ННЅ*о)}*)х#~БH_  еН(Се*о)х|бl_ & хЕН}(е! 9СНg("v**)^ бН}("t*!v*Н‘(е*t*Б	"z**)#^ бl& Н}("x**x*}‡‡*t*х|v*Нc(Нџ(БH 	л!~*s>z*Нp(е*м)Б	+"к)Н<б!z*Н›(л#s#r *”)	:~*ѕК„НюяВvECНA *”)	:~*wНю*|*}ж  *”)	wН|ЙНТЈНЅН–Н/Т®Н–*к)~юВєНM*к)~Й!*q:*ю ВОНх:т)/ТЮ,Н3Гг!т)6 *)^#Vл"Ѓ**Ѓ*~2ѓ*:*ю В!ѓ*5Г"Н3НN!Ђ*6:ѓ*!Ђ*ѕЪ:*Ѓ*~ю"В)EQНA*Ѓ*NН3НN!Ђ*4В:*юВJ"Н3Н~Н|Й*Ѓ*#"Ѓ*ЙНННЅНюяВjECНA*”)DMН¦Й!„*6 :„*<2„*O>№Ъ¦*„*& ))	^#Vл"”)> Н«(µКЈНVГxЙНsН@НЦНЙ?НЖ НЖ+)Нб:-)юВПН§!,)"})е*,)& Б	6Й*,)& ,)	})НП(џЙН|*‘)")IIН\Г»Й*')#"')л!)НЪ(ЪDOНA*')~Й*})#"})*})~Й:“)ю Вn>P!|)ѕТDBDНAН–*|)& ,)	wю
ВfН&ТcERНAГk*к)~ЙГ5:“)юВzН!Й:“)юВ†НЙЙ!|)6 Н-2…*ю ВљГЊ:“)ю ВЁ!,)"):“)юВ¶*})"):“)юВД*')"):…*ю"КФ!†*6,Го!†*6":“)ю Ки*)#")Н-2…*!†*:…*–Жяџ+х~ЦЖяџБHЎТ!|)4Н-2…*Го:†*ю"В:Н-2…*Ц,Жяџх:…*ЦЖяџБHЎТ:ГНЎЙН‡*)е:|)<O Н
"‡*#DM*|)& лНД*)е*‡*лбs#r НЂ*‡*:|)wЙН‡> !|)ѕТќ*|)M*)лН0*)л	НТНЋГ°:“)юВ«НтГ°*)6 ЙНЛН )Е Нaл НЬН0Й*	)"!)")*)")+"')*)")*)")` "))")*)") ")Й*)л*е)Нї(л*DMНД*)е)))Нї(л НЬ*)"‰**)л>НМ(е*‰*Бq#p*‰*##> w#6  *‰*	w#6 *‰*^#Vл"‰**‰*> w#6 *‰*##е*)лбs#rЙ*)~Тґ НЎ*)#е*)Б
w*)>?¦*)#w*)~Т® Н.НtГQ(*)N !Џ'		^#VлйНмГQ(ННмГQ(НмГQ(НDТм ZDН\ННмГQ(НNТ!НDТ!*)лrН*ГE!НyТ"!ENНAГE!*)лНЯ  НЯ*)лНЯ*)лНТН|НЋГQ(НOЦЦџOН©ГQ(НOЦЦџOН©ГQ(НOЦЦџOН©ГQ(НOЦЦџ/OН©ГQ(НOЦЦџ/OН©ГQ(НOЦЦџ/OН©ГQ( Н&ГQ(Н&ГQ(Н&ГQ(Н.ГQ( НЏНыН|ГQ(ЙН|ГQ(НЎНГQ(НГQ( НЏН|Н|ГQ(НrЦЦџOН©ГQ(НrЦЦџOН©ГQ(НrЦЦџOН©ГQ(НrЦЦџ/OН©ГQ(НrЦЦџ/OН©ГQ(НrЦЦџ/OН©ГQ(НЏН|Н|ГQ(НЎНt*)е*)лбs#r*)n& ") НЂГQ(НЗГQ(НtНЎ*)##е*)Бq#p*)^#Vл")ГQ(*)N#F`i")Н|ГQ(НBГQ(НГQ(Нб/ТЩ"НтНwГQ(НхН†Н|ГQ(Н†Н~Н|ГQ(НgН|НZГQ(НgНZГQ(НбТ#НЎНтГQ(*)е*)^бNНяН|Н|ГQ(!“)6 НwГQ(!“)6 Н>ГQ( НїГQ(НїГQ(НГQ(НЎНt*)N#F*)лН*НtГQ(*)+"')ГQ(
НРГQ(Нб/Т”#НтН>ГQ(ГQ(ГQ(Н@ГQ(!‹*6 *‹*& )	лЃ)Нї(ТЖ#!‹*4Г«#!~:‹*ѕВЦ#Н@Гз#*‹*& )	^#Vл"Ѓ)ГQ(НiГQ(НDТэ#НiГ$*)##")Н|ГQ(НUГQ(НBГQ(*)DMНЋГQ(!“)6*)"‘)НґГQ(!“)6Н>ГQ(!“)6НwГQ(Н&Т[$Н–ю
К[$ГP$Н<ГQ(Н&Т~$*о)++р)НП(Т~$ Н3Гh$Н3
Н3Н<ГQ(Н™НV*)N !)		> w#6 *)N !А)		w#6 Н|ГQ(*)#>¦wГQ(*)DMНЋ*)DMНћГQ(ННЎ*)л‘Н*НЎ*[DMН!НмГQ(Нr/2Њ*НD/OН©:Њ*Т%
НРГQ(НРГQ(НРГQ(НРГQ(НЎННРН|НРНЎНNТT%ZTНAНмГQ(НРГQ(Н*)>„НЧ(Тѓ%*)л>„НМ(л+s#rГg%*)N#Fе!Ђ 	лб+s#rлЃ)НП(џ/х>ЂНМ(µЖяџБHЎТі%Н@*)^#Vл"Ѓ)Н|ГQ(НРГQ(НЎ  НЃDMН!ГQ(*#)"[ГQ(НРГQ(НЎ>Ѓ)НМ(DMН!ГQ(Н*)NНшO Н!ГQ(*)^#Vл"Ќ*> Н«(µЦџ*Ќ*х~“ЦџБH±Т<&CAНA*Ќ*#~2Џ*Н~*Џ*M Н!ГQ(Н¬ Н
"ђ**ђ*6*)е*ђ*#Б
w*)е*ђ*лбs#rНЂГQ( НГQ(*)N#FНЏ2’*Н~*’*M Н!ГQ(НГQ(НГQ(Нхѓ)Е:ѓ)<O Н
е*)Бq#p:ѓ)<_ НДНЂГQ(*)N#FНЏ*)N#FPYOН0Н~*)л	НТГQ(НРГQ(НРГQ(НГQ(*)~=w*)х~=БH№Т4'IOНAН|*)~‡†<wГQ(Н&ГQ(Нt*)еН…O !А)		гN#Fбq#pНtН|ГQ(*)^#Vл"%)Н|ГQ(*)!)еНX(лбs#rГQ(Д М Ч Я ч N!]!l!{!‹!›!«!і!»!Г!Й!Ч!Ш!Ю!з!н!ы!
""("8"H"X"f"Љ"ђ"°"В"И"О"Я"л"ч"###2#=#H#P#X#^#w#Ѓ#‰#љ#ќ# #¦#к#р#$$$"$3$>$I$a$Ћ$є$Е$Ш$ы$%!%)%1%\%d%Г%Л%Ь%е%н% &&S&ѓ&‹&¦&®&¶&б&''''B'J'm'}'НtГ ЙN#FЃo€gЙл_ л…oЊgЙл_ лҐo¤gЙDM!  >)л)лТЊ(	=В„(Й^#Vл)В•(Й^#Vл|·g}oВџ(Й_ {•ozњgЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙ712A0D47
:100D16002A7C4FCDC60B2A0D2 D4FCDC60B3E0031
:100D260021  29CDP728D23D0D01950BCD510C2A71
:100D36002529444DCD6D0CCDD60BC921102A702B1B
:100D460071CDЂ 0B019F0BCD510C2A0F2A444DCDE8
:100D56000E0DCD0E01C921122A702B71CDD60B01B5
:100D6600A60BCD510C2A112A444DCD0E0DC92A17BA
:100D76002923221729C92A1529221329EB3E04CD36
:100D8600B528221529EB211929CDDA28D2A00D3E46
:100D960004111B29CDCC28221529C92A132922156D
:100DA6002911040019221329EB211B29CDDA28DA8F
:100DB600BE0D2A1929221329C921142A702B711153
:100DC6001B2901132ACDBF289FC921162A7NI   $BASIC-E INTERPRETER - VER 2.3$NM  $1д-1д-+НЬ,Нх, я!/Н«-"и-и-Нї-")   НЯНe-2м-ю*К¦+!л-6 Нe-х:л-<2л-O !м-	БHqyю$К†+Гh+*л-Mм-Н0*и-л	НТ *и-"и-ГX+Н‰-е*и-Б	"ж-)ж-Нї-"))и-Нї-"	)Н‰-е*)Б	")*д-)НБ-Ъл+$+НЬ,НН‰-))е*)Б	")Нe-юКЧ,:к-ю3В",Нe-*ж-wю К,*ж-#"ж-Г	,ГФ,:к-юЂЪ6,НS-Н.-НS-ГФ,:к-юВd,НS-*и-"ь-*ю-6 НS-Нe-ю Кa,НS-*ь-4ГO,ГФ,НS-:к-Ц6Цџх:к-Ц7ЦџБH±х:к-Ц^ЦџБH±х:к-ЦЦџБH±Т°,Нp-*и-	)еН -+лбs#rНЂ-ГФ,:к-ю.ВФ,Нp-*и-^#Vл))Хе*Б	л+s#rНЂ-бГщ+Гыv!.p+q*.DMНQНЖ
НЖЙ	 * .	6I* .	6N* .	6T* .лНюяВ#- +НЬ,НЙ* .лНЙ*ю-#"ю-л! Нё-ЪR-!Ђ "ю-Н$-ю КR-*ю-6Й*ю-е*и-Б
w*и-#"и-ЙН.-*ю-~2к-ЙНe-*и-#wНe-*и-wЙ*и-##"и-ЙНe-O `iНІ-еНe-_ бЙN#FЃo€gЙ{Ґoz¤gЙ)ВІ-Й{•ozњgЙi`N#F‘ogЙC2A712A134B
:100ED60029 0E02CDDF012A1C2A4D2A1329 \ 60
:100EE600D201CD8E0EC9211D2A712A1329EB0E02BD
:100EF600CDDF012A1D2A4D2A1529EBCDD201CD7C45
:100F06000DCD8E0EC9CDA10D2A1329EB016E0BCD89
:100F16002A010E03CDEC0ECDAC0EC9211F2A702B73
:100F2600712A13293E00772336002A1E2A7C2A13AB
:100F3600292323772A1E2A7ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;HELP: a program to page through a (documentation) file
;
;COMMENTS IN LOWER CASE BY THE AUTHOR, JPR PALFREY.
;COMMENTS IN UPPER CASE ADDED BY SJ WITHERS (FOR BETTER OR
; WORSE!)
;
;WRITTEN FOR MICROSOFT'S MACRO ASSEMBLER, BUT MAY WORK WITH 
; OTHERS USING ZILOG MNEMONICS.
;
.Z80
;
;EQUATES FOR EASIER READING
DFCB	EQU	5CH
TAB	EQU	9
LF	EQU	10
CR	EQU	13
EOF	EQU	26
SPACE	EQU	32
;
;MACROS TO HELP ACCESS CP/M FUNCTIONS AND FOR COMMON OPERATIONS
SETBYT	MACRO	ADDR,VALUE
	LD	HL,ADDR
	LD	(HL),VALUE
	ENDM
INCBYT	MACRO	ADDR
	LD	HL,ADDR
	INC	(HL)
	ENDM
DECBYT	MACRO	ADDR
	LD	HL,ADDR
	DEC	(HL)
	ENDM
FDOS	MACRO	FUNC
	LD	C,FUNC
	CALL	5
	ENDM
DCIO	MACRO	CHAR
	LD	E,CHAR
	FDOS	6
	ENDM
OUT$	MACRO	PTR$
	LD	DE,PTR$
	FDOS	9
	ENDM
OPENF	MACRO	FCB
	LD	DE,FCB
	FDOS	15
	ENDM
READF	MACRO	FCB
	LD	DE,FCB
	FDOS	20
	ENDM
;
;start program
	OUT$	PQUEST
	FDOS	1
	CP	'P'
	JP	Z,ANSP
	CP	'p'
	JP	Z,ANSP
	JP	SKIP
ANSP:	SETBYT	OUTDEV,5
SKIP:	OUT$	CRLF
	SETBYT	DFCB+9,  'D'		;IF YOU DO NOT WANT A
	SETBYT	DFCB+10, 'O'		;DEFAULT SUFFIX OF DOC
	SETBYT	DFCB+11, 'C'		;DELETE THESE LINES
	LD	A,(DFCB+1)
	CP	SPACE
	JP	NZ	FCBOK		;If no name after HELP,
	SETBYT	DFCB+1, 'H'		;use HELP.DOC.
	SETBYT	DFCB+2,	'E'		;CHANGE TO ANOTHER NAME, OR
	SETBYT	DFCB+3, 'L'		;DELETE IF YOU WISH.
	SETBYT	DFCB+4,	'P'
FCBOK:	OPENF	DFCB			;open specified file
	CP	0FFH
	JP	NZ,LOOP1
	OUT$	NOFILE
	JP	0
;start main loop
LOOP1:	LD	HL,RPTR		;check if end of buffer reached
	LD	A,0FFH
	CP	(HL)
	JP	NZ,NOREAD
	READF	DFCB		;if end of buffer, read new record
	CP	0
	JP	NZ,0
	SETBYT	RPTR,80H	;reset RPTR to beginning of buffer
	JP	GETCH
NOREAD:	INC	(HL)
GETCH:	LD	HL,(RPTR)	;get next character from buffer
	LD	A,(HL)
	CP	EOF
	JP	Z,0
	CP	TAB
	JP	NZ,NOTTAB
EXPTAB:	LD	E,SPACE		;expand TAB characters
	LD	A,(OUTDEV)	;output space to output device
	FDOS	A
	CALL	EOLQ
	DECBYT	POS8
	LD	A,(HL)
	CP	0
	JP	NZ,EXPTAB
	LD	(HL),8
	JP	LOOP1
NOTTAB:	LD	E,A		;character is not a TAB
	PUSH	AF
	LD	A,(OUTDEV)
	FDOS	A		;output character to output device
	POP	AF
	CP	CR
	JP	NZ,NOTCR
	SETBYT	POS8,8
	CALL	NEWLN
	JP	LOOP1
NOTCR:	CP	SPACE
	JP	M,LOOP1		;don't count control characters
	DECBYT	POS8
	LD	A,(HL)
	CP	0
	JP	NZ,POS8NZ
	LD	(HL),8
POS8NZ:	CALL	EOLQ
	JP	LOOP1
;
;subroutines:
EOLQ:	INCBYT	LPOS		;has end of line been reached?
	LD	A,(HL)
	CP	81
	RET	NZ
NEWLN:	SETBYT	LPOS,1		;end of line routine
	LD	A,(OUTDEV)
	CP	6
	RET	NZ
	INCBYT	LNUM		;if output to the screen,
	LD	A,(HL)		; count number of lines
	CP	24		; and pause after 23
	JP	Z,WAIT
	RET
WAIT:	DCIO	0FFH		;wait for any key to be typed
	CP	0
	JP	Z,WAIT
	CP	CR
	JP	Z,ONELN		;TYPE ONE MORE LINE IF RETURN PRESSED
	CP	3
	JP	Z,0		;ABORT IF ^C
	SETBYT	LNUM,1
	RET	
ONELN:	SETBYT	LNUM,23
	RET
;
;MESSAGES:
PQUEST:	DEFB	'HELP : jpr palfrey : 29 jan 1981',CR,LF
	DEFB	'Printer or screen (p/s)? $'
NOFILE:	DEFB	'File not found$'
CRLF:	DEFB	CR,LF,'$'
;
;VARIABLES:
RPTR:	DEFB	0FFH		;indicates position in read buffer
	DEFB	0
LNUM:	DEFB	1		;counts number of output lines
LPOS:	DEFB	1		;indicates position in output line
OUTDEV:	DEFB	6		;output device: 5=printer, 6=screen
POS8:	DEFB	8		;TAB expansion variable
	END
R:	DW BUFFER	; INITIALLY START OF BUFFER
BUFFER:		DB 0		; REST OF AVAILABLE RAM IS BUFFER

	END	100H


	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	
яяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
; BINARY TO HEX-ASCII FORMATTER
;
;SYNTAX IS AS FOLLOWS:
;
;HEXDUMP FILENAME.COM FILENAME.HEX
;
;CONVERTED FROM CDL Z80 MNEMONICS TO INTEL 8080
;BY DEREK FORDRED, CP/M UK USER GROUP.
;WILL ASSEMBLE WITH ASM.COM.
;
;HEX RECORDS CHANGED FROM 24 BYTES TO 16 TO BE
;SAME AS CP/M HEX FILE FORMAT.
;
;       SYSTEM EQUATES
;
READBL  EQU       20      ;READ SECTOR
FCB     EQU       5CH     ;INPUT FILE FCB
COFN    EQU       2       ;CONSOLE CHARACTER WRITE
BDOS    EQU       5       ;DOS ENTRY POINT
SDMA    EQU       26      ;SET DMA FUNCTION
DWRIT   EQU       21      ;WRITE SECTOR FUNCTION
BUFF    EQU       80H     ;READ BUFFER ADDRESS
WTFN    EQU       9       ;CONSOLE BUFFERED WRITE
WBOOT   EQU       0       ;WARM BOOT
CONZ    EQU       26      ;EOF MARKER
CLSFN   EQU       16      ;CLOSE FILE
LOGIN   EQU       14      ;LOG-IN DISK
SEARCH  EQU       17      ;SEARCH FOR FILE
DELETE  EQU       19      ;DELETE FILE
MAKEF   EQU       22      ;CREATE FILE
OPENF   EQU       15      ;OPEN FILE
START   EQU       100H    ;WORK FILE START ADDRESS
;
;
        ORG     100H
;
        LXI     SP,STKTOP
        LXI     B,33    ;GET HEX FCB
        LXI     H,FCB+16;AND MOVE IT
        LXI     D,FCBH
	CALL	MOVIT	;BLOCK MOVE
        LXI     B,3     ;MOVE HEX EXT.
        LXI     H,HEXT
        LXI     D,FCBH+9
	CALL	MOVIT	;BLOCK MOVE
        MVI     B,8
        LXI     H,FCB+17;CHECK FOR CONSOLE
AGAIN:  MOV     A,M     ;OR FILE OPERATION
        CPI     ' '
        JNZ     AFORT
        INX     H
	DCR	B
	JNZ	AGAIN	;LOOP
        JMP     RDOPEN
;
;
AFORT:  XRA     A
        STA     CONTST  ;SET FLAG FOR HEX FILE
;
;       SET UP HEX FILE
;
        LDA     FCBH    ;GET DRIVE
        MVI     D,0
        MOV     E,A
        MVI     C,LOGIN
        CALL    BDOS
        LXI     D,FCBH  ;SEARCH FOR FILE
        MVI     C,SEARCH
        CALL    BDOS
        CPI     255
        JZ      MAKE    ;SEE IF FILE EXISTS
        LXI     D,FCBH
        MVI     C,DELETE
        CALL    BDOS    ;ERASE FILE
MAKE:   LXI     D,FCBH
        MVI     C,MAKEF ;CREATE FILE
        CALL    BDOS
        CPI     255
        JNZ     OPENZ
        LXI     D,DIREM ;ERROR DETECTED
        MVI     C,WTFN
        CALL    BDOS
        JP      WBOOT
OPENZ:  LXI     D,FCBH
        CALL    SETUP
        XRA     A
        STA     FCBH+32 ;INIT. SECTOR COUNT
        STA     WTPTR   ;INIT. POINTER
;
;       OPEN READ FILE
;
RDOPEN: LXI     D,FCB
        CALL    SETUP
        XRA     A
        STA     FCB+32  ;INIT. SECTOR COUNT
        MVI     A,80H
        STA     RIBP    ;INIT POINTER
;
;       BINARY TO HEX-ASCII CONVERSION
;
        LXI     H,START
	SHLD	PTR	;INIT. POINTER
WRITE:  CALL    CRLF    ;WRITE CRLF
        MVI     C,11    ;TEST TO ABORT
        CALL    BDOS
        ANI     1
        JZ      OKNOW
        MVI     C,1
        CALL    BDOS
        ANI     127
        CPI     3       ;ABORT
        JNZ     OKNOW
        LXI     D,ABORT
        MVI     C,WTFN
        CALL    BDOS
        JMP     WBOOT
;
;
OKNOW:  MVI     C,':'   ;START OF RECORD CUE
        CALL    PRINT   ;PRINT IT
        CALL    PIMP	;DO CHECKSUM
        LDA     EOFLG   ;CHECK FOR EOF
        CPI     0
        JZ      WRITE   ;GET NEXT RECORD
        CALL    CRLF
        MVI     C,':'
        CALL    PRINT
        MVI     B,10
SST:    MVI     C,'0'
        CALL    PRINT
	DCR	B
        JNZ     SST
        CALL    CRLF
        JMP     CLOSE   ;FINISHED
PIMP:   MVI     D,0     ;INIT CHECKSUM
        MVI     B,16    ;16 BYTES PER RECORD
        MOV     A,B     ;FILE LENGTH
        CALL    PBYTE   ;PRINT IT
        LHLD    PTR     ;GET ADDRESS
        MOV     A,H
        CALL    PBYTE   ;HIGH BYTE FIRST
        MOV     A,L
        CALL    PBYTE   ;LOW BYTE NEXT
        XRA     A       ;FILE TYPEEQU0
        CALL    PBYTE   ;PRINT IT
W3:     CALL    READ    ;GET DATA BYTE
        CALL    PBYTE   ;PRINT IT
        INX     H       ;ADVANCE ADDRESS
	SHLD    PTR
	DCR	B
        JNZ     W3      ;DEC FILE COUNT
        XRA     A
        SUB     D       ;CALC. CHECKSUM
        JMP     PBYTE   ;PRINT IT, RETURN
;
;       WRITE A SINGLE BYTE
;
PBYTE:  PUSH    PSW     ;NIBBLE AT A TIME
        RRC
        RRC
        RRC
        RRC
        CALL    CONV
        CALL    PRINT   ;PRINT IT
        POP     PSW     ;NEXT NIBBLE
        PUSH    PSW     ;SAVE FOR CHECKSUM
        CALL    CONV
        CALL    PRINT   ;PRINT IT
        POP     PSW
        ADD     D       ;ADD TO CHECKSUM
        MOV     D,A     ;UPDATE CHECKSUM
        RET
;
;       CONVERT ASCII TO HEX
;
CONV:   ANI     0FH     ;LOW NIBBLE ONLY
        ADI     90H
        DAA
        ACI     40H
        DAA
        MOV     C,A
        RET
;
;       CRLF
;
CRLF:   MVI     C,0DH
        CALL    PRINT
        MVI     C,0AH
;
;       CONSOLE AND FILE
;       CHARACTER WRITE
;
PRINT:  PUSH    PSW     ;SAVE ENVIRONMENT
        PUSH    B
        PUSH    D
        PUSH    H
        LDA     CONTST  ;TEST FLAG
        CPI     0
        JZ      DISKWR  ;FILE ACCESS
        MVI     D,0
        MOV     E,C     ;CHAR. IN C
        MVI     C,COFN
        CALL    BDOS    ;PRINT TO CRT
PREXIT: POP     H       ;RESTORE ENVIRONMENT
        POP     D
        POP     B
        POP     PSW
        RET
;
;
DISKWR: LDA     WTPTR   ;GET POINTER
        CPI     80H     ;CHECK FOR ROLLOVER
        JNZ     WTBYT
        CALL    DISKCR
        XRA     A
WTBYT:  MOV     E,A     ;WRITE BYTE AT
        MVI     D,0     ;BUFF+A
        INR     A
        STA     WTPTR   ;UPDATE POINTER
        LXI     H,WTBUF
        DAD     D
        MOV     M,C     ;WRITE CHAR TO BUFF
        JMP     PREXIT  ;DONE
;
;       WRITE   SECTOR
;
DISKCR: PUSH    B
        LXI     D,WTBUF
        MVI     C,SDMA
        CALL    BDOS    ;SET WRITE DMA
        LXI     D,FCBH
        MVI     C,DWRIT ;WRITE SECTOR
        CALL    BDOS
        PUSH    PSW
        LXI     D,BUFF  ;RESET DMA ADDRESS
        MVI     C,SDMA
        CALL    BDOS
        POP     PSW
        CPI     0       ;CHECK FOR ERROR
        JZ      BNC2
        LXI     D,WEMS1
        MVI     C,WTFN
        CALL    BDOS    ;WRITE ERROR MESSAGE
        JMP     WBOOT
;
;
BNC2:   POP     B
        RET
;
;       CLOSE THE FILE
;
CLOSE:  LDA     CONTST  ;TEST FLAG
        CPI     0
        JNZ     WBOOT   ;DONE IF CONSOLE
        MVI     B,10    ;WRITE EOF MARKER
OVAGN:  MVI     C,CONZ
        CALL    PRINT
	DCR	B
        JNZ     OVAGN
        CALL    DISKCR  ;FINAL SECTOR
        LXI     D,FCBH
        MVI     C,CLSFN ;CLOSE FILE
        CALL    BDOS
        CPI     255     ;CHECK FOR ERRORS
        JNZ     WBOOT   ;NO ERROR, DONE.
        LXI     D,CLEER
        MVI     C,WTFN
        CALL    BDOS
        JMP     WBOOT
;
MOVIT:	MOV	A,M
	STAX	D
	INX	H
	INX	D
	DCR	C
	JNZ	MOVIT
	RET
;
;
;
;
;       SET UP FILES TO OPEN
;
SETUP:  MVI     C,OPENF
        CALL    BDOS
        CPI     255     ;CHECK FOR ERRORS
        RNZ
        LXI     D,OPNM
        MVI     C,WTFN
        CALL    BDOS
        JMP     WBOOT
;
;       READ A CHARACTER
;
READ:   PUSH    H
        PUSH    D
        PUSH    B
        LDA     EOFLG
        CPI     0
        JNZ     OUT1
        LDA     RIBP    ;GET POINTER
        CPI     80H
        JNZ     TEMP
        LXI     D,FCB
        MVI     C,READBL
        CALL    BDOS    ;READ NEW SECTOR
        CPI     0
        JZ      BNC1
        CPI     1       ;ERROR DETECTED
        JNZ     ALTER   ;EOF?
        MVI     A,1     ;YES, SET FLAG
        STA     EOFLG
        JMP     OUT1
;
;
ALTER:  LXI     D,RDERRM
        MVI     C,WTFN
        CALL    BDOS
        JMP     WBOOT
;
;
BNC1:   XRA     A
TEMP:   MOV     E,A     ;READ BYTE FROM
        MVI     D,0     ;BUFF+A
        INR     A
        STA     RIBP    ;UPDATE POINTER
        LXI     H,BUFF
        DAD     D
        MOV     A,M     ;GET BYTE
OUT1:   POP     B
        POP     D
        POP     H
        RET
;
;       STORAGE AND BUFFER
;
PTR:	DW	0000H	;BUFFER POINTER
RIBP:   DB      80H     ;READ POINTER
EOFLG:  DB      0       ;EOF FLAG
CONTST: DB      1       ;CONSOLE FLAG
WTPTR:  DB      0       ;WRITE POINTER
WTBUF:  DS      128     ;WRITE BUFFER
FCBH:   DS      33      ;FCB FOR HEX FILE
HEXT:   DB      'HEX'   ;DEFAULT EXTENSION
STACK:  DS      64      ;STACK AREA
STKTOP  EQU     $
;
;       ERROR MESSAGES
;
WEMS1:  DB      0DH,0AH,'ERROR ON CLOSING FILE', 0DH,0AH,'$'
CLEER:  DB      0DH,0AH,'ERROR ON CLOSING FILE', 0DH,0AH,'$'
RDERRM: DB      0DH,0AH,'ERROR ON READING FILE', 0DH,0AH,'$'
DIREM:  DB      0FH,0AH,'NO MORE DIRECTORY SPACE', 0DH,0AH,'$'
OPNM:   DB      0DH,0AH,'ERROR ON OPENING FILE', 0DH,0AH,'$'
ABORT:  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее	; HI-TECH S100 COLOUR VDU DRIVER
	; FOR MICROSOFT CP/M FORTRAN
	;
	; WRITTEN BY SJ WITHERS, SCHOOL OF
	; INDUSTRIAL AND BUSINESS STUDIES,
	; UNIVERSITY OF WARWICK, COVENTRY.
	;
	; VERSION 1 - APRIL 1980
	;
	; COMMERCIAL RIGHTS RESERVED, BUT
	; MAY BE FREELY USED FOR EDUCATIONAL,
	; PRIVATE AND OTHER NON-COMMERCIAL
	; PURPOSES. IN PARTICULAR, THIS
	; PIECE OF SOFTWARE MUST NOT BE OFFERED
	; FOR SALE.
	;
	ENTRY	$LUNTB
	EXT	$DRV3,LPTDRV,DSKDRV,$BF,$BL,$ERR,$IOERR
	;
	; FIRST, A SAMPLE LOGICAL UNIT NUMBER TABLE.
	; YOU MAY NEED TO MODIFY IT TO INCORPORATE
	; ANY OTHER SPECIAL PURPOSE DRIVERS YOU HAVE
	; WRITTEN OR INSTALLED.
	;
$LUNTB:	DB	0BH
ONE:	DW	$DRV3
TWO:	DW	LPTDRV
THREE:	DW	$DRV3
FOUR:	DW	$DRV3
FIVE:	DW	COLDRV		;THE COLOUR BOARD IS LOGICAL UNIT 5
SIX:	DW	DSKDRV
SEVEN:	DW	DSKDRV
EIGHT:	DW	DSKDRV
NINE:	DW	DSKDRV
TEN:	DW	DSKDRV
;
VRAMBA:	EQU	0F800H		;BASE ADDRESS OF VIDEO RAM
				; MAY NEED CHANGING TO SUIT
				; THE LOCATION OF THE BOARD
				; IN YOUR SYSTEM
	;
COLDRV:	DW	COLFR		;FORMATTED READ
	DW	COLFW		;FORMATTED WRITE
	DW	COLBR		;BINARY READ
	DW	COLBW		;BINARY WRITE
	DW	COLRE		;REWIND
	DW	COLBA		;BACKSPACE
	DW	COLEN		;ENDFILE
	;
COLRE:
COLBA:
COLEN:	XOR	A		;NO-OPS FOR TERMINAL DEVICES
	RET
	;
COLFR:
COLBR:
COLBW:	JP	$IOERR		;ILLEGAL OPERATIONS
	;
COLFW:				;NO  CR-LF IS PRINTED AT THE BEGINNING
				; OF A RECORD AS THIS CAN CAUSE
				; PROBLEMS WITH CURSOR ADDRESSING.
	LD	HL,($BF)	;BUFFER ADDRESS
	LD	A,($BL)		;NUMBER OF CHARS
	DEC	A		;LOSE 1ST CHAR
	INC	HL		; IE NO CARRIAGE CONTROL
	OR	A		;CONDITION ZERO FLAG
NEXTCH:	RET	Z		;DONE?
	PUSH	AF		;SAVE CHARACTER COUNT
	LD	A,(HL)		;GET CHARACTER
	INC	HL		;BUMP POINTER
	PUSH	HL		; & SAVE IT
	LD	B,A		;SAVE CHARACTER
	LD	A,(ESCFLG)	;WAS PREVIOUS CHARACTER ESC?
	OR	A		;CONDITION FLAGS
	JP	NZ,ESC
	LD	A,B		;RESTORE CHARACTER
	CP	A,32		;IS IT A CONTROL CHARACTER?
	JP	M,CONTRL
PUTCHR:	LD	HL,(CURLOC)	;GET CURSOR POSITION
	LD	(HL),A		;DISPLAY CHARACTER
	LD	A,(COL)
	INC	A		;BUMP COLUMN COUNT
	LD	(COL),A
	CP	A,40		;END OF LINE?
	JP	Z,NLINE
	INC	HL		;STILL HOLDS OLD CURLOC
	LD	(CURLOC),HL
	JP	RESTOR
	;
NLINE:	LD	A,0		;NEW COL WILL BE ZERO
	LD	(COL),A
	LD	A,(ROW)
	INC	A
	LD	(ROW),A		;BUMP ROW COUNTER
	CP	A,24		;END OF PAGE?
	JP	Z,TOP		;IF SO, START OVER
	LD	DE,25
	ADD	HL,DE		;RELATIVE ADDRESS OF NEW LOCATION
	LD	(CURLOC),HL
	JP	RESTOR
	;
TOP:	XOR	A
	LD	(ROW),A		;BACK TO TOP OF PAGE
	LD	HL,VRAMBA	;VIDEO RAM BASE ADDRESS
	LD	(CURLOC),HL
	;
RESTOR:	POP	HL		;RESTORE  BUFFER POINTER
	POP	AF		;AND CHARACTER COUNT
	DEC	A		;THAT'S ONE MORE DONE!
	JP	NEXTCH
	;
ESC:	XOR	A
	LD	(ESCFLG),A	;CLEAR ESCAPE FLAG
	LD	A,B		;CHARACTER BACK INTO A
	JP	PUTCHR
ESCFLG:	DB	0		;NON-ZERO INDICATES LAST CHARACTER
				;WAS  ESCAPE
	;
CONTRL:	CP	A,27		;IS IT ESCAPE?
	JP	Z,SETESC
	CP	A,13		;CARRIAGE RETURN?
	JP	Z,CRET
	CP	A,10		;LINE FEED?
	JP	Z,LFEED
	CP	A,3		;CURSOR X-Y?
	JP	Z,CURSOR
	CP	A,12		;FORM FEED? (ERASE PAGE)
	JP	Z,FFEED
	JP	RESTOR		;IGNORE ALL OTHERS
	;
SETESC:	LD	(ESCFLG),A	;ANY NON-ZERO WILL DO TO SET ESCFLG
	JP	RESTOR
	;
CRET:	LD	A,(COL)
	LD	B,A		;HOLD COLUMN NUMBER IN B
	LD	A,(CURLOC)	;GET LOW BYTE OF CURSOR ADDRESS
	SUB	A,B		;LOW BYTE OF BEGINNING OF LINE ADDRESS
	LD	(CURLOC),A	;NOTE THAT HIGH BYTE OF ADDRESS
				;DOESN'T CHANGE ON A LINE
	XOR	A
	LD	(COL),A		;ZERO COL COUNT
	JP	RESTOR
	;
LFEED:	LD	DE,64		;MOVE ON 64 BYTES FOR A LINEFEED
	LD	HL,(CURLOC)	;GET CURRENT CURSOR LOCATION
	ADD	HL,DE
	LD	(CURLOC),HL	;SAVE NEW LOCATION
	LD	A,(ROW)
	INC	A		;BUMP ROW COUNT
	LD	(ROW),A
	CP	A,24		;END OF PAGE
	JP	NZ,RESTOR	;IF NOT, RESTORE POINTER AND CHARACTER COUNT
	XOR	A
        LD	(ROW),A		;ZERO ROW COUNT
	LD	A,(COL)		;GET  COLUMN COUNT
	LD	E,A		;D STILL =0
	LD	HL,VRAMBA	;VIDEO RAM BASE ADDRESS
	ADD	HL,DE		;ADD OFFSET FOR COLUMN
	LD	(CURLOC),HL	;SAVE NEW CURSOR ADDRESS
	JP	RESTOR		;RESTORE POINTER AND COUNTER
	;
CURSOR:	POP	HL		;RESTORE PONTER
	POP	AF		;AND CHARACTER COUNT
	PUSH	AF		;SAVE IT AGAIN
	CP	A,2		;NEED  X AND Y
	JP	M,XYERR		;PRINT ERROR IF THEY'RE NOT THERE
	POP	AF
	DEC	A		;ONCE FOR X
	DEC	A		;ONCE FOR Y
	PUSH	AF		;SAVE IT (DEC FOR CODE 3 AT RESTOR)
	LD	A,(HL)		;X-COORD
	INC	HL
	LD	(COL),A		;SAVE NEW COLUMN
	LD	A,(HL)		;Y-COORD
	INC	HL
	LD	(ROW),A		;SAVE NEW ROW
	PUSH	HL		;SAVE BUFFER POINTER
				;NOW TO CALCULATE MEMORY LOCATION OF
				; NEW CURSOR POSITION.
				; EQUATION IS
				;  CURLOC=VRAMBA+(64.*ROW)+COL
	LD	E,A		;ROW INTO E
	LD	A,64		;CONSTANT 64 INTO H
	LD	H,A
				;UNSIGNED 8 * 8 BIT MULTIPLY
				;PERSONAL COMPUTER WORLD 
				;VOL1 NO2 PAGE 54
				;PARAMETERS IN H AND E REGS
				;RESULT IN HL
	LD	B,8		;LOOP COUNTER
	LD	D,0
	LD	L,D
MPY1:	ADD	HL,HL		;SHIFT HL LEFT
	JR	NC,MPY2		;SKIP IF C FLAG=0
	ADD	HL,DE		;ADD IN MULTIPLICAND
MPY2:	DJNZ	MPY1		;LOOP UNTIL DONE
	LD	D,H		;TRANSFER RESULT
	LD	E,L		;  INTO DE
	LD	HL,VRAMBA	;VIDEO RAM BASE ADDRESS
	ADD	HL,DE
	XOR	A
	LD	D,A
	LD	A,(COL)		;GET COLUMN 
	LD	E,A
	ADD	HL,DE		;ADD IN COLUMN 
	LD	(CURLOC),HL	;SAVE NEW CURSOR ADDRESS
	JP	RESTOR
	;
XYERR:	CALL	$ERR
	DB	'X-YERR'
	JP	RESTOR
	;
FFEED:	XOR	A		;REINITIALISE ROW AND COLUMN
	LD	(ROW),A
	LD	(COL),A
	LD	HL,VRAMBA	;BASE ADDRESS OF VIDEO RAM
	LD	(CURLOC),HL	;REINITIALISE CURSOR LOCATION
	LD	A,32		;FILLING SCREEN WITH SPACES
	LD	(HL),A		;WRITE THE FIRST SPACE
	LD	BC,05E7H	;NUMBER OF SPACES TO WRITE
	LD	D,H
	LD	E,L
	INC	DE		;ADDRESS OF FIRST DESTINATION
	LDIR			;WRITE THE SPACES
	JP	RESTOR	
	;
	;
	; DATA STORAGE
	;
CURLOC:	DW	0F800H
ROW:	DB	0
COL:	DB	0
	END
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееQQUCH
LETTER-A TEXT FORMATTING PROGRAM
QQC
^LIST OF ^COMMANDS
QQS 1
QQFN,QQJN
^BACKSLASH	^PRINTS AS EXACTLY ONE SPACE
^UP-ARROW	^CAPITALIZE THE FOLLOWING CHARACTER
^Q^Q^P		^SKIP TO NEXT PAGE
^Q^Q^S\N		^SKIP N LINES
^Q^Q^C		^CENTER THE NEXT LINE
^Q^Q^B        ^PRINT NEXT LINE ^B^O^L^D (DOUBLE PRINT)
^Q^Q^H        ^PRINT NEXT LINE IN ^CAPITALS
^Q^Q^U        ^UNDERLINE THE NEXT LINE
^Q^Q^C        ^AS ABOVE
^Q^Q^B^H^U^C   ^PRINT NEXT LINE BOLD CENTRED CAPITAL &
               UNDERLINED (ANY  COMBINATION BUT NOT STARTING
               WITH ^C!)
^Q^Q^F^Y		^ENABLES LINE FILLING
^Q^Q^F^N		^DISABLES LINE FILLING
^Q^Q^J^Y		^ENABLES JUSTIFICATION
^Q^Q^J^N		^DISABLES JUSTIFICATION
QQHC
NOTES
QQJY
QQFY
^THIS PROGRAM IS VERY SLOW AS IT RUNS UNDER ^BASIC - ^BUT IT
HAS THE GREAT ADVANTAGE OF BEING EASY TO PATCH (COMPARED TO A
COM FILE!). ^THIS IS IMPORTANT AS MOST ^PRINTERS HAVE FEATURES
SUCH AS DOUBLE WIDTH PRINT WHICH REQUIRE SPECIAL CONTROL CODES
TO INITIATE. ^WITH ^L^E^T^T^E^R YOU CAN ADD THESE FEATURES AS
YOU WISH.
QQS 1
^TO USE- ^CREATE A FILE USING ^E^D OR OTHER EDITOR. ^FILETYPE
MUST BE .^F^M^I ^THEN ^R^U^N ^L^E^T^T^E^R AND CHOOSE TO
PRINT IT OR FILE A COPY (^CREATES ^FILETYPE ^J^U^S).^IF
YOU WANT MORE THAN ONE COPY IT IS QUICKER TO FILE AND THEN
^R^U^N ^P^R^I^N^T WHICH PRINTS THE FORMATTED FILE.^NOTE THAT IF
YOU DONT USE THE ^B^O^L^D OPTION YOU CAN USE ^R^E^M^O^V^E TO ERASE
QUOTES FROM THE .^J^U^S FILE AND THEN JUST USE ^C^P/^MS ^T^Y^P^E
COMMAND TO OUTPUT.
QQS 1
^PLEASE NOTE THAT ^I HAVE PATCHED MY ^B^I^O^S TO SWITCH MY
PRINTER ^ON & ^OFF ON CONTROL ^P (HENCE THE ^C^H^R$(16)).^I
HIGHLY RECOMMEND THIS METHOD IF YOU HAVE IMPLEMENTED THE ^I^O
BYTE AT LOCATION 0003.^IF YOU WANT DETAILS OF HOW TO DO THIS
YOU ARE WELCOME TO CONTACT ME.
QQS 1
QQJN
QQJY
^MIKE ^MAGNAY
^TEL. ^ABINGDON 834402
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1 REM $$$ LETTER $$$  M.MAGNAY  6/10/80
REM A SIMPLE TEXT PROCESSING PROGRAM
REM ADAPTED & EXPANDED FROM <FORMAT> BY B.RATOFF 8/22/77
BLANK$="                                                    "
BK$=" "
FLAG1=0
FLAG2=0
GOSUB 900
GOSUB 730
50 NL=1
60 LO$=""
70 REM GET NEXT STRING AND CHECK FOR END OF DATA FLAG (..)
READ#1;LI$
IF END#1 THEN 800
IF LEN(LI$)=0 THEN GOSUB 1200 : GOTO 70
IF LEFT$(LI$,2)<>"QQ" THEN 77
IF LEN(LO$)>0 THEN GOSUB 1200
IF LEFT$(LI$,3)="QQJ" THEN JU$=MID$(LI$,4,1) : GOTO 70
IF LEFT$(LI$,3)="QQF" THEN FI$=MID$(LI$,4,1) : GOTO 70
IF LI$="QQP" THEN GOSUB 700 : NL=1 : LO$="" : GOTO 70
IF LEFT$(LI$,3)="QQS" THEN GOSUB 1000 : GOTO 70
IF LI$="QQC" THEN GOSUB 1100 : GOTO 70
FOR I=3 TO LEN(LI$)
SV$=MID$(LI$,I,1)
IF SV$="B" THEN FGB=1
IF SV$="U" THEN FGU=1
IF SV$="C" THEN FGC=1
IF SV$="H" THEN FGH=1
NEXT
GOSUB 5000
GOTO 70
77 GOSUB 400
IF FI$="N" THEN LO$=LI$ : GOSUB 1200 : GOTO 70
SC=1 : EC=LEN(LI$)
80 REM ANY WORDS LEFT IN STRING?
IF SC>EC THEN 70
150 REM GET NEXT WORD. NULL STRING IN W$ MEANS READ SOME MORE
GOSUB 300
IF W$="" THEN 70
160 REM WILL THIS WORD FIT ON THE CURRENT LINE?
IF LEN(LO$)+LEN(W$)>PW-1 THEN 200
REM IT FITS, SO ADD IT, INCL A SPACE IF NOT THE FIRST WORD
IF LEN(LO$)>0 THEN LO$=LO$+" "
LO$=LO$+W$
GOTO 80
200 REM COME HERE WITH A FULL LINE TO JUSTIFY AND PRINT IT
GOSUB 500
210 REM CALL THE BREAK ROUTINE
GOSUB 1200 : GOTO 160
300 REM ROUTINE TO MOVE NEXT WORD FROM LI$ TO W$
REM RETURNS THE NULL STRING IN W$ IF LI$ IS USED UP
W$="" : EW=SC
310 IF MID$(LI$,SC,1)<>" " THEN 350
SC=SC+1 : EW=SC
IF SC<=EC THEN GOTO 310 ELSE RETURN
350 EW=EW+1
360 IF EW>EC THEN 380
IF MID$(LI$,EW,1)<>" " THEN 350
380 W$=MID$(LI$,SC,EW-SC) : SC=EW : RETURN
400 REM ROUTINE TO CONVERT ALPHAS NOT PRECEDED BY "^" TO LC
LT$=""
FOR J=1 TO LEN(LI$)
LC$=MID$(LI$,J,1)
IF LC$<"A" OR LC$="\" THEN LT$=LT$+LC$ : GOTO 470
IF LC$<>"^" THEN 460
LT$=LT$+CHR$(ASC(MID$(LI$,J+1,1)) AND NOT 32) : J=J+1 : GOTO 470
460 LT$=LT$+CHR$(ASC(LC$) OR 32)
470 NEXT J
LI$=LT$
RETURN
500 REM ROUTINE TO JUSTIFY A LINE BY WIDENING WORD SPACING
IF JU$="N" THEN RETURN
IF LEN(LO$)>=PW OR LEN(LO$)<2 THEN 570
REM SCAN LINE FROM RIGHT TO LEFT (IT LOOKS BETTER)
FOR J=LEN(LO$) TO 2 STEP -1
REM ADD SPACE AT EACH WORD BOUNDARY;
IF MID$(LO$,J,1)<>" " OR MID$(LO$,J+1,1)=" " THEN 550
LO$=LEFT$(LO$,J)+MID$(LO$,J,255)
REM QUIT AS SOON AS LINE IS CORRECT LENGTH (PW)
IF LEN(LO$)>=PW THEN J=2
550 NEXT J
REM MAKE ANOTHER PASS IF IT'S STILL TOO SHORT
560 GOTO 500
570 RETURN
600 REM ROUTINE TO CONVERT SPECIAL SYMBOLS:
IF LEN(LO$)=0 THEN RETURN
LT$=""
FOR J=1 TO LEN(LO$)
LC$=MID$(LO$,J,1)
IF LC$="\" THEN LT$=LT$+" " : GOTO 610
LT$=LT$+LC$
610 NEXT J
LO$=LT$
RETURN
700 REM ROUTINE FOR END OF PAGE
IF NL+((PS-PP)/2)+1 > PS THEN 730
FOR I=NL+((PS-PP)/2)+1 TO PS:PRINT:NEXT I
REM IF PAUSE, RING BELL AND WAIT FOR 1 CHAR. FROM KEYBOARD
730 IF PU$="Y" THEN PRINT CHR$(7):OUT 255,0:GOSUB 750
IF PS-PP>1 THEN FOR QQ=1 TO (PS-PP)/2:PRINT:NEXT QQ
740 RETURN
750 REM WAIT FOR A CHARACTER ON CONSOLE "T"
IF (INP(0) AND 1)=1 THEN 750
QQ=INP(1)
RETURN
800 REM ROUTINE TO HANDLE LAST PAGE
GOSUB 600
GOSUB 2000
GOSUB 700
GOTO 999999
900 REM ROUTINE TO REQUEST AND CHECK PARAMETERS
INPUT "INPUT FILENAME";IFILE$
TFIL$=IFILE$+".FMI"
FILE TFIL$
INPUT "TOTAL LINES PER PAGE";PS
910 INPUT "PRINT LINES PER PAGE";PP
IF PP>PS THEN PRINT "INVALID":GOTO 910
930 INPUT "PAUSE AFTER EA. PAGE";PU$
PU$=LEFT$(PU$,1)
IF PU$<>"Y" AND PU$<>"N" THEN PRINT "INVALID":GOTO 930
INPUT "CHARACTERS PER LINE ";PW
INPUT"PRINT,FILE OR BOTH (P,F OR B)";DAT$
PF$=LEFT$(DAT$,1)
IF PF$="P" THEN FLAG1=1
IF PF$="F" THEN FLAG2=1
IF PF$="B" THEN FLAG1=1:FLAG2=1
SECFL$=IFILE$+".JUS"
IF FLAG2=1 THEN FILE SECFL$
IF FLAG1=1 THEN PRINT CHR$(16)
RETURN
1000 REM THIS ROUTINE HANDLES THE "QQS" (SKIP LINES) COMMAND
QQS=VAL(MID$(LI$,4,255))
IF QQS < 1 THEN RETURN
IF QQS + NL > PP THEN GOSUB 700 : NL=1 : RETURN
NL=NL+QQS
FOR QQQ=1 TO QQS : GOSUB 4000 : NEXT QQQ
RETURN
1100 REM THIS ROUTINE CENTERS THE NEXT LINE ON THE PAGE
READ#1;LI$ : GOSUB 400
QQC=INT((PW-LEN(LI$))/2)
LO$=LI$ : GOSUB 600
IF FLAG1=1 THEN PRINT TAB(QQC);LO$
IF FLAG2=1 THEN GOSUB 3000
GOSUB 1250
RETURN
1200 REM LINE BREAK ROUTINE
GOSUB 600 :GOSUB 2000
1250 NL=NL+1 : OUT 255,(NOT NL) AND 255
IF NL>PP THEN NL=PP : GOSUB 700 : NL=1
LO$=""
RETURN
2000 IF FLAG1=1 THEN PRINT LO$
IF FLAG2=1 THEN PRINT #2;LO$
RETURN
3000 ZZ$=LEFT$(BLANK$,QQC)
ZY$=ZZ$+LO$
PRINT #2;ZY$
RETURN
4000 IF FLAG1=1 THEN PRINT
IF FLAG2=1 THEN PRINT #2;BK$
RETURN
5000 READ#1;LI$
IF FGH=0 THEN GOSUB 400
IF FGC=1 THEN GOSUB 5200
LO$=LI$
IF FLAG1=0 THEN 5100
IF FGB=1 THEN GOSUB 5300
PRINT LO$
IF FGU=1 THEN GOSUB 5400
5100 IF FLAG2=0 THEN 5190
IF FGB=1 THEN PRINT#2;"QQB"
PRINT#2;LO$
IF FGU=0 THEN 5190
UNL$=""
FOR Y=1 TO LEN(LO$)
IF MID$(LO$,Y,1)=" " THEN UNL$=UNL$+" " ELSE UNL$=UNL$+"_"
NEXT
PRINT#2;UNL$
5190 FGB=0:FGU=0:FGC=0:FGH=0
IF FLAG1=1 THEN GOSUB 1250
LO$=""
RETURN
5200 QQC=INT((PW-LEN(LI$))/2)
LI$=LEFT$(BLANK$,QQC)+LI$
RETURN
5300 PRINT LO$;
PRINT CHR$(16);
PRINT
PRINT CHR$(16);
PRINT CHR$(13);
RETURN
5400 FOR I=1 TO LEN(LO$)
IF MID$(LO$,I,1)=" " THEN PRINT " "; ELSE PRINT "_";
NEXT I
NL=NL+1
RETURN
999999 IF FLAG1=1 THEN PRINT CHR$(16)
END
R:	DW BUFFER	; INITIALLY START OF BUFFER
BUFFER:		DB 0		; REST OF AVAILABLE RAM IS BUFFER

	END	100H


	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	
яяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееTO GET INSTRUCTIONS ON LETTER, COMPILE LETTER.BAS (BASIC E)
AND THEN RUN LETTER, AND ANSWER INST TO FILENAME.
EM:  DB      0FH,0AH,'NO MORE DIRECTORY SPACE', 0DH,0AH,'$'
OPNM:   DB      0DH,0AH,'ERROR ON OPENING FILE', 0DH,0AH,'$'
ABORT:  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1$0$2$3$4$3$4$3$3$32$32$2$2$255$2$2$2$7$255$2$16$4$255$2$255$255$2$2$2$2$2$2$2$16$16$13$16$*    'Ђ                                                      Ђ  Ђ. Ђ. ”"Ђ.  Ђ .  [&Ђ*>.  [^€АT. 7 }•6 \А. SQQ 7 Ћ6‚АT. 7 ›•А. SQQJ 7 №ЂА. .  U6 \А. SQQF 7 ЧЂА. .  U6 \АQQP 7 уаЂ.  Ђ 6 \А. SQQS 7я6 \АQQC 7R6 \Ђ	. 62АTЂ	.  А	 	7|Ђ
АА	.  UА
B 7LЂ.  А
U 7[Ђ.  А
C 7jЂ.  А
H 7yЂ.  6"%6 \kАN 7™ЂА•6 \Ђ.  ЂАTАА7°6 \щА 7ѕ6 \АTАT А.  7Т6рАT. 7еЂА  ЂАА6Ґч•6ѕЂ ЂААА.  U  762ЂА.   ЂААА
71662ЂА.   АА7F6XАА.  U  7X62ЂААААUЂАЂ Ђ.  6‰АTЂ.  А 	7сЂАА.  UАA А\ 7ЇЂАА6оА^ 7»6аЂААА.   .  UQ. 	RЂА.   6оЂААQ. 
R6yЂААN 7АTА	АT. 76…ЂАT6<. .  0А ЂЂ Ђ8
Ђ9	7‚АА.  U  АА.   .  U  7_6ЂААSАА. UАTА	7Ђ. 66чАT. 7‘Ђ Ђ.  6ЇАTЂ.  А 	7ЪЂАА.  UА\ 7ПЂА  6ЧЂАА6џЂАААА.  .   А7щ6"Ђ	ААА.  .   6АЂ	.  А	 	7"46АY 7>. R$4. . [[(nАА.  7mЂ.  6iАА. Ђ.  А 	7m46S. P.  .  7Ђ6nЂ.  P†Оа6ђINPUT FILENAME $4;Ђ1'ЂА.FMI Ђ А-TOTAL LINES PER PAGE $4;Ђ"'PRINT LINES PER PAGE $4;Ђ"'АА7INVALID $46ЫPAUSE AFTER EA. PAGE $4;Ђ1'ЂА.  SАY АN 7TINVALID $46CHARACTERS PER LINE  $4;Ђ"'PRINT,FILE OR BOTH (P,F OR B) $4;Ђ1'ЂА.  SАP 7±Ђ.  АF 7АЂ.  АB 7ХЂ.  Ђ.  ЂА.JUS А.  7пЂ А-А.  7ю. R$4Ђ А. . UXА .  7А А А7+аЂ.  ЂАА  Ђ!.  6KА Ђ!.  А! 	7Q6<.  [&Ђ*>kЂ"ААT. BЂА†А.  7…А"JА$4А.  7‘о›†ОЂА.   . А. [[(АА7ИЂАаЂ.  Ђ А.  7ЫА$4А.  7н. [&А,?Ђ#А А"SЂ$А#А. [&А$,?А.  74А.  7$. [&А,?.  [&Ђ*>А. 7;kА.  7G"ЂАА. 7X6tА.  7d<А$4А.  7tPА. 7Ђ6шА.  7•. [&QQB ,?. [&А,?А. 7Є6шЂ% Ђ&.  6ИАTЂ&.  А& 	7пАА&.  U  7гЂ%А%  6мЂ%А%_ 6ё. [&А%,?Ђ. Ђ. Ђ. Ђ. А.  7›Ђ Ђ"ААT.  BЂА А"SАА$. !R$4. "R$. #R$Ђ	.  6iАTЂ	.  А	 	7†АА	.  U  7  $6ѓ_ $6YЂА.   А.  7џ. $R$4Ђ"ААT.  BЂА А"SАА$. !R$4. "R$. #R$Ђ	.  6iАTЂ	.  А	 	7†АА	.  U  7  $6ѓ_ $6YЂА.   А.  7џ. $R$яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееREM MICROPLAN                                        MML Ltd.
REM =========                                        11 Sun Street
REM                                                  London E.C.2.
REM                                                  Tel: 01-247 0691
REM COPYRIGHT APRIL 1979
REM
REM ------------------------------------------------------------------
REM
REM
REM  Library of CBASIC utilities to assist in text input & output
REM
REM Operating environment:
REM
REM Hardware:	Digital Microsystems DSC4
REM CP/M:	Vers 2.2 with added features including clock & interrupts
REM CBASIC:	Vers 2.03
REM CRUN:	Vers 2.05
REM
REM ==================================================================
REM
REM FNQ%(QUERY$)
REM FUNCTION to request YES or NO to QUERY
REM
REM FNOK%
REM Function to request YES or NO to "O.K.(Y/N)" prompt
REM
REM
REM FNLINE$
REM FUNCTIOn FNLINE$ to return next word from LINE$
REM
REM
REM FNDATE%
REM Function to request date in Daym Month Year format
REM Returning logical function FNDATE%
REM FNDATE% = TRUE% if date o.k. or FALSE% if date in error
REM Date is returned in array D%(3) where 1 - Day, 2 - Month, 3 - Year
REM
REM
REM FNNOS(TEXT$)
REM FUNCTION FNNOS to return number from TEXT$
REM A value of 9.9E62 is used to indicate bad TEXT$
REM
REM
REM FNDM$(DATE%)
REM  Function returns day and month in form DD/MM
REM
REM
REM FNDMY$(DATE)
REM  Function returns d, month and year in form DD/MM/YY
REM
REM
REM FNDMYY$(DATE)
REM  Function returns day, month and year in form DD/MM/YYYY
REM
REM
REM FNMY$(DATE%)
REM  Function returns month and year in form MMM YY
REM  where MMM is character string
REM
REM
REM FNLINE$
REM FUNCTIOn FNLINE$ to return next word from LINE$
REM
REM
REM FNNEXTWORD$(QUERY$)
REM FUNCTIOn FNNEXTWORD$(QUERY$) to return next word from LINE$
REM
REM
REM FNNEWWORD$(QUERY$)
REM FUNCTIOn FNNEWWORD$(QUERY$) to return a new word from LINE$
REM
REM
REM FNNEXTLINE$(QUERY$)
REM FUNCTIOn FNNEXTLINE$(QUERY$) to return next word from LINE$
REM
REM
REM FNNEWLINE$(QUERY$)
REM FUNCTIOn FNNEWLINE$(QUERY$) to return a new word from LINE$
REM
REM
REM FNHM$(TIME%)
REM  Function returns hours and minutes in form HH:MM
REM  where TIME% is in minutes
REM
REM
REM FNHMS$(TIME)
REM  Function returns hours, minutes and seconds in form HH:MM:SS
REM  where TIME is in seconds
REM
REM =========================================================================
REM
%NOLIST
REM
REM
REM --------------------------------------
REM FUNCTION to request YES or NO to QUERY
REM --------------------------------------
TRUE%=-1: FALSE%=0
DEF FNQ%(QUERY$)
   QUERY%=TRUE%
   WHILE QUERY%
      PRINT QUERY$;: INPUT LINE ANS$
      ANS$=UCASE$(ANS$): LEN%=LEN(ANS$)
      IF LEN% > 0 AND ANS$ = LEFT$("YES",LEN%) THEN FNQ%=TRUE%: RETURN
      IF LEN% > 0 AND ANS$ = LEFT$("NO",LEN%) THEN FNQ%=FALSE%: RETURN
      PRINT "? ";ANS$;" ? - Answer YES or NO"
   WEND
FEND
REM ---------------------------------------------------
REM Function to request YES or NO to "O.K.(Y/N)" prompt
REM ---------------------------------------------------
DEF FNOK%
   QUERY%=TRUE%
   WHILE QUERY%
      INPUT "O.K.(Y/N)?";LINE ANS$
      ANS$=UCASE$(ANS$): LEN%=LEN(ANS$)
      IF LEN% > 0 AND ANS$ = LEFT$("YES",LEN%) THEN FNOK%=TRUE%: RETURN
      IF LEN% > 0 AND ANS$ = LEFT$("NO",LEN%) THEN FNOK%=FALSE%: RETURN
      PRINT "? ";ANS$;" ? - Answer YES or NO"
   WEND
FEND
REM --------------------------------------------
REM FUNCTIOn FNLINE$ to return next word from LINE$
REM --------------------------------------------
DEF FNLINE$
     SPACE%=MATCH(" ",LINE$,1): COMMA%=MATCH(",",LINE$,1)
     WHILE (SPACE% > COMMA% OR SPACE% = 0) AND (COMMA% <> 0)
        FNLINE$=UCASE$(LEFT$(LINE$,COMMA%-1))
        LINE$=MID$(LINE$,COMMA%+1,255): I%=LEN(LINE$)
        WHILE LEFT$(LINE$,1) = " " AND I% > 0
           LINE$=MID$(LINE$,2,256)
        WEND
        RETURN
     WEND
     WHILE (COMMA% > SPACE% OR COMMA% = 0) AND (SPACE% <> 0)
        FNLINE$=UCASE$(LEFT$(LINE$,SPACE%-1))
        LINE$=MID$(LINE$,SPACE%+1,256): I%=LEN(LINE$)
        WHILE LEFT$(LINE$,1) = " " AND I% > 0
           LINE$=MID$(LINE$,2,256)
        WEND
        RETURN
     WEND
     FNLINE$=UCASE$(LINE$): LINE$="": RETURN
FEND
REM ---------------------------------------------------------------
REM Function to request date in Daym Month Year format
REM Returning logical function FNDATE%
REM FNDATE% = TRUE% if date o.k. or FALSE% if date in error
REM Date is returned in array D%(3) where 1 - Day, 2 - Month, 3 - Year
REM ------------------------------------------------------------------
DEF FNDATE%
    FNDATE%=TRUE%
    WHILE LINE$=""
       INPUT "Day, Month, Year?";LINE LINE$
    WEND
    ANS$=FNLINE$: D%(1)=VAL(ANS$)
    IF D%(1) < 1 OR D%(1) > 32 THEN PRINT "? ";ANS$: FNDATE%=FALSE%: RETURN
    WHILE LINE$ = ""
       INPUT "Month?";LINE LINE$
    WEND
    ANS$=FNLINE$: D%(2)=VAL(ANS$)
    IF D%(2) < 1 OR D%(2) > 12 THEN PRINT "? ";ANS$: FNDATE%=FALSE%: RETURN
    WHILE LINE$ = ""
       INPUT "Year?";LINE LINE$
    WEND
    ANS$=FNLINE$: D%(3)=VAL(ANS$)
    IF D%(3) > 1900 THEN D%(3)=D%(3)-1900
    IF D%(3) < 79 OR D%(3) > 129 THEN PRINT "? ";ANS$: FNDATE%=FALSE%: RETURN
    RETURN
FEND
REM --------------------------------------------
REM FUNCTION FNNOS to return number from TEXT$
REM A value of 9.9E62 is used to indicate bad TEXT$
REM --------------------------------------------
DEF FNNOS(TEXT$)
     FNNOS=9.9E62
     LEN%=LEN(TEXT$)
     IF LEN% = 0 THEN PRINT "? ": RETURN
     R=VAL(TEXT$)
     IF LEN(STR$(R)) = LEN% THEN FNNOS=R ELSE PRINT "? "; TEXT$
     RETURN
FEND
REM ---------------------------------------------
REM  Function returns day and month in form DD/MM
REM ---------------------------------------------
DEF FNDM$(DATE%)
   IF DATE% = 0 THEN FNDM$="     ": RETURN
   F.M%=DATE%/100: F.D%=DATE%-F.M%*100
   FNDM$=CHR$(F.D%/10+030H)+CHR$(F.D%-(F.D%/10)*10+030H)+"/"+CHR$(F.M%/10+030H)+CHR$(F.M%-(F.M%/10)*10+030H)
   RETURN
FEND
REM ----------------------------------------------------
REM  Function returns d, month and year in form DD/MM/YY
REM ----------------------------------------------------
DEF FNDMY$(DATE)
   IF DATE = 0.0 THEN FNDMY$="        ": RETURN
   F.Y%=INT%(DATE/10000.0): DATE%=INT%(DATE-FLOAT(F.Y%)*10000.0)
   FNDMY$=FNDM$(DATE%)+"/"+CHR$((F.Y%-(F.Y%/100)*100)/10+030H)+CHR$(F.Y%-(F.Y%/10)*10+030H)
   RETURN
FEND
REM --------------------------------------------------------
REM  Function returns day, month and year in form DD/MM/YYYY
REM --------------------------------------------------------
DEF FNDMYY$(DATE)
    IF DATE = 0.0 THEN FNDMYY$="          ": RETURN
    F.YY%=INT%(DATE/10000.0): DATE%=INT%(DATE-F.YY%*100.0)
    IF F.YY% < 1900 THEN F.YY%=F.YY%+1900
    FNDMYY$=FNDM$(DATE%)+"/" \
       +CHR$(F.YY%/1000+030H)+CHR$((F.YY%-(F.YY%/1000)*1000)/100+030H)+CHR$((F.YY%-(F.YY%/100)*100)/10+030H)+CHR$(F.YY%-(F.YY%/10)*10+030H)
    RETURN
FEND
REM -----------------------------------------------
REM  Function returns month and year in form MMM YY
REM  where MMM is character string
REM -----------------------------------------------
DIM MONTH$(12)
READ MONTH$(1),MONTH$(2),MONTH$(3),MONTH$(4),MONTH$(5),MONTH$(6),MONTH$(7),MONTH$(8),MONTH$(9),MONTH$(10),MONTH$(11),MONTH$(12)
DATA "JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"
DEF FNMY$(DATE%)
    IF DATE% = 0 THEN FNMY$="      ": RETURN
    F.Y%=DATE%/100: F.M%=DATE%-F.Y%*100
    FNMY$=LEFT$(MONTH$(F.M%),3)+" "+CHR$((F.Y%-(F.Y%/100)*100)/10+030H)+CHR$(F.Y%-(F.Y%/10)*10+030H)
    RETURN
FEND
REM -----------------------------------------------
REM FUNCTIOn FNLINE$ to return next word from LINE$
REM -----------------------------------------------
DEF FNLINE$
     SPACE%=MATCH(" ",LINE$,1)
     WHILE SPACE% = 1
        LINE$=MID$(LINE$,2,256)
        SPACE%=MATCH(" ",LINE$,1)
     WEND
     COMMA%=MATCH(",",LINE$,1)
     WHILE (SPACE% > COMMA% OR SPACE% = 0) AND (COMMA% <> 0)
        FNLINE$=UCASE$(LEFT$(LINE$,COMMA%-1))
        LINE$=MID$(LINE$,COMMA%+1,255)
        WHILE LEFT$(LINE$,1) = " "
           LINE$=MID$(LINE$,2,256)
        WEND
        RETURN
     WEND
     WHILE (COMMA% > SPACE% OR COMMA% = 0) AND (SPACE% <> 0)
        FNLINE$=UCASE$(LEFT$(LINE$,SPACE%-1))
        LINE$=MID$(LINE$,SPACE%+1,256)
        WHILE LEFT$(LINE$,1) = " "
           LINE$=MID$(LINE$,2,256)
        WEND
        RETURN
     WEND
     FNLINE$=UCASE$(LINE$): LINE$="": RETURN
FEND
REM -----------------------------------------------------------
REM FUNCTIOn FNNEXTWORD$(QUERY$) to return next word from LINE$
REM -----------------------------------------------------------
DEF FNNEXTWORD$(QUERY$)
   WHILE LINE$ = "" : PRINT QUERY$; : INPUT "";LINE LINE$ : WEND
   FNNEXTWORD$=FNLINE$
   RETURN
FEND
REM -----------------------------------------------------------
REM FUNCTIOn FNNEWWORD$(QUERY$) to return a new word from LINE$
REM -----------------------------------------------------------
DEF FNNEWWORD$(QUERY$)
   LINE$=""
   FNNEWWORD$=FNNEXTWORD$(QUERY$)
   RETURN
FEND
REM -----------------------------------------------------------
REM FUNCTIOn FNNEXTLINE$(QUERY$) to return next word from LINE$
REM -----------------------------------------------------------
DEF FNNEXTLINE$(QUERY$)
   IF LINE$ = "" THEN PRINT QUERY$; : INPUT "";LINE LINE$
   FNNEXTLINE$=FNLINE$
   RETURN
FEND
REM -----------------------------------------------------------
REM FUNCTIOn FNNEWLINE$(QUERY$) to return a new word from LINE$
REM -----------------------------------------------------------
DEF FNNEWLINE$(QUERY$)
   LINE$=""
   FNNEWLINE$=FNNEXTLINE$(QUERY$)
   RETURN
FEND
REM -------------------------------------------------
REM  Function returns hours and minutes in form HH:MM
REM  where TIME% is in minutes
REM -------------------------------------------------
DEF FNHM$(TIME%)
   IF TIME% = 0 THEN FNHM$="     ": RETURN
   F.H%=TIME%/60: F.M%=TIME%-F.H%*60
   FNHM$=CHR$(F.H%/10+030H)+CHR$(F.H%-(F.H%/10)*10+030H)+":"+CHR$(F.F.M%/10+030H)+CHR$(F.F.M%-(F.F.M%/10)*10+030H)
   RETURN
FEND
REM -------------------------------------------------------------
REM  Function returns hours, minutes and seconds in form HH:MM:SS
REM  where TIME is in seconds
REM -------------------------------------------------------------
DEF FNHMS$(TIME)
   IF TIME = 0.0 THEN FNHMS$="        ": RETURN
   TIME%=INT%(TIME/60.0): F.S%=INT%(TIME-FLOAT(TIME%)*60.0)
   FNHMS$=FNHM$(TIME%)+":"+CHR$(F.S%/10+030H)+CHR$(F.S%-(F.S%/10)*10+030H)
   RETURN
FEND
%LIST
NT " "; ELSE PRINT "_";
NEXT I
NL=NL+1
RETURN
999999 IF FLAG1=1 THEN PRINT CHR$(16)
END
R:	DW BUFFER	; INITIALLY START OF BUFFER
BUFFER:		DB 0		; REST OF AVAILABLE RAM IS BUFFER

	END	100H


	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	
яяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
;MULTIPLE FILE TRANSFER UTILITY
;==============================
;
;
ENTRY	EQU	5	;BDOS ENTRY POINT
TFCB	EQU	5CH	;SYSTEM FCB
DBUF	EQU	80H	;SYSTEM DISK BUFFER
CR	EQU	0DH
LF	EQU	0AH
RCFC	EQU	01	;READ CONSOLE
WCFC	EQU	02	;WRITE CONSOLE
RDFC	EQU	13	;RESET DISK
OFFC	EQU	15	;OPEN FILE
CFFC	EQU	16	;CLOSE FILE
SFFC	EQU	17	;SEARCH FIRST
SNFC	EQU	18	;SEARCH NEXT
DFFC	EQU	19	;DELETE FILE
RRFC	EQU	20	;READ RECORD
WRFC	EQU	21	;WRITE RECORD
MFFC	EQU	22	;MAKE FILE
SAFC	EQU	26	;SET ADDRESS
FN	EQU	01	;FILE NAME OFFSET
FT	EQU	09	;FILE TYPE OFFSET
EX	EQU	12	;EXTENT NUMBER OFFSET
NR	EQU	32	;NEXT RECORD OFFSET
;
;
	ORG	100H
;
MFT:	LXI	SP,STACK+64
	LXI	H,MSG1	;PRINT 'MFT V3.1'
	CALL	WASC
	XRA	A	;CLEAR BREAK FLAGS
	STA	IBFLG
	STA	OBFLG
;
;CALCULATE BUFFER SIZE = FWA(BDOS)-FWA(MBUF)
;
	LHLD	ENTRY+1	;HL=ENTRY+1-6
	LXI	D,-6
	DAD	D
	MOV	A,L
	ANI	80H	;HL=HL MOD 128
	MOV	L,A
	LXI	D,MBUF	;HL=HL-FWA(MBUF)
	MOV	A,L
	SUB	E
	MOV	L,A
	MOV	A,H
	SBB	D
	MOV	H,A
	DAD	H	;HL=HL/128
	MOV	L,H
	MVI	A,0
	ACI	0
	MOV	H,A
	DCX	H	;HL=HL-1
	SHLD	SPACE	;SAVE BUFFER SIZE
	LXI	H,MSG2	;WRITE 'BUFFER SIZE = '
	CALL	WASC
	LHLD	SPACE	;WRITE SIZE OF BUFFER
	CALL	WDWC
	LXI	H,MSG3	;WRITE ' SECTORS'
	CALL	WASC
;
;ASK USER TO MOUNT INPUT DISK
;
MFT1:	LXI	H,MSG4	;WRITE 'MOUNT INPUT DISK, TYPE CR'
	CALL	WASC
	CALL	RACC	;READ RESPONSE
	CPI	CR	;WAIT FOR CR
	JNZ	MFT1
	CALL	WEOLC	;ECHO CR-LF
	LDA	IBFLG	;JUMP IF IBFLG SET
	ORA	A
	JNZ	MFT2A
;
;COPY COMMAND LINE INTO CBUF
;
	LXI	H,DBUF	;FWA OF COMMAND LINE IMAGE
	LXI	D,CBUF	;FWA OF COMMAND BUFFER
	MOV	B,M	;COMMAND LINE LENGTH
	INX	H
MFT2:	MOV	A,M	;NEXT BYTE FROM CLI
	INX	H
	STAX	D	;STORE IN DBUF
	INX	D
	DCR	B	;DECREMENT COUNT
	JNZ	MFT2	;LOOP TILL ZERO
	XRA	A
	STAX	D	;STORE ZERO END MARKER
	LXI	H,CBUF	;RESET CBUF
	SHLD	CBUFF
	CALL	CFNT	;CREATE FILE NAME TABLE
	LXI	H,FNT	;RESET POINTERS
	SHLD	IFNTP
	SHLD	OFNTP
MFT2A:	LXI	H,MBUF	;RESET MBUF POINTER
	SHLD	MBUFP
	LHLD	SPACE	;RESET MSIZE
	SHLD	MSIZE
	LDA	IBFLG
	ORA	A
	JZ	MFT3	;JUMP IF IBFLG NOT SET
	LXI	H,IFCB	;COPY IFCB TO TFCB
	LXI	D,TFCB
	MVI	B,33
	CALL	MOVE
	XRA	A
	STA	IBFLG	;CLEAR IBFLG
	MVI	A,1
	STA	OBFLG
	LHLD	IFNTP	;BACK IFNTP UP 4 BYTES
	LXI	D,-4
	DAD	D
	SHLD	IFNTP
	LXI	H,TFCB+FN;WRITE FILENAME
	CALL	WFCB
	LXI	H,MSG6	;WRITE ' - '
	CALL	WASC
	LHLD	IFNTP	;DE=IFNTP
	XCHG
	JMP	MFT4	;CONTINUE READING PREVIOUS FILE
;
;PARSE OFF NEXT NAME FROM CBUF
;
MFT3:	LHLD	IFNTP	;FETCH INPUT FNT POINTER
	MOV	A,M
	CPI	0FFH
	JZ	MFT9	;JUMP IF END OF TABLE
	MVI	M,1
	INX	H
	LXI	D,TFCB+FN;COPY FILENAME INTO TFCB
	MVI	B,11
	CALL	MOVE
	SHLD	IFNTP	;SAVE INPUT FNT POINTER
	LXI	H,TFCB+FN;WRITE FILENAME
	CALL	WFCB
	LXI	H,MSG6	;WRITE ' - '
	CALL	WASC
	XRA	A	;SETUP TFCB
	STA	TFCB
	STA	TFCB+EX
	STA	TFCB+NR
	CALL	OPEN	;OPEN FILE
	LHLD	IFNTP
	XCHG
MFT4:	LHLD	MBUFP
	MOV	A,H
	STAX	D	;COPY INTO FNT ENTRY
	INX	D
	MOV	A,L
	STAX	D
	INX	D
	XCHG		;SAVE FNT POINTER
	SHLD	IFNTP
	LXI	H,0	;FILE SIZE (SECTORS)=0
	SHLD	FSIZE
;
;READ NEXT FILE FROM INPUT DISK
;
MFT6:	LHLD	MBUFP
	XCHG
	CALL	SETDMA
	CALL	READ	;READ NEXT SECTOR
	ORA	A	;JUMP IF NORMAL TRANSFER
	JZ	MFT7
	CPI	1	;JUMP IF EOF
	JZ	MFT8
	LXI	H,MSG8	;WRITE 'READ ERROR - '
	CALL	WASC
	JMP	MFT8	;CONTINUE AS IF EOF
MFT7:	LHLD	MBUFP	;MBUFP=MBUFP+128
	LXI	D,128
	DAD	D
	SHLD	MBUFP
	LHLD	FSIZE	;FSIZE=FSIZE+1
	INX	H
	SHLD	FSIZE
	LHLD	MSIZE	;DECREMENT MSIZE
	DCX	H
	SHLD	MSIZE
	MOV	A,H	;LOPP IF STILL +VE
	ORA	L
	JNZ	MFT6
	LXI	H,TFCB
	LXI	D,IFCB	;COPY TFCB INTO IFCB
	MVI	B,33
	CALL	MOVE
	MVI	A,1	;SET IBFLG
	STA	IBFLG
MFT8:	LXI	D,DBUF	;RESET DMA POINTER
	CALL	SETDMA
	CALL	CLOSE	;CLOSE FILE
	LHLD	FSIZE	;WRITE FILE SIZE
	CALL	WDWC
	LXI	H,MSG9	;WRITE ' SECTORS READ
	CALL	WASC
;
; UPDATE FNT, LOOP
;
	LHLD	FSIZE	;DE=FILE SIZE
	XCHG
	LHLD	IFNTP
	MOV	M,D
	INX	H
	MOV	M,E
	INX	H
	SHLD	IFNTP	;SAVE FNT POINTER
	LDA	IBFLG	;LOOP IF IBFLG NOT SET
	ORA	A
	JZ	MFT3
;
;ASK USER TO MOUNT OUTPUT DISK
;
MFT9:	LXI	H,MSGA	;WRITE 'MOUNT OUTPUT DISK, TYPE CR
	CALL	WASC
	CALL	RACC	;READ RESPONSE
	CPI	CR
	JNZ	MFT9
	CALL	WEOLC	;ECHO CR,LF
	CALL	RESET	;RESET DISK SYSTEM (TO R/W)
	LDA	OBFLG
	ORA	A
	JZ	MFTA	;JUMP IF OBFLG NOT SET
	LXI	H,OFCB	;COPY OFCB TO TFCB
	LXI	D,TFCB
	MVI	B,33
	CALL	MOVE
	CALL	OPEN	;OPEN PREVIOUS FILE
	LHLD	OFNTP	;BACKUP O/P FNT PTR 4 BYTES
	LXI	D,-4
	DAD	D
	SHLD	OFNTP
	LXI	H,TFCB+FN
	CALL	WFCB	;WRITE FILENAME
	LXI	H,MSG6
	CALL	WASC	;WRITE ' - '
	JMP	MFTB
;
; WRITE NEXT FILE TO OUTPUT DISK
;
MFTA:	LHLD	OFNTP
	MOV	A,M
	ORA	A
	JZ	MFTF
	CPI	0FFH
	JZ	MFTF
	INX	H
	LXI	D,TFCB+FN
	MVI	B,11
	CALL	MOVE
	SHLD	OFNTP
	LXI	H,TFCB+FN
	CALL	WFCB
	LXI	H,MSG6
	CALL	WASC
	XRA	A
	STA	TFCB
	STA	TFCB+EX
	STA	TFCB+NR
	LDA	TFCB+9	;FORCE TO R/W FOR 2.0
	ANI	7FH
	STA	TFCB+9
	LDA	TFCB+10	;FORCE TO DIR FOR 2.0
	ANI	7FH
	STA	TFCB+10
	CALL	DELT
	CALL	MAKE	;TRY TO CREATE O/P FILE
	CPI	255	;O.K?
	JNZ	MFTB
	LXI	H,MSGB	;WRITE 'UNABLE TO CREATE'
	CALL	WASC
	JMP	MFTG
MFTB:	LHLD	OFNTP
	MOV	D,M	;FETCH FWA OF FILE FROM FNT
	INX	H
	MOV	E,M
	INX	H
	XCHG
	SHLD	MBUFP	;SAVE IT
	XCHG
	MOV	D,M	;FETCH FILE SIZE FROM FNT
	INX	H
	MOV	E,M
	INX	H
	XCHG
	SHLD	FSIZE
	SHLD	XSIZE	;SAVE FOR PRINTOUT
	XCHG
	SHLD	OFNTP
	LHLD	FSIZE	;JMP IF FSIZE=0
	MOV	A,H
	ORA	L
	JZ	MFTDA
MFTC:	LHLD	MBUFP	;SET DMA ADD TO MBUFP
	XCHG
	CALL	SETDMA
	CALL	WRITE
	ORA	A
	JZ	MFTD	;JUMP IF OK
	LXI	H,MSGC	;WRITE 'ERROR WRITING FILE'
	CALL	WASC
	JMP	MFTG
MFTD:	LHLD	MBUFP	;MBUFP=MBUFP+128
	LXI	D,128
	DAD	D
	SHLD	MBUFP
	LHLD	FSIZE	;FSIZE=FSIZE-1
	DCX	H
	SHLD	FSIZE
	MOV	A,H
	ORA	L	;LOOP TILL ZERO
	JNZ	MFTC
MFTDA:	LXI	H,TFCB	;COPY TFCB INTO OFCB
	LXI	D,OFCB
	MVI	B,33
	CALL	MOVE
	LXI	D,DBUF	;RESET DMA POINTER
	CALL	SETDMA
	CALL	CLOSE	;TRY TO CLOSE FILE
	CPI	255	;JUMP IF OK
	JNZ	MFTE
	LXI	H,MSGD	;WRITE 'UNABLE TO CLOSE'
	CALL	WASC
MFTE:	LHLD	XSIZE	;WRITE NO. OF SECTORS WRITTEN
	CALL	WDWC
	LXI	H,MSGE	;WRITE ' SECTORS WRITTEN'
	CALL	WASC
	JMP	MFTA
MFTF:	LDA	IBFLG	;LOOP IF IBFLG SET
	ORA	A
	JNZ	MFT1
MFTG:	JMP	0	;RETURN TO CPM
;
;	SUBROUTINES
;
MOVE:	MOV	A,M
	INX	H
	STAX	D
	INX	D
	DCR	B
	JNZ	MOVE
	RET
;
; GFN - GET FILE NAME
;
GFN:	MOV	A,M
	ORA	A
	RZ
	CPI	' '
	JNZ	GFN0
	INX	H
	JMP	GFN
;
GFN0:	LXI	D,XFCB
	XRA	A
	STAX	D
	INX	D
	PUSH	D
	MVI	B,11
	MVI	A,' '
GFN6:	STAX	D
	INX	D
	DCR	B
	JNZ	GFN6
	POP	D
	MVI	B,9
GFN1:	MOV	A,M
	ORA	A
	JZ	GFN4
	INX	H
	CPI	' '
	JZ	GFN4
	CPI	'.'
	JZ	GFN2
	CPI	'*'
	JZ	GFN7
	STAX	D
	INX	D
	DCR	B
	JZ	GFN5
	JMP	GFN1
;
GFN7:	DCR	B
	JZ	GFN9
	MVI	A,'?'
	STAX	D
	INX	D
	JMP	GFN7
;
GFN9:	MOV	A,M
	CPI	'.'
	JNZ	GFN4
	INX	H
GFN2:	LXI	D,XFCB+FT
	MVI	B,4
GFN3:	MOV	A,M
	ORA	A
	JZ	GFN4
	INX	H
	CPI	' '
	JZ	GFN4
	CPI	'*'
	JZ	GFN8
	STAX	D
	INX	D
	DCR	B
	JZ	GFN5
	JMP	GFN3
;
GFN8:	DCR	B
	JZ	GFN4
	MVI	A,'?'
	STAX	D
	INX	D
	JMP	GFN8
;
GFN4:	XRA	A
	RET
;
GFN5:	STC
	RET
;
;CFNT - CREATE FILE NAME TABLE
;
CFNT:	LXI	H,FNT
	SHLD	IFNTP
CFNT1:	LHLD	CBUFF
	MOV	A,M
	ORA	A	;EXIT IF END OF LIST
	RZ
	CALL	GFN	;GET NEXT AFN
	SHLD	CBUFF	;SAVE CMD BUFFER POINTER
	JNC	CFNT2	;JUMP IF FILE NAME OK
	LXI	H,MSG5	;WRITE 'SYNTAX ERROR IN FILE NAME'
	CALL	WASC
	JMP	CFNT1	;LOOP
;
CFNT2:	XRA	A	;CLEAR XFCB EXTENT FIELD
	STA	XFCB+EX
	LXI	D,XFCB
	CALL	SRCHF	;SEARCH FOR FIRST OCCURRENCE
	CPI	255	;JUMP IF FOUND
	JNZ	CFNT3
	LXI	H,XFCB+FN
	CALL	WASC
	LXI	H,MSG7	;WRITE ' NOT FOUND
	CALL	WASC
	JMP	0	;LOOP
;
CFNT3:	ANI	3	;INDEX INTO CBUF
	MOV	L,A
	MVI	H,0
	DAD	H
	DAD	H
	DAD	H
	DAD	H
	DAD	H
	LXI	D,DBUF
	DAD	D
	XCHG		;COPY FILENAME INTO FNT
	LHLD	IFNTP
	XCHG
	MVI	B,12
	CALL	MOVE
	LXI	H,ZEROS	;ZERO FILL REST OF ENTRY
	MVI	B,4
	CALL	MOVE
	XCHG
	SHLD	IFNTP	;SAVE INPUT FNT POINTER
	MVI	M,0FFH	;ENSURE FF BYTE AT END
	LXI	D,XFCB	;SEARCH FOR NEXT OCCURRENCE
	CALL	SRCHN
	CPI	255
	JNZ	CFNT3
	JMP	CFNT1	;GO GET NEXT AFN
;WFCB - WRITE FCB STRING TO CONSOLE
;
WFCB:	PUSH	B
	MVI	C,11
WFCB5:	MOV	A,M
	CALL	WACC
	INX	H
	DCR	C
	JNZ	WFCB5
	POP	B
	RET
;
;
;
;WASC - WRITE ASCII STRING TO CONSOLE
;
WASC:	MOV	A,M
	ORA	A
	RZ
	CALL	WACC
	INX	H
	JMP	WASC
;
;WEOLC - WRITE END OF LINE TO CONSOLE
;
WEOLC:	MVI	A,CR
	CALL	WACC
	MVI	A,LF
	JMP	WACC
;
;WDWC - WRITE DECIMAL WORD TO CONSOLE
;
WDWC:	PUSH H!PUSH D!PUSH B
	MVI	B,0	;CLEAR 'DIGIT WRITTEN' FLAG
	LXI	D,10000	;WRITE FIRST DIGIT
	CALL	WNDD
	LXI	D,1000	;WRITE 2ND DIGIT
	CALL	WNDD
	LXI	D,100	;WRITE 3RD DIGIT
	CALL	WNDD
	LXI	D,10	;WRITE 4TH DIGIT
	CALL	WNDD
	LXI	D,1	;WRITE 5TH DIGIT
	MVI	B,1	;FORCE LAST DIGIT TO PRINT
	CALL	WNDD
	POP B!POP D!POP H
	RET
;
WNDD:	MVI	C,0
WNDD1:	MOV	A,L
	SUB	E	;HL=HL-DE
	MOV	L,A
	MOV	A,H
	SBB	D
	MOV	H,A
	JC	WNDD2	;JUMP IF <0
	INR	C
	JMP	WNDD1	;LOOP
;
WNDD2:	DAD	D	;HL=HL+DE
	MOV	A,C
	ORA	C	;JUMP IF C NOT ZERO
	JNZ	WNDD4
	MOV	A,B
	ORA	B	;JUMP IF DIGIT WRITTEN
	JNZ	WNDD4
	MVI	A,' '	;WRITE ONE SPACE
	JMP	WACC
;
WNDD4:	MVI	B,1	;SET 'DIGIT WRITTEN' FLAG
	MOV	A,C	;ENCODE C INTO DECIMAL ASCII
	ADI	'0'
	JMP	WACC
;
;WACC - WRITE ASCII CHARACTER TO CONSOLE
;
WACC:	PUSH H!PUSH D!PUSH B!PUSH PSW
	MVI	C,WCFC
	MOV	E,A
	CALL	ENTRY
	POP PSW!POP B!POP D!POP H
	RET
;
;RACC - READ ASCII CHARACTER FROM CONSOLE
;
RACC:	PUSH H!PUSH D!PUSH B
	MVI	C,RCFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;RESET - RESET DISK SYSTEM
;
RESET:	PUSH H!PUSH D!PUSH B
	MVI	C,RDFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;OPEN - OPEN DISK FILE
;
OPEN:	PUSH H!PUSH D!PUSH B
	LXI	D,TFCB
	MVI	C,OFFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;READ - READ RECORD FROM DISK FILE
;
READ:	PUSH H!PUSH D!PUSH B
	LXI	D,TFCB
	MVI	C,RRFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;CLOSE - CLOSE DISK FILE
;
CLOSE:	PUSH H!PUSH D!PUSH B
	LXI	D,TFCB
	MVI	C,CFFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;DELT - DELETE DISK FILE
;
DELT:	PUSH H!PUSH D!PUSH B
	LXI	D,TFCB
	MVI	C,DFFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;MAKE - MAKE NEW DISK FILE
;
MAKE:	PUSH H!PUSH D!PUSH B
	LXI	D,TFCB
	MVI	C,MFFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;WRITE - WRITE RECORD TO FILE
;
WRITE:	PUSH H!PUSH D!PUSH B
	LXI	D,TFCB
	MVI	C,WRFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;SETDMA - SET DMA ADDRESS
;
SETDMA:	PUSH H!PUSH D!PUSH B
	MVI	C,SAFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;SRCHF - SEARCH FOR NEXT OCCURRENCE OF AFN
;
SRCHF:	PUSH H!PUSH D!PUSH B
	MVI	C,SFFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;SRCHN - SEARCH FOR NEXT OCCURRENCE OF AFN
;
SRCHN:	PUSH H!PUSH D!PUSH B
	MVI	C,SNFC
	CALL	ENTRY
	POP B!POP D!POP H
	RET
;
;MESSAGE AREA
;
MSG1:	DB	'MFT V3.1',CR,LF,0
MSG2:	DB	'BUFFER SIZE = ',0
MSG3:	DB	' SECTORS',CR,LF,0
MSG4:	DB	'MOUNT INPUT DISK, TYPE CR',0
MSG5:	DB	'SYNTAX ERROR IN FILENAME',CR,LF,0
MSG6:	DB	' - ',0
MSG7:	DB	' NOT FOUND',CR,LF,0
MSG8:	DB	'READ ERROR - ',0
MSG9:	DB	' SECTORS READ',CR,LF,0
MSGA:	DB	'MOUNT OUTPUT DISK, TYPE CR',0
MSGB:	DB	'unable to create',CR,LF,0
MSGC:	DB	'error writing file',CR,LF,0
MSGD:	DB	'unable to close',CR,LF,0
MSGE:	DB	' sectors written',CR,LF,0
;
;
ZEROS:	DB	0,0,0,0
;
;
	ORG	($+15)/16*16
;
FNT:	DS	16*64+1
STACK:	DS	64
SPACE:	DS	2
MSIZE:	DS	2
CBUF:	DS	80
CBUFF:	DS	2
FSIZE:	DS	2
XSIZE:	DS	2
IFNTP:	DS	2
OFNTP:	DS	2
MBUFP:	DS	2
IFCB:	DS	33
OFCB:	DS	33
XFCB:	DS	33
IBFLG:	DS	1
OBFLG:	DS	1
;
MBUF	EQU	$
;
	END	MFT
EM:  DB      0FH,0AH,'NO MORE DIRECTORY SPACE', 0DH,0AH,'$'
OPNM:   DB      0DH,0AH,'ERROR ON OPENING FILE', 0DH,0AH,'$'
ABORT:  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1б
!ҐНњЇ2¤2Ґ* ъя}жЂo¦}“o|љg)l> О g+"б
!°Нњ*б
Н°!їНњ!КНњНюВAН¦:¤·В}!Ђ е
F#~#ВaЇ!е
"5Н! ";"=!¦"?*б
"г
:¤·КБ!A\ !НЇ2¤>2Ґ*;ья";!] НЋ!яНњ*;лГх*;~юяК{6#] Н";!] НЋ!яНњЇ2\ 2h 2| Н'*;л*?|}л";!  "7*?лНЃН6·К$юКQ!НњГQ*?Ђ "?*7#"7*г
+"г
|µВ!\ A!Н>2¤Ђ НЃНE*7Н°!Нњ*7л*;r#s#";:¤·КБ!.НњНюВ{Н¦Н:Ґ·КЅ!b\ !НН'*=ья"=!] НЋ!яНњГ*=~·КЋюяКЋ#] Н"=!] НЋ!яНњЇ2\ 2h 2| :e ж2e :f ж2f НTНcюяВ!IНњГ•*=V#^#л"?лV#^#л"7"9л"=*7|µК`*?лНЃНr·КJ!\НњГ•*?Ђ "?*7+"7|µВ3!\ b!НЂ НЃНEюяВ!qНњ*9Н°!ѓНњГЅ:¤·ВAГ  ~#ВЙ~·Ию В­#ГЎѓЇХ> ВёС	~·К#ю Кю.Ксю*КЯКГБКк>?ГЯ~ю.В#Њ~·К#ю Кю*ККГцК>?ГЇЙ7Й! ";*5~·ИНЎ"5Т<!дНњГ$Ї2ЏѓНЌюяВZ!„Нњ!НњГ  жo& )))))Ђ л*;лН!–Нл";6яѓН™юяВZГ$Е~Н #В‘БЙ~·ИН #Гњ>Н >
Г еХЕ 'НЩиНЩd НЩ
 НЩ НЩБСбЙ }“o|љgЪиГЫy±Вшx°Вш> Г yЖ0Г еХЕх_Н сБСбЙеХЕН БСбЙеХЕН БСбЙеХЕ\ Н БСбЙеХЕ\ Н БСбЙеХЕ\ Н БСбЙеХЕ\ Н БСбЙеХЕ\ Н БСбЙеХЕ\ Н БСбЙеХЕН БСбЙеХЕН БСбЙеХЕН БСбЙMFT V3.1
 BUFFER SIZE =   SECTORS
 MOUNT INPUT DISK, TYPE CR SYNTAX ERROR IN FILENAME
  -   NOT FOUND
 READ ERROR -   SECTORS READ
 MOUNT OUTPUT DISK, TYPE CR UNABLE TO CREATE
 ERROR WRITING FILE
 UNABLE TO CLOSE
  SECTORS WRITTEN
                                                                                                           ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееMFT - a Multiple File Transfer Utility
======================================

by Lawrence E. Hughes
Mycroft Labs, P.O.Box 6045
Tallahassee, FL 32301

The listing for this utility appeared in Dr.Dobbs, October 1980.

" This article describes the design and
use of a utility which makes it practical
to use a single disk drive on the Digital
Research CP/M operating system. The
entire source is included in this article,
and is also available from the author
on an 8" single density, 128-byte sector
diskette, along with a few other public
domain programs, from the above address,
for $15. I hereby release MFT into
the public domain, for use on any CP/M
(or other) system. No right is granted
for resale, with or without modifications.

To use MFT, merely type its name,
followed by one or more ambiguous file
names (using ? and/or * wildcards).
You will be prompted to mount the input
disk and type CR. At this time, the disk
with MFT may be removed, if the desired
files are on a different disk. Once the
input disk is mounted, the directory
will be searched and a list of all file
names which satisfy at least one of the
ambiguous file names will be compiled.
As many files as will fit into memory will
then be read. You will then be asked to
mount the output disk and type CR.
Note that MFT can write on this disk
without your having to 'log it in'. All
data read from the input disk is then
written to the output disk. If more
files remain to be read, this cycle repeats
until all files are transferred. As an
example, MFT *.* may be used to copy 
all files from one disk to another.

 Ђ"ААT.  BЂА А"SАА$. !R$4. "R$. #R$Ђ	.  6iАTЂ	.  А	 	7†АА	.  U  7  $6ѓ_ $6YЂА.   А.  7џ. $R$4Ђ"ААT.  BЂА А"SАА$. !R$4. "R$. #R$Ђ	.  6iАTЂ	.  А	 	7†АА	.  U  7  $6ѓ_ $6YЂА.   А.  7џ. $R$яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;****************************************;
;     MULTIPLE FILE PRINT UTILITY        ;
;****************************************;

;VERSION 1.1
;ORIGINAL CODED BY JEFF KRAVITZ
;MODIFIED BY A. GOLD AND ANDREW CLARKE
;CONDITIONAL ASSEMBLY FOR <FF> HARDWARE AND
;OUTPUT TO CONSOLE OR CP/M LIST DEVICE
;10/15/77
;MULTIPLE FILE ACCESS ADDED 3/26/81
;THIS VERSION IS MEANT AS A 'STRIPPED'
;PROGRAMME TO HACK AS APPROPRIATE FOR
;YOUR SYSTEM. THERE ARE ROUTINES IN THE
;BIG VERSION IN THE U.S.USERGROUP NO
;15.12 TO DO PAGINATION AND PRINT PITCH
;FOR DIABLO. THIS VERSION IS INTENDED TO
;PRINT OUT BATCHES OF ASSEMBLY LISTINGS
;OR DOCUMENTATION WHILE I GO AWAY TO HAVE
;A NICE CUP OF TEA
;TO USE TYPE-
;PRINT AFN.TYP AFN.TYP ............AFN.TYP
;   IN OTHER WORDS IT WILL ACCEPT A
;COMMAND LINE OF A LIST OF UNAMBIGUOUS
;OR AMBIGUOUS FILENAMES
;   PRINT *.* WOULD PRINT OUT THE WHOLE
;DISK
;
;TO MAKE THIS PROGRAMME, I RIPPED THE
;GUTS OUT OF THE PROGRAMME MFT FROM
;DR DOBBS .
;
;IF YOU HAVE A QUERY, PHONE ME ON
;SUDBURY (SUFFOLK) 76601
; ANDREW R.M.CLARKE 7/4/81



;	*** MISCELLANEOUS EQUATES ***


MAXLN	EQU	56	;LINES/PAGE
NULLS	EQU	0	;NULLS AFTER A FORM FEED

FN	EQU	01	;FILE NAME OFFSET
FT	EQU	09	;FILE TUPE OFFSET
EX	EQU	12	;FILE EXTENT OFFSET
NR	EQU	32	;NEXT RECORD OFFSET

CPM	EQU	0005H	;CPM ENTRY POINT
DBUF	EQU	0080H	;TRANSIENT PROGRAM BUFFER 
TFCB	EQU	005CH	;TRANSIENT PROGRAM FCB

PBUFF	EQU	09	;PRINT BUFFER CODE
OPEN	EQU	15	;OPEN FUNCTION CODE
READ	EQU	20	;READ FUNCTION CODE
SEARF	EQU	17	;SEARCH FUNCTION CODE
SEARN	EQU	18	;SEARCH NEXT FUNCTION CODE

LINES	EQU	7	;LINES TO PAGE TOP

LF	EQU	0AH	;<LF>
FF	EQU	0CH	;<FF>
CR	EQU	0DH	;<CR>
TAB	EQU	09H	;<TAB>
SPACE	EQU	20H	;<SPACE>
DOT	EQU	2EH	;FULL STOP
RUBOUT	EQU	7FH	;USED AS FF NULL. MAY CAUSE PROBLEM
			;TO SOME PRINTERS

ODEV	EQU	2	;CON:=2  LST:=5
FORM	EQU	0FFFFH	;SET 0FFFFH FOR 0CH <FF>
			;SET 0 FOR <LF>'S TO PAGE TOP



;	*** MAIN PROGRAMME START ***
;	----------------------------



	ORG	100H
	JMP	START


;	*** PUT FILE IDENTITY IN OBJECT CODE ***

	DB	'/ PRINT UTILITY VERS. 1.6 /'
	IF FORM
	DB	' HARDWARE FF /'
	ENDIF
	IF	NOT FORM
	DB	' LF TO PAGE TOP /'
	ENDIF
	IF	NOT ODEV-5
	DB	' OUT TO LST: /'
	ENDIF
	IF	NOT ODEV-2
	DB	' OUT TO CON: /'
	ENDIF
	DB	'MULTIPLE FILE ACCESS  /'


;	*** SET UP THE STACK ***


START:	LHLD	CPM+1
	DCX	H
	SPHL
Љ;	*** MOVE COMMAND LINE TO CBUF ***

	LXI	H,DBUF	;ADDRESS OF COMMAND
	LXI	D,CBUF	;ADDRESS OF CBUFFER
	MOV	B,M	;GET LENGTH
	MOV	A,B	;CHECK FOR ENTRY
	ORA	A	;IS LENGTH ZERO?
	JZ	ERROR	;IF SO, ABORT
	INX	H
MOVCOM:	MOV	A,M	;GET NEXT BYTE
	INX	H
	STAX	D	;STORE IN CBUF
	INX	D
	DCR	B	;DECREMENT COUNT
	JNZ	MOVCOM
	XRA	A
	STAX	D	;STORE ZERO AT END

;	*** FILL FILE NAME TABLE ***

	LXI	H,CBUF	
	SHLD	CBUFF	;RESET CBUF POINTER
	CALL	CFNT	;WRITE FILE NAME TABLE
	LXI	H,FNT
	SHLD	IFNTP	;RESET FNT POINTER


;	*** FETCH NEXT FILENAME ***

FETCH:	LHLD	IFNTP	;FETCH FNT POINTER
	MOV	A,M
	CPI	0FFH	;IS IT END OF TABLE?
	JZ	GOCPM	;IF SO,JOB DONE
	MVI	M,1
	INX	H

	LXI	D,TFCB+FN ;COPY IN FILENAME
	MVI	B,11
	CALL	MOVE
	SHLD	IFNTP	;SAVE FNT POINTER

	XRA	A	;CLEAR THE FCB
	STA	TFCB
	STA	TFCB+EX
	STA	TFCB+NR


;	*** RESET POINTERS AND COUNTERS ***

	XRA	A
	STA	COL
	STA	PAGE
	STA	PAGE+1
	LXI	H,DBUF+128	
	SHLD	INPTRЉ
;	*** OPEN THE NEXT FILE ***


	LXI	D,TFCB	;POINT TO FCB
	CALL	FOPEN	;OPEN FILE
	JC	ERROR	;IF ERROR, EXIT
;
	IF	FORM	;DO <FF> IF HARDWARE
	CALL	TOF	;PRINT HEADING
	ENDIF
;
	IF 	NOT FORM;IF NO HARDWARE, ASSUME THERE
	CALL TOF3
	ENDIF
;

;	*** FILE PRINTING LOOP ***

LOOP:	CALL	GETBT	;GET A BYTE
	JC	ERROR	;ERROR
	CPI	1AH	;EOF?
	JZ	DONE	;YES
	CPI	CR	;CR?
	JZ	CRET	;YES
	CPI	LF	;LF?
	JZ	LFEED	;YES
	CPI	TAB	;TAB?
	JZ	TABMOV	;YES
	CPI	SPACE	;ODD CONTROL CHR?
	JNC	LOOPX	;NO, PRINT CHR.
	JMP	LOOP	;YES, DROP IT

;	*** SPACE TO NEXT TAB STOP ***

TABMOV:	LXI	H,COL	;POINT TO COLUMN
TBLP:	MVI	A,SPACE	;PRINT ONE SPACE
	CALL	PBYT
	MOV	A,M	;GET COLUMN
	ANI	07H	;MODULO 8
	JNZ	TBLP	;IF NOT AT TAB STOP, KEEP TYPEIN
	JMP	LOOP
LOOPX:	CALL	PBYT	;PRINT BYTE
	JMP	LOOP

;	*** ZERO COLUMN COUNTER AND TYPE CR ***

CRET:	XRA	A
	STA	COL
	MVI	A,CR
	JMP	LOOPX

;	*** PROCESS LINE FEEDS ***

LFEED:	LDA	LINE	;GET LINE COUNTЉ	CPI	MAXLN	;PAGE OVERFLOW?
	JZ	NEWPG	;YES
	INR	A	;BUMP LINE COUNT
	STA	LINE
	MVI	A,LF
	JMP	LOOPX	;CONTINUE

;	*** GO TO NEW PAGE ***

NEWPG:	MVI	A,CR
	CALL	PBYT	;PRINT CR
	CALL	TOF
	JMP	LOOP
;
;	*** SUBROUTINE TO PRINT PAGE NO. AND TITLE ***
;	*** FORM FEED,PRINT TITLE AND PAGE ***

;
	IF	FORM	;ROUTINE TO FORM FEED WITH 0CH
TOF:	MVI	A,FF	;FORM FEED
	CALL	PBYT
	MVI	B,NULLS	;NUMBER OF RUBOUTS
TOF2:	MVI	A,RUBOUT
	CALL	PBYT
	DCR	B	;DCREMENT COUNT
	JNZ	TOF2	;PRINT 'N' RUBOUTS
	ENDIF
;
;
	IF	NOT FORM;ROUTINE TO PAGE TOP WITH <LF>'S
TOF:	MVI	B,LINES	;NUMBER OF LINES
TOF2:	MVI	A,LF	;<LF>
	CALL	PBYT
	DCR	B	;DCREMENT COUNT
	JNZ	TOF2	;PRINT 'N' <LF>'S
	ENDIF
;
;
TOF3:	LXI	H,FMSG	;POINT TO MESSAGE
	CALL	PSTRNG	;PRINT STRING
	LXI	H,TFCB ;POINT TO FCB
	CALL	TYPFCB	;TYPE THE FILENAME
	LXI	H,PMSG	;POINT TO MESSAGE
	CALL	PSTRNG	;PRINT STRING
	LHLD	PAGE	;GET PAGE NUMBER
        INX     H       ;BUMP IT
	SHLD	PAGE	;SAVE IT
	CALL	DEC	;CONVERT TO DECIMAL
	MVI	A,CR	;PRINT CR
	CALL	PBYT
	MVI	A,LF
	CALL	PBYT	;PRINT LF
	MVI	A,LF
	CALL	PBYT	;AND SECOND
	MVI	A,LFЉ	CALL	PBYT	;AND A THIRD
	XRA	A
	STA	LINE	;RESET LINE COUNT
	STA	COL	;RESET COLUMN
	RET

;	*** PRINT OUT A BYTE ***

PBYT:	PUSH	H
	PUSH	B
	PUSH	PSW
	MOV	E,A
	MVI	C,ODEV
	CALL	CPM	;PRINT
	POP	PSW
	CPI	SPACE	;NON-PRINTING?
	JC	PBY2	;YES, DONT BUMP COL
	LXI	H,COL	;INCREMENT COLUMN
	INR	M
PBY2:	MVI	C,11	;GET CONSOLE STATUS
	CALL	CPM
	CPI	00	;BREAK?
	JNZ	GOCPM	;YES, DONE
	POP	B
	POP	H
	RET

;	*** PRINT A STRING ( TERMINATED BY $) ***

PSTRNG:	MOV	A,M	;GET BYTE
	CPI	'$'	;STRING END?
	RZ		;YES, DONE
	CALL	PBYT	;PRINT BYTE
	INX	H	;BUMP POINTER
	JMP	PSTRNG	;LOOP

;	*** PRINT B BYTES FROM HL (NOT SPACE) ***

PCNT:	MOV	A,M	;GET BYTE
	CPI	SPACE	;IS IT A SPACE?
	CNZ	PBYT	;PRINT IT IF NOT SPACE
	INX	H	;BUMP POINTER
	DCR	B	;DECREMENT COUNT
	JNZ	PCNT
	RET

;	*** PRINT 16 BIT NUMBER IN HL (DECIMAL ***

DEC:    PUSH H!PUSH D!PUSH B
        MVI     B,0     ;CLEAR 'DIGIT WRITTEN' FLAG
        LXI     D,10000 ;WRITE FIRST DIGIT
        CALL    DIG
        LXI     D,1000  ;WRITE SECOND DIGIT
        CALL    DIG
        LXI     D,100   ;AND THE THIRD!Љ        CALL    DIG
        LXI     D,10    ;THE FOURTH
        CALL    DIG
        LXI     D,1
        MVI     B,1     ;FORCE LAST DIGIT TO PRINT
        CALL    DIG
        POP B!POP D!POP H
        RET

DIG:    MVI     C,0
DIG1:   MOV     A,L
        SUB     E       ;HL=HL-DE
        MOV     L,A
        MOV     A,H
        SBB     D
        MOV     H,A
        JC      DIG2   ;JUMP IF <0
        INR     C
        JMP     DIG1   ;LOOP

DIG2:   DAD     D       ;HL=HL+DE
        MOV     A,C
        ORA     C
        JNZ     DIG3
        MOV     A,B
        ORA     B       ;JUMP IF DIGIT WRITTEN
        JNZ     DIG3
        MVI     A,' '
        JMP     PBYT
        
DIG3:   MVI     B,1
        MOV     A,C
        ADI     '0'
        JMP     PBYT



;	*** DO A FF AT THE END OF FILE ***

	IF	FORM
DONE:	MVI	A,FF	;FORM FEED
	CALL	PBYT
	MVI	B,NULLS	;RUBOUT COUNT
DLP2:	MVI	A,RUBOUT
	CALL	PBYT
	DCR	B
	JNZ	DLP2
	ENDIF
;
	IF	NOT FORM
DONE:	LXI	H,LINE	;POINT TO CURRENT LINE
	MVI	A,MAXLN
	SUB	M	;LINES LEFT TO PRINT
	ADI	LINES	;PLUS LINE TO PAGE TOP
	MOV	B,AЉDLP2:	MVI	A,LF	;<LF>
	CALL	PBYT
	DCR	B	;DCREMENT COUNT
	JNZ	DLP2	;PRINT 'N' LINES TO PAGE TOP
	ENDIF
;
	JMP	FETCH	;GO GET ANOTHER FILE

;	*** EXIT IF IRRECOVERABLE ERROR ***

ERROR:	LXI	D,ERMSG
	MVI	C,PBUFF	;WRITE MSG
	CALL	CPM
GOCPM:	JMP	0000H


 
;	*** OPEN FCB IN DE, SET CARRY IF ERROR ***


FOPEN:	MVI	C,OPEN	;OPEN CODE
	CALL	CPM	;ISSUE OPEN
	CPI	0FFH	;ERROR?
	JZ	FOERR	;YES
	XRA	A	;CLEAR CARRY
	RET
FOERR:	LXI	D,FOERRM;'OPEN FILE ERROR'
	MVI	C,PBUFF	;PRINT BUFFER BDOS CALL
	CALL	CPM
	STC
	RET


;	*** SEARCH FOR FIRST OCCURENCE ***

SRCHF:	PUSH H!PUSH D!PUSH B
	MVI	C,SEARF
	CALL	CPM
	POP B! POP D! POP H
	RET

;	*** SEARCH FOR NEXT OCCURENCE ***

SRCHN:	PUSH H!PUSH D!PUSH B
	MVI	C,SEARN
	CALL	CPM
	POP B!POP D!POP H
	RET

;	*** READ A BYTE FROM THE FILE ***

GETBT:	LXI	H,DBUF+128
	XCHG		;BUFFER END ADDR. IN DE
	LHLD	INPTR	;CURRENT POINTER IN HL
	CALL	CPHL	;TEST FOR END OF BUFFERЉ	JZ	GETB2	;YES, READ
GETB1:	MOV	A,M	;GET BYTE
	INX	H	;BUMP POINTER
	SHLD	INPTR	;SAVE POINTER
	ORA	A	;RESET CARRY
	RET
GETB2:	MVI	C,READ	;READ CODE
	LXI	D,TFCB	;FCB ADDRESS
	CALL	CPM	;ISSUE READ
	CPI	00	;ERROR?
	JNZ	IERR	;YES
	LXI	H,DBUF	;RESET BUFFER POINTER
	SHLD	INPTR
	JMP	GETB1	;CONTINUE
IERR:	STC
	RET


;	*** PRINT THE FCB ADDRESSED BY HL ***

TYPFCB:	INX	H	;POINT TO FN
	MVI	B,8	;LENGTH OF NAME
	CALL	PCNT	;PRINT IT
	MVI	A,DOT	;PRINT A DOT
	CALL	PBYT	;
	MVI	B,3	;LENGTH OF TYPE
	CALL	PCNT	;PRINT IT
	RET


;	*** COMPARE HL VS DE ***


CPHL:	MOV	A,H
	CMP	D
	RNZ
	MOV	A,L
	CMP	E
	RET


	
;	*** MOVE SUBROUTINE ***

;
MOVE:	MOV	A,M
	INX	H
	STAX	D
	INX	D
	DCR	B
	JNZ	MOVE
	RET
;
;	*** GET THE FILE NAME ***
;ЉGTFN:	MOV	A,M
	ORA	A
	RZ
	CPI	' '
	JNZ	GTFN0
	INX	H
	JMP	GTFN
;
GTFN0:	LXI	D,XFCB
	XRA	A
	STAX	D
	INX	D
	PUSH	D
	MVI	B,11
	MVI	A,' '
GTFN6:	STAX	D
	INX	D
	DCR	B
	JNZ	GTFN6
	POP	D
	MVI	B,9
GTFN1:	MOV	A,M
	ORA	A
	JZ	GTFN4
	INX	H
	CPI	' '
	JZ	GTFN4
	CPI	'.'
	JZ	GTFN2
	CPI	'*'
	JZ	GTFN7
	STAX	D
	INX	D
	DCR	B
	JZ	GTFN5
	JMP	GTFN1
;
GTFN7:	DCR	B
	JZ	GTFN9
	MVI	A,'?'
	STAX	D
	INX	D
	JMP	GTFN7
;
GTFN9:	MOV	A,M
	CPI	'.'
	JNZ	GTFN4
	INX	H
GTFN2:	LXI	D,XFCB+FT
	MVI	B,4
GTFN3:	MOV	A,M
	ORA	A
	JZ	GTFN4
	INX	H
	CPI	' 'Љ	JZ	GTFN4
	CPI	'*'
	JZ	GTFN8
	STAX	D
	INX	D
	DCR	B
	JZ	GTFN5
	JMP	GTFN3
;
GTFN8:	DCR	B
	JZ	GTFN4
	MVI	A,'?'
	STAX	D
	INX	D
	JMP	GTFN8
;
GTFN4:	XRA	A
	RET
;
GTFN5:	STC
	RET
;

;	*** CREATE FILE NAME TABLE ***
;
CFNT:	LXI	H,FNT
	SHLD	IFNTP
CFNT1:	LHLD	CBUFF
	MOV	A,M
	ORA	A	;EXIT IF END OF LIST
	RZ
	CALL	GTFN	;GET NEXT AFN
	SHLD	CBUFF	;SAVE CMD BUFFER POINTER
	JNC	FIND	;JUMP IF FILE NAME OK
	LXI	H,MSG5	;WRITE 'SYNTAX ERROR IN FILE NAME'
	CALL	PSTRNG
	JMP	CFNT1	;LOOP
;
FIND:	XRA	A	;CLEAR XFCB EXTENT FIELD
	STA	XFCB+EX
	LXI	D,XFCB
	CALL	SRCHF	;SEARCH FOR FIRST OCCURRENCE
	CPI	255	;JUMP IF FOUND
	JNZ	GETFCB
	LXI	H,XFCB 
	CALL	TYPFCB
	LXI	H,MSG7	;WRITE ' NOT FOUND
	CALL	PSTRNG
	JMP	ERROR	;LOOP
;
GETFCB:	ANI	3	;INDEX INTO CBUF
	MOV	L,A
	MVI	H,0
	DAD	H
	DAD	HЉ	DAD	H
	DAD	H
	DAD	H
	LXI	D,DBUF
	DAD	D
	XCHG		;COPY FILENAME INTO FNT
	LHLD	IFNTP
	XCHG
	MVI	B,12
	CALL	MOVE
	XCHG
	SHLD	IFNTP	;SAVE INPUT FNT POINTER
	MVI	M,0FFH	;ENSURE FF BYTE AT END
	LXI	D,XFCB	;SEARCH FOR NEXT OCCURRENCE
	CALL	SRCHN
	CPI	255
	JNZ	GETFCB
	JMP	CFNT1	;GO GET NEXT AFN
;
;
;	*** MESSAGES AND STRINGS ***

FMSG:	DB	CR,'> $' ;INSERT PRINTER ASTRING TO TASTE
PMSG:	DB	'                 PAGE$'
ERMSG:	DB	'I FEAR THAT YOU HAVE MADE AN ERROR, '
	DB	'PLEASE TRY AGAIN',0DH,0AH,'$'
MSG5:	DB	'SYNTAX ERROR IN FILENAME',0DH,0AH,'$'
MSG7:	DB	' NOT FOUND ',0DH,0AH,'$'
FOERRM:	DB	'UNABLE TO OPEN FILE$'

;	*** DATA AND TABLES ***

COL:	DB	0	;COLUMN NUMBER
LINE:	DB	0	;LINE NUMBER
PAGE:	DW	0	;PAGE COUNTER
CBUFF:	DW	0	;COMMAND LINE POINTER
IFNTP:	DW	0	;FNT POINTER
INPTR:	DW	DBUF+128;INPUT POINTER
FNT:	DS	16*64+1	
CBUF:	DS	80	;COMMAND BUFFER
XFCB:	DS	33

	END

;***E.O.F.***
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГQ/ PRINT UTILITY VERS. 1.6 / HARDWARE FF / OUT TO LST: /MULTIPLE FILE ACCESS  /* +щ!Ђ ыFx·Кщ#~#ВcЇ!ы"фНъ!ъ"ц*ц~юяК6#] Нt"цЇ2\ 2h 2| Ї2р2т2у! "ш\ НЪщНН1ЪщюКжюКтю
Кыю	КЫю ТмГ№!р> Н_~жВЮГ№Н_Г№Ї2р>Гм:сю8К<2с>
Гм>Н_НГ№>Н_ >Н_В!bН!\ Н]!fН*т#"тН–>Н_>
Н_>
Н_>
Н_Ї2с2рЙеЕх_Н сю Ъr!р4Н ю ВБбЙ~ю$ИН_#Г~ю Д_#ВЉЙеХЕ 'НїиНїd Нї
 Нї НїБСбЙ }“o|љgЪОГБy±ВЮx°ВЮ> Г_yЖ0Г_>Н_ >Н_ВнГ||	Н Г  Н юяКЇЙЬ	Н ЙеХЕН БСбЙеХЕН БСбЙ! л*шНnКE~#"ш·Й\ Н ю В[!Ђ "шГ>7Й#НЉ>.Н_НЉЙ|єА}»Й~#ВtЙ~·Ию В‰#Г}K	ЇХ> В”С	~·Кц#ю Кцю.КНю*К»КшГќКЖ>?Г»~ю.Вц#T	~·Кц#ю Кцю*КлКшГТКц>?ГлЇЙ7Й!ъ"ц*ф~·ИН}"фТ!іНГ Ї2W	K	НюяВ6!K	Н]!ОНГщжo& )))))Ђ л*цлНtл"ц6яK	Н%юяВ6Г > $                 PAGE$I FEAR THAT YOU HAVE MADE AN ERROR, PLEASE TRY AGAIN
$SYNTAX ERROR IN FILENAME
$ NOT FOUND 
$UNABLE TO OPEN FILE$               ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее10 REM JUSTIFIED FILE PRINT
INPUT"FILE TO BE PRINTED?";G$
FILNAM$=G$+".JUS"
FILE FILNAM$
30 INPUT"PRINTER OR SCREEN?";IN$
TST$=LEFT$(IN$,1)
IF TST$="P" THEN PRINT CHR$(16)
IF END#1 THEN 100
FOR I=1 TO 2 STEP 0
READ#1;LINE$
PRINT LINE$
NEXT
100 CLOSE 1
IF TST$="P" THEN PRINT CHR$(16)
INPUT"MORE TO PRINT?";IN$
TST$=LEFT$(IN$,1)
IF TST$="Y" THEN 10
END
	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	
яяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1$0$16$2$16$* д   FILE TO BE PRINTED? $4;Ђ 1'ЂА .JUS Ђ А-PRINTER OR SCREEN? $4;Ђ1'ЂА.  SАP 7 b. R$4.  [^  Ђ.  6 Џ. . А ЂЂ Ђ8
Ђ9	7  .  [&Ђ*>А$46 r.  [@АP 7 ґ. R$4MORE TO PRINT? $4;Ђ1'ЂА.  SАY 7 б6    [^  Ђ. :  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее!  9"Ы1Н’Н9!~ю"К#юВХНЇН’б"ЭНc*ЫщГ  ХН \ Н бЂ лю К<юИО	Н Г  ХН \ Н бюК‘ю ВXЂ л*ЭzјЪf{ЅЪfЙЇ2| \ Н юяК¤ЙЅ	Н Г  \ Н юяКXЙFILE NOT FOUND
$DISK ERROR
$                                     4Ђ"ААT.  BЂА А"SАА$. !R$4. "R$. #R$Ђ	.  6iАTЂ	.  А	 	7†АА	.  U  7  $6ѓ_ $6YЂА.   А.  7џ. $R$яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееDIM A%(20,20), Q$(10)
S% = 4
G% = 10
B% = 10
DIM ARRAY$(20,20)
RANDOMIZE
PRINT TAB(20); "SPIES"
PRINT TAB(20); "====="
5 PRINT "THE OBJECT OF THIS GAME IS TO FIND";S%;" SPIES HIDDEN ON"
PRINT "A";B%;" BY";B%;" BOARD.  THE ORIGIN IS POSITION 0,0 AND YOU"
PRINT "GUESS THEIR POSITION BY TYPING CO-ORDINATES AS TWO NUMBERS"
PRINT "BETWEEN 0 AND";B%-1;" SEPARATED BY A COMMA.  THE FIRST NUMBER"
PRINT "IS THE DISTANCE TO THE RIGHT OF THE ORIGIN AND THE SECOND"
PRINT "IS THE DISTANCE ABOVE THE ORIGIN."
PRINT
PRINT "YOU GET";G%;" TRIES AND AFTER EACH TRY YOU WILL BE TOLD"
PRINT "HOW FAR YOU ARE FROM EACH REMAINING SPY."

PRINT
INPUT "TYPE 'Y' AND RETURN IF YOU UNDERSTAND";DUMMY$
IF DUMMY$ <> "Y" THEN GOTO 5
X% = 1
PRINT
10	PRINT "THE BOARD LOOKS LIKE THIS:"
PRINT
FOR N% = B%-1 TO 0 STEP -1
FOR E% = 0 TO B%-1
ARRAY$(N%,E%) = "* "
NEXT E%, N%
GOSUB 1.00E10
10.5	FOR J% = 1 TO 2
		FOR I% = 1 TO S%
		IF INT(B%*RND) = 0 THEN GOTO 10.5
		A%(I%,J%) = INT(B%*RND)
		NEXT I%
	NEXT J%

	FOR T% = 1 TO G%
		PRINT
		PRINT "TURN NUMBER";T%;". TYPE YOUR GUESS AND PRESS RETURN."
15		INPUT Y%,X%
		PRINT
		IF INT(X%+Y%)<>X%+Y% THEN GOTO 20
		IF X%>B%-1 THEN GOTO 20
		IF Y%>B%-1 THEN GOTO 20
		IF X%<0 THEN GOTO 20
		IF Y%>=0 THEN GOTO 30
20		PRINT "VALUES MUST BE NUMBERS IN THE RANGE 0 TO";B%-1;".PLEASE RETYPE."
		GOTO 15
30			FOR I% = 1 TO S%
			IF A%(I%,1) = -1 THEN  GOTO 50
			IF A%(I%,1) <> X% THEN GOTO 40
			IF A%(I%,2) <> Y% THEN GOTO 40
			A%(I%,1) = -1
			PRINT "YOU HAVE FOUND SPY";I%; : PRINT CHR$(7) : ARRAY$(X%,Y%) = "!"
			GOTO 50
40			D% = SQR((A%(I%,1)-X%)^2+(A%(I%,2)-Y%)^2)
			PRINT "YOU ARE";INT(D%*10);" UNITS FROM SPY";I%
50		NEXT I%
	PRINT "YOUR BOARD LOOKS LIKE THIS NOW (THE + IS YOUR GO):"
	GOSUB 1.00E10
		FOR J% = 1 TO S%
			IF A%(J%,1) <> -1 THEN GOTO 60
		NEXT J%
	PRINT
	PRINT "CONGRATULATIONS YOU HAVE FOUND ALL";S%;" SPIES IN";T%;" TURNS!"
	GOTO 70
60 NEXT T%

	PRINT 
	PRINT "YOU HAVE HAD THE MAXIMUM OF";G%;" TRIES. THEY WERE HIDDEN AT:"
		FOR I% = 1 TO S%
			IF A%(I%,1) = -1 THEN GOTO 65
			PRINT "SPY";I%;" (";A%(I%,2);",";A%(I%,1);" )"
65		NEXT I%
70	PRINT
	PRINT "IF YOU WOULD LIKE ANOTHER GAME TYPE 'YES' -"
	INPUT "OTHERWISE TYPE 'NO' AND TYPE RETURN";Q$
	IF Q$ = "YES" THEN GOTO 90
	IF Q$ = "NO" THEN GOTO 100
	PRINT "I DO NOT UNDERSTAND YOUR REPLY ";Q$;" PLEASE TYPE YES OR NO."
	GOTO 70

90	PRINT
	INPUT "DO YOU WANT TO CHANGE ANY OF THE NUMBERS?"; CHANGE$
	IF CHANGE$ = "YES" THEN GOSUB 150
	PRINT
	PRINT S%;" SPIES ARE NOW IN HIDING"
	T% = 0
	GOTO 10
100	PRINT :PRINT "GOODBYE"
	STOP

150	PRINT "IF YOU WOULD LIKE TO CHANGE THE BOARD SIZE"
	GOSUB 850
	IF P$ = "NO" THEN GOTO 350
225	INPUT "INPUT LENGTH OF SIDE OF NEW SQUARE";B%
	PRINT
	IF B% <= 1 THEN GOTO 225
	IF B% > 20 THEN PRINT "THE SQUARE CANNOT BE BIGGER THAN 20 X 20.":GOTO 225
	IF INT(B%) <> B% THEN GOTO 225
350	PRINT "IF YOU WOULD LIKE TO CHANGE THE NUMBER OF GOES"
	GOSUB 850
	IF P$ = "NO" THEN GOTO 525
425	INPUT "INPUT THE NUMBER OF GOES";G%
	IF G% < 1 THEN GOTO 425
	IF INT(G%) <> G% THEN GOTO 425
525	PRINT "IF YOU WOULD LIKE TO CHANGE THE NUMBER OF SPIES"
	GOSUB 850
	IF P$ = "NO" THEN RETURN
600	PRINT
625	INPUT "INPUT THE NUMBER OF SPIES";S%
	IF S% < 1 THEN GOTO 625
	IF INT(S%) <> S% THEN GOTO 625
	IF S%<= 10 THEN RETURN
	PRINT "THERE CAN BE A MAXIMUM OF 10 SPIES"
	GOTO 600

850	PRINT
	INPUT "TYPE 'YES' OR 'NO' THEN TYPE RETURN";P$
	PRINT
	IF P$ = "YES" THEN RETURN
	IF P$ = "NO" THEN RETURN
	PRINT "YOUR REPLY ";P$;" NOT UNDERSTOOD"
	GOTO 850
	RETURN

1.00E10 REM ARRAY PRINT ROUTINE

FOR N% = B%-1 TO 0 STEP -1
FOR E% = 0 TO B%-1
IF T% > 0 AND ARRAY$ = "!" THEN GOTO 1.00E20
IF T% > 0 AND A%(I%,1)<>-1 THEN ARRAY$(X%,Y%) = "+"
1.00E20	PRINT TAB(5+E%*2); ARRAY$(N%,E%);
NEXT E%
PRINT N%
NEXT N%
PRINT TAB(4);
FOR ENO% = 0 TO B%-1: PRINT USING "##"; ENO%;: NEXT ENO%
PRINT
RETURN
	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	
яяяяяяяяяяяяяяяяяяяяяяяя1$* 
Т      Ђ ЂЂЂ ЂЂ
Ђ ЂЂЂЂ
ЂЂ
ЂЂЂЂ MЂJSPIES $d4ЂJ===== $d4THE OBJECT OF THIS GAME IS TO FIND $Аp# SPIES HIDDEN ON $d4A $Аp# BY $Аp# BOARD.  THE ORIGIN IS POSITION 0,0 AND YOU $d4GUESS THEIR POSITION BY TYPING CO-ORDINATES AS TWO NUMBERS $d4BETWEEN 0 AND $АЂp# SEPARATED BY A COMMA.  THE FIRST NUMBER $d4IS THE DISTANCE TO THE RIGHT OF THE ORIGIN AND THE SECOND $d4IS THE DISTANCE ABOVE THE ORIGIN. $d4d4YOU GET $Аp# TRIES AND AFTER EACH TRY YOU WILL BE TOLD $d4HOW FAR YOU ARE FROM EACH REMAINING SPY. $d4d4TYPE 'Y' AND RETURN IF YOU UNDERSTAND n;Ђ1'АY 7Y6 IЂЂd4THE BOARD LOOKS LIKE THIS: $d4d4ЂАЂ6«Ђ ЂАЂЂ Ђ8Ђ97ЧЂ	Ђ 6ГАЂЂ	А	
7ФАА	АЂ!*  6і6Њ
Ђ
Ђ6пЂЂ
А

7.ЂЂ6АЂА
7+АCpBЂ p76ЪАА
А Ђ!АCpB:6ч6вЂЂ6CАЂА
7»d4TURN NUMBER $Аp#. TYPE YOUR GUESS AND PRESS RETURN. $d4Ђ n;Ђ":Ђ":'d4ААpBААp7Ґ6ЫААЂ7ґ6ЫААЂ7Г6ЫАЂ 7П6ЫАЂ 7Ы6$VALUES MUST BE NUMBERS IN THE RANGE 0 TO $АЂp#.PLEASE RETYPE. $d46ЂЂ69АЂА
7АЂА Ђ!Ђ7N6АЂА Ђ!А7b6іАЂА Ђ!А7v6іАЂА Ђ!ЂYOU HAVE FOUND SPY $Аp#dЂR$d4АААЂ!! 6ЂАЂА Ђ!АЂ	АЂА Ђ!АЂ	pI:YOU ARE $АЂ
pB# UNITS FROM SPY $Аp#d46,YOUR BOARD LOOKS LIKE THIS NOW (THE + IS YOUR GO): $d4
Ђ
Ђ6VАЂ
А

7nА
ЂА Ђ!Ђ7k6ё6Id4CONGRATULATIONS YOU HAVE FOUND ALL $Аp# SPIES IN $Аp# TURNS! $d46_66d4YOU HAVE HAD THE MAXIMUM OF $Аp# TRIES. THEY WERE HIDDEN AT: $d4ЂЂ6АЂА
7_АЂА Ђ!Ђ7*6\SPY $Аp# ( $АЂА Ђ!p#, $АЂА Ђ!p# ) $d46d4IF YOU WOULD LIKE ANOTHER GAME TYPE 'YES' - $d4OTHERWISE TYPE 'NO' AND TYPE RETURN n;Ђ1'АYES 7М6АNO 7Ъ6ЊI DO NOT UNDERSTAND YOUR REPLY  $А$ PLEASE TYPE YES OR NO. $d46_d4DO YOU WANT TO CHANGE ANY OF THE NUMBERS? n;Ђ1'АYES 7a›d4Аp# SPIES ARE NOW IN HIDING $d4ЂЂ 6`d4GOODBYE $d4IF YOU WOULD LIKE TO CHANGE THE BOARD SIZE $d4	–АNO 7Ы6^INPUT LENGTH OF SIDE OF NEW SQUARE n;Ђ":'d4АЂ76ЫАЂ7OTHE SQUARE CANNOT BE BIGGER THAN 20 X 20. $d46ЫАpBАp7^6ЫIF YOU WOULD LIKE TO CHANGE THE NUMBER OF GOES $d4	–АNO 7ў6ЯINPUT THE NUMBER OF GOES n;Ђ":'АЂ7Р6ўАpBАp7Я6ўIF YOU WOULD LIKE TO CHANGE THE NUMBER OF SPIES $d4	–АNO 7	"d4INPUT THE NUMBER OF SPIES n;Ђ":'АЂ7	S6	$АpBАp7	b6	$АЂ
7	lTHERE CAN BE A MAXIMUM OF 10 SPIES $d46	"d4TYPE 'YES' OR 'NO' THEN TYPE RETURN n;Ђ1'd4АYES 7	УАNO 7	ЯYOUR REPLY  $А$ NOT UNDERSTOOD $d46	–ЂАЂ6
2Ђ ЂАЂЂ Ђ8Ђ97
ҐЂ	Ђ 6
JАЂЂ	А	
7
њАЂ А! 7
^6
„АЂ АЂА Ђ!Ђ7
„АААЂ!+ ЂА	ЂJАА	АЂ!$d6
:Аp#d46
ЂJdЂЂ 6
БАЂЂА
7
О## cАp#d6
±d4Ђ 7Ы6^INPUT LENGTH OF SIDE O:  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;How To Install Spooler On A North Star Horizon
;SJ Withers 16/3/81
;
;Find the end of the jump table. Between the lines
;	DB	0,0,0
;and
;	DW	HORLEN
;insert these two lines:
	DB	0FFH	;ALLOWS SPOOLER TO LOCATE END OF TABLE
	DW	LSTBSY	;ADDRESS OF PRINTER STATUS ROUTINE
;The next part is the List Device Busy routine.  I suggest you
;place it before any other routines, then (for a given system
;size) it will always be in the same place, regardless of other mods
;you make to the CBIOS.  If your printer uses XON/XOFF or
;similar protocols, you will need a more sophisticated test,
;but one of these should make a start.
;So, between:
;PROMLOC:DB	0E800/256 AND 0FFH	;ADDR OF PROM
;and
;HORST:	IN	3
;insert one of these three routines:
;
;SERIAL PRINTER WITH HANDSHAKE
LSTBSY:	IN	5
	MOV	B,A
	ANI	1
	JNZ	CTOS
NOTRDY:	MVI	A,0		;RETURN NOT READY
	RET
CTOS:	MOV	A,B
	ANI	80H
	JNZ	NOTRDY
	MVI	A,0FFH		;RETURN READY
	RET
;
;SERIAL PRINTER WITHOUT HANDSHAKING
LSTBSY:	IN	5
	ANI	1
	MVI	A,0	;SET A=0, FLAGS UNCHANGED
	RZ		;RET IF NOT READY WITH 0 IN ACC
	CMA		;A NOW EQUALS 0
	RET
;
;PARALLEL PRINTER
LSTBSY:	IN	6		;MOTHERBOARD STATUS
	ANI	1		;MASK TO GET PO-FLAG
	JZ	NOTRDY
	CMA			;A NOW CONTAINS FF =>READY
	RET
NOTRDY:	MVI	A,0		;0 =>READY
	RET
;
;From here on, follow the instructions given on pages 32-33 of the 1980
;CPMUGUK Yearbook (also known as Volume 1, Number 1 of the Newsletter!).
;My excuse for not repeating them is that I prepared the manuscript on a
;different system, and so can't simply merge the two files.
`Ђ л*ЭzјЪf{ЅЪfЙЇ2| \ Н юяК¤ЙЅ	Н Г  \ Н юяКXЙFILE NOT FOUND
$DISK ERROR
$                                     4Ђ"ААT.  BЂА А"SАА$. !R$4. "R$. #R$Ђ	.  6iАTЂ	.  А	 	7†АА	.  U  7  $6ѓ_ $6YЂА.   А.  7џ. $R$яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1І* "€Гг*  йжO* 	 й>ЙЕХН \ Н СБ·К;=Й!Ђ лВ$ЙRETCP  O* й0FCBO\б!6 #В_Г/OPFIL\s:T_Н СН <В/!ЊГOPEN FILE ERROR DFTFCsЃ\ STNAM§іСб~Gю	ЪВ!ЫГеХ!рF#~ВКК/СбГЙFILENAME LENGTH > 8         STC CPMLDіЙ§\§і§s° л}!  Г.'!яяГ.Хе!Mз9ЪP!Nи9ТV*r##"r^#Vbk+~+ngй!\Г!hГSTACK EMPTY
STACK FULL*Њй*Ћй}*t^#V+++"tл"rГ/’*~^#V*r##лs#rГ}()   °*r##"r^#VХГ/S()  °Й*r## ^е"rГ/ABORTЙг1І!"t!Ж"v!яя"њН!Ю
"rГ/*ђй*€њяНPл*zР!ГDICTIONARY FULL*|єеР!<ГCOMPILE BUFFER FULL+|/g}/oЙе}!   )Тg€В`гo|`)Тx€ВqW\ehБ	Т†лЙ(ELSEг’*r##^#V+"rГ/(IF) ’¬б|µК’*r##"rГ/.    ¬З*zГ.STATEЗЃo:q·И>!q4ю	КъхНwсюА—2q>
Гй> Нw:qжИ>	Га~·И=х#е~НабсГLOOKUЧ$б"ћ*x"ўFз|µК.*ў^#Vл^#Vл|µК…ця" л*ћжѕВu#ѕВu·КjВ[* 
 еГ'*  ^#Vл|µВG*ў++Г+B,   $—б}НМГ/,    —©бНБГ/C,   ©єбНШГ/е}НМб|НМЙ*zw#"zНЙе}Нгб|НгЙ*|w#"|Н.ЙRDLINєщ!G" "—2“2ћ/2’*њ#|µВљНsю
КЌюКY·КtюКzюКzхНа>я2ћсНпhеТ!KГLINE TOO LONG* №е|µК* +" >_НаГ!G" НЮ—* w№е}2FГ/:ћ·ВНЮГ/*њлНУХ*ље#"љ ь|µВА*њ#"њ!  "љСб~ю
КљюК}юК}юКеНпhеТљГE!лГEOF* w#" Йъб|µВ/!1Іе!"t!Ж"vГ*	UNDEFINEDERR  щ**„лГHERRMS*;НЩбН
НЮ*zН
НЩ*њ#|µКг!FН
НЮГгUNIT ;ЃT ЙНoНИюВЊ!’ГНoН"И!§ГDISK WRITE PROTECTED
DISK ERRORILLEGAL BLOCK #NEWESmЃf>яГФ—2n*f{ѕВк#zѕВк#^#VЙ*f"jл"l*j Н@zіКM*j"hл"j^#V*l|єВф}»Вф*j Н@Х*fл*j НE*j"f*hС НE*j Н@ЙНs:n·Вf*j Н@*lН…*lл*js#rГ*j Н@zіИ*j^#VХ*j Н@бНs*j   НEЙRBLOCМЄС:T·ІWНУГ»WBLOCЄВС:T·ІWНОХГЫUPDATВЫ*fяя НEГ/FLUSHЫф*f"jНs*j Н@zіК/лГчEBUF ф*f"j6я#6я+   НE*j Н@zіК/лГ^#VЙ	s#rЙWORD T:“·В' 	*z#л*~#·КЄёКf№Кfю"К~ю\ВЂGO~#·КЇёКђ№ВЂ"—*zНP}=*zw:“ogГ.>я2“+ГђLITERTЙЗб¬ °°єє'}З[	}ILITEЅбб#"ў!  "¤"¦НЗ	ю+К	ю-В	!яя"¤НЗ	·КB	ю0Ъю:Ъ	юAЪЦЦ0*ЂЅТ2ћ*Ђл*¦НX|µВ:ћo& "¦Г	*¤|µ*¦ьPеГ'SLITEб[	б#"ўНЗ	ю'Кr	ю"Кr	ю\В!ЙНШ*|"ћ—НгНЗ	·КБ	ю&К	Нг*ћ4Г‚	—2 НЗ	ю&К»	ю0ъю8тЦ0G: ЂГ™	: ГЋ	НгГ'*ў~#"ўЙERRCH[	Ъ	НН.*xл!DзТ
!:зЪ
*vл!:зТ
!ъжЪ
Г/!ј"x!%
Г!<
Г!R
Г!c
ГVOCABULARY STACK EMPTYVOCABULARY STACK FULLLOOP STACK EMPTYLOOP STACK FULLЙT¬ }З$¬ ќ
’кя•
ъ’вя•
*ЉГ-ќ
С!ця~·ъH:o·тHлНШГ/PROMPЪ	ї
*њ#|µВ/НЩ:pНа>>На> НаГ/Йю
щu
)¬фя°}єЪ	’дяю
*‚Г-HГH>Ђ2o>02p!F"|!ЙНШГ/):’·К:pю0ВГ'ENTERї
E*†Г-ENT0 EU*z>6 #=ВZБ>2ћ
·КmНМ!ћ5Вg*~^#VлНБ*z##НБ*zл*~s#rГ/л^#V*x##"xs#rГ/
ASSEMU–”STOICІ––<L   ѕКбН+Г/L>   КЫНГ.LOAD Ыл*њН+*љН+б"њ!  "љГ/;F   лН"љН"њГ/*v^#V+++"vлЙл*v##"vs#rЙDEFINB*x^#Vл"~Г/>    BY*x++"xГ/Ѓ^    Yn—2’Г/Ѓ%    n>я2“Г/Ѓ:    ‘:pю0В¶<2p!EНШ!вНШ*|е!  НШГ/!јГSYNTAX ERROR*rл++"r*t##"ts#rГ/в*r##^#V#еХ~НМСб#zіВл++"r*~^#V!Йлs#rГ/…CODE<‘Й°EєІ}Ѓ;    /НT!}НШГ/†;CODE/EНT!’НШ”Гљ:p=ю0В¶2pбгеНPл*|лбs#rЙCONSTEЙE©’лГёPUSH   Ѓ.NEXT ЏЃ/DPUSH›Ѓ-@PUSH§ЃёPUSHDіЃ»0PUSHїЃ-1PUSЛЃ'MUL  ЧЃX-HL  гЃP(MSG)пЃ
(,)  ыЃБ(B,) ЃМ(BRANЃ–ERRORЃ(TTI)+Ѓs(TTO)7Ѓа(READCЃ€(WRITOЃv(RBLO[ЃУ(WBLOgЃОT1   sЃћR0   Й{’НМГ/R1   ‹Й{’НLНМГ/R2    Й{’НLб…Г§R3   ·Й{’ГѕR4   НЙ{’НМб}НМГ/R5   ЯЙ{’НLГдR6   щЙ{’НLНМбНБГ/R7   Й{’ГR8   (Й{’НМ*zе!  Гбг)))…Й  
 f     fV   : DDUP FLTZ IF FMINUS FATAN FMINUS ELSE FATAN THEN ;

% EXTEND EXPONENT SIGN BIT TO HIGH ORDER BYTE
'EXTB7 CODE<  H POP,  L A MOV,  A ORA,  PUSH JP,  -1 H MVI,  PUSH JMP,  >

% LOG BASE 2
'FLOG2 : DDUP FLEZ IF "FLOG ERROR" ERR THEN
  EXTB7 FLOAT -ROT 0
  DDUP 3.84959 F* -1.42502 F+ DOVER F* -2.42459 F+ DSWAP
  DDUP 2.84953 F+ DSWAP F* 0.499939 F+ F/ F+ ;

% LOG BASE E
'FLN : FLOG2 0.693147 F* ;

% LOG BASE 10
'FLOG10 : FLOG2 0.301030 F* ;

% 2.0**
'2.0** : DDUP FRAC
  DDUP 0.0135342 F* 0.0520115 F+ DOVER F* 0.241443 F+ DOVER F*
  0.693004 F+ F* 1.00000 F+ DSWAP INTEGER 377 AND + ;

% EXPONENTIAL
'FEXP : 0.693147 F/ 2.0** ;

% 10.0**
'10.0** : 0.301030 F/ 2.0** ;

% LINEAR LEAST SQUARES FIT
0.0 'S1 FVARIABLE
0.0 'S2 FVARIABLE
0.0 'S3 FVARIABLE
0.0 'S4 FVARIABLE
0.0 'DET FVARIABLE
0 'NPTS VARIABLE

'<LSQ : 0.0 S1 F! 0.0 S2 F! 0.0 S3 F! 0.0 S4 F! 0 NPTS ! ;

'LSQ : DDUP S2 F+! DOVER F* S3 F+! DDUP S1 F+! DDUP F* S4 F+! NPTS 1+! ;

'LSQ> : NPTS @ FLOAT S4 F@ F* S1 F@ DDUP F* F- DET F!
  DET F@ FEQZ IF "LSQ ERROR" ERR THEN
  S2 F@ S4 F@ F* S1 F@ S3 F@ F* F- DET F@ F/
  NPTS @ FLOAT S3 F@ F* S1 F@ S2 F@ F* F- DET F@ F/ ;

% RANDOM NUMBER GENERATOR
% RETURNS A NUMBER UNIFORMLY DISTRIBUTED BETWEEN 0.0 AND 1.0
32741 'FSEED VARIABLE
'FRAND CODE<  NEXT H LXI,  T1 4 + SHLD,  FSEED LHLD,  16345 D LXI,
  MUL CALL,  XCHG,  FSEED SHLD,  0 B LXI,  NORM JMP,  >

RADIX !
;F



***EOF***


 1+ DUP <L 1 AND IF
  FRAC FMINUS 1.0 F+ ELSE FRAC THEN FSIN4 L> 2 AND IF FMINUS THEN ;

'FSIN : 0.6366198 F* DDUP INTEGER DUP <L 1 AND IF
  FRAC FMINUS 1.0 F+ ELSE FRAC THEN FSIN4 L> 2 AND IF FMINUS THEN ;

'FSIN : DDUP FLTZ IF FMINUS FSIN FMINUS ELSE FSIN THEN ;

% INVERSE TANGENT
'FATAN : DDUP DDUP F* DDUP 0.0208351 F* -0.0851330 F+
  DOVER F* 0.1801410 F+ DOVER F* -0.3302995 F+ F* 0.9998660 F+ F* ;

'FATAN : DDUP 1.0 FGT IF 1.0 DSWAP F/ FATAN FMINUS
  1.570796 F+ ELSE FATAN THEN ;

'FATAN^V^  Ђ0 HЖј@L–
 ї
;¬/±N:Wяя5%ю?M  яя@Eј  е      яя    Й{’НLб…Г§R3   ·Й{’ГѕR4   НЙ{’НМб}НМГ/R5   ЯЙ{’НLГдR6   щЙ{’НLНМбНБГ/R7   Й{’ГR8   (Й{’НМ*zе!  Гбг)))…Й  яяf^  яяf    V                ј  – ї
;U  ЅW  :{  ооо "%оовѕ  Й{’  –”        \1o1o1PP                                                  ф
Hp1&//w0                         ЙO}}т?z© ў&н5ZY} zт?†°еє&}>*5«4¬ Й	LSQ ERROR *П>*5л>*57Б>*5Э>*57`8щ>*5v7?‡6Э>*57Б>*5П>*57`8щ>*5v7}}                                                               RETCPM  LL,  XCHG,  FSEED SHLD,  0 B LXI,  NORM JMP,  > 345 D LXI, 1+! ;  SH,   B    :Ѓ  C    ўЃ D    ®Ѓ E    єЃ H    ЖЃ L    ТЃ M    ЮЃ A    кЃ PSW  цЃ SP   Ѓ NOP, Џ  LXI,  DAD, &¤	 DCX, 2¤ STAX,>¤ LDAX,J¤
 INR, V¤ DCR, b¤ SHLD,n," LHLD,z,* STA, †,2 LDA, ’,: RLC, ћЏ RRC, ЄЏ RAL, ¶Џ RAR, ВЏ DAA, ОЏ' CMA, ЪЏ/ STC, жЏ7 CMC, тЏ? MVI, юэ MOV, 
»@ POP, ¤Б PUSH,"¤Е ADD, .СЂ ADC, :С€ SUB, FСђ SBB, RС ANA, ^С  XRA, jСЁ ORA, vС° CMP, ‚Сё ADI, ЋгЖ ACI, љгО SUI, ¦гЦ SBI, ІгЮ ANI, ѕгж XRI, Кго ORI, Цгц CPI, вгю RNZ, оЏА RZ,  ъЏИ RNC, ЏР RC,  ЏШ RPO, Џа RPE, *Џи RP,  6Џр RM,  BЏш JMP, N,Г CALL,Z,Н RET, fЏЙ INX, r¤ JNZ, ~,В JZ,  Љ,К JNC, –,Т JC,  ў,Ъ JPO, ®,в JPE, є,к JP,  Ж,т JM,  Т,ъ CNZ, Ю,Д CZ,  к,М CNC, ц,Ф CC,  ,Ь CPO, ,д CPE, ,м CP,  &,ф CM,  2,ь OUT, >гУ IN,  JгЫ XTHL,VЏг XCHG,bЏл DI,  nЏу EI,  zЏы PCHL,†Џй SPHL,’Џщ HLT, ћЏv RST, Є¤З IF,  ¶>Г IFNZ,В>В IFZ, О>К IFNC,Ъ>Т IFC, ж>Ъ IFPO,т>в IFPE,ю>к IFP, 
>т IFM, >ъ 3DROP{.бббГ/DROP .>Г02DROP>KГ/DUP  KXбеГ.OVER Xg! 9ГёSWAP gxбгГ.@    x‡бГё!    ‡•бСs#rГ/1+   •§б#Г.1-   §¶б+Г.2+   ¶Еб##Г.2-   ЕХб++Г.MINUSХебНPГ.NOT  ецбНQГ.+    ц бСГ.-      бНPСГ.AND   * Ббx¤gyҐoГ.OR   * ? БбxґgyµoГ.XOR  ? T Ббx¬gy­oГ.B@   T i бn& Г.B!   i z бСsГ/EXEC z Љ Сbk+~+ngй-1   Љ Ѓяя0    ќ Ѓ  1    © Ѓ 2    µ Ѓ CHECKБ ЃpCOLUMН Ѓq.R   Щ Ѓt.L   е Ѓv.V   с Ѓx.D   э Ѓz.C   	!Ѓ|CURRE!Ѓ~RADIX!!ЃЂPROMP-!Ѓ‚ERRMS9!Ѓ„ENT  E!Ѓ†MEMORQ!Ѓ€LIT  ]!ЃЉ(TTYIi!ЃЊ(TTYOu!ЃЋ(ABORЃ!Ѓђ.I   "ЃrT1   ™!ЃћTHEN,Ґ!ЙЗx•}ELSE,±!ЙВx±!}EQZ  Ќ!Х!СzіВГ'NEZ  Х!и!СzіКГ'LTZ  и!ы!Сz·тГ'GEZ  ы!"Сz·ъГ'LEZ  "!"Сz·тГ'GTZ  !"5"Сz·ъГ'EQ   5"I"бС|єВ}»ВГ'NE   I"b"бС|єВ'}»В'ГLT   b"{"бС{•zњъ'ГGE   {"‘"бС{•zњъГ'LE   ‘"§"Сб{•zњъГ'GT   §"Ѕ"Сб{•zњъ'ГULT  Ѕ"У"бС{•zњЪ'ГUGE  У"й"бС{•zњЪГ'ULE  й"я"Сб{•zњЪГ'UGT  я"#Сб{•zњЪ'Г@@   #+#б^#VлГё@!   +#=#б^#VлСs#rГ/1+!  =#S#б4В/#4Г/1-!  S#g#б^#Vr+sГ/MVBYTg#|#бСБ|·ъ/µК/
+|µВ€#Г/RMVBY|#џ#бСБ|·ъ/µК/
+|µВ«#Г/FILL џ#В#СБбx·ъ/±К/s#r#x±ВО#Г/0FILLВ#е#  ГГ#+!   е#х#б^#VлБ	лr+sГ/	IMMEDх#$*~^#V!ця~оЂwГ/<-   $($Сбs#rГ/0<-  ($:$б6 #6 Г/-1<- :$M$б6я#6яГ/S,   M$`$б~<ех~НМсб#=К/Гc$x/Gy/OЙ-BC  Г!Ѓs$z/W{/_Й-DE  …$Ѓ‡$НQН‡$zіА#Й-HLDE™$Ѓ›$z¬хz·ь‡$|·ьPНXсь›$ЙSMUL °$ЃІ$Нs$>)Ъц$л)лТг$,е	Ъо$б=ВШ$Й33=ВШ$Йл)лТэ$,	=ВШ$ЙDIV  С$ЃУ$|·хЁх|·ь›$x·ьs$НУ$сь‡$сьPЙSDIV %Ѓ%C.   `$A%*|Г.+CHECA%Q%!p4Г/SYNTAX ERROR-CHECQ%o%!p5~ю0т/!X%Г…BEGINo%ЙQ%A%Х}ѓEND  ‰%Йo%°¬єA% є}†REPEA›%Йo%o%x°’єA% єA%Хg ($}‚IF   µ%ЙQ%°¬єA%© є}„THEN Э%Йo%A%Хg ($}„ELSE ч%Йo%Q%°’єA%g ($A%© є}(()  &3&Сz·ъ’іК’*v 	"vs#r*r##"rГ/(U() 3&_&СzГ9&())  _&n&*v^#Vr+szіВ’*vъя"v*r##"rГ/Ѓ(    n&ЙQ%°3&єA%© є}‚U(   њ&ЙQ%°_&єA%© є}Ѓ)    ¶&Йo%°n&єXA%g ($A% є}(DO) Р&ф&СБ{‘zт’*v##s#r#q#p#"vs#r*r##"rГ/(LOOPф&%'*v^#Vr+s+F+N{‘zъ’*vъя"v*r##"rГ/(+LOO%'Y'*v^#VлБ	лГ,'‚DO   Y'ЙQ%°ф&єA%© є}„LOOP p'Йo%°%'єXA%g ($A% є}…+LOOPЉ'Йo%°Y'єXA%g ($A% є}(UDO)®'Т'СБ{‘zТ’*v##s#r#q#p#"vs#r*r##"rГ/(ULOOТ'(*v^#Vr+s+F+N{‘zЪ’*vъя"v*r##"rГ/(U+LO(7(*v^#VлБ	лГ
(ѓUDO  7(ЙQ%°Т'єA%© є}…ULOOPN(Йo%°(єXA%g ($A% є}†U+LOOh(Йo%°7(єXA%g ($A% є}I    Њ(°(*vГёJ    °(А(*vъяГёK    А(Ф(*vфяГёI'   Ф(и(*v#V+^+Н€$F+N+л	лF+Nл	Г.J'   и()ъя*vГл(K'   ) )фя*vГл(EXIT  )4)*v#6 +6+6 +6Г/<R   4)P)*t##"tСs#rГ/R>   P)i)*t^#V+++"tГ»ABS  i)‚)б|·ьPГ.M+   ‚)•)БСб	лТ-#Г-M-   •)«)БНs$Г–)2/   «)ј)б|·тГ)7g}oГ.U2/  ј)Х)б|·ГГ)2*   Х)е)б)Г.LSHIFе)ф)Сбz·ъ.іК.)Гь)RSHIFф)*Сбz·ъ.іК.||g}oГ*URSHI*/*Сбz·ъ.іК.·|g}oГ7*DLSHI/*O*БбСx·ъ-±К-л)хл)сТe*#ГX*DRSHIO*s*БбСx·ъ-±К-||g}ozW{_Г|*DURSHs*›*БбСx·ъ-±К-·|g}ozW{_Г¤*UM*  ›*В*СбНXГ-U*   В*Ф*СбНXГ»U/   Ф*ж*Б!  СНУ$Г»U/MODж*ы*Б!  СНУ$Г-UM/MOы*+БбСНУ$Г-UMOD +#+Б!  СНУ$Г.UM/  #+8+БбСНУ$Г»U*/  8+K+БСбЕНXБНУ$Г»*    K+c+СбНІ$Г»/    c+u+БСz·!  тЂ++Н%Г»MOD  u+ђ+БСz·!  т›++Н%Г.M*   ђ+«+СбНІ$Г-M/   «+Ѕ+БбСН%Г»/MOD Ѕ+Р+БСz·!  тЫ++Н%Г-M/MODР+л+БбСН%Г-*/   л+ю+БСбЕНІ$БН%Г»MOVE ю+,БСГ/XCHG ,+,СбNwy#NwyГ/S@   +,F,!  9Г.2OVERF,W,! 9Гё3OVERW,h,! 9ГёUNDERh,y,бСГ.2UNDEy,€,! 9Сs#rГ/3UNDE€,ќ,! Г‹,DDUP ќ,­,бСХеГ-DOVER­,ѕ,! 9^#VХ+++ГёDUNDEѕ,Ц,бСББГ-DSWAPЦ,з,Бб"ћб" С*ћеЕ* Г-2SWAPз,-бБСЕГ-+ROT --БбСЕГ--ROT -(-СБбЕГ-FLIP (-9-БСбЕГ-OCTAL9-Й° -!•}DECIMJ-Й°
 -!•}HEX  ^-Й° -!•}VARIAr-Й{’Г»ARRAY†-Й© x†-¶3& © ©n&шя}BRANC—-ЙЗ°  x{© ©’Г–ADDRE·-Й$ц¬ Й	UNDEFINED *}FORGEЦ-ЙЦ-X°
  	!•°  ‡!!=#}MAX  щ-Й­,Ѕ"¬ >’ y,}MIN  .Й­,{"¬ >’ y,}UMAX ;.Й­,#¬ >’ y,}UMIN W.Й­,У"¬ >’ y,}COUNTs.Џ.б~#е& oГ.<TTO>Џ.Ј.б}НаГ/<TTI>Ј.µ.Нso& Г.OUT  µ.Љ-Ј.IN   И.Љ-µ.TYO  Ф.ЙИ.‡Љ }TYI  а.ЙФ.‡Љ }TYPE т.Йg xТ'
 °(i а.(ця}MSG  /ЙЏ./}CR   $/Й° а.}IFCR 4/ЙЩ i ¬ 4/}SPACEF/Й°  а.}SPACE\/Й3& \/n&ъя}TAB  n/ЙЩ i  n/}‚//   „//:o/2oГ/ENT0 /ЙX$¬ >F/ЙREDEFINING  $/X$/4/U}#CNT ¬/Љ- #PTR Э/Љ-5@#PUT й/х/*Э/#"Э/*й/+"й/СsГ/<#   х/0*z  "й/!  "Э/Г/#>   0/0б*й/л*Э/Г-#A   /0D0бцяТP0 : Г.#    D0Й-!‡ы*D0х/}#S   a0Йa0XХ!¬ця}U<#> w0Й0w0/0}U=   Ќ0ЙЌ0/\/}U?   џ0Й‡џ0}<#>  ±0ЙXК‚)0w0Ыы!¬ °- х//0}=    Б0ЙБ0/\/}?    з0Й‡з0};:   щ0Й{i)©’Хл##^#V*rл"r*t##"ts#rбГёSZSTO	1Й-!‡^-Й	STOIC IS  $/З° u+§џ0Й DECIMAL PAGES LONG $/-!•}COL  81Љ-  FORMA‚1Й‚1‡° I"¬
 4/‚1:$’ ‚1‡§° Ф*„/‚1S#}LIST Ћ1ЙЦ-+#‚1:$X°
  Џ.° ;./‚1‡§° Ф*°  „/Xџ0Ћ1°  ‡XХ!¬Дя>4/ЙEND OF LIST $/}…ASCIIД1ЙT°°є¬ © ’ З§i є}DUMP )2Йg xф&< °(Б0/°/ а.\/° © ф& °(§° c+„/°(А( щ0Б Y'жя4/° Y'Дя}UDUMPO2Йg xф&< °(Б0/°/ а.\/° © ф& °(§° c+„/°(А( ±0Б Y'жя4/° Y'Дя}CHAR=Ў2ЙX°  {"g°_ Ѕ"? ¬ °< а.Ќ0/°> а.’ а.}A=   у2Й° ы*у2у2}A?   +3Й‡+3}ADUMPA3Йg xф&0 °(Б0/°/ а.\/° © ф& °(А( A3Б Y'тя4/° Y'Ря}ACCEPQ3ЙщT¬ © ’ Зб}SEED —3Љ-б5RAND µ3Б3*µ3еНXл"µ3Г.[    Б3ЙF,К}]    Ы3ЙF,Ыx ј)}
CASE ERROR(CASEл34*r##N#F+е	"rСб|·ъ14#)y•xњЪ14^#VГ‹ !ч3Г„CASE 4ЙQ%°4єA%© є}FLTZ A4[4бС|·ъ'ГFLEZ [4o4бСzіК'Г]4FGEZ o4ѓ4бС|·т'ГFGTZ ѓ4—4бСzіКГ…4FEQZ —4«4бСzіК'ГFNEZ «4ї4бСzіВ'ГF()  ї4У4*r##N#F#"r^#VХЕГ/F!   У4с4бСs#rС#s#rГ/D2UNDс45! 9Гт4D3UND55! 9Гт4F@   5*5бN#F#^#VХЕГ/	FCONS*5Й{©’лГ+5D2OVEA5U5! 9Г+5D3OVEU5f5! 9Г+5	FVARIf5Й†-©}FMINUw5‡5б|оЂgГ.FABS ‡5™5б& Г.еЕ*ўйFRET ™5Ѓџ5|µКЭ5|·ъЛ5{_zW}o|gГ·5z·тџ5#|µВџ5! ЂГџ5  Гџ5NORM Ї5Ѓ±5б"ўб|· т 6ЂНP  Г±5(FLOAн5Ѓп5FLOAT66Нп5Г/б"ўБбyюъџ5ютC6·}o|gВ56Г±5!    Гџ5(FRAC6Ѓ$6FRAC V6b6Н$6Г/INT OVERFLOWб"ўСб{юъҐ6ютџ6>“_·|g}oВЉ6z·ьPе*ўй!h6Г!  е*ўй	(INTEb6Ѓu6INTEG·6Г6Нu6Г/б"ўб" Сб"ћбНX:ћO: ЃO:џG:ЎЁGГ±5(F*) Г6ЃЙ6F*   щ67НЙ6Г/ZERO DIVIDEб"ўб" Бб"ћбx±КZ7  |·g}ozWЕНУ$БХ  НУ$б: O:ћ‘<O:џG:ЎЁGГ±5!7Г(F/) 7Ѓ7F/   j7v7Н7Г/б"ўб" Сб"ћб|µК8zіК8:ћO: ‘КЧ7ъВ7л: G:ћ2 x2ћ:ЎG:џ2Ўx2џГ”7ют8G·zW{_ВИ7ТЧ7:џG:ЎёВф7Тџ5|g}oТр7#Гџ5·ъщ7л}“o|љgТ
8ЂНPГ8   Г±5л*ћDMлГџ5* Г8(F+) v7Ѓ|7F+   ,888Н|7Г/б"ўб|оЂgГЃ7(F-) 88Ѓ>8F-   T8`8Н>8Г/FLT  `8Й`8[4}FLE  p8Й`8o4}FGT  Ђ8Й`8—4}FGE  ђ8Й`8ѓ4}FEQ   8Й`8«4}FNE  °8Й`8ї4}FMOD А8Йз,ѕ,v7b67}F+!  Р8ЙXК*588Ыс4}*¤~#"¤ЙLITG ж8Ѓф8FLITE99б#"¤!  "¦"Ё"Є"®ееНф8ю+К<9ю-В?9!яя"¦Нф8ю.ВM9!яя"®Г<9·Кк9юEК”9ю0ъЏ9ю:тЏ9Ц0o& "¬!  е! еНЙ6*¬еНп5Н|7*®|µК<9*Ё+"ЁГ<9ббГ!  "¬Нф8ю+К­9ю-В°9!яя"ЄНф8·КХ9ю0ъЏ9ю:тЏ9Ц0х*¬
 НXсo& "¬Г­9*¬е*Є|µбьPл*Ё"Ё*®|·Вч9ббГ*Ё|·ъ:*Ё|µК3:+"Ё!  е! еНЙ6Гя9*Ё|µК3:#"Ё!  е! еН7Г:*¦|µК'б|оЂgеГ'FLIT 9ЙЅ¬ ќ ’ З9¬ °У4єєєќ ’ © }PI   N:G5 ЙEXP  Ђ:Љ-  FSCL Ћ:Й° Ћ:•­,У4 @њ 8¬ Ћ:S#У4   v7’вя­,У4
  ъp8¬ Ћ:g#У4   7’вя}FPRINљ:Й-!‡К^-Г60a0a0a0°. х/a0/0/°E а.Ћ:‡Xы!¬
 е°- ’ °+ а.0a0a0/0/\/Ы-!•}F=   к:Й­,«4¬ KЙ 0.000E+00  $/’ ­,[4¬
 ‡5°- ’ °  а.љ:к:}F?   H;Й*5H;}GUESSЏ;џ;бС}}o?ЪІ;,zЖ@Гґ;zW{_Г-FSQRTџ;ЙXы!¬ ЙFSQRT ERROR *­,«4¬
 У4    ’ ­,џ;° 3& ѕ,ѕ,v788¶n&тяЦ,}FSIN4Е;Й­,­,7­,У4щЂфЋ7У4э Лў88ѕ,7У4 Ђ[Ґ887У4 Й887}FCOS <Й™5У4  ъў7­,Г6§XКµ * ¬ b6‡5У4  Ђ88’ b6<ЫБ * ¬ ‡5}FSIN T<ЙУ4  ъў7­,Г6XКµ * ¬ b6‡5У4  Ђ88’ b6<ЫБ * ¬ ‡5}FSIN њ<Й­,[4¬
 ‡5њ<‡5’ њ<}FATANа<Й­,­,7­,У4ы ®Є7У4эЂ[®88ѕ,7У4ю wё88ѕ,7У4яЂ©887У4  ця887}FATAN =Й­,У4  Ђђ8¬ У4  Ђз,v7 =‡5У4 Й88’  =}FATANH=Й­,[4¬
 ‡5H=‡5’ H=}EXTB7~=ћ=б}·т.&яГ.FLOG2ћ=Й­,o4¬ Й
FLOG ERROR *ћ=6(-© ­,У4 `ц7У4Ђi¶88ѕ,7У4Ђ-›88з,­,У4 ^¶88з,7У4я шя88v788}FLN  і=Йі=У4  r±7}FLOG1>Йі=У4я !љ7}2.0**/>Й­,b6­,У4ъ АЭ7У4ь Х88ѕ,7У4ю =ч88ѕ,7У4  i±887У4  Ђ88з,Г6°я *  }FEXP E>ЙУ4  r±v7E>}10.0*•>ЙУ4я !љv7E>}S1   «>Љ-    S2   Б>Љ-    S3   П>Љ-    S4   Э>Љ-    DET  л>Љ-    NPTS щ>Љ-  <LSQ ?ЙУ4    Б>с4У4    П>с4У4    Э>с4У4    л>с4© ?•}LSQ  ?Й­,П>ж8ѕ,7Э>ж8­,Б>ж8­,7л>ж8?S#}LSQ> M?Й?‡6л>*57Б>*5­,7`8щ>с4щ>*5«4¬ Й	LSQ ERROR *П>*5л>*57Б>*5Э>*57`8щ>*5v7?‡6Э>*57Б>*5П>*57`8щ>*5v7}FSEEDy?Љ-б5FRANDт?ю?!/"ў*т?еНXл"т?  Г±5  ETCPM     /%98678:-465#	;8789E8!E5525 6 9	5;;/B9H?,?#@><@#A=429726B5C26E4+,$8/(+A0LAD#@LJ:@7?"@=-2C7AA<A@,!J@<63NЂW
100
PUSH JMP, >
EN, B POP, D POP, H POP, H INX, C DCR,
P,
                                                                        P JMP                                                                            JM                                                                    T N%
PRINT TAB(4);
FOR ENO% = 0 TO B%-1: PRINT USING "##"; ENO%;: NEXT ENO%
PRINT
RETURN
	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	
яяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее % ************************************************************************
 % ** COPYRIGHT.  STOIC-CP/M FILE HANDLING PROGRAMME FOR U.S.USERGROUP  ***
 % ** VERSION OF STOIC. A.R.M.CLARKE,CHILTON COTTAGE,SUDBURY,SUFFOLK    ***
 % ************************************************************************
 
% A.R.M.CLARKE. 1980

     RADIX @ DECIMAL

 % THIS IS A MEANS OF USING THE STANDARD STOIC AS FOUND ON THE U.S.USERGROUP
 % LIBRARY ,VOLUME 23.       IT GIVES A COMPLETE ACCESS TO THE CP/M B.D.O.S.
 % COMMANDS AND PROVIDES EVERYTHING NECESSARY FOR FILE HANDLING IN SEQUENTIAL
 % AND RANDOM ACCESS.  WITH THIS PROGRAMME IS A SLIGHTLY MODIFIED VERSION OF
 % THE STOIC SCREEN EDITOR TO PROVE THE POINT. TRY IT!
 % WHEREVER POSSIBLE ,COMPATIBILITY HAS BEEN MAINTAINED WITH THE STOIC FILE
 % HANDLING WORDS.  THE ORIGINAL KERNEL WORDS ARE NOT NEEDED BUT THE 'CPMLD'
 % COMMAND IS USED.COMMON UTILITIES SUCH AS TYPING THE FILE,COPYING,DELETING
 % AND RENAMING ARE IMPLEMENTED
 % PLEASE NOTE THAT I HAVE LEFT THE CODE RATHER UNECONOMIC IN SIZE OUT OF A
 % MIXTURE OF IDLENESS AND A DESIRE FOR CLARITY. IF YOU DEVISE A REVISION
 % THAT CONFORMS TO THE SPIRIT OF SPEED, CLARITY, AND ELEGANCE, LET ME KNOW
 % AND I WILL INCLUDE IT IN SUBSEQUENT REVISIONS.
 % THIS PACKAGE IS DESIGNED FOR CP/M 1.4 AND WILL NOT RUN ON CP/M 2.2 WITHOUT
 % MODIFICATION. PLEASE ALSO NOTE THAT, ALTHOUGH DRIVE SELECTION IS WRITTEN
 % INTO THE PACKAGE, I HAVE NOT DEBUGGED THIS AS I HAVE ONLY A SINGLE DISK
 % DRIVE. I HAVE RESISTED PUTTING IN TOO MANY WORDS (SUCH AS GETWORD-WHICH
 % GETS THE NEXT WORD STRING FROM THE FILE AND PUTS IT ON TOP OF THE
 % DICTIONARY) AS THE FILE IS ALREADY TOO LARGE AND YOU NEED SOME THINGS TO
 % PRACTICE ON; IF YOU GET STUCK, GIVE ME A RING ON SUDBURY(SUFFOLK) 76601
 % AND I WILL TRY TO HELP
 % P.S. MOST OF THIS WAS REVISED USING STOIC'S SCREEN EDITOR


 %            ****** CONSTANTS AND VARIABLES  ******

0       'FCBAD     VARIABLE   % POINTER TO CURRENT F.C.B.
0       'SFLAG     VARIABLE   % SEARCHFLAG FOR WILDCARD ACCESS
26      'EOF       CONSTANT   % CP/M'S END OF FILE CHARACTER
0       'DRIVE#    VARIABLE   % CURRENT DRIVE NUMBER (0-3)
128     'DMA       CONSTANT   % DEFAULT 'DMA' BUFFER
3942    'BLOCKBASE CONSTANT   % BASE ADDRESS OF THE LOWER BLOCK
% THIS IS AN UNASHAMED LASH-UP.  MODIFY IT TO SUIT THE KERNEL IMAGE 
-1      'CONS      VARIABLE   % OUTPUT TO CONSOLE FLAG
0       'LST       VARIABLE   % OUTPUT TO LIST DEVICE FLAG
0       'LASTBYTE  VARIABLE   % LAST BYTE OUTPUT BY STOIC
5       'BDOS      CONSTANT   % BDOS ENTRY POINT (0005H)
13      '<CR>      CONSTANT   % ASCII CARRIAGE RETURN
10      '<LF>      CONSTANT   % ASCII LINE FEED
19      '<^S>      CONSTANT   % CP/M STOP OUTPUT COMMAND

 %            ****** CONSOLE AND PRINTER OUTPUT ******

% THE FOLLOWING WORDS USE DIRECT BIOS CALLS RATHER THAN THE MORE OBVIOUS
% BDOS CALLS FOR TWO REASONS. TO GET UNECHOED INPUT AND BECAUSE I/O BDOS
% CALLS ARE NOTICABLY SLOWER!

% BIOS OFFSET IN DE, MAKES JUMP TO BIOS VECTOR TABLE
ASSEMBLER<
. 1 LHLD, D DAD, PCHL,
'BIOS CONSTANT

% 0/0   STOP? IS A SUBROUTINE THAT IMPLEMENTS THE USE OF ^S AS A MEANS OF
 % TEMPORARILY STOPPING OUTPUT TO THE PRINTER OR CONSOLE. ANY KEY PRESSED
 % WILL CAUSE OUTPUT TO CONTINUE
 
. 3 D LXI, BIOS CALL, A ANA, RZ, 6 D LXI, BIOS CALL,
<^S> CPI, RNZ, 6 D LXI, BIOS CALL, RET,
'STOP? CONSTANT

 % 0/0   (CLO) IS THE SUBROUTINE THAT IS THE CORE OF THE CP/M OUTPUT
 % MODS. OUTPUT IS SENT TO CONSOLE OR LIST DEVICE OR BOTH ACCORDING
 % TO THE FLAGS `CONS` AND `LST`. THE CONTROL S SWITCH IS IMPLEMENTED
 % AND THE AWKWARD DIFFERENCES BETWEEN STOIC AND CP/M IN THEIR 
 % TREATMENT OF THE CR/LF SEQUENCE IS AVOIDED BY SENDING LF
 % AUTOMATICALLY AFTER CR BUT IGNORING THE LF THAT OCCURS DIRECTLY
 % AFTER CR SO AS TO AVOID DOUBLE LINE FEEDS

. PSW PUSH, STOP? CALL, PSW POP, A C MOV, LASTBYTE LDA, <CR> CPI,
 C A MOV, IFNZ, <LF> CPI, RZ, THEN, 32 CPI, IFM, COLUMN H LXI,
 M INR, THEN, LASTBYTE STA,  . A C MOV, . <L PSW PUSH, B PUSH,
 CONS LDA, A ANA, IFZ, 9 D LXI, BIOS CALL, THEN, B POP, LST LDA,
 A ANA, IFZ, 12 D LXI, BIOS CALL, THEN, PSW POP, <CR> CPI, RNZ,
 A SUB, COLUMN STA, <LF> A MVI, JMP,
 >
'(CLO) CONSTANT

 % <CR.NO.LF> IS PART OF THE ROUTINE USED TO OUTPUT CARRIAGE RETURN
 % WITHOUT ACCOMPANYING LINE FEEDS
L> '<CR.NO.LF> CONSTANT

 % 1/0   <OUT> OUTPUTS THE BYTE AT TOP
'<OUT> CODE< H POP, L A MOV, (CLO) CALL, NEXT JMP, >

 % NOW WE MAKE (CLO) THE OFFICIAL OUTPUT ROUTINE
() <OUT> OUT !

 % AND NOW WHEN (TTO) IS CALLED, THEN (CLO) IS USED INSTEAD
ASSEMBLER<
(CLO) () (TTO) !
>

 % 0/0   CR(NO-LF) OUTPUTS A CR WITHOUT A LF
'CR(NO-LF) CODE< A SUB, COLUMN STA, <CR> C MVI, <CR.NO.LF> CALL, NEXT JMP, >

 % 1/0   LOU OUTPUTS BYTE ON TOP TO LIST DEVICE ONLY
'LOU : LST @ CONS @ LST -1<- CONS 0<- -ROT TYO CONS ! LST ! ;

 % 1/0   TOU OUTPUTS BYTE ON TOP TO CONSOLE ONLY
'COU : LST @ CONS @ LST 0<- CONS -1<- -ROT TYO CONS ! LST ! ;

 % 0/0   ^P SWITCHES THE PRINTER OUTPUT ON OR OFF
'^P : LST DUP @ NOT <- ;

 % NOW PRESSING CONTROL P SWITCHES PRINTER OUTPUT (IF SEPARATED FROM
 % ANOTHER STOIC WORD BY CR, SPACE, TAB OR FF)
'&020& : ^P ;

 %           ****** FILE CONTROL BLOCKS AND BUFFERS ******


 % FILE CREATES AN FCB WHOSE NAME IS AT TOP. WHEN REFERENCED 
 % THE ADDRESS OF THE FILE CONTROL BLOCK IS STORED IN THE
 % VARIABLE FCBAD. THIS CAUSES THE FILE CONTROL BLOCK TO BECOME
 % THE CURRENT ONE REFERENCED BY DISK FILE COMMANDS.
 % REMEMBER THAT THE STOICCPM SYSTEM USES AS MANY FILE CONTROL
 % BLOCKS AS NEEDED FOR FILE I/O. AS WELL AS THE CP/M BLOCK
 % IT ALSO HAS AN ARRAY CONTAINING FILE FLAGS AND VARIABLES
 % REQUIRED FOR COMPLEX FILE OPERATIONS. FINALLY, EACH FCB
 % HAS ITS OWN FILE BUFFER FOR FILE I/O SO THAT SEVERAL
 % FILES CAN BE WRITTEN TO OR READ FROM AT THE SAME TIME

'FILE : 17 3 64 + + SWAP ARRAY ;CODE< XCHG, FCBAD SHLD, NEXT JMP, >

 % FCB PUSHES THE ADDRESS OF THE CURRENT FILE CONTROL BLOCK
'FCB : FCBAD @ ;
 % FNAD PUSHES THE FILE NAME ADDRESS 
'FNAD CODE< 1 D LXI, . . . . . . . . . . . . FCBAD LHLD, D DAD, PUSH JMP, > 
 % FTAD PUSHES THE FILE TYPE ADDRESS 
'FTAD CODE< 9 D LXI, JMP, >
 % EX IS A VARIABLE GIVING FILE EXTENT 
'EX CODE< 12 D LXI, JMP, >
 % RC IS A VARIABLE GIVING THE RECORD COUNT
'RC CODE< 15 D LXI, JMP, >
 % NR IS A VARIABLE GIVING THE NEXT RECORD TO READ
'NR CODE< 32 D LXI, JMP, >
 % EF IS A FLAG THAT CAN BE SET TO NON-ZERO AT END OF FILE
'EF CODE< 33 D LXI, JMP, >
 % W/R IS A FLAG SHOW]NG THE WRITE/READ STATUS OF THE FILE 
'W/R CODE< 34 D LXI, JMP, > 
 % O/C IS A FLAG GIVING THE OPEN/CLOSED STATUS OF THE FILE 
'O/C CODE< 35 D LXI, JMP, > 
 % RB IS A VARIABLE THAT GIVES THE NEXT RELATIVE BYTE TO READ/ WRITE
'RB CODE< 36 D LXI, JMP, >
 % F/E IS A FLAG INDICATING WHETHER THE BUFFER IS EMPTY OR NOT
'F/E CODE< 37 D LXI, JMP, > 
 % DR# IS A VARIABLE GIVING THE DRIVE NO. OF THE FILE 
'DR# CODE< 38 D LXI, JMP, > 
 % R->BUF IS A VARIABLE GIVING THE CURRENT RECORD NO. IN THE BUFFER 
'R->BUF CODE< 39 D LXI, JMP, > 
 % FBUFFER PUSHES THE ADDRESS OF THE START OF THE FILE BUFFER 
'FBUFFER CODE< 40 D LXI, JMP, > 

 % NOW WE DEFINE THREE FCBS ! 
 'IFILE FILE   'OFILE FILE   'AFILE FILE   
             AFILE
% AFILE IS THE CURRENT FCB NOW


 %    ****** FILE CONTROL BLOCK WORDS. ******

 % 0/0  CLEARFCB CLEARS THE FCB AND PUTS IN BLANKS AND ZEROS
'CLEARFCB : FCB 84 0FILL FCB 6 8224 FILL 0 FCB B! ;

 % 1/2or3  FT-THERE? TAKES AN ADDRESS OF A STRING OFF THE STACK AND FINDS 
 % WHETHER THE STRING HAS A '.'  . IF SO IT CONVERTS THE FILENAME AND TYPE
 % INTO STOIC STRINGS AND PUSHES THEIR ADDRESS ON THE STACK. TOP OF THE
 % STACK CONTAINS A -1. IF NO '.'THE ADDRESS OF THE ENTIRE STRING IS
 % PUSHED AND AN 0 IS PUSHED ON THE TOP OF THE STACK
'FT-THERE? CODE< H POP, H D MOV, L E MOV, M B MOV, 0 C MVI,
 ASCII . A MVI, . <L H INX, M CMP, IFZ, C INR, B DCR, L> JNZ,
D PUSH, 0PUSH JMP, THEN, XCHG, M B MOV, B DCR, C M MOV, B A MOV,
C SUB, D STAX, H PUSH, D PUSH, -1PUSH JMP, >

 % 1/0 PUTINNAME PUTS THE FILENAME (AND OPTIONALLY THE TYPE) ADDRESSED
 % BY THE TOP OF THE STACK INTO THE CURRENT F.C.B.  IF NO FILETYPE IS
 % SPECIFIED THEN THE DEFAULT 'STC' FILETYPE IS INSERTED
'PUTINNAME : . 32 + SWAP DDUP B@ 1+ MVBYTES  FT-THERE? EQZ IF 
'STC THEN FTAD OVER 1+ FLIP B@ 3 MIN MVBYTES FNAD OVER 1+ FLIP
B@ 8 MIN MVBYTES ;

 % 1/0  INFCB CLEARS THE CURRENT FCB AND INSERTS THE FILENAME ADDRESSED
 % BY THE TOP OF THE STACK. IT ALSO MAKES THE DRIVE NUMBER THAT IS CURRENT
 % THE DRIVE NO. FOR THE FILE
'INFCB : CLEARFCB PUTINNAME DRIVE# @ DR# B! ;

 % 0/0  TYPEFCB TYPES THE FILENAME AND FILETYPE IN THE FCB 
'TYPEFCB : SPACE FNAD 8 + FNAD DO I B@ DUP 32 NE IF TYO ELSE DROP THEN 
LOOP 46 TYO FTAD 3 + FTAD DO I B@ DUP 32 NE IF TYO ELSE DROP THEN 
LOOP ;

 %            ****** ERROR MESSAGES ******

 % THESE MESSAGES ARE STORED AS NULL TERMINATED STRINGS PRECEEDED BY
 % THEIR BYTE COUNT SO THAT THEY CAN BE ACCESSED BY BOTH CODE AND FORTH
 % DEFINITIONS. THE STARTING ADDRESS OF EACH STRING IS STORED IN THE
 % ACCOMPANYING CONSTANT
 %        EG. 1ERROR MSG  OR 2ERROR ERR OR  4ERROR H LXI, ERROR JMP,

. "SORRY,BUT WE HAVE A PROBLEM.&15&THE " S, '0ERROR CONSTANT
. " FILE IS NOT ON" S, '1ERROR CONSTANT
. " FILE IS'NT OPEN" S, '2ERROR CONSTANT
. "D.O.S. READ PAST THE END OF THE FILE" S, '3ERROR CONSTANT
. "D.O.S. READ UNWRITTEN DATA IN RANDOM ACCESS" S, '4ERROR CONSTANT
. "ERROR WAS IN EXTENDING THE FILE" S, '5ERROR CONSTANT
. "END OF DISK DATA WAS REACHED" S, '6ERROR CONSTANT
. "DIRECTORY IS FULL UP !" S, '7ERROR CONSTANT
.  "FILE ALREADY EXISTS ON" S, '8ERROR CONSTANT

 %    ****** CP/M-FDOS INTERACTION WORDS ******


 % 2/1  (FUNCTION) (PARAMETER) FDOSENTRY,MAKES A BDOS CALL 
 % PUSHES RETURNED VALUE ON T.
'FDOSENTRY CODE<  D POP, B POP, BDOS CALL, 0 H MVI, A L MOV, PUSH JMP, >

 % 0/0  LIFTHEAD LIFTS THE HEAD FROM THE CURRENT DRIVE 
'LIFTHEAD : 12 0 FDOSENTRY DROP ;

 % 0/0  RESET SETS 80H DMA,INITIALIZES BDOS AND SELECTS DRIVE A  
'RESET : 13 0 FDOSENTRY DROP ;

 % 1/0  (DRIVENO.) LOGIN, LOGS IN AND SELECTS SPECIFIED DISC 
'LOGIN : 0 MAX 3 MIN 14 SWAP FDOSENTRY DROP ;

 % ?DRIVE ANNOUNCES THE DRIVE NO. 
'?DRIVE : 25 0 FDOSENTRY 32 TYO 65 + 32 'DRIVE MSG TYO TYO ;

 % 0/1  OPENFILE, OPENS THE FILE SPECIFIED IN THE FCB  
 % BYTE ADDRESS OF FCB IN DICTIONARY LEFT ON THE STACK  
'OPENFILE : 15 FCB FDOSENTRY DUP 255 EQ IF 0ERROR MSG TYPEFCB 1ERROR  
MSG ?DRIVE ABORT   THEN ;

 % 0/1  CLOSEFILE CLOSES A FILE THAT HAS PREVIOUSLY BEEN  
 % OPENED. LEAVES BYTE ADDRESS OF DIRECTORY FCB ON STACK  
'CLOSEFILE : 16 FCB FDOSENTRY DUP 255 EQ IF 0ERROR MSG 2ERROR 
ERR THEN ;

 % 0/1 OR 2  SEARCHFILE FINDS FIRST`OCCURECE` FCB IN   % THE DIRECTGRY . LEAVS BYTE ADDRESS ON STACK AT T-1 
 % AND -1 AT TOP . 0 AT TOP IF NO MATCH.  
'SEARCHFILE : 17 FCB FDOSENTRY DUP 255 EQ IF DROP  
0 ELSE -1 THEN ;

 % 0/1 OR 2  SEARCHAGAIN, USED AFTER SEARCHFILE WITH NO  
 % INTERMEDIATE BDOS CALLS .LEAVES BYTE ADDRESS AT T-1  
 % AND -1 AT TOP . 0 AT TOP IF NO MATCH.  
'SEARCHAGAIN : 18 FCB FDOSENTRY DUP 255 EQ IF DROP 0 
ELSE -1 THEN ;

 % 0/0  DELETEFILE WIPES FILE FROM THE DISC  
'DELETEFILE : 19 FCB FDOSENTRY DROP ;

 % 0/0  READARECORD READS THE NEXT RECORD OF A PREVIOUSLY  
 % OPENED FILE NR IS SET TO NEXT RECORD TO READ  
'READARECORD : 20 FCB FDOSENTRY DUP NEZ IF 0ERROR MSG 1 EQ IF 
3ERROR ERR ELSE 4ERROR ERR THEN THEN DROP ;

 % 0/0  WRITEARECORD WRITES THE NEXT RECORD OF A PREVIOUSLY 
 % OPENED FILE. NR IS SET TO NEXT RECORD TO WRITE  
'WRITEARECORD : 21 FCB FDOSENTRY DUP NEZ IF 0ERROR MSG DUP 255  
EQ IF 7ERROR ERR THEN 1 EQ IF 5ERROR ERR ELSE 6ERROR
ERR THEN THEN DROP ;

 % 0/1  MAKEAFILE MAKES A NEW FILE AND LEAVES THE  
 % BYTE ADDRESS OF THE FCB IN THE DIRECTORY AT TOP  
'MAKEAFILE : 22 FCB FDOSENTRY DUP 255 EQ IF 0ERROR MSG 7ERROR 
ERR THEN ;

 % 0/0  RENAMEFILE CHANGES THE NAME OF THE FCB (FCB&FCB+16) 
'RENAMEFILE : 23 FCB FDOSENTRY DROP ;

 % 0/0  ?LOGIN ANNOUNCES WHICH DRIVES ARE 'ON LINE'
'?LOGIN : 24 0 FDOSENTRY 4 0 DO 2 U/MOD 'DRIVE MSG SPACE 65
I + TYO SPACE EQZ IF 'NOT MSG THEN SPACE "ON LINE" MSG CR LOOP ;

 % 1/0  SETDMA SETS ADDRESS OF 128 BYTE I/O BUFFER (1/0) 
'SETDMA : 26 SWAP FDOSENTRY DROP ;

 % 0/1  ?ALLOCATION RETURNS ALLOCATION VECTOR AT TOP 
 % INCLUDED MERELY FOR COMPLETENESS  
'?ALLOCATION : 27 0 FDOSENTRY ;

 % 0/0  SETDRIVE SETS THE DRIVE TO READ-ONLY. TO RESET USE RESET
'SETDRIVE : 28 0 FDOSENTRY DROP ;

 % 0/1  RO-VECTOR RETURNS A BYTE MAP OF THE READ ONLY DRIVES
'RO-VECTOR : 29 0 FDOSENTRY ;

 % 1/0 SETDIRDMA SETS THE DIRECTORY I/O DMA TO THE ADDRESS AT TOP
 % WHEN YOU HAVE SEVERAL I/O BUFFERS IN STOIC DIRE CONSEQUENCES
 % FOLLOW IF THIS IS NOT USED! (ALL AUTOMATIC IN THIS SYSTEM)
'SETDIRDMA : 30 SWAP FDOSENTRY DROP ;

 %         ****** PRIMITIVE SEQUENTIAL FILE OPERATIONS ******


 % READFBUFF IS A SUBROUTINE FOR READING A RECORD INTO 
 % THE BUFFER OF THE CURRENT FILE
     ASSEMBLER< DEFINITIONS
   .
B PUSH, D PUSH, H PUSH, FCBAD LHLD, 36 D LXI, D DAD, 0 M MVI,
 H INX, 1 M MVI,  H INX, M E MOV, 0 D MVI, 14 C MVI, H PUSH,
BDOS CALL, H POP, H INX, H INX, XCHG, 26 C MVI, BDOS CALL,
 FCBAD LHLD, XCHG, 20 C MVI, BDOS CALL, A ANA, IFNZ, FCBAD LHLD,
32 D LXI, D DAD, M D MOV, D DCX, 7 B LXI, B DAD, D M MOV, 30 C MVI,
DMA D LXI, BDOS CALL, H POP, D POP, B POP, RET, THEN, 
0ERROR H LXI, (MSG) CALL, 1 CPI, IFZ, 4ERROR H LXI, ERROR JMP,
THEN, 3ERROR H LXI, ERROR JMP,

'READFBUFF CONSTANT

 % WRITEFBUFF IS A SUBROUTINE FOR WRITING A RECORD FROM
 % THE BUFFER OF THE CURRENT FILE
 
. B PUSH, D PUSH, H PUSH, FCBAD LHLD, 36 D LXI, D DAD, 0 M MVI,
 H INX, H INX, M E MOV, 0 D MVI, 14 C MVI, H PUSH, BDOS CALL,
 H POP, H INX, H INX, XCHG, 26 C MVI, BDOS CALL, FCBAD LHLD,
 XCHG, 21 C MVI, BDOS CALL, A ANA, IFNZ, FCBAD LHLD, 32 D LXI,
 D DAD, M D MOV, D DCX, 7 B LXI, B DAD, D M MOV, 30 C MVI, DMA D LXI,  
BDOS CALL, H POP, D POP, B POP, RET, THEN,
0ERROR H LXI, (MSG) CALL, 1 CPI, IFZ, 2 CPI, IFZ, 7ERROR H LXI,
ERROR JMP, THEN, 6ERROR H LXI, ERROR JMP, THEN, 5ERROR H LXI,
ERROR JMP,
  'WRITEFBUFF CONSTANT

 % (GETBYTE) GETS THE NEXT BYTE OF A FILE THAT HAS BEEN 
 % OPENED FOR READING INTO THE A REGISTER . 
 
  . "FILE IS WRITE-ONLY" S, . <L H LXI, ERROR JMP,
   .
FCBAD LHLD, H A MOV, L ORA, IFZ, 34 D LXI, D DAD, M A MOV,
 A ANA, L> JNZ, H INX, M A MOV, A ANA, IFZ, H INX, M A MOV,
 128 SBI, READFBUFF CZ, H INX, M A MOV, A ANA, READFBUFF CZ,
H DCX, M C MOV, M INR, 0 B MVI, 4 D LXI, B DAD, D DAD,
 M A MOV, RET,
THEN, THEN, 2ERROR H LXI, ERROR JMP,

'(GETBYTE) CONSTANT

 % (PUTBYTE) PUTS THE CONTENTS OF THE A REGISTER INTO
 % THE NEXT BYTE OF THE PREVIOUSLY OPENED FILE

. "FILE IS READ-ONLY" S, . <L H LXI, ERROR JMP,

 .
A C MOV, FCBAD LHLD, H A MOV, L ORA, IFZ, 34 D LXI,
D DAD, M A MOV, A ANA, L> JZ, H INX, M A MOV, A ANA,
IFZ, H INX, M A MOV, 128 SBI, WRITEFBUFF CZ, M E MOV,
 M INR, 0 D MVI, D DAD, 4 D LXI, D DAD, C M MOV, RET,
 THEN, THEN, 2ERROR H LXI,
ERROR JMP,
  '(PUTBYTE) CONSTANT
    > DEFINITIONS

 % 0/1  GETBYTE RETURNS THE NEXT BYTE FROM THE FILE ,USING
 % THE CURRENT FILE CONTROL BLOCK
'GETBYTE CODE< (GETBYTE) CALL, A L MOV, 0 H MVI, PUSH JMP, >

 % 1/0  PUTBYTE STORES THE BYTE AT TOP IN THE NEXT BYTE OF
 % THE FILE,USING THE CURRENT FILE CONTROL BLOCK
'PUTBYTE CODE< H POP, L A MOV, (PUTBYTE) CALL, NEXT JMP, >

 % 0/0  RECORDWRITE WRITES OUT THE CONTENTS OF THE CURRENT FILE
 % BUFFER INTO THE NEXT DISK RECORD
'RECORDWRITE CODE< WRITEFBUFF CALL, NEXT JMP, >

 % 0/0 RECORDREAD READS THE NEXT RECORD INTO THE CURRENT FILE BUFFER
'RECORDREAD CODE< READFBUFF CALL, NEXT JMP, >
 
 %  2/0  GETBYTES TAKES A BYTE COUNT AT TOP AND A BUFFER ADDRESS AT
 % TOP -1 AND READS THE SPECIFIED NUMBER OF BYTES FROM THE FHLE
 % SPECIFIED(BY THE CURRNT FCB INTO THE SAID BUFFER
'GETBYTES CODE< H POP, D POP, H A MOV, A ORA, NEXT JM, L ORA,
NEXT JZ, . D PUSH, H PUSH, (GETBYTE) CALL, H POP, D POP,
D STAX, D INX, H DCX, H A MOV, L ORA, JNZ, NEXT JMP, >

 % 2/0  PUTBYTES TAKES A BYTE COUNT AT TOP AND A BUFFER ADDRESS AT
 % TOP -1 AND WRITES THE SPECIFIED NUMBER OF BYTES TO THE DISK FILE
 % SPECIFIED BY THE CURRENT FCB FROM THE SAID BUFFER
'PUTBYTES CODE< H POP, D POP, H A MOV, A ORA, NEXT JM, L ORA,
NEXT JZ, . D PUSH, H PUSH, D LDAX, (PUTBYTE) CALL, H POP,
D POP, D INX, H DCX, H A MOV, L ORA, JNZ, NEXT JMP, >

 % 1/1  GETBLOCK GETS A BLOCK WHOSE STARTING ADDRESS IS AT
 % TOP FROM THE CURRENT FILE THAT HAS BEEN PREVIOUSLY OPENED
 % PUSHES -1 IF END OF FILE REACHED, OTHERWISE 0
'GETBLOCK CODE< FCBAD LHLD, 33 D LXI, D DAD, M A MOV, A ANA,
-1PUSH JNZ, T1 SHLD, 1024 H LXI, D POP, . <L D PUSH, H PUSH,
 (GETBYTE) CALL, H POP, D POP, D STAX, EOF CPI, IFZ, 
 D INX, H DCX, H A MOV, L ORA, L> JNZ, 0PUSH JMP, THEN,
 T1 LHLD, -1 M MVI, -1PUSH JMP, >

 % 1/1  PUTBLOCK  PUTS A BLOCK WHO'SE STARTING ADDRESS IS AT
 % TOP INTO THE CURRENT FILE THAT'S BEEN PREVIOUSLY WOPENED
 % PUSHES -1 IF END OF FILE REACHED, OTHERWISE 0
'PUTBLOCK CODE< FCBAD LHLD, 33 D LXI, D DAD, M A MOV, A ANA,
-1PUSH JNZ, T1 SHLD, 1024 H LXI, D POP, . <L D PUSH, H PUSH,
 D LDAX, PSW PUSH, (PUTBYTE) CALL, PSW POP, H POP, D POP,
  EOF CPI, IFZ,  D INX, H DCX, H A MOV, L ORA, L> JNZ, 0PUSH JMP,
 THEN, T1 LHLD, -1 M MVI, -1PUSH JMP, >

 % PRINTLINE PUTS UP ON THE CONSOLE THE NEXT LINE OF THE FILE
 % IN THE CURRENT FCB
 % PUSHES -1 IF END OF FILE REACHED, OTHERWISE 0.
 % STOPS TYPING IF KEY IS PRESSED, CONTINUES IF KEY PRESSED
'PRINTLINE CODE< FCBAD LHLD, 33 D LXI, D DAD, M A MOV,
A ANA, -1PUSH JNZ, H PUSH, . <L (GETBYTE) CALL, EOF CPI, IFZ,
PSW PUSH, (CLO) CALL, PSW POP, 10 CPI, L> JNZ, H POP,
 0PUSH JMP, THEN, H POP, -1 M MVI, -1PUSH JMP, >


 %              ****** BASIC DISC UTILITIES ******


 % 0/1 THERE? PUSHES -1 IF FILE IS ON LOGGED DISK, OTHERWISE PUSHES
 % 0 AND ANNOUNCES THE FACT
'THERE? : SEARCHFILE DUP EQZ IF 0ERROR MSG TYPEFCB 1ERROR MSG
?DRIVE ELSE UNDER THEN ;
 
 % 0/1 NOT-THERE? PUSHES 0 IF THE FILE IN THE FCB ALREADY EXISTS, AND
 % ANNOUNCES THE FACT; OTHERWISE PUSHES -1 
'NOT-THERE? : SEARCHFILE IF DROP 8ERROR MSG ?DRIVE CR BEGIN SEARCHAGAIN 
IF DROP "THERE'S ANOTHER" MSG TYPEFCB " ON" MSG ?DRIVE CR REPEAT 0  
ELSE -1 THEN ;
 
 % 1/0  EXIST SEARCHES FOR NAME ON TOP GIVES ERROR MESSAGE
 % IF THE FILE IS NOT FOUND 
'EXIST : AFILE INFCB THERE? EQZ IF ABORT THEN ;
 
 % 1/0  NOT-EXIST SEARCHES FOR NAME ON TOP, GIVES ERROR MESSAGE
 % IF THE FILE IS FOUND 
'NOT-EXIST : AFILE INFCB NOT-THERE? EQZ IF ABORT THEN ;

 % 0/0  SETUP SETS THE CURRENT DRIVE
'SETUP :  DRIVE# @ LOGIN ;

 % 1/0  DRIVE SETS THE CURRENT DRIVE 
'DRIVE : 0 MAX 3 MIN DUP LOGIN DRIVE# ! ;

 % NOW WE CAN HAVE PSEUDO CP/M DRIVE ACTIVE COMMANDS
'A: : 0 DRIVE ; 'B: : 1 DRIVE ; 'C: : 2 DRIVE ; 'D: : 3 DRIVE ;
 % WARNING! DRIVE SELECT WORDS NOT CHECKED OR DEBUGGED (I'VE ONLY
 % GOT ONE DRIVE)

 % 1/0  OPEN  OPENS THE FILE WHO'SE NAME IS AT TOP USING THE 
 % CURRENT FCB. THE FILE IS OPENED FOR READING ONLY
'OPEN : SETUP  INFCB OPENFILE -1 O/C B! 0 W/R B! DROP ;

 % 0/0  WOPEN   OPENS A FILE FOR WRITING.  FILE NAME ON TOP
 % OF THE STACK. ANY PREVIOUS VERSION OF THE FILE IS DELETED
 % THE FILE IS OPENED USING THE CURRENT FCB .SEVERAL FILES
 % CAN BE OPEN AT ANY TIME
'WOPEN : SETUP INFCB SEARCHFILE IF DROP DELETEFILE THEN MAKEAFILE
DROP OPENFILE DROP -1 O/C B! -1 W/R B! ;

 % 0/0  CLOSE   CLOSES THE FILE IN THE CURRENT FCB
'CLOSE : W/R B@ IF RB B@ GTZ IF RECORDWRITE THEN THEN  
DMA SETDIRDMA CLOSEFILE DROP 0 O/C B! ;

 % PUTNAMEINFCB TAKES WILDCARD OR AMBIGUOUS NAME AT TOP
 % AND PUTS THE NEXT OCCURENCE OF THE FILENAME IN THE FCB.
 % RETURNS -1 AT TOP IF SUCCESSFUL, OTHERWISE 0. FOR THIS
 % COMMAND TO WORK PROPERLY, SFLAG MUST INITIALLY BE SET
 % TO 0 ; THIS SHOULD BE AUTOMATIC!
'PUTNAMEINFCB : INFCB SFLAG @ IF SEARCHAGAIN ELSE SEARCHFILE
SFLAG -1<- THEN IF 4 MOD 32 * 1 + DMA + FNAD 11 MVBYTES -1
ELSE SFLAG 0<- 0 THEN ;

 % 1/0  DELETE  ERASES THE FILE WHOSE NAME IS AT THE TOP
 % OF THE STACK
'DELETE : AFILE EXIST DELETEFILE CLEARFCB ;

 % LIST-DIRECTORY LISTS ALL THE FILES ON THE DISK IN TWO COLUMNS
 % IN THE ORDER THAT THEY OCCUR IN THE DIRECTORY. IF YOU ONLY
 % WANT THE .STC FILES THEN TAKE OFF THE .??? AMBIGUOUS FT
'LIST-DIRECTORY : RESET SETUP AFILE SFLAG 0<- IFCR " FILES ON"
 MSG ?DRIVE CR CR 0 BEGIN '????????.??? PUTNAMEINFCB IF 1+ DUP
 <#> 2 OVER - SPACES TYPE ASCII / TYO SPACE TYPEFCB COLUMN 
B@ 30 GT IF CR ELSE 30 TAB THEN REPEAT DROP ;


 %               *********** DISK UTILITIES ********** 

 % 1/0  WPRINT TYPES A FILE ON THE CONSOLE (ACCEPTS AMBIGUOUS FILENAMES)
 % SYNTAX   'FILENAME WPRINT  OR  '????????.ASM WPRINT
 % DO NOT USE THIS IF YOU HAVE A FILE OPEN!
'WPRINT : RESET SETUP AFILE SFLAG 0<- BEGIN DUP PUTNAMEINFCB IF OPENFILE DROP
-1 O/C B! 0 W/R B! BEGIN PRINTLINE END CLOSE REPEAT DROP ;

 % 1/0  PRINT PRINTS THE FILE WHOSE NAME IS ADDRESSED AT TOP. THIS IS THE
 % ORIGINAL VERSION OF THE COMMAND
'PRINT : AFILE OPEN BEGIN GETBYTE DUP EOF NE IF TYO REPEAT DROP CLOSE ;

 % 2/0  'ORIGINAL 'COPY COPY  COPIES THE FILE WHOSE NAME IS AT TOP - 1 
 % TO A FILE WHOSE NAME IS AT TOP, AND DELETES ANY PREVIOUS VERSION OF 
 % THE FILE AT TOP
 % THIS COMMAND IS WRITTEN FOR A SINGLE DRIVE SYSTEM SO IT COULD PROBABLY
 % BE SIMPLIFIED FOR ALL YOU MORE FORTUNATE HACKERS WITH TWIN DRIVES
'COPY : SETUP OFILE WOPEN IFILE OPEN BEGIN IFILE BLOCKBASE
GETBLOCK DROP BLOCKBASE 1024 + GETBLOCK DROP OFILE BLOCKBASE
PUTBLOCK DROP BLOCKBASE 1024 + PUTBLOCK END IFILE CLOSE
OFILE CLOSE ;

 % 2/0  'OLDNAME 'NEWNAME RENAME  RENAMES THE FILE WHOSE
 % NAME IS AT TOP - 1 TO THE NAME AT TOP
'RENAME : AFILE DDUP NOT-EXIST EXIST
FCB 17 8224 FILL PUTINNAME FNAD DUP 16 + 11 MVBYTES
FCB 6 8224 FILL PUTINNAME 0 FCB B! 0 FCB 16 + B! RENAMEFILE ;

" ************************************************ " MSG CR
" ***  CP/M FILING SYSTEM HAS BEEN LOADED NOW  *** " MSG CR 
" ************************************************ " MSG CR
RADIX !

;F

:  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее

% ***************************************************************************
% ** COPYRIGHT (C) MASSACHUSETTS INSTITUTE OF TECHNOLOGY AND HARVARD       **
% ** UNIVERSITY, BIOMEDICAL ENGINEERING CENTER 1977.  ALL RIGHTS RESERVED. **
% ***************************************************************************

% 8080 DISPLAY EDITOR
% J. SACHS 2/9/77
% MODIFIED TO RUN WITH STOICCPM.STC 
% BY A.R.M.CLARKE
% THE DOCUMENTATION IS AS THE ORIGINAL,EXCEPT FOR EXTRA 
% COMMANDS 'GRLIB, GWLIB, ISP, ICR, AND DCR.' ALL THESE
% ARE EXPLAINED IN THE PROGRAMME
% THE <A> COMMAND IS ERASED,THE PAGE HAS BEEN GIVEN AN
% ARBITRARY VALUE, AND I HAVE PUT IN CONTROL CHARACTERS
% AND UNIQUE CHARACTERS FOR THE CURSORS: SIMPLY RESTORE
% THE ORIGINAL 'DISPLAY-CURSORS' COMMAND.

RADIX @ OCTAL

% DEFINE EDITOR BRANCH
'EDITOR< BRANCH
EDITOR< DEFINITIONS

% EDITOR VARIABLES
0 'LAST VARIABLE		% PTR TO END OF TEXT BUFFER
				% (ALSO START OF X BUFFER)
0 'XLAST VARIABLE		% PTR TO END OF X BUFFER
0 'CP VARIABLE			% CURSOR
0 'P1 VARIABLE			% PTR TO START OF CURRENT STRING
0 'P2 VARIABLE			% PTR TO END OF CURRENT STRING
0 'P3 VARIABLE			% TEMPORARY
0 'C1 VARIABLE			% TEMPORARY
0 'IFLAG VARIABLE		% INPUT FILE ACTIVE FLAG
0 'OFLAG VARIABLE		% OUTPUT FILE ACTIVE FLAG
7 'INAME ARRAY			% INPUT FILE NAME
7 'ONAME ARRAY			% OUTPUT FILE NAME
33 'ESC VARIABLE		% ESCAPE CHAR FOR I/ COMMAND

400 'MARGIN CONSTANT		% DICTIONARY MARGIN FOR EDITOR MACROS, ETC.
'LIMIT : . MARGIN + ;		% LOWER MEMORY LIMIT

% MOVE CP N LINES
'L CODE<  B POP,  B A MOV,  A ORA,  IFM,  C ORA,  IFZ,
  .  .  CP LHLD,  XCHG,  LAST LHLD,
  -HL CALL,  D DAD,  H A MOV,  L ORA,  NEXT JZ,  XCHG,
  M A MOV,  H INX,  CP SHLD,  12 CPI,  JNZ,  B DCX,
  B A MOV,  C ORA,  JNZ,  NEXT JMP,
  THEN,  THEN,  B DCX,
  .  .  CP LHLD,  XCHG,  MEMORY LHLD,
  -HL CALL,  D DAD,  H A MOV,  L ORA,  NEXT JZ,  XCHG,
  H DCX,  M A MOV,  CP SHLD,  12 CPI,  JNZ,  B INX,
  B A MOV,  C ORA,  JNZ,  CP LHLD,  H INX,  CP SHLD,
  NEXT JMP,  >

% COMPARE TWO ARG STRINGS; BYTE COUNT AT TOP
'CMPBYTES CODE<  B POP,  D POP,  H POP,  B A MOV,  A ORA,
  0PUSH JM,  C ORA,  0PUSH JZ,  .  D LDAX,  M CMP,
  0PUSH JNZ,  D INX,  H INX,  B DCX,  B A MOV,  C ORA,
  JNZ,  -1PUSH JMP,  >

% APPEND AN INPUT LINE TO TEXT BUFFER
. <L "CORE FULL" S,

'GETLINE CODE<
  FCBAD LHLD, 41 D LXI, D DAD, M A MOV, 
  H POP,   A ANA, -1PUSH JNZ,
    T1 SHLD,
  .  <L
  .  <L
  CP LHLD,  XCHG,  P2 LHLD,  -HL CALL,  D DAD,  IFC,
  (GETBYTE) CALL,
  EOF CPI,  -1PUSH JZ,
  CP LHLD,  A M MOV,  H INX,  CP SHLD,
  15   CPI, IFZ,
  L> JMP,
  THEN,  T1 LHLD,  H DCX,  T1 SHLD,
  H A MOV,  L ORA,  L> JNZ,  0PUSH JMP,
  THEN,  L> H LXI,  ERROR JMP,  >

% DISPLAY CURSORS
'DISPLAY-CURSORS CODE<  D POP,  -DE CALL,
  P1 LHLD,  D DAD,  H A MOV,  L ORA,  IFNZ,
  25 A MVI,  D PUSH,  (TTO) CALL,  D POP,  THEN,
  CP LHLD,  D DAD,  H A MOV,  L ORA,  IFNZ,
D PUSH, 03 A MVI, (TTO) CALL, 120 A MVI, (TTO) CALL, D POP, THEN,
  P2 LHLD,  D DAD,  H A MOV,  L ORA,  IFNZ,
  21 A MVI,  (TTO) CALL,  THEN,  NEXT JMP, >

% DISPLAY A CHARACTER
'DISPLAY-CHAR CODE<  H POP,  L A MOV,  12 CPI,  IFZ,  
 40 CPI, IFP, 15 CPI,
  IFZ,  11 CPI,  IFZ,  PSW PUSH,  136 A MVI,  (TTO) CALL,
  PSW POP,  100 ADI,  THEN,  THEN,  THEN,  (TTO) CALL, THEN,  NEXT JMP, >

% EXCHANGE P1 AND P2 UNLESS P1<P2
'P1<P2 : P1 @ P2 @ UGT IF P1 P2 XCHG THEN ;

% SET P1 TO CP
'S1 : CP P1 MOVE ;

% SET P2 TO CP
'S2 : CP P2 MOVE ;

% SET CP TO BEGINNING OF TEXT BUFFER
'B : MEMORY CP MOVE ;

% SET CP TO END OF TEXT BUFFER
'Z : LAST  CP MOVE ;

% MOVE CP N CHARACTERS
'M : CP @ + LAST @ MIN MEMORY @ MAX CP ! ;

% SET P1, MOVE N CHARACTERS, SET P2
'<M> : S1 M S2 P1<P2 ;

% SET P1, MOVE N LINES, SET P2
'<L> : S1 L S2 P1<P2 ;

% SET P1 TO FIRST, SET P2 TO LAST
'<ALL> : B S1 Z S2 ;

% PUSH THE LINE NUMBER OF THE LINE CONTAINING THE CURSOR
'LINE# : 0 CP @ MEMORY @ DO I B@ 15 EQ + LOOP MINUS ;

% STRING SEARCH
'<S> : C1 ! P3 ! IF
   0 LAST @ C1 @ - CP @ UDO I P3 @ C1 @ CMPBYTES IF -1
   UNDER I P1 ! I C1 @ + DUP P2 ! CP ! EXIT THEN ULOOP
  ELSE
   0 CP @ MEMORY @ UDO I' P3 @ C1 @ CMPBYTES IF -1
   UNDER I' DUP P1 ! CP ! I' C1 @ + P2 ! EXIT THEN ULOOP
  THEN ;

'<SS> : SWAP COUNT <S> NOT IF 'MISSING ERR THEN ;
'S : -1 <SS> ;
'BS : 0 <SS> ;

% DELETE BETWEEN P1 AND P2
'<D> : P1 @ 1- P2 @ 1- P1 @ MEMORY @ - RMVBYTES
   MEMORY @ P1 @ - P2 @ + MEMORY ! P2 P1 MOVE P2 CP MOVE ;

% DELETE N CHARACTERS
'D : <M> <D> ;

% DELETE N LINES
'DL : <L> <D> ;

% DELETE TEXT BUFFER
'DA : <ALL> <D> ;

% INSERT STRING
'<I> : C1 ! P3 ! MEMORY @ C1 @ - LIMIT ULE IF "CORE FULL"
  ERR THEN MEMORY @ DUP C1 @ - CP @ MEMORY @ - MVBYTES
  MEMORY @ C1 @ - MEMORY ! P3 @ CP @ C1 @ - C1 @ MVBYTES
  S2 CP @ C1 @ - P1 ! ;

% INSERT STRING FOLLOWED BY CR
'<IL> : 2 + <I> 12 15 P2 @ DUP 2SWAP 2 - B! 1- B! ;

% INSERT STRING FOLLOWED BY FF
'<IP> : 1+ <I> 14 P2 @ 1- B! ;

'IS : COUNT <I> ;
'IL : COUNT <IL> ;
'IP : COUNT <IP> ;

% INSERT CR
'ICR : '&15&&12& IS ;

% INSERT A SPACE
'ISP : '&40& IS ;

% INSERT FF
'IFF : '&14& IS ;

% INSERT NUMBER AS TEXT
'I# : <#> <I> ;

% REPLACE CURRENT STRING
'U : <D> IS ;

% STRING SUBSTITUTE
'C : SWAP S U ;
'BC : SWAP BS U P1 CP MOVE ;

% SEARCH AND DESTROY
'SD : S <D> ;
'BSD : BS <D> ;

% DELETE THE NEXT RETURN 
'DCR : '&15&&12& SD ;

% ADD AN OFFSET TO ALL TEXT BUFFER POINTERS
'ADJUST : DUP MEMORY +! DUP LAST +! DUP CP +! DUP P1 +! P2 +! ;

% DELETE X BUFFER
'XD : XLAST @ LAST @ -
  LAST @ 1- XLAST @ 1- LAST @ MEMORY @ - RMVBYTES
  ADJUST ;

% COPY TEXT BETWEEN P1 AND P2 INTO X BUFFER
'<XC> : XD
  MEMORY @ P2 @ P1 @ - - LIMIT ULE IF "CORE FULL" ERR THEN
  MEMORY @ DUP P2 @ P1 @ - - LAST @ MEMORY @ - MVBYTES
  P1 @ P2 @ - ADJUST P1 @ LAST @ P2 @ P1 @ - MVBYTES ;

% COPY N CHARACTERS INTO "X" BUFFER
'XC : <M> <XC> ;

% COPY N LINES INTO "X" BUFFER
'XCL : <L> <XC> ;

% MOVE N CHARACTERS INTO "X" BUFFER
'XM : XC <D> ;

% MOVE N LINES INTO "X" BUFFER
'XML : XCL <D> ;

% INSERT CONTENTS OF "X" BUFFER AT CP
'XG : LAST @ XLAST @ OVER - <I> ;

% OUTPUT TEXT TO OUTPUT FILE
'<P> : OFLAG @ IF OFILE P1 @ P2 @ OVER - PUTBYTES ELSE
  "NO OUTPUT FILE" ERR THEN ;
'PEOF :  OFILE EOF PUTBYTE ;
'P : <M> <P> ;
'PL : <L> <P> ;
'PA : <ALL> <P> ;

% MOVE TEXT BUFFER DOWN
'DOWN : MEMORY @ LIMIT CP @ MEMORY @ - MVBYTES
  S2 CP @ MEMORY @ LIMIT - - CP ! S1 LIMIT MEMORY ! ;

% MOVE TEXT BUFFER UP
'UP : CP @ 1- P2 @ 1- CP @ LIMIT - RMVBYTES
  MEMORY @ P2 @ CP @ - + MEMORY !
  P2 @ CP @ P1 @ - - P1 ! P1 CP MOVE ;

% APPEND TEXT FROM INPUT FILE
'<AL> : IFLAG @ IF Z DOWN IFILE GETLINE UP ELSE 
"NO INPUT FILE" ERR THEN DUP IF -1 EF B! THEN ;
'<AP> : ( 64 <AL> ) ;

'AL : <AL> IF "EOF" ERR THEN ;
'AP : <AP> IF "EOF" ERR THEN ;

% DELETE TEXT-BUFFER AND APPEND FROM INPUT FILE
'<YL> : DA <AL> ;
'<YP> : DA <AP> ;
'YL : DA AL ;
'YP : DA AP ;

% WRITE A PAGE AND READ NEXT PAGE
'<R> : ( PA 1 <YP> ) ;
'R : ( PA 1 YP ) ;

% GLOBAL SEARCH AND REPLACE COMMANDS
'<N> : BEGIN -1 OVER COUNT <S> IF DROP -1 -1 ELSE
  1 <R> IF DROP 0 -1 ELSE 0 THEN THEN END ;
'N : <N> NOT IF 'MISSING ERR THEN ;
'V : SWAP N U ;

% CLOSE INPUT AND OUTPUT FILES
'IOCLOSE : IFLAG @ IF IFLAG 0<- IFILE CLOSE THEN 
           OFLAG @ IF OFLAG 0<- OFILE CLOSE THEN ;

% GET INPUT FILE
'GR : DUP INAME OVER B@ 1+ MVBYTES IFILE OPEN IFLAG -1<- ;

% GET OUTPUT FILE
'GW : DUP ONAME OVER B@ 1+ MVBYTES OFILE WOPEN OFLAG -1<- ;

% GET INPUT LIBRARY FILE AND INSERT AT CURRENT CURSOR POSITION
'GRLIB : AFILE OPEN DOWN BEGIN 1 GETLINE END UP CLOSE ;

% PUTS THE TEXT BETWEEN P1 AND P2 INTO THE NAMED NEW LIBRARY FILE
'GWLIB : AFILE WOPEN P1 @ P2 @ OVER - 
  PUTBYTES EOF PUTBYTE CLOSE ;

% FLUSH TEXT BUFFER AND INPUT AND OUTPUT FILES
'GX : DA OFLAG @ IF IOCLOSE ONAME DELETE ELSE IOCLOSE THEN ;

% OPEN INPUT FILE, CREATE SCRATCH FILE, READ 1ST PAGE OF INPUT FILE
'O : GR '++ED++ GW 1 YP B ;

% WRITE OUT AND CLOSE FILES
'W : IFLAG @ IF BEGIN 1 <R> END PA PEOF IOCLOSE
  INAME DELETE ONAME INAME RENAME DA ELSE
  PA PEOF DA IOCLOSE THEN ;

% WRITE AND RENAME
'WR : IFLAG @ IF BEGIN 1 <R> END THEN PA PEOF
   DA IOCLOSE ONAME SWAP RENAME ;

% WRITE AND RE-OPEN COMMANDS
'WO : W INAME O ;
'WRO : DUP WR O ;

% TEXT TYPE-OUT COMMANDS
'<T> : P1 @ P2 @ OVER - TYPE ;
'T : <M> <T> ;
'TL : <L> <T> ;
'TA : <ALL> <T> ;

% ERASE SCREEN
'ERASE : 32 TYO ;

% DISPLAY DIRECTORY, WAIT FOR CR
'FL : ERASE LIST-DIRECTORY BEGIN TYI 15 EQ END ;

% DISPLAY TEXT BUFFER
'DISPLAY : ERASE SPACE SPACE
  IFLAG @ IF INAME COUNT 14 MIN TYPE ELSE 52 TYO THEN
  54 TYO
  OFLAG @ IF ONAME
COUNT 14 MIN TYPE ELSE 52 TYO THEN
  CR CR
  CP @ <L -10 L 20 L CP @ DUP -22 L CP @
  L> CP ! UDO I DISPLAY-CURSORS I B@ DISPLAY-CHAR ULOOP
  DISPLAY-CURSORS ;

% EDITOR PROMPT MESSAGE
'EDIT-PROMPT :
  CHECK B@ 60 EQ IF DISPLAY 21 TYO CR CR THEN
  PROMPT0 ;

% EDITOR ERROR HANDLER
'ERRS : ERASE () <TTO> OUT ! () <TTI> IN ! MSG CR . MSG
  BEGIN TYI 15 EQ END
  ABORT ;

% EXIT EDITOR, FLUSH TEXT AND X BUFFERS
'H : GX ERASE () PROMPT0 PROMPT ! () ERRMSG0 ERRMSG ! >
  XLAST MEMORY MOVE ;

% INSERT MODE
'I/DISPLAY : CP @ LAST @ OVER LAST ! DISPLAY LAST ! CP ! ;

'I/ : DOWN I/DISPLAY BEGIN
   CP @ P2 @ EQ IF "CORE FULL" ERR THEN
   TYI DUP ESC @ EQ IF DROP -1 ELSE
       DUP 177 EQ IF
        DROP CP @ P1 @ NE IF CP 1-! I/DISPLAY THEN
        0 ELSE
       DUP EQZ IF DROP P1 CP MOVE I/DISPLAY 0 ELSE
       DUP DUP TYO BEGIN CP @ B! CP 1+!  
       15 EQ IF 12 DUP REPEAT 0 THEN THEN THEN
  END UP P2 CP MOVE
;

% CONDITIONAL CHANGE COMMANDS
'CU :
  DISPLAY "&15&TYPE A KEY" MSG TYI
  DUP 15 EQ IF
   DROP 0 ELSE
   12 EQ IF
    DUP U 0 ELSE
    2DROP -1 THEN
   THEN
;

'CC : BEGIN OVER S CU END ;
'BCC : BEGIN OVER BS CU P1 CP MOVE END ;
'CV : BEGIN OVER N CU END ;

> DEFINITIONS

EDITOR<
'EDIT : () EDIT-PROMPT PROMPT ! () ERRS ERRMSG ! EDITOR<
  MEMORY @ DUP LAST ! DUP XLAST ! DUP CP ! DUP P1 ! P2 ! ;
>

RADIX !
;F



***EOF***
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
% ***************************************************************************
% ** COPYRIGHT (C) MASSACHUSETTS INSTITUTE OF TECHNOLOGY AND HARVARD       **
% ** UNIVERSITY, BIOMEDICAL ENGINEERING CENTER 1977.  ALL RIGHTS RESERVED. **
% ***************************************************************************

% 8080 FILE SYSTEM
% DISK VERSION FOR CP/M BIOS USING AN ADAPTED VERSION OF THE TAPE SYSTEM
% J. SACHS 3/7/77
% ADDITIONS BY A.R.M.CLARKE, CHILTON COTTAGE, CHILTON CORNER, SUDBURY, SUFFOLK
% 11/8/80
% THIS IS AN ALTERED VERSION OF THE FILE HANDLING SYSTEM FOR THOSE WHO WISH
% TO USE THE ORIGINAL STOIC SYSTEM. IT WAS DEVELOPED ON A SINGLE DRIVE SYSTEM.
% TO USE IT ONE LOADS THE KERNEL IN THE NORMAL WAY AND THEN LOADS THIS AND
% ANY OTHER MODULES THAT ONE NEEDS (PARTICULARLY THE EDITOR.) WHEN ALL IS
% SAFELY GATHERED IN, THEN TYPE THE WORD "START"(WITHOUT THE PARENTHESES)
% AND THE FILE SYSTEM SHOULD BE ACTIVATED. IF YOU EVER WANT TO DO ANOTHER 
% CPMLD THEN TYPE "FINISH" (AGAIN WITHOUT PARENTHESIS). INSERT YOUR STOIC 
% DISK WHICH WOULD NOT NEED CP/M ON IT (A PLAIN FRESH DISK TO START WITH!)
% AND OFF YOU GO. I HAVE TESTED AND HOPEFULLY DEBUGGED THIS SYSTEM BUT
% PLEASE BEAR IN MIND THAT THIS IS, IN FACT A MODIFICATION OF THE TAPE
% RATHER THAN THE DISK STOIC FILE SYSTEM: THIS MIGHT EXPLAIN ONE OR TWO
% MINOR BUGS THAT I HAVEN'T ELIMINATED (OCCASIONAL LOSS OF 1ST DIRECTORY
% ENTRY SOLVED BY PUTTING IN A DUMMY NULL FILE THERE; TROUBLE WITH SAVING
% AND RESTORING THE CORE IMAGE). ALL IN ALL A GOOD SYSTEM WITH THE ADVANTAGE
% OF SPEED BUT THE DISADVANTAGE OF HAVING ONLY ONE FILE OF UNDECLARED SIZE
% OPEN FOR WRITING AT ANY ONE TIME.
% 		AS YOU WILL SEE, THIS VERSION OF THE FILE SYSTEM USES ONLY
% BIOS CALLS, LIKE THE STOIC IN THE U.S.CP/MU.G. LIBRARY. YOU CAN THEREFORE
% OVERWRITE THE FDOS UP TO THE BIOS JUMP TABLE IF YOU WISH (RESET THE STOIC
% MEMORY VARIABLE).
%		THE PATCHES POKE THE NEW DISKIN AND DISKOU SUBROUTINE
% ADDRESSES INTO THE KERNEL. IF YOU ALTER YOUR KERNEL CHECK THAT THESE 
% LOCATIONS ARE STILL CORRECT. I AM BUSILY REWRITING THE KERNEL TO CPMIFY
% IT PROPERLY, SO I HAVEN'T GIVEN THIS PROGRAM THE ATTENTION IT DESERVES.
% I HAVE MADE THE CODE IN MY PATCH CLEAR RATHER THAN COMPACT. IF YOU FIND
% A BUG OR AN IMPROVEMENT LET ME KNOW! THE PATCH IS SET UP FOR SINGLE
% SIDED SINGLE DENSITY 8IN DRIVE. IF YOU DON'T HAVE THIS THEN GOD BLESS
% YOU, YOU MUST ALTER IT TO SUIT. IT ALSO ASSUMES CP/M 1.4, SO WATCH IT!
RADIX @ DECIMAL

% ADDRESS BLOCK-NUMBER NUMBER-OF-BLOCKS RDBLKS
% READS BLOCKS DIRECTLY FROM MASS STORAGE DEVICE INTO MEMORY
'RDBLKS CODE<  B POP,  H POP,  UNIT LDA,  A ORA,  RAL,  H ORA,  A H MOV,
  D POP,  (READ) CALL,  NEXT JMP,  >

% ADDRESS BLOCK-NUMBER NUMBER-OF-BLOCKS WRBLKS
% WRITES BLOCKS DIRECTLY FROM MEMORY TO THE MASS STORAGE DEVICE
'WRBLKS CODE<  B POP,  H POP,  UNIT LDA,  A ORA,  RAL,  H ORA,  A H MOV,
  D POP,  (WRITE) CALL,  NEXT JMP,  >

% BLOCK-NUMBER BLIST DISPLAYS THE REQUESTED BLOCK (IN FORTH FORMAT )
'BLIST : DUP "BLOCK NO." MSG = CR RBLOCK 0 SWAP DUP 1024 +
SWAP DO DUP <#> 3 OVER - SPACES TYPE 1+ SPACE I 64 TYPE
CR 64 +LOOP DROP ;

% CONSTANTS AND VARIABLES
4 'EOF CONSTANT		% END OF FILE CODE
26 'NSECTORS CONSTANT   % NUMBER OF SECTORS TO A TRACK
77 'NTRACKS CONSTANT    % NUMBER OF TRACKS TO A DISK
128 'NBYTES CONSTANT    % NUMBER OF BYTES TO A SECTOR
8 'NSECS/BLOCK CONSTANT % NUMBER OF SECTORS TO A BLOCK
NTRACKS NSECTORS * NSECS/BLOCK / 'NBLKS CONSTANT 
			% # OF BLOCKS ON MASS STORAGE DEVICE
NSECS/BLOCK NBYTES * 'BSIZE CONSTANT	
			% # OF BYTES PER BLOCK
0 'FCT VARIABLE		% FILE CONTROL TABLE POINTER
0 'ENTP0 VARIABLE	% 2 TEMPORARY VARIABLES
0 'ENTP1 VARIABLE
4 'BDMA ARRAY           % BIOS PARAMETER VARIABLES
BDMA 2 + 'BDRIVE CONSTANT
BDRIVE 1+ 'BSECTOR CONSTANT
BDRIVE 2 + 'BTRACK CONSTANT
BDRIVE 3 + 'BNSECS CONSTANT
HEX
011F 'DSKOUAD CONSTANT  % DEPENDANT ON VERSION OF CORE IMAGE
0122 'DSKINAD   CONSTANT  % DITTO
 
DECIMAL
% IN THE FOLLOWING CODE I HAVE ADDED NO SKEW FACTOR AT ALL SO AS TO KEEP 
% THINGS SIMPLE. IT SEEMS FAST ENOUGH WITHOUT IT BUT FEEL FREE TO ADD IT
% TO TASTE!

ASSEMBLER<
. 1 LHLD, D DAD, PCHL,
'BIOS CONSTANT

. "OFF THE DISK!" S, <L
. BDMA LHLD, NBYTES D LXI, D DAD, BDMA SHLD, BNSECS LHLD,
H DCX, H A MOV, L ORA, RZ, BNSECS SHLD, BSECTOR H LXI,
M INR, NSECTORS 1+ A MVI, M CMP, RNZ, 1 M MVI, H INX,
M INR, NTRACKS A MVI, M CMP, RNZ, L> H LXI, ERROR JMP,
'INCSNDECS CONSTANT

. B PUSH, XCHG, BDMA SHLD, NSECS/BLOCK H LXI, MUL CALL,
NSECTORS B LXI, DIV CALL, H INX, L D MOV, UNIT LDA, BDRIVE H LXI,
A M MOV, H INX, D M MOV, H INX, E M MOV, H POP, H DAD,
H DAD, H DAD, BNSECS SHLD, RET,
'SETUP CONSTANT

. BDMA H LXI, M C MOV, H INX, M B MOV, H PUSH, 33 D LXI, BIOS CALL,
H POP, H INX, M C MOV, 24 D LXI, H PUSH, BIOS CALL,
H POP, H INX, M C MOV, 30 D LXI, H PUSH, BIOS CALL,
H POP, H INX, M C MOV, 27 D LXI, BIOS CALL, RET,
'TELLBIOS CONSTANT


. SETUP CALL, . TELLBIOS CALL, 36 D LXI, BIOS CALL,
RNZ, INCSNDECS CALL, JNZ, RET,
'DSKIN CONSTANT

. SETUP CALL, .  TELLBIOS CALL, 39 D LXI, BIOS CALL,
RNZ, INCSNDECS CALL, JNZ, RET,
'DSKOU CONSTANT

>

HEX
'START : C3 DSKOUAD B! C3 DSKINAD B! DSKIN DSKINAD 1+ !
DSKOU DSKOUAD 1+ ! ;
 
'FINISH : 3E DSKOUAD B! 06 DSKINAD B! C901 DSKOUAD 1+ !
C508 DSKINAD 1+ ! ;


OCTAL

% DEFINE FILE CONTROL TABLE VARIABLES
'FCTBLK0 CODE<  FCT LHLD,  PUSH JMP,  >
'FCTUNIT CODE<  2 D LXI,  .  .  FCT LHLD,  D DAD,  PUSH JMP,  >
'FCTBLK CODE<  4 D LXI,  JMP,  >
'FCTBYTE CODE<  6 D LXI,  JMP,  >

% GET ADDRESS OF DIRECTORY BUFFER
'DIRECTORY : 0 RBLOCK ;

% GET NEXT DIRECTORY ENTRY
'NXENT0 : DIRECTORY 10 - ENTP0 ! ;
'NXENT : 10 ENTP0 +! ENTP0 @@ ;

% GET STARTING BLOCK # GIVEN PTR TO DIRECTORY ENTRY
'SBLK : 6 + @ 777 AND ;

% FILENAME MATCH
'MATCH CODE<  B POP,  H POP,  6 E MVI,  .  B LDAX,  M CMP,  0PUSH JNZ,
  A ORA,  -1PUSH JZ,  B INX,  H INX,  E DCR,  JNZ,  -1PUSH JMP,  >

% SEARCH FOR MATCH IN DIRECTORY
'SEARCH : NXENT0 BEGIN NXENT IF ENTP0 @ OVER 1+ MATCH IF
  DROP ENTP0 @ -1 -1 ELSE 0 THEN ELSE DROP 0 -1 THEN END ;

% TEST IF FILE EXISTS
'EXIST : SEARCH NOT IF "FILE DOES NOT EXIST" ERR THEN ;

% TEST IF FILE DOES NOT EXIST
'NOT-EXIST : SEARCH IF "FILE ALREADY EXISTS" ERR THEN ;

% GET PTR TO LAST DIRECTORY ENTRY
'SLOT : DIRECTORY BEGIN DUP @ IF 10 + REPEAT ;

% TEST IF FILE IS OPEN
'OPEN? : FCTBLK0 EQZ FCTBLK0 @ EQZ OR IF "FILE NOT OPEN" ERR THEN ;

% GET FILE POSITION
'GPOS : OPEN? FCTBLK @ BSIZE UM* FCTBYTE @ M+ ;

% SET FILE POSITION
'SPOS : OPEN? BSIZE UM/MOD FCTBYTE ! FCTBLK ! ;

% INITIALIZE DIRECTORY
'ZERO-DIRECTORY : DIRECTORY BSIZE 2/ 0FILL 1 DIRECTORY 6 + ! UPDATE ;

% SQUASH DELETE ENTRIES FROM END OF DIRECTORY
'FSQUASH : SLOT BEGIN DUP DIRECTORY NE SWAP 10 - DUP @ -1 EQ 2SWAP
  AND IF DUP 3 0FILL UPDATE REPEAT DROP ;

% DELETE FILE
'DELETE : EXIST -1<- UPDATE FSQUASH ;

% RENAME FILE
'RENAME : DUP NOT-EXIST 1+ SWAP EXIST 6 MVBYTES UPDATE ;

% CREATE CONTIGUOUS FILE
'CCONT : OVER NOT-EXIST SLOT DUP DIRECTORY BSIZE 10 - + LT IF
  SWAP OVER SBLK + DUP NBLKS GE IF "DISK FULL" ERR THEN OVER
  16 + ! DUP 10 + 3 0FILL SWAP 1+ SWAP 6 MVBYTES ELSE
  "DIRECTORY FULL" ERR THEN UPDATE ;

% DEFINE FILE CONTROL TABLE
'FILE : 4 SWAP ARRAY ;CODE<  XCHG,  FCT SHLD,  NEXT JMP,  >

% COMPUTE # OF BLOCKS LEFT ON STORAGE DEVICE
'LEFT : NBLKS SLOT SBLK - ;

% LIST FILENAME
'LIST-NAME : DUP 6 + SWAP DO I B@ DUP IF TYO ELSE DROP EXIT
  THEN LOOP ;

% LIST DIRECTORY
'LIST-DIRECTORY : IFCR NXENT0 BEGIN NXENT ENTP0 @ SBLK U<#>
  4 OVER - SPACES TYPE SPACE IF ENTP0 @@ -1 EQ IF "(--)" 1+
  ELSE ENTP0 @ THEN LIST-NAME 0 ELSE -1 THEN COLUMN B@ 16 GT
  IF CR ELSE 16 TAB THEN END ;

% OPEN FILE
'OPEN : EXIST SBLK FCTBLK0 ! UNIT B@ FCTUNIT ! FCTBLK 0<- FCTBYTE 0<- ;

% CLOSE FILE
'CLOSE : FCTBLK0 0<- ;

% OPEN FOR WRITING
'WOPEN : DUP SEARCH IF DROP DUP DELETE THEN DUP LEFT 1- DUP LEZ IF
  "DISK FULL" ERR THEN CCONT OPEN ;

% GIVE BACK UNUSED BLOCKS
'SHRINK : OPEN? FCTBLK0 @ FCTBLK @ + FCTBYTE @ NEZ - SLOT 6 + ! UPDATE ;

% EXECUTE A FILE
'LOAD : EXIST SBLK LOAD ;


ASSEMBLER< DEFINITIONS

% GET NEXT BYTE FROM FILE
  . <L . <L "FILE NOT OPEN" S,

  .  FCT LHLD,  H A MOV,  L ORA,  IFZ,  M E MOV,  H INX,  M D MOV,
  D A MOV,  E ORA,  IFZ,  H INX,  M A MOV,  H INX,  A ORA,  RAL,  D ORA,
  A D MOV,  H INX,  M C MOV,  H INX,  M B MOV,  H INX,
  XCHG,  B DAD,  XCHG,  H PUSH,  (RBLOCK) CALL,  H POP,  M C MOV,  H INX,
  M B MOV,  XCHG,  B DAD,  H PUSH,  XCHG,  B INX,  C A MOV,
  BSIZE 400 MOD CPI,  IFNZ,  B A MOV,  BSIZE 400 / CPI,  IFNZ,  H DCX,
  H DCX,  H DCX,  M INR,  IFNC,  H INX,  M INR,  H DCX,  THEN,  H INX,
  H INX,  H INX,  0 B LXI,  THEN,  THEN,  B M MOV,  H DCX,  C M MOV,  H POP,
  M A MOV,  RET,  THEN,  THEN,  L> H LXI,  ERROR JMP,
'(GETBYTE) CONSTANT

% PUT NEXT BYTE IN FILE
  .  PSW PUSH,  FCT LHLD,  H A MOV,  L ORA,  IFZ,  M E MOV,  H INX,  M D MOV,
  D A MOV,  E ORA,  IFZ,  H INX,  M A MOV,  H INX,  A ORA,  RAL,  D ORA,
  A D MOV,  H INX,  M C MOV,  H INX,  M B MOV,  H INX,
  XCHG,  B DAD,  XCHG,  H PUSH,  (RBLOCK) CALL,  H POP,  M C MOV,  H INX,
  M B MOV,  XCHG,  B DAD,  H PUSH,  XCHG,  B INX,  C A MOV,
  BSIZE 400 MOD CPI,  IFNZ,  B A MOV,  BSIZE 400 / CPI,  IFNZ,  H DCX,
  H DCX,  H DCX,  M INR,  IFNC,  H INX,  M INR,  H DCX,  THEN,  H INX,
  H INX,  H INX,  0 B LXI,  THEN,  THEN,  B M MOV,  H DCX,  C M MOV,  H POP,
  PSW POP,  A M MOV,  NEWEST LHLD,  6 D LXI,  D DAD,  -1 M MVI,  H INX,
  -1 M MVI,  RET,  THEN,  THEN,  L> H LXI,  ERROR JMP,
'(PUTBYTE) CONSTANT

> DEFINITIONS

'GETBYTE CODE<  (GETBYTE) CALL,  A L MOV,  0 H MVI,  PUSH JMP,  >
'PUTBYTE CODE<  H POP,  L A MOV,  (PUTBYTE) CALL,  NEXT JMP,  >

% GET NEXT N BYTES
'GETBYTES CODE<  H POP,  D POP,  H A MOV,  A ORA,  NEXT JM,  L ORA,
  NEXT JZ,  .  D PUSH,  H PUSH,  (GETBYTE) CALL,  H POP,  D POP,
  D STAX,  D INX,  H DCX,  H A MOV,  L ORA,  JNZ,  NEXT JMP,  >

% PUT NEXT N BYTES
'PUTBYTES CODE<  H POP,  D POP,  H A MOV,  A ORA,  NEXT JM,  L ORA,
  NEXT JZ,  .  D PUSH,  H PUSH,  D LDAX,  (PUTBYTE) CALL,  H POP,  D POP,
  D INX,  H DCX,  H A MOV,  L ORA,  JNZ,  NEXT JMP,  >

% PUSH THE # OF BLOCK OF FREE MEMORY (ERROR IF 0)
'MAXBL : MEMORY @ . - BSIZE / DUP EQZ IF "INSUFFICIENT MEMORY" ERR THEN ;

% BLK1 BLK2 NBLKS MVBLOCKS
% MOVES NBLKS BLOCKS FROM BLK1 TO BLK2
'MVBLOCKS : DUP 0 DO
  . 3OVER I + 2OVER MAXBL MIN RDBLKS . 2OVER I + 2OVER MAXBL MIN WRBLKS
  MAXBL - MAXBL +LOOP 3DROP ;

% SQUASH THE DIRECTORY
'SQ : ENTP0 @ SBLK ENTP1 @ SBLK ENTP0 @ 10 + SBLK ENTP0 @ SBLK - MVBLOCKS
  ENTP1 @ SBLK ENTP0 @ SBLK - DUP ENTP0 @ 10 + SBLK + SWAP ENTP0 @ 6 + +!
  ENTP0 @ ENTP1 @ 10 MVBYTES ENTP1 @ 10 + 3 0FILL ENTP1 @ 16 + ! 10 ENTP1 +! ;

'SQUASH : FLUSH FSQUASH NXENT0 BEGIN NXENT 1+ U2/ EQZ END ENTP0 ENTP1
  MOVE ENTP0 @@ IF BEGIN BEGIN NXENT 1+ END ENTP0 @@ IF SQ UPDATE 0 ELSE
  -1 THEN END THEN FLUSH ;

% READ AND WRITE CORE IMAGE
'(RDCI) CODE<  D POP,  4 H LXI,  SP DAD,  T1 SHLD,  B POP,  H POP,
  T1 2+ SHLD,  MEMORY LHLD,  SPHL,  T1 2+ LHLD,  UNIT LDA,  A ORA,  RAL,
  H ORA,  A H MOV,  (READ) CALL,
.  HEX
  T1 LHLD,  SPHL,
0006 LHLD, MEMORY SHLD, NEXT JMP, >
'(RESTART) CONSTANT

'(WRCI) CODE<  D POP,  4 H LXI,  SP DAD,  T1 SHLD,  B POP,  H POP,
  T1 2+ SHLD,  MEMORY LHLD,  SPHL,  T1 2+ LHLD,  UNIT LDA,  A ORA,  RAL,
  H ORA,  A H MOV,  (WRITE) CALL,
  T1 LHLD,  SPHL,  NEXT JMP,  >

OCTAL

'RDCI : EXIST DUP SBLK SWAP 10 + SBLK OVER - STATE (RDCI) ;
'WRCI : SLOT SBLK SWAP . STATE - BSIZE U/MOD NEZ - SWAP
  OVER CCONT FLUSH STATE (WRCI) ;

HEX

% WRITE BOOTSTRAP FILE
'WRITE-BOOT : SLOT SBLK DUP WBLOCK DUP 0 <- 2+ (RESTART)
  <- 1+ SWAP . 0 - BSIZE U/MOD NEZ - SWAP OVER 1+ CCONT
  FLUSH EBUF 0 (WRCI) ;

OCTAL

% DEFINE TWO FILE CONTROL TABLES
'IFILE FILE
'OFILE FILE

% TYPE A FILE
'PRINT : IFILE OPEN BEGIN GETBYTE DUP EOF NE IF TYO REPEAT
  DROP CLOSE ;

% COPY A FILE
'XFER : OFILE WOPEN IFILE OPEN BEGIN IFILE GETBYTE DUP OFILE
  PUTBYTE EOF EQ END IFILE CLOSE OFILE SHRINK CLOSE ;

RADIX !
;F

***EOF***


U.K. CP/M Users Group - Program Submission Form

Submission Date: 26 FEB 81 

File name: LETTER.BAS - TEXT FORMATTING & JUSTIFICATION PROG. 
           PRINT.BAS - PRINTS COPIES OF JUSTIFIED FILES.

Author: MIKE MAGNAY  
       GANYMEDE WANTAGE RD. ROWSTOCK
        DIDCOT OXON OX11OJU
   TEL ABINGDON 834402

Submitted by: MIKE MAGNAY 
This program is public domain because: 
  AUTHORS MOD OF PREVIOUS U.G.PROG.
Who would this program be useful to: 
   All CP/M users

Briefly describe the program function: 
JUSTIFIES AND FORMATS TEXT. FILE SAVE OF FORMATTED TEXT.

Where is further documentation available: 
INST.FMI IS BOTH THE INSTRUCTIONS & AN EXAMPLE.
MODIFICATION OF <FORMAT> BY B.RATOFF, U.S.U.G.VOL 3.19

Hardware dependencies: 
PRINTER - IT IS INTENDED THAT THE .BAS FILE BE PATCHED BY
THE USER TO SUIT SPECIAL FEATURES OF HIS/HER PRINTER.
PATCHES FOR FUTURE VOLS?

Software dependencies: 
SHOULD COMPILE & RUN ON ALL VERSIONS OF BASIC E.

Source processor: N/A 

How easy is the code to modify: 
   FAIRLY STRAIGHTFORWARD
Ђ л*ЭzјЪf{ЅЪfЙЇ2| \ Н юяК¤ЙЅ	Н Г  \ Н юяКXЙFILE NOT FOUND
$DISK ERROR
$                                     4Ђ"ААT.  BЂА А"SАА$. !R$4. "R$. #R$Ђ	.  6iАTЂ	.  А	 	7†АА	.  U  7  $6ѓ_ $6YЂА.   А.  7џ. $R$яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее	CP/M USERS' GROUP (UK) SOFTWARE LIBRARY - VOLUME 1



BANNER.ASM	(6k)	Banner program  patched by Colin Todd and Derek
			Fordred for CP/M 1.4 and 2.2.
			(Modified from US Vol.8. program).
CARMAINT.BAS	(6k)	by K. Bennett, used to keep vehicle maintenance 
			records.  Uses CBASIC2

CARMAINT.INT	(3k)	Intermediate code of CARMAINT.BAS.  

DUMBCOPY.ASM	(5k)	Single drive disk copy program. Derek Fordred and 
			Andrew Clarke.

DEDUMP.ASM	(8k)	File transfer utility from Computer Age, by Dr.Lee of
			Peterborough. Uses DUMP.COM in the sending computer.

DIRDUMP.ASM	(13k)	by T.Read. Produces a complete directory listing of
			a CP/M 2.0+ disk grouped into user partitions, 
			directable to printer or console.

DIS.COM		(4k)	by D.Powys-Lybbe. 8080 labelling disassembler.
			Disassembles a .COM file and produces .DIS source file.

DIS.DOC		(4k)	Instructions for using DIS.COM.

ERUN.COM	(12k)	E-BASIC runtime interpreter, required for LETTER.

HEXDUMP.ASM	(9k)	Modified US Vol.40 program. Rewritten for 8080 and
			ASM.COM assembler.

			Included here as it is so useful, and because
			the original source code required the TDL Assembler.
			Performs the opposite function to LOAD.

HELP.MAC	(4k)	Lists an ASCII file a screenful at a time.
			Default suffix is .DOC, default filename is HELP.DOC,
			but this can be changed quite easily.  Original idea
			was to provide instructions for novice users (hence
			HELP), but you must supply your own information file.
			Written by JPR Palfrey for the Microsoft Macro
			Assembler (Z80 mnemonics).

HITECH.Z80	(6k)	by S. Withers.  Driver routine for Hitech Electronics
			S100 colour VDU card, plus LUN Table for use with
			FORTRAN.  Requires Z80.

INST.FMI	(2k)	Instruction file demonstrating the use of the LETTER
			text formatting program.

LETTER.BAS	(6k)	Rewrite of FORMAT.BAS from US Vol.3. Text formatting
			program. Requires E-BASIC.


LIB.BAS		(11k)	by D.Powys-Lybbe. Library of CBASIC utilities to assist
			in text input and output. Requires CP/M 2.2 and CBASIC2.
			Written for Digital Microsystems DSC4.

MFT.ASM		(12k)	File transfer for a single drive system. From Dr.Dobbs.
			Written by Larry Hughes.

MPRINT.ASM	(12k)	Prints files with page numbering etc. Responds to
			ambiguous filenames and lists of files. (e.g. MPRINT *.*)
			by Andrew Clarke.

PRINT.BAS	(1k)	Part of text formatter set of programs (See LETTER.BAS).

REMOV".COM	(1k)	From US Vol.40. Used to remove quotation marks from
			the text file generated by LETTER.BAS.

SPIES.BAS 	(4k)	CBASIC2 version of the Digico game. Mods by K. Bennett.

SPOOLNSH.INS	(2k)	How to patch Lifeboat Associates' North Star CP/M
			1.4 BIOS User Area to allow the use of SPOOLER with
			a variety of printer types.  Read in conjunction
			with the article in the CPMUGUK 1980 Yearbook.
			By SJ Withers.

STOICCPM.STC	(22k)	Program to be compiled into STOIC to allow for full
			file handling etc. under CP/M using the BDOS. By
			Andrew Clarke.

STOICEDT.STC	(10k)	STOIC Editor from US Vol.23 modified for use with
			STOICCPM.STC above. By Andrew Clarke.

STOICFLE.STC	(12k)	STOIC file system for above. By. Andrew Clarke.

U-G FORM.LIB	(2k)	UK CP/M User Group program submission form.

T N%
PRINT TAB(4);
FOR ENO% = 0 TO B%-1: PRINT USING "##"; ENO%;: NEXT ENO%
PRINT
RETURN
	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	
яяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее

UK User Group Volume 2.

ED111 Macro Text Editor by David Back.
US Group Catalogue.

		-CATALOG.02-    CONTENTS OF CP/MUGUK VOL.  02-

2.1	13k	CCP.ASM		Source of the CCP of ICOS-80, a CP/M lookalike.
2.2	80k	CPMLIB.DOC	US Library catalogue.
2.3	2k	CRCK.COM	CRC check program from US Vol.50.
2.4	78k	ED111.ASM	Source of powerful macro text editor.
2.5	13k	ED111.COM	Command file of above.
2.6	4k	ED111.IMP	Implementation notes.
2.7	1k	EDIT.MAC	Macros for above.
2.8	3k	HELP.MAC	Macro information for above
2.9	33k	TEXTED.DOC	Extensive documentation for above.
2.10	1k	UK2.DOC		Comments on programs.
2.11	1k	CRCKLST.CRC	CRC's for files on disk
:  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;TITLE('ICOS-80 (C) D.R.BACK.1981')
;NAME CCP
;
;*****************************
;CONSOLE COMMAND PROCESSOR. CCP
;******************************
;
BASE EQU 0
BIAS EQU 0A800H
BDOS EQU 5	;REQUIRES FUNCTION NO. IN C AT ENTRY
CDISK EQU 4	;.CURRENT DEFAULT DRIVE
;
TPA EQU 100H+BASE
;
CR EQU 0DH
LF EQU 0AH
;
ORG 3400H+BIAS
;
	LXI SP,3C00H+BIAS
	MVI C,32	;SET USER CODE=0
	MVI E,0
	CALL BDOS
PRMPT:	LDA CDISK
	PUSH PSW	;SAVE DEFAULT DRIVE
	MVI C,13	;RESET DISK SYSTEM
	CALL BDOS
	POP PSW
	STA CDISK
	ADI 'A'
	STA PRMT+2	;CURRENT DRIVE
	MVI C,9		;PRINT PROMPT
	LXI D,PRMT
	CALL BDOS
	MVI C,10	;READ CONSOLE
	LXI D,CONBUF
	CALL BDOS
	LXI H,CONBUF	;TEST FOR OVERFLOW
	LDA CONSIZ
	CMP M
	JZ PRMPT
	MVI C,36	;CLEAR DEFAULT FCB
	XRA A
	LXI H,BASE+5CH
	CALL CLEAR
	MVI C,33	;CLEAR CCPFCB
	XRA A
	LXI H,CCPFCB
	CALL CLEAR
	LXI D,CCPFCB	;GET COMMAND TO CCPFCB
	LXI H,CONBUF+2
	CALL LDFCB
	RAR
	JC BDFLNM
	LXI D,BASE+5CH	;GET 1ST FILENAME TO FCB
	LHLD IBFPNT
	SHLD MOVPNT	;SAVE START OF COMMAND TAIL
	CALL LDFCB
	RAR
	JNC OK1
BDFLNM:	MVI C,9
	LXI D,INVALF
	CALL BDOS
	JMP PRMPT
OK1:	LXI D,BASE+6CH	;GET 2ND FILENAME TO FCB
	LHLD IBFPNT
	CALL LDFCB
	RAR
	JC BDFLNM
	CALL MOVE	;COMMAND TAIL TO DEFAULT BUFFER
	XRA A		;BRANCH TO COMMAND
	STA WDCNT
	LXI H,BLTIN
	SHLD BLTPNT
COMP1:	LXI D,CCPFCB
	INX D		;IGNORE DRIVE CODE
	XRA A
	STA CHRCNT
COMP2:	LDAX D
	CMP M
	JZ COMP3
	LXI B,LENGTH
	LHLD BLTPNT
	DAD B
	SHLD BLTPNT
	LDA WDCNT
	INR A
	STA WDCNT
	CPI NCMDS
	JNZ COMP1
	JMP OPNCOM
COMP3:	INX H
	INX D
	LDA CHRCNT
	INR A
	STA CHRCNT
	CPI LENGTH
	JNZ COMP2
	LDA WDCNT
	MOV L,A
	MVI H,0
	DAD H
	LXI B,BLTBAS
	DAD B
	MOV A,M
	INX H
	MOV H,M
	MOV L,A
	PCHL
;
BLTBAS:	DW SAVE
	DW DIR
	DW DELET
	DW TYPE
	DW REN
	DW LOGIN
NCMDS EQU ($-BLTBAS)/2
;
;***********BUILT IN COMMANDS******************
;
SAVE:	CALL CNVBN	;SYNTAX	SAVE N FILE.EXT
	JNC BDFLNM	;BIN IN A
	ORA A
	JZ PRMPT	;SAVE 0 IS ILLEGAL
	MOV H,A
	MVI L,0
	SHLD LENTH
	CALL HLFMOV
	LXI D,CCPFCB
	CALL AMBGTS	;MUST NOT BE AMBIG
	RAR
	JC PRMPT
	MVI C,19	;DELETE
	CALL BDOS
	LXI D,CCPFCB
	MVI C,22	;MAKE
	CALL BDOS
	INR A
	JZ DSKFL
	LXI H,TPA
	SHLD STRT
WRTDMA:	XCHG
	MVI C,26	;SETDMA
	CALL BDOS
	LXI D,CCPFCB
	MVI C,21	;WRITE SEQUENTIAL
	CALL BDOS
	ORA A
	JNZ DSKFL
	LHLD LENTH
	LXI D,80H
	CALL DSUB
	SHLD LENTH
	JZ CLS
	LHLD STRT
	LXI B,80H
	DAD B
	SHLD STRT
	JMP WRTDMA
CLS:	LXI D,CCPFCB
	MVI C,16	;CLOSE
	CALL BDOS
	INR A
	JZ NTFER
	JMP PRMPT
DSKFL:	LXI D,DSKFLM
	MVI C,9
	CALL BDOS
	JMP PRMPT
;
DIR:	LXI H,BASE+6DH
	MOV A,M
	STA SYSDIS	;SWITCH TO DISPLAY S FILES
	LXI H,BASE+5CH	;SYNTAX	DIR [FILENAME] [I]
	PUSH H
	INX H
	MOV A,M		;BLANK FILENAME CHECK
	CPI ' '
	JNZ DIR4
	POP H
	PUSH H
	INX H
	MVI C,11
	MVI A,'?'	;FILL FCB WITH '?'
DIR3:	MOV M,A
	INX H
	DCR C
	JNZ DIR3
DIR4:	POP H
	LDA CDISK
	STA DSKTMP
	XRA A
	CMP M
	JNZ FCBDR
	LDA CDISK
	MOV E,A
	JMP DRVS
FCBDR:	MOV E,M
	DCR E
DRVS:	MVI C,14	;SELECT DRIVE
	CALL BDOS
	MOV A,L
	ORA H
	JZ PRMPT
	PUSH H		;SAVE .DPHD
	LDA DSKTMP
	MOV E,A
	MVI C,14
	CALL BDOS	;RESTORE DEFAULT
	MOV A,L
	ORA H
	POP H
	JZ PRMPT
	LXI B,8
	DAD B
	MOV E,M
	INX H
	MOV D,M
	INX H
	MOV C,M
	INX H
	MOV B,M
	PUSH B		;BC=.DPBLK
	XCHG
	SHLD CONCPY	;.DIRBUF
	XCHG
	MVI C,26
	CALL BDOS	;SETDMA TO .DIRBUF
	POP D
	LXI H,5
	DAD D
	MOV E,M
	INX H
	MOV D,M
	INX H
	PUSH H
	INX H
	INX H
	MOV B,M		;ALLOC0
	INX H
	MOV C,M		;ALLOC1
DIR1:	XRA A
	MOV A,C
	RAL
	MOV C,A
	MOV A,B
	RAL
	MOV B,A
	JNC DIR6
	DCX D
	JMP DIR1
DIR6:	INX D
	XCHG
	SHLD VALUE
	LXI H,DSKSZ+7
	SHLD BUFADR
	CALL CONV
	POP H
	MOV E,M
	INX H
	MOV D,M
	INX D
	XCHG
	SHLD VALUE
	LXI H,FILS+7
	SHLD BUFADR
	CALL CONV
	CALL NXTL	;CLEAR COL COUNT
	MVI C,17	;SFIRST
	LXI D,BASE+5CH
	CALL BDOS
DIR0:	CPI 0FFH
	JZ DIR5
	CALL DIRCPY
	MVI C,18	;SNEXT
	LXI D,BASE+5CH
	CALL BDOS
	JMP DIR0
DIR5:	LDA COLCNT
	ORA A
	CNZ NXTL
	LXI H,0
	SHLD VALUE	;INIT SIZE=0
	SHLD NFILES	;INIT NO.OF FILES=0
	MVI C,12
	MVI A,'?'
	LXI H,BASE+5DH
	CALL CLEAR
	MVI C,17
	LXI D,BASE+5CH
	CALL BDOS	;SFIRST
TSEN:	CPI 0FFH
	JZ WRSZ
	LHLD NFILES
	INX H
	SHLD NFILES
	CALL DIRAD
	LXI B,16
	DAD B
	XCHG		;DE=START OF ALLOC
	LHLD VALUE
TRYNXT:	LDAX D		;WORKS ONLY IF DSM<=255
	ORA A		;I.E. 1 BYTE BLOCK ALLOC
	JZ NOADD
	INX H
NOADD:	INX D
	DCR C
	JNZ TRYNXT
	SHLD VALUE
	MVI C,18
	LXI D,BASE+5CH
	CALL BDOS	;SNEXT
	JMP TSEN
WRSZ:	LXI H,DSKSZ+2
	SHLD BUFADR
	CALL CONV	;USED ALLOC
	LHLD NFILES
	SHLD VALUE
	LXI H,FILS+2
	SHLD BUFADR
	CALL CONV	;NO. OF FILES
	MVI C,9		;WRITE DISK USAGE
	LXI D,FILS
	CALL BDOS
	JMP PRMPT
;
DELET:	LXI D,BASE+5CH	;SYNTAX	DELETE FILE.EXT
	MVI C,19
	CALL BDOS
	INR A
	JZ NTFER
	JMP PRMPT
;
TYPE:	LXI D,BASE+5CH	;SYNTAX	TYPE FILE.EXT
	CALL AMBGTS	;MAY NOT BE AMGIG
	RAR
	JC PRMPT
	MVI C,15	;OPEN
	CALL BDOS
	INR A
	JZ NTFER
NXTRD:	LXI D,BASE+5CH
	MVI C,20	;READ SEQUENTIAL
	CALL BDOS
	ORA A
	JNZ PRMPT
	LXI H,BASE+80H
	MVI C,128
CONL:	PUSH H
	PUSH B
	MOV A,M
	CPI 1AH		;^Z
	JZ ENDF
	MOV E,A
	MVI C,2
	CALL BDOS
	POP B
	POP H
	INX H
	DCR C
	JNZ CONL
	JMP NXTRD
ENDF:	POP B
	POP H
	JMP PRMPT
;
REN:	CALL HLFMOV	;SYNTAX RENAME OLDFILE NEWFILE
	LXI D,CCPFCB	;DOES NEWFILE EXIST
	CALL AMBGTS	;MAY NOT BE AMBIG
	RAR
	JC PRMPT
	MVI C,15	;OPEN
	CALL BDOS
	INR A
	JNZ FEXIST
	LXI D,BASE+5CH
	CALL AMBGTS	;MAY NOT BE AMBIG
	RAR
	JC PRMPT
	MVI C,23	;RENAME
	CALL BDOS
	INR A
	JNZ PRMPT
	JMP NTFER
FEXIST:	LXI D,EXIST
	MVI C,9
	CALL BDOS
	JMP PRMPT
;
LOGIN:	LXI H,CCPFCB	;SYNTAX	DRIVE:
	MOV A,M
	ORA A
	JZ PRMPT
	DCR A
	MOV E,A
	MVI C,14
	CALL BDOS
	JMP PRMPT
;
OPNCOM:	LXI H,CCPFCB+9	;TEST FOR BLANK EXTENSION
	MVI C,3
	MVI A,' '
NULT:	CMP M
	JNZ BDFLNM	;INVALID FILENAME
	INX H
	DCR C
	JNZ NULT
	LXI H,CCPFCB+9	;ADD 'COM'
	MVI M,'C'
	INX H
	MVI M,'O'
	INX H
	MVI M,'M'
	LXI D,CCPFCB	;OPEN COMMAND FILE
	MVI C,15
	CALL BDOS
	INR A
	JNZ RDSEQ
NTFER:	MVI C,9
	LXI D,NOTFND
	CALL BDOS
	JMP PRMPT
;*************TRANSIENT COMMANDS***************
RDSEQ:	LXI D,TPA	;SET DMA TO TPA
	PUSH D
SDM:	MVI C,26
	CALL BDOS
	LXI D,CCPFCB
	MVI C,20	;LOAD COMMAND FILE
	CALL BDOS
	ORA A
	JNZ EOF
	LXI H,80H
	POP D
	DAD D
	XCHG
	PUSH D
	JMP SDM
EOF:	POP D
	MVI C,26
	LXI D,80H
	CALL BDOS	;SET DMA TO DEFAULT
	CALL TPA
	JMP PRMPT
;
;********CCP SUBROUTINES**********
CLEAR:	MOV M,A
	INX H
	DCR C
	JNZ CLEAR
	RET
;===================-
HLFMOV:	LXI H,BASE+6CH	;MOVE HALF FCB TO CCPFCB
	LXI D,CCPFCB
	MVI C,16
	CALL MOVL
	RET
;===================
;BYTE MOVER HL=.SOURCE DE=.DEST C=COUNT
MOVL:	MOV A,M
	STAX D
	INX H
	INX D
	DCR C
	RZ
	JMP MOVL
;======================
MOVE:	MVI A,0FFH
	LHLD MOVPNT
	LXI D,BASE+80H
	STAX D		;SET LENGTH TO 0
	INX D
MOV1:	MOV A,M
	STAX D
	MOV C,A
	LDA BASE+80H
	INR A
	STA BASE+80H
	CPI 7FH
	RZ
	MOV A,C
	CPI CR
	RZ
	CPI LF
	RZ
	INX H
	INX D
	JMP MOV1
;=========================
;HL=.SOURCE DE=.FCB
;ACCEPTS CP/M OR ISIS FILENAMES AND DEVICES
;RETURNS A=0 IF OK ELSE A=FF
LDFCB:	XRA A
	STA ISW
	CMA
	STA FSTSW
	SHLD IBFPNT	;FIRST CHAR OF SOURCE
	XCHG
	SHLD FCBST	;.FCB
	CALL CLRFCB
	MVI C,8		;MAX CHAR COUNT
NXTCHR:	LHLD IBFPNT
	MOV A,M
	CPI 60H
	JC UPP
	SUI 20H
UPP:	CALL DELTS	;TEST FOR DELIMITER
	JZ DEL
	CALL TERMTS	;TEST FOR TERMINATOR
	JC DEL
	CPI ':'
	JZ COLON
	CPI '.'
	JZ DOT
	CPI '*'
	JZ STAR
	LHLD FCBPNT
	MOV M,A		;STORE CHAR IN FCB
	INX H
	SHLD FCBPNT
	XRA A
	STA FSTSW
	DCR C		;CHAR COUNT
	JM INVAL
INCBUF:	LHLD IBFPNT
	INX H
	SHLD IBFPNT
	JMP NXTCHR
DEL:	MOV B,A
	LDA FSTSW
	RAR
	JNC VAL
	MOV A,B
	CALL TERMTS
	JC VAL
	JMP INCBUF
DOT:	LDA FSTSW
	RAR
	JC INVAL
	MVI C,3
	LXI D,9
	LHLD FCBST
	DAD D
	SHLD FCBPNT
	JMP INCBUF
PASS:	CALL CLRFCB
	MVI C,0
	JMP INCBUF
COLON:	LDA FSTSW
	RAR
	JC COLON1
	LHLD FCBST
	INX H
	LDA ISW
	RAR
	MOV A,M
	JNC CPMFIL
	CPI 'F'
	JNZ PASS
	INX H
	MOV A,M
	CPI '0'
	JC INVAL
	CPI '5'+1	;DRIVES 0 TO 5 VALID
	JNC INVAL
	SUI 2FH
COLON2:	LHLD FCBST
	MOV M,A
	CALL CLRFCB
	MVI C,8
	JMP INCBUF
CPMFIL:	MOV A,C		;CHAR COUNT
	CPI 6
	JC PASS
	MOV A,M
	CPI 'A'
	JC INVAL
	CPI 'Q'		;DRIVES A TO P ARE VALID
	JNC INVAL
	SUI 40H
	JMP COLON2
COLON1:	XRA A
	CMA
	STA ISW
	JMP INCBUF
STAR:	MVI B,'?'
	MOV A,C		;CHARCNT
	CPI 8
	JZ FNAM
	CPI 3
	JNZ INVAL
	LXI D,9
	LHLD FCBST
	DAD D
	SHLD FCBPNT
	CALL STRBST
	JMP INCBUF
FNAM:	LHLD FCBST
	INX H
	SHLD FCBPNT
	CALL STRBST
	JMP INCBUF
STRBST:	LHLD FCBPNT
	MOV M,B
	INX H
	SHLD FCBPNT
	DCR C
	JNZ STRBST
	XRA A
	STA FSTSW
	RET
INVAL:	XRA A
	CMA
	RET
VAL:	XRA A
	RET
;==================
;REQUIRES A=CHAR
;RETURNS Z IF DELIMITER
DELTS:	CPI ' '
	RZ
	CPI 9H		;TAB
	RZ
	CPI ','
	RZ
	CPI '='
	RZ
	CPI '<'
	RZ
	CPI '['
	RET
;=================
;CY SET=TERMINATOR
TERMTS:	CPI ' '
	RC
	CPI 7BH
	CMC
	RET
;=====================
CLRFCB:	LHLD FCBST
	INX H
	SHLD FCBPNT
	MVI C,11
	MVI A,' '
	CALL CLEAR
	RET
;====================
;TEST FOR AMBIGUOUS OR NULL FILENAME
;REQUIRES DE=.FCB
;RETURNS 0=UNAMBIG  FF=AMBIG
AMBGTS:	PUSH D
	INX D
	LDAX D
	DCX D
	CPI ' '
	JZ AMBG2
	MVI C,12
AMBG1:	LDAX D
	CPI '?'
	JZ AMBG2
	INX D
	DCR C
	JNZ AMBG1
	POP D
	XRA A
	RET
AMBG2:	LXI D,INVALF
	MVI C,9
	CALL BDOS
	POP D
	XRA A
	CMA
	RET
;========================
DIRAD:	LHLD CONCPY	
	ADD A
	ADD A
	ADD A
	ADD A
	ADD A
	MOV E,A
	MVI D,0
	DAD D
	RET
;==============================-
DIRCPY:	CALL DIRAD	;FORMAT DIRBUF TO CONSOLE
	XCHG
	LXI H,9
	DAD D		;WR PROT BIT
	MOV A,M
	ANI 80H
	STA WPRBIT
	INX H
	MOV A,M
	ANI 80H
	STA SYSBIT
	XCHG
	MVI C,0
NXTCH:	XRA A
	CMP C
	MOV A,M
	JNZ NOTFST
	CPI 0E5H
	RZ
	LDA SYSDIS
	CPI 'I'
	JZ NFS
	LDA SYSBIT
	ORA A
	RNZ
NFS:	MOV A,M
NOTFST:	PUSH H
	ANI 7FH
	CPI ' '
	JNC PRNTNG
	MVI A,' '
PRNTNG:	MOV E,A
	CALL ECHO
	INR C
	MOV A,C
	CPI 9
	JNZ NODOT
	MVI E,'.'
	CALL ECHO
	MOV A,C
NODOT:	CPI 12
	POP H
	JZ NXTLIN
	INX H
	JMP NXTCH
NXTLIN:	CALL TAB
	LDA WPRBIT
	MVI E,'W'
	ORA A
	JNZ WP
	MVI E,' '
WP:	CALL ECHO
	LDA SYSBIT
	MVI E,'S'
	ORA A
	JNZ SY
	MVI E,' '
SY:	CALL ECHO
	LDA COLCNT
	CPI 65
	JNC NXTL
	CALL TAB
	RET
NXTL:	MVI E,CR
	CALL ECHO
	MVI E,LF
	CALL ECHO
	XRA A
	STA COLCNT
	RET
;====================
ECHO:	PUSH B
	MVI C,2
	CALL BDOS
	LXI H,COLCNT
	INR M
	POP B
	RET
;====================
TAB:	LDA COLCNT
	ANI 7
	RZ
	MVI E,' '
	CALL ECHO
	JMP TAB
;=====================
;BIN TO ASCII
CONV:	LXI H,I
	MVI M,1
CONV1:	MVI A,4		;SIZE
	CMP M
	RC
	LDA I
	DCR A
	JZ A1
	LHLD VALUE
	MOV A,L
	ORA H
	JNZ A1
	MVI A,' '
	JMP A2
A1:	LHLD VALUE
	XCHG
	LXI H,10	;BASE
	CALL AP0029
	XCHG
	SHLD VALUE
	LXI H,'0'
	DAD D
	MOV A,L
	CPI '9'+1
	JC A2
	ADI 7
A2:	MOV E,A
	LXI H,I
	MVI A,4		;SIZE
	SUB M
	MOV C,A
	MVI B,0
	LHLD BUFADR
	DAD B
	MOV M,E
	LXI H,I
	INR M
	JMP CONV1
;========================
AP0029:	MOV B,H
	MOV C,L
AP0030:	LXI H,0
	MVI A,16
	PUSH PSW
	DAD H
	XCHG
	SUB A
	DAD H
	XCHG
	ADC L
	SUB C
	MOV L,A
	MOV A,H
	SBB B
	MOV H,A
	INX D
	JNC $+5
	DAD B
	DCX D
	POP PSW
	DCR A
	JNZ $-14H
	RET
;========================
;CONVERT ASCII NUMBER AT BASE+5DH TO BIN
;RETURNS A=BIN  CY SET IF OK
CNVBN:	XRA A
	MOV B,A
	LXI D,BASE+5DH
	MVI C,4		;MAX PERMITTED DIGITS
NXTDIG:	LDAX D
	CPI ' '
	JZ CNVFIN
	CPI '0'
	JC CONVER
	CPI ':'
	JNC CONVER
	SUI '0'
	MOV L,A
	MOV A,B
	ADD A
	MOV H,A
	ADD A
	ADD A
	ADD H
	ADD L
	MOV B,A
	INX D
	DCR C
	JNZ NXTDIG
CONVER:	XRA A		;CLEAR CY
	RET
CNVFIN:	MOV A,B
	STC
	RET
;=========================
;DOUBLE SUBTRACT HL:=HL-DE
;Z & CY ARE SET FOR RESULT
DSUB:	MOV A,L
	SUB E
	MOV L,A
	MOV A,H
	SBB D
	MOV H,A
	RNZ
	INR L
	DCR L
	RET
;================================
;
PRMT:	DB CR,LF,'X>','$'
INVALF:	DB 'INVALID FILENAME',CR,LF,'$'
NOTFND:	DB 'NOT FOUND',CR,LF,'$'
EXIST:	DB 'FILE EXISTS',CR,LF,'$'
DSKFLM:	DB 'DISK FULL',CR,LF,'$'
FILS:	DB CR,LF,'    /     FILES'
DSKSZ:	DB CR,LF,'    /     BLOCKS USED',CR,LF,'$'
;
BLTIN:	DB 'SAVE   '
	DB '    '
LENGTH EQU $-BLTIN
	DB 'DIR    '
	DB '    '
	DB 'DELETE '
	DB '    '
	DB 'TYPE   '
	DB '    '
	DB 'RENAME '
	DB '    '
	DB '           '
CONBUF:	DB CONLEN
CONSIZ:	DS 1
CONLIN:	DS 128
CONLEN EQU $-CONSIZ
MOVPNT:	DS 2
ISW:	DS 1		;ISIS NAME SWITCH
FSTSW:	DS 1
FCBST:	DS 2
FCBPNT:	DS 2
IBFPNT:	DS 2
WDCNT:	DS 1
CHRCNT:	DS 1
BLTPNT:	DS 2
CCPFCB:	DS 33
CONCPY:	DS 2
LENTH:	DS 2
STRT:	DS 2
DSKTMP:	DS 1
NFILES:	DS 2		;NO. OF FILES
SYSDIS:	DS 1		;S DISPLAY SWITCH
WPRBIT:	DS 1		;WRITE PROTECT BIT
SYSBIT:	DS 1		;SYSTEM BIT
COLCNT:	DS 1		;COLUMN COUNT
;
I:	DS 1		;CONV VARIABLE
BUFADR:	DS 2		;.BUFFER FOR CONV O/P
VALUE:	DS 2		;2 BYTE VALUE FOR CONV
;
;SPACE FOR CCP STACK
;
END

		;CONV VARIABLE
BUFADR:	DS 2		;.BUFFER FOR CONV O/P
VALUE:	DS 2		;2 BYTE VALUE FOR CONV
;
;SPAC4Ђ"ААT.  BЂА А"SАА$. !R$4. "R$. #R$Ђ	.  6iАTЂ	.  А	 	7†АА	.  U  7  $6ѓ_ $6YЂА.   А.  7џ. $R$яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее

VOLUME 1

VARIOUS CP/M UTILITY PROGRAMS

NUMBER	SIZE	NAME		COMMENTS

	3K	CATALOG.1	CONTENTS OF CP/M GROUP VOL 1
	3K	VOLUME1.DOC	COMMENTS ON CERTAIN PROGRAMS ON
				VOLUME
1.1	8K	ASSIGN.ASM	IOBYTE ASIGN. USE WITH VBIOS31
1.2	2K	CASDSK.ASM	CASSETTE TO DISK TRANSFER
1.3	9K	COPY.ASM	COPY SYSTEM, DATA OR WHOLE DISKETTE
				FROM DRIVE A TO B.
1.4	8K	COPY.COM	AS ASM, USED TO COPY THIS DISK
1.5	9K	COPYX.ASM	AS COPY, USES INTERNAL SCRATCH
				INSTEAD OF AREA AT 40H
1.6	4K	DIABLO.ASM	ROMABLE HYTYPE/QUME DRIVER
1.7	8K	DISASSM1.ASM	CHRISTENSEN DISASSEMBLER AS PER
				DR. DOBB'S OF FEB 1977. SEE
				ALSO SEDIT.ASM BELOW
1.8	4K	DISASSM2.ASM	INTEL LIBRARY DISASSEMBLER
1.9	9K	DISKTEST.ASM	PROGRAM TO SEARCH FOR SOFT AND
				HARD SECTOR ERRORS IN DISK I/O
				DESTROYS FILES ON DISKETTE AND
				ONLY RUNS IN 16K SYSTEMS
1.10	2K	DSKCAS.ASM	DISKETTE TO CASETTE TRANSFER
1.11	1K	ED3.ASM		PATCHES FOR 'R' BUG IN CP/M ED.COM
1.12	7K	EXAM.ASM	SECTOR VIEWER FOR VDM. SEE
				DISK1.DOC
1.13	1K	FILES.COM	GIVES CONSOLE DISPLAY OF DIRECTORY
				RECORD NUMBERS ASSIGNED TO EACH
				FILE.  OFFERS TO DELETE FAULTY
				DIRECTORY ENTRIES.
1.14	1K	GETVEC.LIB	ASM ROUTINE TO CREATE BIOS PRIMITIVE
				JUMP TABLE. BIG IMPROVEMENT ON ARG'S
				IN COPY.  TOM KIRK SAYS A Z80 CAN
				DO IT ALL IN 4 INSTRUCTIONS!!
1.15	4K	HYS13.ASM	DIABLO DRIVER FOR 3P+S IN Z80
1.16	5K	HYS15.ASM	DIABLO DRIVER FOR 3P+S IN 8080
1.17	7K	ICOPY.ASM	COPY A FILE FROM ISIS DISKETTE
				ON B TO CP/M DISKETTE ON A. USE
				IDIR FIRST TO IDENTIFY FILENAMES
1.18	6K	IDIR.COM	LISTS TO CONSOLE DIRECTORY
				OF ISIS DISKETTE IN B.
1.19	7K	LIOS.ASM	CP/M I/O SUBROUTINES. SEE PRINT
				FOR APPLICATION
1.20	10K	LTG.ASM
1.21	6K	MAZE.ASM	INTEL MAZE PROGRAM
1.22	4K	MEMTEST.ASM	INTEL RAM TEST
1.23	7K	PRINT.ASM	MOD OF PRNT TO PERMIT CONDITIONAL
				ASSEMBLY FOR CON:/LST: AND FOR
				HARDWARE <FF> OR NONE
1.24	5K	PRNT.ASM	TRANSIENT TO PRINT FILES WITH
				PAGINATION AND PAGE NUMBERS
1.25	10K	RELOC.ASM	CP/M RELOCATION PROGRAM
1.26	7K	RTE.ASM		INTEL REAL-TIME EXECUTIVE
1.27	4K	SEDIT.ASM	SYMBOL TABLE EDITOR OF DISASSM1
1.28	16K	SPACE.ASM	GAME
1.29	8K	SPAT.ASM	RE-WRITE OF EXAM TO ALLOW WRITING.
				SEE VOL 3 FORMAT.BAS AND README.FMI
1.30	3K	TRAIN.ASM	VDM GRAPHIC
1.31	4K	TREAD.ASM	TAPE READER TO DISK TRANSFER
1.32	17K	VBIOS31.ASM	BIOS FOR 32K OF MEMORY WITH VDM
1.33	3K	VBOOT31		COLD BOOT FOR VBIOS31
1.34	1K	XSTAT.COM	SIMILAR TO STAT. REPORTS # OF
				FILES AND NULL FILES. KNOWN BUG
				IS THAT IS REPORTS NULL EXTENTS
				TO NON-NULL FILES. DON'T DELETE
				A FILE BASED ON THIS!!!!!


VOLUME 2

LAWRENCE LIVERMORE BASIC AND DISK TINY BASIC

NOTE THAT AN IMPROVED IMPLEMENTATION OF BOTH LLLBASIC AND DISK
TINY BASIC ARE NOW PRESENT ON VOLUMES 10 AND 11 RESPECTIVELY.

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.2	CONTENTS OF CP/M VOLUME 2
2.1	84K	LLLBASIC.ASM	LLLBASIC INTERPRETER SOURCE
2.2	38K	LLLBASIC.COM	SIMPLE PATCHED COM FOR CP/M
				(NOT ECONOMICAL BUT INSTRUCTIVE)
2.3	2K	LLLBASIC.DOC	NOTES ON LLLBASIC
2.4	61K	LLLFP.ASM	FLOATING POINT PACKAGE FOR LLLBASIC
2.5	2K	LLLMON.ASM	KLUGE MONITOR TO TEST LLL IN
				LLLBASIC.COM
2.6	2K	STARTREK.DOC	COMMENTS ON STARTREK.TBI
2.7	5K	STARTREK.TBI	TINY BASIC LOADABLE STARTREK
2.8	3K	TINYBAS.COM	SHERRY VERSION OF WANG PALO ALTO
				TINY BASIC, WITH DISK SAVE AND
				LOAD OF PROGRAMS FOR CP/M
2.9	13K	TINYBAS.DOC	FULL INSTRUCTIONS FOR TINYBAS



VOLUME 3

VARIOUS BASIC E GAMES AND PROGRAMS

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.3	CONTENTS OF CP/M VOLUME 3
		VOLUME3A.DOC	COMMENTS ON SOME PROGRAMS
		VOLUME3B.DOC	COMMENTS ON OTHER PROGRAMS
3.1	2K	ACE.BAS		BASIC-E PROGRAM. SEE DOC'S
3.2	4K	AMAZE.BAS	BASIC-E PROGRAM. SEE DOC'S
3.3	2K	ANIMAL.BAS	BASIC-E PROGRAM. SEE DOC'S
3.4	2K	BAGELS.BAS	BASIC-E PROGRAM. SEE DOC'S
3.5	6K	BAGELS2.BAS	BASIC-E PROGRAM. SEE DOC'S
3.6	7K	BIOPRINT.BAS	BASIC-E PROGRAM. SEE DOC'S
3.7	11K	BLKFRI.BAS	BASIC-E PROGRAM. SEE DOC'S
3.8	10K	BLKFRI2.BAS	BASIC-E PROGRAM. SEE DOC'S
3.9	6K	CANNONS.BAS	BASIC-E PROGRAM. SEE DOC'S
3.10	3K	CHASE.BAS	BASIC-E PROGRAM. SEE DOC'S
3.11	2K	CHOMP.BAS	BASIC-E PROGRAM. SEE DOC'S
3.12	1K	COMBINE.BAS	BASIC-E PROGRAM. SEE DOC'S
3.13	1K	CORE.BAS	BASIC-E PROGRAM. SEE DOC'S
3.14	1K	CORETEST.BAS	BASIC-E PROGRAM. SEE DOC'S
3.15	4K	CRAPS.BAS	BASIC-E PROGRAM. SEE DOC'S
3.16	1K	EUCLID.BAS	BASIC-E PROGRAM. SEE DOC'S
3.17	1K	FIB.BAS		BASIC-E PROGRAM. SEE DOC'S
3.18	1K	FIT.BAS		BASIC-E PROGRAM. SEE DOC'S
3.19	4K	FORMAT.BAS	BASIC-E PROGRAM. SEE DOC'S
3.20	1K	FORMAT.FMI	INSTRUCTIONS FOR FORMAT.BAS IN
				FORMAT CODE
3.21	5K	HANG.BAS	BASIC-E PROGRAM. SEE DOC'S
3.22	5K	HELLO.BAS	BASIC-E PROGRAM. SEE DOC'S
3.23	7K	KENO.BAS	BASIC-E PROGRAM. SEE DOC'S
3.24	5K	LANDER.BAS	BASIC-E PROGRAM. SEE DOC'S
3.25	8K	LANES.BAS	BASIC-E PROGRAM. SEE DOC'S
3.26	7K	LEM.BAS		BASIC-E PROGRAM. SEE DOC'S
3.27	3K	LOAN.BAS	BASIC-E PROGRAM. SEE DOC'S
3.28	2K	LOVE.BAS	BASIC-E GRAPHIC
3.29	2K	PLOT2.BAS	BASIC-E PROGRAM. SEE DOC'S
3.30	4K	POET.BAS	BASIC-E PROGRAM. SEE DOC'S
3.31	6K	README.FMI	ANOTHER FORMAT SOURCE WITH NOTES
				ON THE AUTHOR, ON ML80 AND ON SPAT
3.32	5K	S/TREK.BAS	BASIC-E PROGRAM. SEE DOC'S
3.33	4K	STARS.BAS	BASIC-E PROGRAM. SEE DOC'S
3.34	27K	STARTREK.BAS	BASIC-E PROGRAM. SEE DOC'S
3.35	7K	STORY.BAS	BASIC-E PROGRAM. SEE DOC'S
3.36	4K	STRIKE9.BAS	BASIC-E PROGRAM. SEE DOC'S
3.37	7K	TREKINST	INSTRUCTIONS FOR STARTREK.BAS
3.38	7K	TTT.BAS		BASIC-E PROGRAM. SEE DOC'S
3.39	9K	WUMPUS.BAS	BASIC-E PROGRAM. SEE DOC'S


VOLUME 4

ACTOR, ML80 AND EXAMPLES OF FORTRAN-80 CODE

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.4	CONTENTS OF CP/M GROUP VOL 4
		VOLUME4.DOC	COMMENTS ON PROGRAMS
4.1	16K	ACT.DOC		ACTOR MANUAL
4.2	11K	ACT31.COM	LATEST ACTOR INTERPRETER
4.3	11K	ACT31UC.COM	LATEST UPPER-CASE CHARACTER SET
				ACTOR INTERPRETER
4.4	2K	AMAZE		ACTOR PROGRAM
4.5	1K	AMUSE		ACTOR PROGRAM
4.6	16K	CALENDAR.COM	OBJECT OF CALENDAR.FOR AND
				NUMBER.MAC.  CREATES DISK FILE
				CALLED CALENDAR  TRY IT!!
4.7	4K	CALENDAR.FOR	FORTRAN MAIN AND SUB-PROGRAMS
4.8	6K	FDL		ACTOR PROGRAM - CAREFUL WITH THIS
				AS IT CLEANS OUT INPUT FILES
4.9	2K	HAIKU		ACTOR PROGRAM
4.10	3K	IOEXAMP		ACTOR PROGRAM
4.11	11K	L81.COM		ML80 MODULE - SEE DISKETTE.DOC
4.12	11K	L82.COM		ML80 MODULE - SEE DISKETTE.DOC
4.13	5K	L83.COM		ML80 MODULE - SEE DISKETTE.DOC
4.14	10K	M81.COM		ML80 MODULE - SEE DISKETTE.DOC
4.15	20K	MAZE.COM	OBJECT OF MAZE.FOR AND RND.FOR
				CREATES A MAZE ON CONSOLE.
				TRY IT!!!
4.16	5K	MAZE.FOR	SOURCE OF MAZE.COM MAIN
4.17	1K	ML.SUB		SUBMIT.COM COMMAND FILE TO RUN
				ML80 SOURCE THROUGH EACH MODULE
				AND CLEAN UP AFTERWARDS
4.18	1K	MLCOPY.SUB	SUBMIT.COM COMMAND FILE TO
				TRANSFER ML80 GROUP VIA PIP.COM
4.19	2K	NUMBER.MAC	CALENDAR TITLE GENERATOR WRITTEN
				IN SOURCE CODE FOR FORTRAN-80
				ASSEMBLER. (NOTE SUFFIX MAC DOES
				NOT CONNOTE THAT MACROS ARE
				SUPPORTED.  ASSEMBLER IS CALLED
				M80.COM - NOT TO BE CONFUSED WITH
				ML80 MACRO PROCESSOR M81.COM!!!!!)
4.20	1K	RND.FOR		SUB-PROGRAM OF MAZE
4.21	1K	WDIR.COM	OBJECT OF WDIR.M80 (TRY IT!!)
4.22	3K	WDIR.M80	ML80 SOURCE FOR WDIR.COM
4.23	1K	XDIR.COM	OBJECT OF XDIR.M80 (TRY IT!!)
4.24	4K	XDIR.M80	ML80 SOURCE FOR XDIR.COM
4.25	2K	Z-LCTOUC.ACT	ACTOR PROGRAM TO CONVERT STD ACTOR
				PROGRAMS TO ACTUC CHARACTER SET
				(Z-NAME DUE TO LAST MINUTE ADD.)


VOLUME 5

BASIC-E COMPILERS AND INTERPRETERS
BASIC-E PROGRAMS, CONTINUED FROM VOLUME 3
MICROSOFT BASIC PROGRAMS

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.5	CONTENTS OF CP/M GROUP VOL 5
		VOLUME5.DOC	COMMENTS
5.1	8K	21.ASC		MICROSOFT BASIC PROGRAM
5.2	12K	BAS2-0.COM	BASIC-E COMPILER
5.3	12K	BAS2-1.COM	CASIC-E COMPILER
5.4				DELETED
5.5	5K	BIO-FF.ASC	MICROSOFT BASIC PROGRAM
5.6	4K	BIORYTH.ASC	MICROSOFT BASIC PROGRAM
5.7	10K	BLKFRI2.ASC	MICROSOFT BASIC PROGRAM
5.8				DELETED
5.9	2K	DECISION.ASC	MICROSOFT BASIC PROGRAM
5.10				DELETED
5.11	6K	EDTEXT.ASC	MICROSOFT BASIC PROGRAM
5.12	2K	FORMAT.ASC	MICROSOFT BASIC PROGRAM
5.13				DELETED
5.14	16K	OTHELLO.BAS	BASIC-E PROGRAM
5.15	5K	OTHELLO.DOC	INSTRUCTIONS FOR OTHELLO.BAS
5.16	2K	RADIX.ASC	MICROSOFT BASIC PROGRAM
5.17	1K	RECOVERY.ASC	MICROSOFT BASIC PROGRAM
5.18	12K	RUN2-2.COM	BASIC-E INTERPRETER
5.19	12K	RUN2-3.COM	BASIC-E INTERPRETER
5.20	12K	RUNK2-0.COM	BASIC-E INTERPRETER
5.21	4K	SLOT.ASC	MICROSOFT BASIC PROGRAM
5.22	2K	SORT.ASC	MICROSOFT BASIC PROGRAM
5.23	7K	STARTREK.ASC	MICROSOFT BASIC PROGRAM
5.24	14K	SUPTRK3.ASC	MICROSOFT BASIC PROGRAM


VOLUME 6

CHICAGO AREA COMPUTER HOBBIEST EXCHANGE SOFTWARE

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.6	CONTENTS OF CP/M VOLUME 6
		EDVDM.DOC	ED.COM PATCH TO CHANGE LINES OF
				P COMMAND. SEE EXPLAIN.DOC
		EXPLAIN.DOC	COMMENTS ON CERTAIN  PROGRAMS
		MAILLIST.DOC	DOCUMENTAION ON CACHE MAILLIST
				PROGRAMS
6.1	6K	BLOAD.ASM	TARBELL TAPE MITS 3.1 BASIC CSAVE TO
				ASCII
6.2	34K	CCOS1.ASM	CACHE CASETTE OPERATING SYSTEM
6.3	2K	CKSUM.ASM	CHECKSUMS CP/M FILES
6.4	5K	COMPARE.ASM	COMPARES TWO CP/M FILES
6.5	15K	CUTTER.ASM	SEEMS TO BE VDM TO CASETTE PROGRAM,
				BUT DOCUMENTATION STILL AWAITED
6.6	3K	IDUMP.ASM	INTERPRETED FILE DUMP
6.7	9K	MAINT.BAS	MAILLIST MODULE
6.8	13K	MODEM.ASM	PROGRAM TO SEND AND RECEIVE FILES
				AND CONTROL REMOTE COMPUTERS
				VIA MODEM
6.9				DELETED
6.10	1K	PREFMT.BAS	MAILLIST MODULE
6.11	3K	PURGE.ASM	DISKETTE DIRECTORY PURGE
6.12	1K	QUICKIE.BAS	MAILLIST MODULE
6.13	8K	REPORT.BAS	MAILLIST MODULE
6.14	6K	SIZE.ASM	GIVES SIZE OF CP/M FILE
6.15	5K	SLOAD.ASM	LOADER MODULE OF CCOS1
6.16	7K	SORT.ASM	MAILLIST MODULE
6.17	4K	TISQ.ASM	TIMES SQUARE (NEWSCASTER) LETTERS
				TO VDM
6.18	5K	TLOAD.ASM	TARBELL LOADER FOR TSAVED FILES
6.19	2K	TMAP.ASM	MAP OF TAPE WITH TSAVED FILES
6.20	5K	TSAVE.ASM	CP/M FILE TO TARBELL TAPE WITH
				CHECKSUM
6.21				DELETED


VOLUME 7

PILOT - PROGRAMMED INQUIRY, LEARNING AND TEACHING

NOTE THAT AN IMPROVED IMPLEMENTATION OF THIS VERSION AND A NEW
Z-80 SIMPLER PILOT ARE NOW OFFERED IN VOLUME 12

NUMBER	SIZE	NAME		COMMENTS
		CATALOG.7	CONTENTS OF CP/M VOL 7
		VOLUME7.DOC	COMMENTS
7.1	6K	PILOT		LOADED MDS OBJECT
7.2	66K	PILOT.ASM	PILOT SOURCE
7.3	136K	PILOT.LST	MDS ASSEMBLER LISTING WITH
				X-REFERENCE TABLES
7.4	6K	PILOT.OBJ	RELOCATABLE MDS OBJECT


VOLUME 8

VARIOUS CP/M UTILITY PROGRAMS

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.8	CONTENTS OF CP/M CROUP VOL 8
8.1	1K	ALLOC.COM	GRAPHIC DISPLAY OF DISK USAGE
				[MINOR BUG IS THAT THE 32 BY 8
				MATRIX SHOWS 2K USED FOR AN EMPTY
				DISK AND 13K FREE FOR A FULL ONE.
				A PATCHED VERSION PLUS SOURCE
				HAS BEEN PROMISED]
8.2	6K	BANNER.ASM	PUTS LARGE LETTERS TO LST: OR PUN:
				USEFUL TO IDENTIFY LISTING PRINTOUTS
8.3	7K	BINLOAD1.ASM	PROGRAM TO READ DISK DATA FROM ABSOLUTE
				SECTOR ADDRESSES TO MEMORY
8.4	2K	BIOSGO.LIB	PRETTY VERSION OF #1.14.  PUTS A DUMMY
				BIOS JUMP TABLE WHERE A PROGRAM NEEDS IT
8.5	2K	BPNF.ASM	PROGRAM TO PUNCH STANDARD BPNF PROM TAPE
				FOR AREA IN MEMORY
8.6	2K	BSPAT16B.ASM	PATCH TO PERMIT <BS> I.E. (CTL H) TO ECHO
				AS A BACKSPACE AND ACT AS A RUB OUT FOR
				CP/M VERSION 1.3
8.7	4K	BYTEMOV.ASM	BYTESAVER PROM BURNING PROGRAM
8.8	2K	DDTPATCH.ASM	PATCH TO CORRECT ASSEMBLER ERRORS IN
				DDT.  THIS ONE IS DIFFERENT - IT WORKS!!
8.9	9K	DISKDUP.ASM	THIS IS ANOTHER DISK COPYING PROGRAM.  THESE
				ALL SEEM HARDWARE SENSITIVE SO GOOD LUCK WITH
				THIS ONE
8.10	2K	DISKIN.LIB	ROUTINE TO READ SINGLE CHARACTERS FROM DISK
				FILES
8.11	7K	DISKTES1.ASM	RE-WRITTEN VERSION OF #1.9 FOR GENERALITY OF
				SYSTEM SIZES
8.12	1K	DIVIDE1.LIB	ROUTINE TO DIVIDE 2 BYTE QUANTITY BY ONE BYTE
				DIVISOR WITH REMAINDER
8.13	17K	DSKDIR.ASM	SENDS TO CONSOLE FULL SIZE (DECIMAL), NUMBER OF
				RECORDS AND EXTENTS OF FILES.  ACCEPTS GENERAL
				COMMANDS "DSKDIR N:*.TYP" ETC.
8.14	8K	FMAP.ASM	SENDS TO CONSOLE QUANTITY AND RECORD NUMBER OF
				GROUPS (CLUSTERS?) ON LOGGED-IN DISK.  BUG-
				IT IGNORES GROUPS AFTER FIRST EXTENT.  ALSO
				CREATES DISK FILE OF FILE NAMES IF DESIRED
8.15	4K	FORMAT1.ASM	DISKETTE FORMATTER FOR TARBELL CONTROLLER, OR
				ONE USING SAME CONTROLLER CHIP
8.16	2K	GO.ASM		SAY "GO FF00" AND AS IF BY MAGIC....  USEFUL
				IF NO FRONT PANEL AVAILABLE.
8.17	2K	INNUM1.LIB	VARIABLE RADIX NUMBER INPUT ROUTINE.  NEEDS
				MPY8.LIB BELOW AND A CHARACTER INPUT ROUTINE
8.18	9K	MAC4.ASM	PATCHES TO PUT TDL MACRO ASSEMBLER UP AS DISK
				ASSEMBLER THROUGH CP/M
8.19	3K	MAKEFCB.LIB	ROUTINE TO CREATE FCB'S
8.20	1K	MPY8.LIB	TWO BYTE BY ONE BYTE MULTIPLY
8.21	2K	OUTNUM1.LIB	OUTPUT A TWO BYTE NUMBER IN ANY CHOSEN RADIX
8.22	2K	PBURN.ASM	BYTESAVER PROM BURNER.  8.7 ABOVE HAS BETTER
				USER INTERFACE FOR PROMPTS AND ERROR HANDLING
8.23	10K	PRINT2.ASM	REVISION OF #1.24 TO INCLUDE DIABLO DRIVER
				AND HIGH SPEED TRAVEL BETWEEN PRINTED CHARACTERS
8.24	1K	RECSEC.LIB	ROUTINE TO TRANSLATE CP/M RECORD (GROUP-CLUSTER)
				NUMBER TO DISKETTE SECTOR ADDRESS
8.25	4K	SYMPRT.ASM	PROGRAM TO PRINT THE SYMBOL TABLE REMAINING IN
				MEMORY AFTER RUNNING BASIC-E COMPILER K2.0
8.26	2K	WYLECON2.LIB	ROUTINE TO TRANSLATE WYLE KEYBOARD OUTPUT TO
				UPPER/LOWER CASE ASCII
8.27	20K	XREF.ASM	PROGRAM TO CREATE FULL CROSS-REFERENCE TABLE FROM
				INTEL ASSEMBLER SOURCE. (ONLY GENERATES THE TALE,
				DOES NOT DO THE ASSEMBLY)
8.28	6K	XSTAT2.ASM	SOURCE OF #1.34 PLUS SOME GUESSED SUBROUTINES.


VOLUME 9

GENERAL LEDGER PROGRAM BY BUD SHAMBURGER

THESE TWELVE PROGRAMS WERE PUBLISHED IN MACHINE READABLE
FORM AS PAGE 32A OF INTERFACE AGE MAGAZINE, VOLUME 2, ISSUE 10,
DATED SEPTEMBER 1977.

THE SYSTEM WAS DESCRIBED IN A SERIES OF THREE ARTICLES IN THE
ISSUES OF SEPTEMBER THROUGH NOVEMBER.  IN THE FINAL ISSUE, FULL
TYPED LISTINGS WERE GIVEN FOR THE TWELVE PROGRAMS PLUS TWO OTHERS,
"CHART" AND "GENPRO", NEITHER OF WHICH WERE ON THE "FLOPPY ROM".

THE VERSIONS HERE ARE IN FULL ASCII.  THE LANGUAGE IS MITS 12K
DISK BASIC VER. 4.0.  IN CERTAIN CASES, THE COMMENT PREAMBLES
WERE REMOVED FROM THE HEADS OF THE FILES, TO PERMIT LOADING IN
THE SYSTEM USED TO RECOVER THE CODE.


NUMBER	SIZE	NAME		COMMENTS

	1K	CATALOG.9
9.1	2K	COPCON.ASC	SEE MAGAZINE REFERENCES ABOVE
9.2	2K	COPRAN.ASC	SEE MAGAZINE REFERENCES ABOVE
9.3	3K	GETPUT.ASC	SEE MAGAZINE REFERENCES ABOVE
9.4	7K	GL1.ASC		SEE MAGAZINE REFERENCES ABOVE
9.5	16K	GL2.ASC		SEE MAGAZINE REFERENCES ABOVE
9.6	4K	GL3.ASC		SEE MAGAZINE REFERENCES ABOVE
9.7	4K	GL4.ASC		SEE MAGAZINE REFERENCES ABOVE
9.8	6K	GL5.ASC		SEE MAGAZINE REFERENCES ABOVE
9.9	7K	GL6.ASC		SEE MAGAZINE REFERENCES ABOVE
9.10	13K	GL7.ASC		SEE MAGAZINE REFERENCES ABOVE
9.11	3K	GLMENU.ASC	SEE MAGAZINE REFERENCES ABOVE
9.12	7K	SORTGL.ASC	SEE MAGAZINE REFERENCES ABOVE


VOLUME 10

LAWRENCE LIVERMORE BASIC INTERFACED TO CP/M
WITH DISK LOAD OF PROGRAMS

THESE PROGRAMS REPLACE THE VERSIONS ISSUED ON
CP/M USERS' GROUP VOLUME 2

NUMBER	SIZE	NAME		COMMENTS

	1K	CATALOG.10	CONTENTS OF CP/M GROUP VOL 10
	4K	LLLBASIC.DOC	COMMENTS ON PROGRAMS IN VOLUME 10
10.1	85K	LLLBASIC.ASM	SEE LLLBASIC.DOC
10.2	7K	LLLBASIC.COM	TOTAL ASSEMBLED PACKAGE
10.3	61K	LLLFP.ASM	SEE LLLBASIC.DOC
10.4	5K	LLLMON.ASM	SEE LLLBASIC.DOC
10.5	1K	TEST.FIL	TEST PROGRAM.  TO RUN TYPE
				"LLLBASIC TEST.FIL" AND AFTER
				"READY" PROMPT, TYPE "PTAPE"
				THEN YOU MAY "LIST" OR "RUN"


VOLUME 11

DISK TINIBASIC AND DISK PROCESSOR TECHNOLOGY BASIC/5

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.11	CONTENTS OF CP/M VOLUME 11
		VOLUME11.DOC	COMMENTS ON CONTENTS
11.1	76K	BASIC/5.ASM	PRO TECH 5K DISKIFIED BASIC
11.2	8K	BASIC/5.COM	5K BASIC IN 8K (SIGN OF THE TIMES)
11.3	7K	BASIC/5.DOC	CP/M IMPLEMENTATION AND OTHER
				MAJOR EXTENSIONS EXPLAINED
11.4	6K	STARTREK.TBI	WAS ALSO #2.7 SEE VOLUME11.DOC
11.5	1K	TINICOPY.SUB	SOMEONE USES THE SUBMIT PROGRAM??
11.6	62K	TINIDISK.ASM	SOURCE OF TINIDISK
11.7	3K	TINIDISK.COM	WAS ALSO #2.8
11.8	13K	TINIDISK.DOC	WAS ALSO #2.9


VOLUME 12

PILOT INTERPRETERS PATCHED FOR CP/M

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.12	CONTENTS OF CP/M VOL 12
12.1	1K	GOLDI.PLT	SOURCE PROGRAM FOR ZPILOT
12.2	2K	HIPILOT.PLT	SOURCE PROGRAM FOR ZPILOT
12.3	67K	PILOT.ASM	PATCHED VERSION OF #7.2 SEE
				PILOT.DOC
12.4	5K	PILOT.COM	SEE PILOT.DOC
12.5	2K	PILOT.DOC	DESCRIPTION OF CP/M IMPLEMENTATION
				OF PILOT
12.6	1K	PILOT.TST	SOURCE PROGRAM FOR PILOT. TYPE
				"PILOT PILOT.TST" TO RUN
12.7	5K	PMON.ASM	CP/M INTERFACE USED IN PILOT.COM
12.8	1K	WIERD		WIERD.PLT RE-CODED FOR THE PILOT.COM
				SYNTAX FOR COMPARISON PURPOSES ONLY.
				[WONDER WHO CAN'T SPELL STRAWBERRIES??]
12.9	1K	WIERD.PLT	SOURCE PROGRAM FOR ZPILOT
12.10	1K	ZPILOT.COM	OBJECT OF ZPILOT.Z80
12.11	7K	ZPILOT.Z80	ZILOG MNEMONIC SOURCE OF A PILOT
				INTERPRETER.  NO DOC!!


VOLUME 13

BASIC-E/CBASIC AND MICROSOFT BASIC PROGRAMS

A VERY MIXED BUNCH.  ZOSO LAMENTS ABOUT THE
QUALITY IN HIS CHRISTMAS PLAY, COMPLETE WITH GREEK
CHORUS.  THIS DISKETTE IS A MUST FOR ANYONE WHO
MUST HAVE A COPY OF EVERYTHING.  UNFORTUNATELY
A FEW JEWELS HERE MAY BE MISSED BECAUSE OF THE
COMPANY IT KEEPS IN THIS VOLUME

THE *.ASC ARE MICROSOFT, THE *.BAS WILL (SOMETIMES)
COMPILE ON BASIC-E/CBASIC.  MANY ARE COMPATIBLE.  ALL
CAN BE SWITCHED WITH SYNTACTICAL SYNCHRONIZATION (WHO
SAID THAT??) (MY LIPS DIDN'T MOVE)

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.13	CONTENTS OF CP/M VOLUME 13
13.1	7K	15/PUZ.ASC	PROGRAM IN MICROSOFT BASIC
13.2	7K	1500.ASC	PROGRAM IN MICROSOFT BASIC
13.3	2K	23MATCH.BAS	PROGRAM IN BASIC-E/CBASIC
13.4	3K	BAGELS.BAS	PROGRAM IN BASIC-E/CBASIC
13.5	4K	BIORYME.ASC	PROGRAM IN MICROSOFT BASIC
13.6	6K	BLACKJAC.BAS	PROGRAM IN BASIC-E/CBASIC
13.7	1K	BULLSEYE.BAS	PROGRAM IN BASIC-E/CBASIC
13.8	6K	CHECKERS.BAS	PROGRAM IN BASIC-E/CBASIC
13.9	2K	CHIEF.BAS	PROGRAM IN BASIC-E/CBASIC
13.10	2K	CONVERT.BAS	PROGRAM IN BASIC-E/CBASIC
13.11	7K	DICE.BAS	PROGRAM IN BASIC-E/CBASIC
13.12	7K	KINGDOM.BAS	PROGRAM IN BASIC-E/CBASIC
13.13				DELETED
13.14	15K	NFL.BAS		PROGRAM IN BASIC-E/CBASIC
13.15	4K	ROCKET.BAS	PROGRAM IN BASIC-E/CBASIC
13.16	1K	RUSSIAN.BAS	PROGRAM IN BASIC-E/CBASIC
13.17	16K	SWARMS.BAS	PROGRAM IN BASIC-E/CBASIC
13.18	16K	SWARMS2.ASC	PROGRAM IN MICROSOFT BASIC
13.19	2K	TRAP.BAS	PROGRAM IN BASIC-E/CBASIC
13.20	6K	WUMPAS.BAS	PROGRAM IN BASIC-E/CBASIC
13.21	23K	ZOSO.2		WHEN THE REVIEW IS ABOUT TWICE AS
				LONG AS ANY OF THE PROGRAMS, I GUESS
				THE REVIEWER HAS SOMETHING ON HER/HIS
				MIND


VOLUME 14

VARIOUS CP/M UTILITIES

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.14	CONTENTS OF CP/M VOLUME 14
14.1	5K	ARTICLE		TEXT FOR SECTEST BELOW
				(DID YOU KNOW THAT THE WEST GERMAN
				GARMENT INDUSTRY GROSSES $30 BN?)
14.2	6K	BCD-DRVR	DRIVER TO CONVERT ASCII TO THAT FUNNY
				REVERSE BCD USED BY IBM 2740 TERMINALS
14.3	5K	DLDHI.ASM	HIGH PORTION OF DLOAD - SEE DOC
14.4	5K	DLOAD.ASM	PATCHES TO PUT MITS 3.2 8K BASIC UP ON
				CP/M WITH CSAVE/CLOAD TO DISK
14.5	4K	DLOAD.DOC	IMPLEMENTATION NOTES FOR DLOAD AND
				COMMENTS ON MOVE, LIST32 AND THE USE
				OF MITS 8K BASIC VERS 3.2 AFTER	PATCHING
14.6	3K	DUMP.COM	RUNNING VERSION OF DUMP BELOW, SUPPLIED
				AS DUMP.ASM CODED FOR TDL ASSEMBLER (8080 OK)
14.7	23K	DUMP.MAC	FANTASTIC DISK VIEWER PROGRAM.  CAN ADDRESS
				FILES, CP/M GROUPS OR SECTORS DIRECTLY, USES
				STANDARD CONSOLE OUTPUT, AND DISPLAYS IN DDT
				DUMP FORM WITH HEX AND ASCII SIMULTANEOUSLY
14.8	5K	LIST32.ASM	PROGRAM TO RECOVER ASCII FILE FROM INTERNAL
				STORAGE MITS 3.2 FORM - SEE DLOAD.DOC
14.9	2K	MOVE.ASM	A PIP TO TRANSFER FILES WITHOUT THE PROBLEM
				OF <CTL Z>'S IN FILES WITH NON-COM TYPE NAMES,
				SUCH AS BASIC-E/CBASIC INT FILES - SEE DLOAD.DOC
14.10	3K	PUT.ASM		USED TO LOAD A FILE AT ANY MEMORY ADDRESS, AND
				OPTIONALLY START TO RUN IT.  USEFUL FOR POKING
				ODD DRIVERS AND MONITORS INTO MEMORY FOR THOSE
				WITH NO FRONT PANEL
14.11	10K	REL1.ASM	INSTRUCTIVE RE-CONSTRUCTION OF RELOC/CPM PROGRAM
				SEE RELHOW.TXT.  NOTE THAT RELOCATION TABLE IS
				NOT INCLUDED.
14.12	9K	REL256.COM	RELOC FOR INTEGER K-100H SYSTEM
14.13	9K	REL512.COM	RELOC FOR INTEGER K-200H SYSTEM
14.14	9K	REL768.COM	RELOC FOR INTEGER K-300H SYSTEM
14.15	3K	RELHOW.DOC	IMPLEMENTATION NOTES FOR RELOCATING CP/M VERSION
				1.3 AT 100H INCREMENTS INSTEAD OF 400H AS SUPPLIED
14.16	10K	SECTEST.BAS	CBASIC PROGRAM FOR TESTING CONTEXT COMPREHENSION
				AND RECALL.  USES THE ARTICLE FILE #14.1
14.17	1K	SECTEST.DOC	BOB TELLS HOW TO USE IT
14.18	7K	SEDY.ASM	DISK PEEKING PROGRAM.
14.19	2K	SEDY.COM	COMPILATION, AS 14.18 WRITTEN FOR TDL ASSEMBLER
				(8080 OK)


VOLUME 15

UTILITIES AND NON-BASIC GAMES

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.15	CONTENTS OF CP/M GROUP VOL 15
15.1	2K	ALLOC.ASM	SOURCE OF 8.1 WITH IMPROVEMENTS TO
				ALLOW "ALLOC B:" AND GIVE DISPLAY OF
				ONLY THE USABLE PORTION OF DISKETTE
15.2	2K	BEASTIE.ASM	SOL VDM GAME FROM DR. DOBBS
15.3	8K	CHASE.ASM	SOL VDM GAME FROM DR. DOBBS
15.4	6K	DUMP.ASM	KERNL UTILITY. SEE 15.7
15.5	3K	INIT.ASM	KERNL INITIATION ROUTINE. SEE 15.7
15.6	3K	INIT2.ASM	KERNL INITIATION ROUTINE. SEE 15.7
15.7	57K	KERNL.ASM	KERNEL OF REAL-TIME INTERACTIVE
				MULTI-PURPOSE OPERATING SYSTEM FROM
				DR. DOBBS 2:8 OF SEPT 1977. ORIGINAL PER
				THE MDS IMPLEMENTATION DESCRIBED
15.8	8K	MDGCBIOS.ASM	BIOS WRITTEN IN TDL ASSEMBLER FOR
				TARBELL CONTROLLER
15.9	2K	MDGSBOOT.ASM	BOOT FOR 15.5
15.10	25K	OTHELLO.COM	RUNNING OBJECT FROM 15.11
15.11	12K	OTHELLO.FOR	FORTRAN SOURCE OF BOARD GAME
15.12	16K	PRINT3.ASM	FURTHER RE-WRITE OF 8.23 TO PERMIT COMMAND LINE
				CONTROL OF TITLES, PAGINATION AND PRINT PITCH
15.13	1K	PROC1.ASM	PROCEDURE TO OPERATE UNDER KERNL. SEE 15.7
15.14	1K	PROC2.ASM	PROCEDURE TO OPERATE UNDER KERNL. SEE 15.7
15.15	2K	PROC3.ASM	PROCEDURE TO OPERATE UNDER KERNL. SEE 15.7
15.16	1K	PROC4.ASM	PROCEDURE TO OPERATE UNDER KERNL. SEE 15.7
15.17	2K	PROC5.ASM	PROCEDURE TO OPERATE UNDER KERNL. SEE 15.7
15.18	1K	PROC6.ASM	PROCEDURE TO OPERATE UNDER KERNL. SEE 15.7
15.19	2K	PROC7.ASM	PROCEDURE TO OPERATE UNDER KERNL. SEE 15.7
15.20	1K	PROC8.ASM	PROCEDURE TO OPERATE UNDER KERNL. SEE 15.7
15.21	4K	ROMP.ASM	TARBELL TAPE LOADER AND SAVER
15.22	46K	SOLOS.ASM	SOL OPERATING SYSTEM PUBLISHED IN
				ACCESS.  COMMENTED AND INCLUDES NOTED
				PATCH TO USE AS CP/M CONSOLE
15.23	2K	TARGET.ASM	SOL VDM GAME BY GEORGE W. ROMPOT FROM
				MITS NEWSLETTER
15.24	6K	TLOAD.ASM	RE-WRITE OF 6.18 WITH DOCUMENTED
				ENHANCEMENTS
15.25	5K	TSAVE.ASM	RE-WRITE OF 6.20 WITH DOCUMENTED
				ENHANCEMENTS


VOLUME 16

ASSEMBLERS, OTHER UTILITIES AND FOCAL

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.16	CONTENTS OF CP/M GROUP VOL 16
		VOLUME16.DOC	COMMENTS ON CERTAIN PROGRAMS
16.1	9K	ASMX.COM	ASSEMBLER WHICH RECOGNIZES Z-80 OPS
				SEE VOL.DOC  [CAREFUL: WITH CORRECT
				SYNTAX (ASMX FILENAME.AAA) THIS DOES
				WORK.  WITH FAULTY SYNTAX THE PROGRAM
				TAKES REVENGE ON THE DISK DIRECTORY.]
				RUNS OK ON 8080
16.2	12K	COPYDSK.ASM	DISK COPY PROGRAM. SEE VOL.DOC
16.3	13K	COPYDSK.MAC	AS 16.2 FOR TDL ASSEMBLER
16.4	7K	CPMUTIL.ASM	CP/M SUBROUTINES USEFUL GENARALLY AND
				EMPLOYED AS PART OF Z80ASM 16.17
16.5	3K	EDIT.COM	INTEL-LIKE EDITOR. DOES L F B AND -B
				MUCH FASTER THAN ED.COM. SEE VOL.DOC
16.6	8K	EDUCATOR.ASM	8080 INSTRUCTION SET TUTOR FROM BYTE
				OF JULY 1976
16.7	57K	FOCAL.ASM	FOCAL LANGUAGE INTERPRETER. SEE VOL.DOC
16.8	8K	MACASM.COM	MACRO ASSEMBLER. SEE VOL.DOC
16.9	2K	MOVDOWN.ASM	PROGRAM TO LOAD FILE WHICH OPERATES BELOW
				100H
16.10	2K	SEEK.ASM	SET DISK TRACK FROM FRONT PANEL DURING
				ALIGNMENT
16.11	9K	SPAT1.ASM	RE-WRITE OF 1.29 TO GENERALIZE CONSOLE FROM
				ORIGINAL VDM DEPENDANCY
16.12	2K	TASMIO.DOC	DOC FOR TASMIO PATCH TO PUT TDL TAPE ASSEMBLER
				UP ON CP/M
16.13	3K	TASMIO.HEX	SEE TASMIO.DOC
16.14	18K	TASMIO.MAC	SEE TASMIO.DOC
16.15	3K	TEST1A.ASM	SUCCESSFUL TEST FOR Z80ASM 16.17
16.16	1K	TEST2.ASM	UNSUCCESSFUL TEST FOR Z80ASM 16.17
16.17	9K	Z80ASM.COM	ZILOG MNEMONIC ASSEMBLER. RUNS ON 8080. SEE
				Z80DOC.DOC 16.18
16.18	4K	Z80DOC.DOC	DOC FOR 16.17
16.19	28K	Z80MAIN.ASM	SEE 16.17
16.20	4K	Z80OPCDS.ASM	SEE 16.17
16.21	11K	Z80SUBS.ASM	SEE 16.17


VOLUME 17

UTILITIES, DENVER TINY BASIC AND NON-BASIC GAMES

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.17	CONTENTS OF CP/M GROUP VOL 17
		VOLUME17.DOC	COMMENTS ON CERTAIN PROGRAMS
17.1	13K	3DTICTAC.ASM	GAME NOT YET PATCHED TO CP/M
17.2	50K	CROROS.ASM	CROMEMCO RESIDENT OPERATING SYSTEM
				SEE VOL.DOC
17.3	16K	DENVBAS.ASM	DENVER TINY BASIC FROM DR. DOBBS
				NO CP/M I/O YET
17.4	6K	DISASM.COM	REVISION OF INTEL DISASSEMBLER
				SEE VOL.DOC
17.5	6K	DISPLAY.ASM	PART OF SPACE GAME. SEE VOL.DOC
17.6	6K	FUNCTION.ASM	PART OF SPACE GAME. SEE VOL.DOC
17.7	14K	MINOL.ASM	CORRECTED VERSION OF A TINY BASIC
				FROM DR. DOBBS
17.8	2K	NUMS.ASM	PART OF SPACE GAME. SEE VOL.DOC
17.9	25K	PROCCALC.ASM	PRO TECH DESK CALCULATOR PACKAGE. SEE
				VOL.DOC
17.10	19K	SPACE.ASM	PART OF SPACE GAME. SEE VOL.DOC
17.11	7K	Z80-OPS.ASM	Z-80 MNEMONICS RECOGNIZED BY ASMX 16.1


VOLUME 18

MATHS ROUTINES, MONITORS AND CASUAL

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.18	CONTENTS OF CP/M GROUP VOL 18
		VOLUME18.DOC	COMMENTS ON CERTAIN PROGRAMS
18.1	40K	CASUAL.ASM	CASUAL LANGUAGE FROM DR. DOBBS 1:10
				OF DECEMBER 1976, RE-WRITTEN IN INTEL
				MNEMONICS. NO CP/M I/O YET
18.2	39K	FLTARITH.ASM	SECTION 1 OF INTEL 8008 MATHS ROUTINES
				RE-WRITTEN FOR 8080. CAN STAND ALONE OR
				RUN WITH FPCONV 18.3
18.3	18K	FPCONV.ASM	SECTION 2 OF INTEL 8008 MATHS ROUTINES
				RE-WRITTEN FOR 8080. ACTS AS BINARY TO
				DECIMAL INTERFACE TO FLTARITH 18.2
18.4	39K	MATH.ASM	YALE MATHS ROUTINES
18.5	2K	MATH.DOC	COMMENTS ON MATH.ASM 18.4
18.6	24K	MILMON80.ASM	STAND-ALONE MONITOR EDITOR ASSEMBLER
				SEE VOL.DOC
18.7	46K	PROCSELF.ASM	SOFTWARE PACKAGE #1. NO CP/M I/O YET


VOLUME 19

VARIOUS UTILITIES

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.19	CONTENTS OF CP/M GROUP VOL 19
		VOLUME19.DOC	COMMENTS ON VOLUME CONTENTS
19.1	17K	ADE.ASM		ABSOLUTE DISK EDITOR. SEE VOL.DOC
19.2	6K	COPY.ASM	DISK COPY PROGRAM. SEE VOL.DOC
19.3	9K	CPM.DOC		IMSAI'S DESCRIPTION OF CP/M
19.4	21K	LINK.ASM	REMOTE COMPUTER CONTROL VIA D C HAYES
				MODEM BOARD. SEE VOL.DOC
19.5	17K	LINK73.ASM	EARLIER VERSION OF 19.4 FOR STANDARD MODEM
19.6	60K	RM80.ASM	RESIDENT PROM MONITOR. SEE VOL.DOC AND
				RM80.DOC 19.7
19.7	8K	RM80.DOC	COMMENTS ON RM80 19.6
19.8	4K	SAP.ASM		SORTS AND PACKS DIRECTORY. SEE VOL.DOC AND
				XFER 19.12
19.9	8K	SCOPY.ASM	DISKETTE COPY PROGRAM FOR SINGLE DISK SYSTEM
				SEE VOL.DOC
19.10	16K	TREAD.ASM	RM80 TAPE BACKUP UTILITY WITH 19.11
19.11	10K	TSAVE.ASM	RM80 TAPE SAVE UTILITY WITH 19.10
19.12	9K	XFER.ASM	FILE COPY PROGRAM FOR SINGLE DISK SYSTEM
				SEE VOL.DOC AND SAP 19.8


VOLUME 20

BASIC-E / CBASIC PROGRAMS
PICTURES

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.20	CONTENTS OF CP/M GROUP VOL 20
		ZOSO.20		OUR TALENTED AND MODEST REVIEWER PAYS
				TRIBUTE TO A WORTHWHILE SET OF SUBMISSIONS
20.1	8K	BLACKJAC.BAS	PROG IN BASIC-E/CBASIC. SEE ZOSO.20
20.2	8K	CIVILW.BAS	PROG IN BASIC-E/CBASIC. SEE ZOSO.20
20.3	9K	FOOTBALL.BAS	PROG IN BASIC-E/CBASIC. SEE ZOSO.20
20.4	7K	GOLF.BAS	PROG IN BASIC-E/CBASIC. SEE ZOSO.20
20.5	3K	GUNNER.BAS	PROG IN BASIC-E/CBASIC. SEE ZOSO.20
20.6	7K	LUNAR1.BAS	PROG IN BASIC-E/CBASIC. SEE ZOSO.20
20.7	9K	PINUP.PIC	PICTURE
20.8	18K	PINUP1.PIC	PICTURE
20.9	9K	POKER.BAS	PROG IN BASIC-E/CBASIC. SEE ZOSO.20
20.10	4K	SNOOPY.PIC	PICTURE
20.11	27K	STARTREK.BAS	PROG IN BASIC-E/CBASIC. SEE ZOSO.20
20.12	57K	STMASTER.BAS	PROG IN BASIC-E/CBASIC. SEE ZOSO.20
20.13	1K	STMASTER.DOC	SEE ZOSO.20
20.14	33K	STRTRK/1.BAS	PROG IN BASIC-E/CBASIC. SEE ZOSO.20
20.15	7K	TREKINST	SEE ZOSO.20
20.16	7K	TWEETY.PIC	PICTURE


VOLUME 21

MICROSOFT BASIC PROGRAMS

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.21	CONTENTS OF CP/M GROUP VOL 21
		ZOSO21.DOC	UNCHARACTERISTIC FOR ZOSO.  HE LIKES SOME
				OF THESE PROGRAMS
		ZOSO21.TOP	SAME AGAIN BUT WITH FORMATTING FOR TDL
				TEXT OUTPUT PROCESSOR.  SHAME THEY DIDN'T
				THINK TO PERMIT DISK FILE OUTPUT FOR THIS
				RUNOFF, BUT THEN PAPER TAPE IS SO MUCH BETTER!!
		TDL.HYP		UNSOLICITED TESTIMONIAL
21.1	3K	ACYDUCY.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.2	3K	APOLLO.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.3	3K	BANNER.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.4	4K	BIO.ASC		PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.5	10K	BLKFRI3.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.6	6K	BLKJK.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.7	3K	CHASE.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.8	12K	CHESS.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.9	1K	DIAMONDS.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.10	4K	ENTE.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.11	6	ENTEP.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.12	6K	FURS.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.13	6K	HORSE.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.14	8K	KING.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.15	3K	LANDER.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.16	2K	MANDALA.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.17	4K	MAZE.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.18	3K	ROCKET.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.19	3K	RUSSIAN.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.20	4K	SNOOPY.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.21	21K	STRTRK/2.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.22	20K	STRTRK/3.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.23	1K	TACOS.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.24	5K	TAXMAN.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.25	16K	TRADE.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.26	2K	TRAP.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.27	4K	W/SEARCH.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.28	3K	WARI.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP
21.29	7K	WUMP.ASC	PROGRAM IN MICROSOFT BASIC. SEE ZOSO21.DOC/TOP


VOLUME 22

MONSTEROUS STARTREK GAMES

WELL DOCUMENTED GAMES FOR MEMBERS WITH LOTS OF
MEMORY AND LOTS OF TIME

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.22	CONTENTS OF CP/M GROUP VOL 22
		ZOSO.22		DESCRIPTION AND APPLICATION NOTES
				ON THE PROGRAMS BY ZOSO AND EDISON DOGGE
22.1	48K	BIGTREK.ASC	22.3 TRIMMED TO LOAD UNDER TDL DISK BASIC
				WITH 64K MEMORY
22.2	39K	BIGTREK.BAS	COMPACTED VERSION OF 22.1 FOR MUCH FASTER LOAD
22.3	54K	STARTREK.TXT	STARTING POINT OF BIGTREK. PURPORTED TO WORK
				WITH 8K BASIC. UNFORTUNATELY LARGER INTERPRETERS
				LEAVE INSUFFICIENT MEMORY FOR PROGRAM. CONTAINS
				THE AUTHOR CREDITS.
22.4	21K	STRTRK/2.ASC	A SECOND APPEARENCE OF PROGRAM 21.21 WHICH ZOSO
				INCLUDED FOR IMPROVEMENT HINTS FOR SERIOUS
				TREKKIES WHO DON'T HAVE VOLUME 21
22.5	5K	TREKINFO.DOC	DETAILED RULES AND FEATURES OF STARTREK.TXT AND
				BIGTREK
22.6	42K	TREKMOD.ASC	BIGTREK TRIMMED SOME MORE AND ABLE TO LOAD WITH
				MICROSOFT DISK BASIC


VOLUME 23

STOIC (STACK ORIENTED INTERACTIVE COMPILER)

STOIC HAS THE CAPABILITIES OF A COMPILER, EDITOR, ASSEMBLER,
DEBUGGER, LOADER AND OPERATING SYSTEM.  IT APPEARS TO BE
CONCEPTUALLY SIMILAR TO FORTH IN THE USE OF AN EXTENSIBLE
VOCABULARY OF WORDS, WITH THE ABILITY TO "FORGET" DEFINITIONS
AND RE-DEFINE OR CREATE NEW WORDS IN TERMS OF PREVIOUSLY LEARNED
WORDS.

THE FIRST TWO MODULES, THE BOOTSTRAP AND KERNEL, WERE WRITTEN
IN ASSEMBLER MNEMONICS.  THEREAFTER THE MODULES WERE WRITTEN IN
STOIC WORDS.

THIS PACKAGE IS A STAND-ALONE SYSTEM AND DOES NOT REQUIRE A
RESIDENT FDOS, SUCH AS CP/M OR ISIS.

THE MATERIAL HAS BEEN SIGNIFICANTLY RE-ARRANGED AND REVISED SINCE THE
CATALOGS WERE FIRST PUBLISHED.  IN PARTICULAR THE KERNEL NOW INCORPORATES
WORD DEFINITIONS WHICH PERMIT DIRECT OPERATION THROUGH CP/M.
STOICCPM.DOC EXPLAINS THE PROCEDURE FOR BRINGING THE SYSTEM UP.  IT
WAS NECESSARY TO LEAVE CERTAIN FILES OFF BECAUSE OF LACK OF SPACE,
AND THESE CAN BE OBTAINED AS VOLUME 23B.  THE OVERFLOW VOLUMES WILL
ALSO BE ADDED TO A FUTURE REGULAR VOLUME, AND WERE SELECTED AS THE
LEAST NECESSARY FOR A CP/M USER.

FILES OF TYPE .STC ARE WRITTEN IN STOIC AND CAN BE LOADED AS DESCRIBED
IN THE VOLUME23.DOC

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.23	CONTENTS OF CP/M GROUP VOL 23
		VOLUME23.DOC	COMMENTS ON THIS VOLUME, ADDITIONAL
				TO STOICCPM.DOC
		STOICCPM.DOC	COMMENTS ON CP/M STOIC. READ TOGETHER
				WITH THE VOLUME23.DOC
23A.1	13K	ASSEMBL.DOC	STOIC 8080 ASSEMBLER
23A.2	8K	DICT.DOC	STOIC DICTIONARY DEFINITIONS
23A.3	8K	EDIT.DOC	STOIC DISPLAY EDITOR DOC
23A.4	9K	FILES.DOC	STOIC FILE SYSTEM DOC
23A.5	5K	FLOATPNT.DOC	FLOATING POINT DOC
23A.6	2K	INTRRUPT.DOC	INTERRUPT HANDLER DOC
23A.7	38K	KERNEL.ASM	STOIC KERNEL WITH CP/M WORDS IN 8080
				ASSEMBLER
23A.8	24K	KERNEL.DOC	STOIC KERNEL DOC
23A.9	46K	STOIC.DOC	OVERVIEW OF STOIC CONCEPTS AND STRUCTURE
23A.10	23K	STOICBAS.STC	BASIC DEFINTIONS
23A.11	4K	STOICD/A.STC	GRAPHICS FOR D/A HARDWARE
23A.12	9K	STOICEDT.STC	EDITOR
23A.13	3K	STOICFFT.STC	FAST FOURIER TRANSFORM
23A.14	8K	STOICFLE.STC	FILE SYSTEM
23A.15	11K	STOICFLT.STC	FLOATING POINT PACKAGE
23A.16	5K	STOICINT.STC	4 BYTE INTEGER ADDITION
23A.17	3K	STOICITP.STC	INTERRUPT PACKAGE
23A.18	3K	STOICMIS.STC	MISCELLANEOUS WORDS
23A.19	2K	STOICSIN.STC	INTEGER SINE AND COSINE
23A.20	2K	STOICSRT.STC	SORT ROUTINE

OVERFLOW AVAILABLE AS VOLUME 23B. THIS MATERIAL IS NOT ESSENTIAL
FOR CP/M USE, AND WILL BE AVAILABLE ON A REGULAR VOLUME AT SOME
FUTURE DATE.

23B.1	7K	BOOT.ASM	STOIC BOOTSTRAP IN 8080 ASSEMBLER
23B.2	2K	BOOT.DOC	BOOT DOC
23B.3	6K	LOAD.DOC	INFORMATION ON LOADING STOIC AS A
				STAND-ALONE SYSTEM
23B.4	13K	STOIC.COM	CP/M STOIC CONSTRUCTED AS DESCRIBED
				IN VOLUME23.DOC


VOLUME 24

CP/M UTILITIES, MACRO LIBRARIES AND RATFOR

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.24	CONTENTS OF CP/M VOL 24
		VOLUME24.DOC	COMMENTS ON CERTAIN PROGRAMS IN VOLUME
24.1	19K	DUMP.ASM	REVISION OF 14.7 TO INCORPORATE MANY
				ENHANCEMENTS, AND ASSEMBLE WITH DIGITAL
				RESEARCH MACRO ASSEMBLER, USING 24.4
24.2	3K	DUMP.COM	ASSEMBLY OF 24.1
24.3	3K	MAC40.LIB	LIBRARY OF MACROS TO CROSS-ASSEMBLE 4004/4040
				CODE USING DIGITAL RESEARCH MACRO ASSEMBLER
24.4	17K	MACRO.LIB	EXTENSIVE MACRO LIBRARY FOR USE WITH
				DIGITAL RESEARCH MACRO ASSEMBLER
24.5	3K	OPCODE.LIB	EXTENDED REGISTER OPERATION MACRO LIBRARY
				FOR DIGITAL RESEARCH MACRO ASSEMBLER
24.6	32K	RATFOR.COM	PRE-PROCESSOR TO TRANSLATE FROM THE STRUCTURED
				LANGUAGE RATFOR, DESCRIBED IN SOFTWARE TOOLS,
				TO STANDARD FORTRAN.  TYPE "RATFOR FILENAME", TO
				CREATE FILENAME.FOR FROM FILENAME.RAT
24.7	5K	TAPELIB.COM	OBJECT OF 24.9
24.8	12K	TAPELIB.DOC	DESCRIPTION OF 24.9
24.9	37K	TAPELIB.MAC	PIP-LIKE PROGRAM TO TRANSFER FILES FROM
				CP/M DISK TO TARBELL TAPE. PERMITS VIEWING
				ON CONSOLE (IF YOUR HARDWARE IS FAST ENOUGH)
				WRITTEN IN TDL MACRO ASSEMBLER
24.10	11K	XDIR.ASM	DIRECTORY PROGRAM GIVING NEAT 3-WIDE
				DISPLAY, SORTED AND WITH FILES SIZED IN K'S
				AND REPORTING CORRECT NUMBER OF FILES AND
				REMAINING DISK SPACE. USES DIGITAL RESEARCH
				MACRO ASSEMBLER AND MACRO LIBRARY 24.4
24.11	2K	XDIR.COM	OBJECT OF 24.10


VOLUME 25

VARIOUS ASSEMBLER UTILITIES

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.25	CONTENTS OF CP/M GROUP VOL 25
		VOLUME25.DOC	COMMENTS ON VOLUME CONTENTS
25.1	2K	88-MODEM.DOC	NOTES ON 25.2 BELOW
25.2	32K	88-MODEM.ASM	INTELLIGENT TERMINAL PROGRAM FOR THE IDS 88
				MODEM BOARD.  SEE DR. DOBB'S VOL 3, ISSUE 6,
				JUN-JUL 1978.
25.3	3K	BKSPACE.DOC	NOTES ON BACKSPACE HANDLING IN CP/M AND
				MICROSOFT BASIC.
25.4	4K	FRAGMENT.DOC	PAGING AND SCREEN COPY CODE FOR MEMORY MAPPED
				VIDEO BOARD.
25.5	5K	LETTER.ASM	PERSONALIZED FORM LETTER GENERATOR.  FOR MAC 
				ASSEMBLER.  OUTPUT IN DIGITAL RESEARCH TEX FORMAT.
25.6	3K	LETTER.DOC	DOCUMENTATION FOR LETTER
25.7	6K	MYMAC.LIB	MACRO LIBRARY NEEDED TO ASSEMBLE LETTER.
25.8	2K	NAMES.DAT	SAMPLE NAME FILE FOR LETTER.
25.9	9K	DCHAYES.ASM	PROGRAM IN DCHAYES MODEM MANUAL.
25.10	7K	DCHDIAG.ASM	DIAGNOSTIC FOR DCHAYES MODEM.
25.11	13K	MODEM.ASM	INTELLIGENT TERMINAL PROGRAM FOR CACHE
				COMPUTER NETWORK.
25.12	3K	MODEM.DOC	DOCUMENTATION FOR 25.11
25.13	26K	CBIOS24.ASM	BIOS FOR TARBELL DISK CONTROLLER.  SEE
				TARBELL.DOC
25.14	2K	SBOOT24.ASM	BOOT FOR TARBELL DISK CONTROLLER.  SEE
				TARBELL.DOC
25.15	26K	FBIOS24.ASM	BIOS FOR DUAL PERSCI DISK CONTROLLER.
				SEE TARBELL.DOC
25.16	2K	FBOOT24.ASM 	BOOT FOR DUAL PERSCI DISK CONTROLLER.
				SEE TARBELL.DOC
25.17	9K	COPY.ASM	USERS' GROUP 1.3 MODIFIED FOR TARBELL
				CONTROLLER.
25.18	9K	FORMAT.ASM	DISK INITIALIZE PROGRAM FOR TARBELL
				CONTROLLER.
25.19	3K	TARBELL.DOC	NOTES ON 25.13 THROUGH 25.18.
25.20	3K	NOTES.VAN	NOTES ON CP/M OPERATION AND UNDOCUMENTED
				FEATURES.
25.21	5K	CAT.ASM		MASTER DISK CATALOG SYSTEM PROGRAM.
25.22	8K	UCAT.ASM	MASTER DISK CATALOG SYSTEM PROGRAM.
25.23	5K	QCAT.ASM	MASTER DISK CATALOG SYSTEM PROGRAM.
25.24	7K	CATALOG.DOC	DOCUMENTATION FOR MASTER CATALOG SYSTEM.
25.25	13K	STOIC.COM	CP/M STOIC CONSTRUCTED AS DESCRIBED
				IN VOLUME23.DOC.
25.26	7K	BOOT.ASM	STOIC BOOTSTRAP IN 8080 ASSEMBLER.
25.27	2K	BOOT.DOC	BOOT DOCUMENTATION.
25.28	6K	LOAD.DOC	INFORMATION ON LOADING STOIC AS A
				STAND-ALONE SYSTEM.
25.29	1K	STATPCH.ASM	DEVICE NAME PATCHES FOR STAT
25.30	3K	TTYDRV.MAC	TTY DRIVERS FROM MICROSOFT FORTRAN


VOLUME 26

MICROSOFT BASIC AND FORTRAN GAMES AND UTILITIES

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.26	CONTENTS OF CP/M GROUP VOL 26
		ZOSO26.DOC	OUR REVIEWER'S COMMENTS ON VOL 26 AND 27
26.1	4K	BACCRRT.ASC	MICROSOFT BASIC GAME.  SEE ZOSO26.DOC FOR
				NOTE ON CRT DEPENDENT CODE.
26.2	14K	BASEBALL.ASC	MICROSOFT BASIC GAME
26.3	7K	BIOCAL.ASC	BIORHYTHM PROGRAM.  SEE ZOSO26.DOC.
26.4	6K	BIRTHDAY.ASC	GIVES DAY OF WEEK FOR ANY DATE
26.5	8K	BLACKJACK.ASC	MICROSOFT BASIC GAME.  SEE ZOSO26.DOC FOR
				NOTE ON CRT DEPENDENT CODE.
26.6	10K	BUDGET.ASC	BUDGET PROGRAM.  SEE ZOSO26.DOC
26.7	3K	CHASE.ASC 	MICROSOFT BASIC GAME
26.8	12K	CHESS.ASC	MICROSOFT BASIC GAME
26.9	9K	CIVILWAR.ASC	MICROSOFT BASIC GAME
26.10	6K	CLIMATES.ASC	MICROSOFT BASIC GAME
26.11	6K	CLOUD-9.ASC	MICROSOFT BASIC GAME
26.12	5K	CRAPS.ASC	MICROSOFT BASIC GAME
26.13	7K	CRAZY-8.ASC	MICROSOFT BASIC GAME.  SEE ZOSO26.DOC FOR
				NOTE ON CRT DEPENDENT CODE.
26.14	1K	GALAXY.ASC	MICROSOFT BASIC GAME
26.15	2K	GALAXY2.ASC	MICROSOFT BASIC GAME
26.16	8K	SQUARE.ASC	MICROSOFT BASIC GAME
26.17	16K	SWARMS.ASC	MICROSOFT BASIC GAME
26.18	8K	WEATHER.ASC	MICROSOFT BASIC GAME
26.19	5K	WORD-PLZ.ASC	MICROSOFT BASIC GAME
26.20	12K	OTHELLO.FOR	FORTRAN VERSION OF OTHELLO ON VOL 15.
				SEE ZOSO26.DOC
26.21	22K	OTHELLO.COM	EXECUTABLE 26.20
26.22	1K	CHAIN.ASC	PROGRAM TO COPY FROM CONSOLE TO XXX.SUB FILE.
26.23	2K	EDITM.FOR	FORTRAN IV PROGRAM.  WRITES M80 PRN FILE
				TO LST DEVICE.


VOLUME 27

MICROSOFT BASIC GAMES

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.27	CONTENTS OF CP/M GROUP VOL 27
		ZOSO27.DOC	OUR REVIEWER'S COMMENTS ON VOL 26 AND 27
27.1	6K	ANTONYMS.ASC	MICROSOFT BASIC GAME
27.2	4K	DISSAMBR.ASC	DISASSEMBLER.  SEE ZOSO27.DOC
27.3	8K	DOTS.ASC	MICROSOFT BASIC GAME
27.4	3K	DRAGRACE.ASC	MICROSOFT BASIC GAME
27.5	8K	FOOTBALL.ASC	MICROSOFT BASIC GAME
27.6	10K	GOLF.ASC	MICROSOFT BASIC GAME
27.7	2K	GREEKRTS.ASC	MICROSOFT BASIC GAME
27.8	6K	HANGMN-1.ASC	MICROSOFT BASIC GAME
27.9	6K	HANGMN-2.ASC	MICROSOFT BASIC GAME
27.10	6K	HANGMN-3.ASC	MICROSOFT BASIC GAME
27.11	3K	HIDESEEK.ASC	MICROSOFT BASIC GAME
27.12	5K	IQUEEN.ASC	MICROSOFT BASIC GAME
27.13	2K	MASTERMD.ASC	MICROSOFT BASIC GAME
27.14	5K	MAZE.ASC	MICROSOFT BASIC GAME
27.15	7K	MEMBRAIN.ASC	MICROSOFT BASIC GAME
27.16	2K	NIM.ASC		MICROSOFT BASIC GAME
27.17	7K	ROULETTE.ASC	MICROSOFT BASIC GAME
27.18	9K	SHOP.ASC	MICROSOFT BASIC GAME
27.19	4K	SNOOPY.ASC	GENERATES SNOOPY PICTURE
27.20	7K	STARTREK.ASC	MICROSOFT BASIC GAME
27.21	8K	SYNONYMS.ASC	MICROSOFT BASIC GAME
27.22	11K	BLUFF.INT	MICROSOFT BASIC GAME
27.23	12K	RUN.COM		RUN PROGRAM TO EXECUTE BLUFF.INT.  SEE
				ZOSO27.DOC
27.24	46K	MEGATREK.ASC	22.1 TRIMMED TO RUN UNDER MICROSOFT BASIC
				VERSION 4.5 IN A 63K CP/M SYSTEM
27.25	1K	MEGATREK.DOC	NOTE ON MEGATREK


VOLUME 28

BASIC-E UTILITIES AND GAMES INCLUDING A DATA BASE SYSTEM AND AN ALGOL-LIKE
LANGUAGE.  UPDATED PROGRAMS FOR THE CACHE MAILLIST.

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.28	CONTENTS OF CP/M GROUP VOL 28
28.1	6K	DATABASE.DOC	DOCUMENTATION FOR INITIAL MODULES OF 
				DATABASE SYSTEM.
28.2	6K	DBENTRY.BAS	D.B. SYSTEM FILE LOAD UTILITY
28.3	7K	DBQUERY.BAS	D.B. SYSTEM QUERY AND UPDATE MODULE
28.4	7K	DBSETUP.BAS	D.B. SYSTEM FILE INITIALIZATION MODULE
28.5	1K	INV.		SAMPLE FILE DEFINITION FOR INVENTORY DATA BASE
28.6	1K	INV.IND		SAMPLE PART # INDEX FOR INVENTORY FILE
28.7	23K	MAILLIST.DOC	UPDATED DOCUMENTATION FOR CACHE MAILING LIST 
				SYSTEM
28.8	11K	MAINT.BAS	UPDATED MAILLIST PROGRAM.  HANDLES MORE DATA
				FIELDS IN FILE.
28.9	11K	REPORT.BAS	IMPROVED MAILLIST REPORT PROGRAM.
28.10	14K	ALGOLM.COM	ALGOLM COMPILER BY LT. MARK S.
				MORANVILLE-NAVAL POSTGRADUATE SCHOOL.
				SEE PROCEEDINGS OF SECOND WEST COAST
				FAIRE, MARCH 1978
28.11	14K	RUNALG.COM	ALGOLM INT FILE INTERPRETER
28.12	9K	ALGINTRO.TXT	ALGOLM INTRODUCTION
28.13	3K	ALGSTART.TXT	ALGOLM RUN INSTRUCTIONS
28.14	2K	COMERR.TXT	ALGOLM COMPILE ERRORS DOCUMENTATION
28.15	2K	RUNERR.TXT	ALGOLM RUN TIME ERRORS DOCUMENTATION
28.16	25K	USRMAN.TXT	ALGOLM USER MANUAL
28.17	3K	ARRAY.ALG	SAMPLE ALGOLM PROGRAM
28.18	1K	BOOLINT.ALG	SAMPLE ALGOLM PROGRAM
28.19	1K	CASETEST.ALG	SAMPLE ALGOLM PROGRAM
28.20	1K	CASETWO.ALG	SAMPLE ALGOLM PROGRAM
28.21	1K	FLYTEST.ALG	SAMPLE ALGOLM PROGRAM
28.22	1K	GOTOTEST.ALG	SAMPLE ALGOLM PROGRAM
28.23	1K	HANOI.ALG	SAMPLE ALGOLM PROGRAM
28.24	2K	LUNAR.ALG	SAMPLE ALGOLM PROGRAM
28.25	2K	PERM.ALG	SAMPLE ALGOLM PROGRAM
28.26	2K	READWORD.ALG	SAMPLE ALGOLM PROGRAM
28.27	1K	RWINT.ALG	SAMPLE ALGOLM PROGRAM
28.28	1K	SIISTR.ALG	SAMPLE ALGOLM PROGRAM
28.29	2K	SORT.ALG	SAMPLE ALGOLM PROGRAM
28.30	1K	STRING.ALG	SAMPLE ALGOLM PROGRAM
28.31	1K	STRTST.ALG	SAMPLE ALGOLM PROGRAM
28.32	1K	BLKTEST.ALG	SAMPLE ALGOLM PROGRAM
28.33	1K	ONEND2.ALG	SAMPLE ALGOLM PROGRAM
28.34	1K	WFILE.OUT	SAMPLE ALGOLM PROGRAM OUTPUT
28.35	1K	WINPUT.INP	DEMO INPUT FILE FOR READWORD.
28.36	1K	RFILE.INP	DEMO INPUT FILE FOR RWINT.
28.37	1K	BLK.INP		DEMO INPUT FILE
28.38	1K	FILE1.INP	DEMO INPUT FILE
28.39	1K	FILE2.INP	DEMO INPUT FILE
28.40	4K	ADM3.MOD	MODS FOR ADM3


VOLUME 29

ASSEMBLER GAMES AND UTILITIES AND CP/M BASIC-E VERSION 1.4 FLOATING
POINT SOURCE(OBTAIN VOLUME 30 ALSO FOR COMPLETE SET)


NUMBER	SIZE	NAME		COMMENTS

		CATALOG.29	CONTENTS OF CP/M GROUP VOLUME 29
		VOLUME29.DOC	COMMENTS ON PROGRAMS ON VOLUME 29
29.1	25K	TTT.ASM		3-D TIC TAC TOE GAME
29.2	9K	CHASE.ASM	VDM/SOL GAME.  15.3 WITH CP/M I/O.  SEE
				VOLUME29.DOC.
29.3	3K	TARGET.ASM	VDM/SOL GAME.  
29.4	8K	DEFLECT.ASM	VDM GAME
29.5	8K	MUSIC.ASM	MUSIC PROGRAM
29.6	2K	MUSICP.COM	MUSIC PROGRAM WITH TABLE FOR "SOUNDS OF
				SILENCE"
29.7	12K	PIRANHA.ASM	VDM GAME
29.8	19K	ROBIN.ASM	USES POLY VTI.  SEE VOLUME29.DOC.
29.9	3K	ROBOT.ASM	VDM GAME
29.10	2K	ALLOC.ASM	DISK ALLOCATION DISPLAY.  SEE VOLUME29.DOC.
29.11	24K	EDIT.ASM	DISASSEMBLY OF 16.5.  SEE VOLUME29.DOC.
29.12	5K	SAP.ASM		SORTS AND PACKS DIRECTORY.  IMPROVED VERSION
				OF 19.8.  SEE VOLUME29.DOC.
29.13	3K	NOTATE.ASM	ADDS COMMENTS TO ASM SOURCE.  ASSEMBLE USING MAC.
				SEE VOLUME29.DOC.
29.14	1K	SYMSTACK.LIB	ASSEMBLER TIME PUSH/POP LIB FOR MAC.  SEE
				VOLUME29.DOC.
29.15	2K	NCOMPARE.LIB	CORRECTED VERSIONS OF DIGITAL RESEARCH 
				DISTRIBUTION.  SEE VOLUME29.DOC.
29.16	11K	SEQIO.LIB	CORRECTED VERSION OF DIGITAL RESEARCH
				DISTRIBUTION.  SEE VOLUME29.DOC.
29.17	1K	WHENS.LIB	MODIFICATION OF DIGITAL RESEARCH VERSIONS TO 
				ALLOW INFINITE NESTING.  SEE VOLUME29.DOC.
29.18	1K	DOWHILES.LIB	MODIFICATION OF DIGITAL RESEARCH VERSIONS TO
				ALLOW INFINITE NESTING.  SEE VOLUME29.DOC.
29.19	2K	SELECTS.LIB	MODIFICATION OF DIGITAL RESEARCH VERSIONS TO
				ALLOW INFINITE NESTING.  SEE VOLUME29.DOC.
29.20	1K	IGADD.MAC	SUBROUTINE CALLABLE FROM FORTRAN-80
29.21	1K	MON1.MAC	SUBROUTINE CALLABLE FROM FORTRAN-80
29.22	1K	MON2.MAC	SUBROUTINE CALLABLE FROM FORTRAN-80
29.23	2K	UNLOAD.ASM	CONVERTS COM FILE TO HEX.  ASSEMBLE USING MAC.
				SEE VOLUME29.DOC.
29.24	14K	FPCONV.SRC	CP/M BASIC-E FLOATING POINT CONVERSION PACKAGE
29.25	2K	FPDATA.SRC	EQUATE TABLES FOR FPCONV
29.26	8K	FPINT.SRC	INTERFACE BETWEEN INTERPRETER AND FLOATING
				POINT PACKAGE
29.27	29K	FPPKG.SRC	INTERPRETER
29.28	13K	TRAN.SRC	TRANSCENDENTAL FUNCTION PACKAGE
29.29	5K	MOVE.ASM	1 DISK MOVE PROGRAM.  ASSEMBLE USING MAC.
29.30	6K	MOVENMAC.ASM	MOVE.ASM WITH MACROS EXPANDED FOR ASSEMBLY
				USING ASM.
29.31	5K	TIMESQ.ASM	SIGN GENERATOR FOR VDM.
29.32	3K	WSYSGEN.ASM	PROGRAM TO SYSGEN A STACK OF DISKS EASILY.
29.33	1K	VDM.DOC		MODIFY ED TO PAGE 16 LINES INSTEAD OF 24.


VOLUME 30

CP/M BASIC-E VERSION 1.4 PLM SOURCE
(OBTAIN VOL 29 ALSO FOR COMPLETE SET)

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.30	CONTENTS OF CP/M GROUP VOLUME 30
30.1	2K	BASCOM.LIT	LITERAL EQUATES
30.2	39K	BASIC.PLM	VERSION 1.4 BASIC-E COMPILER MODIFIED FOR CP/M
30.3	14K	BASPAR.PLM	PARSER MODULE
30.4	54K	BASSYN.PLM	SYMBOL TABLE AND CODE GENERATOR MODULE
30.5	12K	BASIC.COM	EXECUTABLE COMPILE MODULE
30.6	66K	RUN.PLM		RUN MODULE
30.7	12K	RUN.COM		EXECUTABLE RUN MODULE
30.8	17K	BUILD.PLM	INVOKED WHEN RUN CALLED TO BUILD
				INTERNAL TABLES FROM INT FILE


VOLUME 31

TARBELL BASIC MANUAL AND ASSEMBLER SOURCE
(OBTAIN VOLUME 32 ALSO FOR COMPLETE PACKAGE)

NUMBER	SIZE	NAME		COMMENTS

31.1	2K	TBASIC.TOC	TABLE OF CONTENTS
31.2	3K	TBASIC.1	CHAPTER 1
31.3	2K	TBASIC.2	CHAPTER 2
31.4	3K	TBASIC.3	CHAPTER 3
31.5	3K	TBASIC.4	CHAPTER 4
31.6	3K	TBASIC.5	CHAPTER 5
31.7	3K	TBASIC.6	CHAPTER 6
31.8	4K	TBASIC.7	CHAPTER 7
31.9	3K	TBASIC.8	CHAPTER 8
31.10	2K	TBASIC.9	CHAPTER 9
31.11	3K	TBASIC.10	CHAPTER 10
31.12	3K	TBASIC.11	CHAPTER 11
31.13	2K	TBASIC.12	CHAPTER 12
31.14	2K	TBASIC.13	CHAPTER 13
31.15	2K	TBASIC.14	CHAPTER 14
31.16	2K	TBASIC.15	CHAPTER 15
31.17	3K	TBASIC.A	APPENDIX A
31.18	3K	TBASIC.B1	APPENDIX B PAGE 1
31.19	3K	TBASIC.B2	APPENDIX B PAGE 2
31.20	3K	TBASIC.C	APPENDIX C
31.21	2K	TBASIC.D1	APPENDIX D PAGE 1
31.22	2K	TBASIC.D2	APPENDIX D PAGE 2
31.23	3K	TBASIC.E	APPENDIX E
31.24	1K	TBASIC.H	APPENDIX H
31.25	3K	TBASIC.I	APPENDIX I
31.26	2K	TBASIC.J	APPENDIX J
31.27	1K	TBASIC.K	APPENDIX K
31.28	3K	TBASIC.IND	INDEX
31.29	3K	TBASIC.AD	PRODUCT DESCRIPTION
31.30	3K	TBASIC.CPM	SPECIAL INSTRUCTIONS
31.31	21K	TBASIC.COM	EXECUTABLE MODULE
31.32	43K	TBASICA4.ASM	SOURCE MODULE
31.33	55K	TBASICA5.ASM	SOURCE MODULE
31.34	26K	TBASICA6.ASM	SOURCE MODULE


VOLUME 32

TARBELL BASIC.  ASSEMBLER SOURCE
(OBTAIN VOL 31 ALSO FOR COMPLETE SET)

NUMBER	SIZE	NAME		COMMENTS

32.1	1K	READ.ME		NOTE FROM TARBELL ELECTRONICS
32.2	10K	RTMASM.COM	MULTI INPUT FILE ASSEMBLER
32.3	3K	RTMASM.DOC	INSTRUCTIONS FOR ASSEMBLING
32.4	26K	TBASICA1.ASM	SOURCE MODULE
32.5	47K	TBASICA2.ASM	SOURCE MODULE
32.6	53K	TBASICA3.ASM	SOURCE MODULE
32.7	19K	TBASICIO.ASM	SOURCE MODULE


VOLUME 33

SEARCH AND RESCUE PROGRAMS FROM R.A. GREGOIRE

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.33	CONTENTS OF CP/M GROUP VOLUME 33
33.1	8K	SAR.DOC		DETAILED DESCRIPTIONS OF THE SAR PROGRAMS
33.2	1K	ADDPOD.BAS	CALCULATES JOINT PROBABILITY OF DETECTION
33.3	18K	BITCASP.BAS	ENHANCED RJCASP TO USE SUMMAGRAPHICS BITPAD
33.4	22K	CAESAR.BAS	FLIGHT LOG KEEPER 
33.5	2K	CAESAR.BQ	CAESAR BRIEFING QUESTIONAIRE
33.6	2K	CAESAR.DQ	CAESAR DEBREIFING QUESTIONAIRE
33.7	4K	CAESAR.MQ	CAESAR MISSION QUESTIONAIRE
33.8	4K	CAPSERCH.BAS	GAME TO TEACH FUNDAMENTALS OF SAR
33.9	20K	CASPGAME.BAS	DEMONSTRATOR FOR BITCASP
33.10	14K	CASPPLUS.BAS	EXPANDED VERSION OF RJCASP
33.11	7K	DFELT.BAS	RE-WRITE OF N-ELT1
33.12	3K	ELTPOD.BAS	CALCULATES ELECTRONIC DISCOVERY PROBABILITIES
33.13	10K	N-ELT1.ASC	MICROSOFT BASIC VERSION - SEE 33.15
33.14	10K	N-ELT1.BAS	CBASIC VERSION - SEE 33.15
33.15	6K	N-ELT1.DOC	RADIO DIRECTION FINDING TO LOCALIZE RADIO BEACON
33.16	2K	OPT.BAS		TESTS POBABILITY OF VISUAL DETECTION
33.17	3K	RJCASP.BAS	ALLOCATION OF SEARCH RESOURCE
33.18	9K	SERCHGME.BAS	33.8 RE-WRITTEN AS STRCTURED PROGRAM
33.19	3K	VISPOD.BAS	CALCULATES VISUAL DISCOVERY PROBABILITIES


VOLUME 34

SAM76.  An interesting macro / text processing language.
Also contains (*) some utilities that the author found
useful, and which were therefore left on the disk.

"SAM76 The First Language Manual" is available, $15 postpaid,
from:   SAM76 Inc.
        Box 257 RR1
        Pennington, N. J., 08534

See Dr. Dobbs Journal #26 (Volume 3, Issue 1) for a look
at SAM76, but consider the above book as the "real" reference.

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.034	CONTENTS OF CP/M VOL. 34
34.1	1K	ABSTRACT.034	Quick look at SAM76
34.2	8K	ASTRO.FNT	Astrological signs for graphics
34.3	1K	BONUS.DOC	Function documentation
34.4	1K	BOOK.DOC	How to order SAM76 manual
34.5	1K	COPY.COM	* Disk copy program
34.6	1K	CPMSETL.COM	Part of SAM76 setup procedure
34.7	3K	DEMO.SAM	Some interesting demo programs
34.8	1K	DIRFIX.SAM	Disk directory routines
34.9	19K	EXTF.ASM	Various routines, including
34.10	1K	EXTF.DOC	..a clock driver.
34.11	1K	FRIEND.DOC	oops!! Applies to something
				not supplied on disk: a vers
				of SAM76 that runs at 8000H
34.12	2K	G.SAM		Sets up SAM for load-and-go
34.13	1K	HOOH.SAM	Hex to octal to hex
34.14	1K	IDUMP.COM	Interpreted file dump (**)
34.15	13K	ILRAW.COM	Raw copy of SAM76.  See
				READ-ME.DOC and S.DOC
34.16	10K	INFO.SAM	Creates following .DOC files
34.17	1K	INFO1.DOC	<<Empty>> ??
34.18	1K	INFO2.DOC	Misc. DOC
34.19	2K	INFO3.DOC	Misc. DOC
34.20	1K	INFO4.DOC	<<Empty>> ??
34.21	2K	INFO5.DOC	Misc. DOC
34.22	1K	KSAP.COM	* Sort and pack directory
34.23	3K	LABEL.SAM	Demo prog.
34.24	1K	LOOP.SAM	Demo prog.
34.25	1K	MOVE2.SAM	Demo prog.
34.26	1K	MULT.SAM	Multiplies long decimal #'s
34.27	5K	NEWS.SAM	Random news story generator.
34.28	10K	P1UR.FNT	Used with graphics
34.29	15K	PLOT.ASM	For graphics on Poly/TRS-80
34.30	1K	PLOT.DOC	..type board, or plotter.
34.31	7K	PRINT.SAM	Print SAM files
34.32	3K	READ-ME.DOC	One user's experiences.
34.33	2K	S.DOC		Doc on creating S.COM
34.34	1K	SIZE.SAM	Demo
34.35	1K	SIZLST.SAM	Demo
34.36	4K	SLED.SAM	Demo
34.37	4K	THREED.SAM	Demo
34.38	7K	UPD051.TXT	???
34.39	7K	UPD052.TXT	???
34.40	1K	VERIFY.SAM	Demo
34.41	6K	VOLSAM.DOC	Volume documentation
				("extended abstract")
34.42	3K	X$UTIL.SAM	Demo
34.43	4K	XD.COM		* directory lister
34.44	1K	XDIR.COM	* directory lister
34.45	1K	XM.COM		* directory lister (seems like
				an old copy of "FMAP")

**   .SAM files are not printable due to control-Z at their
start, so IDUMP was included on this disk "for the curious".
It is an hex-ascii interpreted file dump program.


VOLUME 35

FELIX - GRAPHICS ANIMATION SYSTEM - with pseudo assembler, etc.
	See ABSTRACT.35

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.035	CONTENTS OF CP/M VOL. 35
		ABSTRACT.035	Abstract of disk contents
35.1	2K	BEE.FAS		Source code for a cartoon about
					a bee and a bird.
35.2	10K	BEE#.FEX	Executable bee story, with
					background and objects.
35.3	5K	CHECKOU&.FEX	Executable checkout.
35.4	4K	CHECKOUT.FAS	Felix pseudo-machine
					diagnostic program
35.5	8K	CLEAR.ASM	Start of FELIX source code
35.6	1K	CREATE.ASM	FELIX source code	
35.7	1K	DISPONOF.ASM	FELIX source code
35.8	1K	DISTEST.FAS	Demo of distance operator,
					joystick rescaling.
35.9	5K	DISTEST&.FEX	Executable DISTANCE TEST.
35.10	11K	DISTPLUS.ASM	FELIX source code
35.11	14K	DOODLE.ASM	FELIX source code
35.12	1K	DOODLE.COM	OBJECT DRAWING UTILITY.
35.13	3K	DSKRD.ASM	FELIX source code
35.14	1K	EXEC.COM	PSEUDO-MACHINE INTERPRETER.
35.15	2K	EXEC.OBJ	The 'actual' pseudo-machine
				(loaded by EXEC.COM,TRACE.COM)
35.16	9K	EXECPLUS.ASM	FELIX source code
35.17	2K	EXECSAFE.ASM	FELIX source code
35.18	10K	FANCY#.FEX	Same as 'PAINTER&' but with a
					pretty init. background
35.19	9K	FASM.COM	PSEUDO-CODE ASSEMBLER.
35.20	1K	FCBMOV.ASM	FELIX source code
35.21	1K	FCBNEW.ASM	FELIX source code
35.22	5K	FELIX.ASM	FELIX source code
35.23	1K	FELIX.COM	INITIAL SETUP ROUTINE.
35.24	7K	FELIX.DOC	SOME DETAILS ABOUT THE SYSTEM.
35.25	3K	FELIX.OBJ	The 'actual' base routines
					(loaded by FELIX.COM)
35.26	3K	FELIXV1.CAT	Author's original volume cat.
35.27	2K	GETF.ASM	FELIX source code
35.28	2K	GETW.ASM	FELIX source code
35.29	2K	HEXOUT.ASM	FELIX source code
35.30	2K	LOADBACK.COM	Utility for getting
					backgrounds from disk.
35.31	2K	LOADOB.COM	utlity for getting objects
					from disk
35.32	5K	LOADPROG.ASM	Utility for getting (parts of)
					programs from disk.
35.33	1K	LOADPROG.COM	Object of above
35.34	2K	MUSTANG.FAS	Cowboy jumps on a horse as
					it rides by.
35.35	6K	MUSTANG&.FEX	Executable cowboy story.
35.36	15K	NUMBER.ASM	FELIX source code
35.37	3K	OBJECT.ASM	FELIX source code
35.38	1K	OBJNULL.ASM	FELIX source code
35.39	1K	PAINT.FAS	Source code for a simple paint-
					er.  Needs joysticks.
35.40	1K	PAINT.FEX	PAINTER for use with
				your own objects.
35.41	2K	PAINT.PRN	PAINT.FAS listing
35.42	6K	PAINT&.FEX	Painter for use with
					its own objects.
35.43	4K	PAINTER.FEX	Painter using 'Theta'
					(added A/D in)
35.44	6K	PAINTER&.FEX	Painter with Theta and its
					own objects.
35.45	11K	PARM.ASM	FELIX source code
35.46	3K	PATH.ASM	FELIX source code
35.47	3K	POSIT.ASM	FELIX source code
35.48	3K	PUTF.ASM	FELIX source code
35.49	3K	PUTW.ASM	FELIX source code
35.50	1K	RESCALE.ASM	FELIX source code
35.51	5K	ROTATE.ASM	FELIX source code
35.52	1K	SAPD.COM	????
35.53	2K	SAVEBACK.COM	Utility for saving backgrounds
				 	to disk.
35.54	2K	SAVEOB.COM	Utility for saving objects
					to disk
35.55	5K	SHOWSWAP.ASM	FELIX source code
35.56	4K	SINCOS.OBJ	A SIN-COS table, plus some
				routines (loaded by FELIX.COM)
35.57	1K	SPIN.ASM	FELIX source code
35.58	1K	TABLE.ASM	FELIX source code
35.59	2K	TRACE.ASM	FELIX source code
35.60	1K	TRACE.COM	Pseudo-machine interpreter
				with trace.
35.61	2K	XTRA.ASM	FELIX source code


VOLUME 36

Assemblers, editors, text processor related programs,
memory bank boot and manager, misc. utilities,
drivers for TDL software, etc.

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.036	CONTENTS OF CP/M VOL. 36
	6K	ABSTRACT.036	Abstract on some files
36.1	7K	COMBINE.ASM	Combine multiple .asm files..
36.2	1K	COMBINE.COM	..and delete comments
36.3	4K	CPM-PEN.ASM	Convert CP/M to electric..
36.4	1K	CPM-PEN.COM	..pencil files
36.5	8K	FIND.ASM	Find ASCII string in 1 or..
36.6	1K	FIND.COM	..more files
36.7	1K	FIND.DOC	DOC on above
36.8	11K	L82.COM		ML80 Component
36.9	1K	LINES.COM	Count lines in an ASCII file
36.10	1K	LINES.DOC	DOC of above
36.11	6K	LINKASM.COM	ASM.COM with feature to link..
36.12	5K	LINKASM.DOC	..files together at assembly
36.13	1K	LIST.COM	List files with starting..
36.14	1K	LIST.DOC	..line number
36.15	10K	M81.COM		ML80 Component
36.16	11K	MAC6.AZM	I/O drivers for TDL..
36.17	2K	MAC6.COM	..macro assembler
36.18	4K	MAC6.DOC	..
36.19	8K	MBMBOT.ASC	Memory bank boot & mgmt
36.20	3K	MFACCESS.LIB	Subroutine to setup for..
				..multiple files (ex: *.ASM)
36.21	2K	ML80.DOC	DOC on ML80 components
36.22	9K	ML80.REF	Reference material on ML80
36.23	3K	PEN-CPM.ASM	Electric Pencil to CP/M file..
36.24	1K	PEN-CPM.COM	..conversion program
36.25	2K	PEN-CPM.DOC	..
36.26	24K	POW.ASM		Source for text processor
36.27	5K	POWCMDS.POW	POW documentation
36.28	2K	POWTEXT.POW	More POW doc.
36.29	6K	SCRAMBLE.ASM	File encode/decode
36.30	2K	SCRAMBLE.DOC	Doc on above
36.31	17K	TED.COM		Nice CP/M text editor, with..
36.32	23K	TED.DOC		..built in help features.
36.33	10K	TOP.AZM		TDL Text output processor..
36.34	5K	TOP.PRN		..patches
36.35	3K	TOP.TOP		..
36.36	22K	XREF.ASM	Cross references .ASM files


VOLUME 37

CBASIC2 programs: (coded in comments)
(1) Comprehensive arithmetic teaching programs;
(2) CRAPS program; 
(3) some accounting programs; 
(4) parts list program
(5) Basic interpreter keyword changer (not CBASIC)

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.037	CONTENTS OF CP/M VOL. 37
	6K	ABSTRACT.037	Abstract of disk contents
37.1	3K	AREA.BAS	(1) Metric conversion in CBASIC
37.2	2K	AREA.INT	(1) INT of above
37.3	3K	CHAIN.BAS	(1) Menu program for arithmetic
					drills.
37.4	2K	CHAIN.INT	(1) INT of above
37.5	1K	COMMON1.TXT	(1) Part of arith. drill progs.
37.6	1K	COMPILE.SUB	(1) Compiles arith. drill progs
37.7	3K	CPUPARTS.BAS	(4) Data table for MANPARTS
37.8	41K	CRAPS.BAS	(2) Very complete program
37.9	1K	CRAPS.DOC	(2) DOC on above
37.10	19K	CRAPS.INT	(2) INT of above
37.11	3K	DEC1.BAS	(1) Arithmetic drill
37.12	2K	DEC1.INT	(1) INT of above
37.13	2K	DEC2.BAS	(1) Arithmetic drill
37.14	2K	DEC2.INT	(1) INT of above
37.15	3K	DEC3.BAS	(1) Arithmetic drill
37.16	2K	DEC3.INT	(1) INT of above
37.17	3K	DEC4.BAS	(1) Arithmetic drill
37.18	3K	DEC4.INT	(1) INT of above
37.19	3K	DEC5.BAS	(1) Arithmetic drill
37.20	3K	DEC5.INT	(1) INT of above
37.21	3K	DEC6.BAS	(1) Arithmetic drill
37.22	3K	DEC6.INT	(1) INT of above
37.23	3K	DECIMAL.BAS	(1) Arithmetic drill
37.24	2K	DECIMAL.INT	(1) INT of above
37.25	2K	DISK.PRN	(2) More doc on CRAPS
37.26	3K	DISTANCE.BAS	(1) Metric conversions drill
37.27	3K	DISTANCE.INT	(1) INT of above
37.28	5K	FORMULA.BAS	(1) Drill formulas, volume, etc
37.29	4K	FORMULA.INT	(1) INT of above 
37.30	3K	FRAC1.BAS	(1) Arithmetic drill
37.31	2K	FRAC1.INT	(1) INT of above
37.32	3K	FRAC2.BAS	(1) Arithmetic drill
37.33	2K	FRAC2.INT	(1) INT of above
37.34	3K	FRAC3.BAS	(1) Arithmetic drill
37.35	2K	FRAC3.INT	(1) INT of above
37.37	3K	FRAC4.BAS	(1) Arithmetic drill
37.37	2K	FRAC4.INT	(1) INT of above
37.38	4K	FRACTION.BAS	(1) Arithmetic drill
37.39	3K	FRACTION.INT	(1) INT of above
37.40	1K	GRADE.BAS	(1) Arith drill grading program
37.41	1K	HEADER.BAS	(1) %Include for drill progs.
37.42	4K	INTEGER.BAS	(1) Arithmetic drill
37.43	3K	INTEGER.INT	(1) INT of above
37.44	13K	JRNL.BAS	(3) Accounting program
37.45	9K	JRNL.INT	(3) INT of above
37.46	1K	MANPARTS.BAS	(4) Manufactured parts program
37.47	3K	NEWFRAC2.BAS	(1) Arithmetic Drill program
37.48	1K	PARTS.BAS	(4) Parts list generator
37.49	2K	PASSWORD.BAS	(5) Change BASIC keywords to
					protect your programs
37.50	3K	PERCENT.BAS	(1) Arithmetic drill program
37.51	2K	PERCENT.INT	(1) INT of above
37.52	3K	VOLUME.BAS	(1) Arithmetic drill program
37.53	2K	VOLUME.INT	(1) INT of above
37.54	3K	WEIGHT.BAS	(1) Arithmetic drill program
37.55	2K	WEIGHT.INT	(1) INT of above
37.56	3K	WHOLE.BAS	(1) Arithmetic drill program
37.57	2K	WHOLE.INT	(1) INT of above


VOLUME 38

(1) CP/M speed up utilities (and bios auto-reloc)
(2) Tarbell controller utilities

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.038	CONTENTS OF CP/M VOL. 38
	5K	ABSTRACT.038	Abstracts on some of the files.
38.1	5K	BVBOOT.ASM	(1) Boot for full sized..
				    Tarbell sys running BVIOS
38.2	28K	BVIOS.ASM	(1) Compact BIOS allowing..
				    ..Tarbell systems to not..
				    ..be 1K smaller
38.3	56K	DFOCO.ASM	(2) Double Density FOrmat and..
38.4	8K	DFOCO.COM	(2) ..COpy option for Tarbell..
38.5	20K	DFOCO.DOC	(2) ..and Delta disk cntrlrs
38.6	1K	DMSPATCH.ASM	(1) FAST patch for Digital..
				    ..Micro Systems Drives
38.7	1K	DSCUSPAT.ASM	(1) FAST patch for Discus 2D
38.8	20K	FAST.ASM	(1) Speed up transients via..
38.9	2K	FAST.COM	(1) track & dir. buffering.
38.10	3K	FASTNSTL.DOC	(1) FAST installation doc
38.11	18K	FMAN.PRN	(1) FAST operations manual
38.12	18K	MACRO.LIB	(2) Used by DFOCO
38.13	1K	MICROPAT.ASM	(1) FAST patch for Micropolis
38.14	15K	PACKUP.ASM	(1) Part of FAST
38.15	4K	REL.ASM		(1) Relocation utility source
38.16	2K	REL.UTL		(1) Relocation utility
38.17	2K	RELCPM.DOC	(1) Doc on relocation pgms
38.18	1K	RELCPM.SUB	(1) Submit file for relocations
38.19	1K	RELED.SUB	(1) Submit file for relocations
38.20	2K	RELHDR.ASM	(1) Hdr for REL.UTL
38.21	3K	RSPEED.ASM	(1) Routine to determine how..
38.22	1K	RSPEED.COM	(1) ..fast your disk reads,..
				    to set up SPEED, FAST
38.23	1K	SKEW2PAT.ASM	(1) Skew table patch for FAST
38.24	1K	SKEW3PAT.ASM	(1) Skew table patch for FAST
38.25	2K	SMAN.PRN	(1) SPEED operations manual..
				    addendum to FMAN.PRN
38.26	5K	SPEED.COM	(1) CCP replacement with
				    full track blocking etc.
38.27	3K	UTL.LIB		(1) Macro library for reloc.


VOLUME 39

MUSIC PROGRAMS:

(1) plays 3 part harmony thru the 8080 interrupt enable line!
	(Some .MUS might be incomplete - but lotsa fun here)
(2) plays 4(?) part harmony thru 8 bit DAC, uses BASIC to
    "compile" the parts.
(3) Patches for Software Technology Music, for SOL+CP/M

---->	Look out, both (1) and (2) use filetype .MUS, so watch
	the (1) and (2) to see which a particular .MUS is for.

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.039	CONTENTS OF CP/M VOL. 39
	3K	ABSTRACT.039	Abstracts on some of the files
39.1	2K	2PRTFJSB.MUS	(2) Source music score, BACH
				    2 part invention
39.2	4K	2PRTFJSB.NOT	(2) "Compiled" score
39.3	4K	AIR.MUS		(1) Source music score
39.4	1K	ALLEGRO.MUS	(1) Source music score
39.5	1K	AMERICA.MUS	(1) Source music score
39.6	3K	ARIA.MUS	(1) Source music score
39.7	2K	AWAVE.BAS	(2) Wave form generator
39.8	2K	AWAVE.INT	(2) INT of above
39.9	1K	BOOGIE.MUS	(1) Source music (diddling)
39.10	2K	BOUREE.MUS	(1) Source music score
39.11	1K	BREEZ.MUS	(1) Source music score
39.12	2K	CALIOPE.MUS	(1) Source music (Super!)
39.13	1K	CHOPS.MUS	(1) Source music score
39.14	3K	CHORALE.MUS	(1) Source music score
39.15	1K	DAISY.MUS	(1) Source music score
39.16	1K	ENTER.MUS	(1) Source music (Partial)
39.17	1K	FIX.SUB		(2) To remove (") from music
				    ..BASIC "compiled" output.
39.18	3K	HUSTLE.MUS	(1) Source music score
39.19	1K	IRISH.MUS	(1) Source music score
39.20	2K	LAWRENCE.MUS	(1) Source music score (Arabia)
39.21	3K	LVBMIN.MUS	(2) Source music score
39.22	7K	LVBMIN.NOT	(2) Compiled score
39.23	2K	MAPLE.MUS	(1) Source music score
39.24	1K	MARINE.MUS	(1) Source music score
39.25	3K	MINWALZ.MUS	(1) Source music (L-uuuv it)
39.26	1K	MRIVER.MUS	(1) Source music score
39.27	5K	MUSIC.COM	(1) Executable code
39.28	13K	MUSIC.DOC	(1) Doc incl how to put..
				    hardware on your micro
39.29	14K	MUSIC4.ASM	(2) The music driver program
39.30	2K	MUSIC4.COM	(2) COM of above
39.31	2K	MUSIC4.DOC	(2) Doc on MUSIC4
39.32	3K	MUSPAT.DOC	(3) DOC on following:
39.33	7K	MUSPAT.HEX	(3) HEX patch file
39.34	2K	MYLIFE.MUS	(1) Source music score
39.35	3K	NOTES.BAS	(2) Tune constructing program
39.36	2K	NOTES.INT	(2) INT of above
39.37	1K	PIC.MUS		(1) Source music score
39.38	3K	PRELUDE.MUS	(1) Source music score
39.39	1K	PUR2MIN.MUS	(2) Source music score
39.40	3K	PUR2MIN.NOT	(2) Compiled score
39.41	3K	REMOV".ASM	(2) Remove (") from a file
39.42	1K	REMOV".COM	(2) COM of above
39.43	1K	ROLLING.MUS	(1) Source music score
39.44	2K	SARABAND.MUS	(1) Source music score
39.45	2K	SMALL.MUS	(1) Source music score
39.46	3K	SPREAD.MUS	(1) Source music (Interesting,
				    obscure, New Orleans jazz)
39.47	2K	STARWARS.MUS	(1) Source music score
39.48	2K	TINSOLD.MUS	(1) Source music (a start...)
39.49	2K	WALK.MUS	(1) Source music (Terriffikk)
39.50	1K	WAVES.MUS	(2) Source music score
39.51	3K	WHATI.MUS	(1) Source music score
39.52	3K	WIERD.MUS	(1) Source music score
39.53	2K	YANKEE.MUS	(1) Source music score (good!)


VOLUME 40

Various utilities, disk cataloging system, modem programs.

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.040	CONTENTS OF CP/M VOL. 40
		ABSTRACT.040	Abstract on some of the files.
40.1	1K	/.COM		Quickie submit; Example:
40.2	1K	/.DOC		/ asm foo.bbz;load b:foo
40.3	1K	ALLOC.COM	Prints bit map of disk usage..
40.4	1K	ALLOC.DOC	..(update of prev 1.3 only one)
40.5	37K	BOOTER.ASM	Pascal boot for Tarbell & Delta
40.6	1K	CAT.COM		Part of master cataloging sys.
40.7	1K	CAT2.COM	Part of master cataloging sys.
40.8	5K	CATALOG.DOC	Doc on master cataloging system
40.9	1K	CK-FIX.COM	File checksum program
40.10	1K	CK-FIX.DOC	DOC on above
40.11	4K	COMPARE.ASM	See if two files match exactly
				(Uses MAC and MAC's SEQIO)
40.12	2K	COMPARE.COM	COM of above 'cause many macros
40.13	8K	CV.ASM		Split screen VDM 2 file compare
40.14	1K	CV.COM		..(requires MAC for assembly)
40.15	1K	CV.DOC		DOC on above
40.16	1K	D.COM		Shows what files are different
40.17	1K	D.DOC		..on a disk from some prev time
40.18	14K	DI.ASM		Directory listing program.
				(req's MACRO.LIB from disk 38)
40.19	2K	DI.COM		COM of above
40.20	26K	DU.ASM		Disk utility: scan, patch, etc.
40.21	4K	DU.COM		COM of above.
40.22	1K	DU.DOC		DOC of above
40.23	1K	EJECT.ASM	"EJECT n" pages on CPM list dev
40.24	1K	FMAP.COM	File map (standalone, and part
40.25	1K	FMAP.DOC		of cataloging system)
40.26	9K	HEXDUMP.ASM	Binary to Hex (RequiresTDL asm)
40.27	1K	MAST.CAT	Sample master catalog
40.28	40K	MODEM4.ASM	Checksummed blocked file xfer
40.29	7K	MODEM4.DOC	DOC on above.  PMMI/Hayes/serl
40.30	3K	NSBOOT.ASM	Boot for National Semi 8221
40.31	12K	NSCBIOS.ASM	CBIOS for National Semi 8221
40.32	3K	PBOOT.ASM	Pascal boot loader for Tarbell
40.33	5K	PGEN.ASM	Boot mods for 512 long sectors
40.34	17K	PMMIBYE3.ASM	Dial in remote console prog.
40.35	7K	SPASCAL.DOC	Sam Singer's PASCAL mods
40.36	2K	UCAT.COM	Update catalog program
40.37	3K	VDMSAVE.ASM	Write VDM lines to a file


VOLUME 41

(1) Ham radio programs
(2) Chess program
(3) VDM Pong program
(4) Fortran least squares curve fitting program

NUMBER	SIZE	NAME		COMMENTS


		-CATALOG.041	CONTENTS OF CP/M VOL. 41
	   	ABSTRACT.041	Abstracts on some files
41.1	12K	BMAINT.BAS	(1) Ham maillist maint. BASIC/E
41.2	12K	BREPORT.BAS	(1) Ham maillist report
41.3	26K	CHESS.COM	(2) COM of 41.5
41.4	2K	CHESS.DOC	(2) DOC on chess program
41.5	24K	CHESS.FOR	(2) Cromemco Z-80 Fortran Chess
41.6	2K	CODE.BAS	(1) Simple Morse code receiver
41.7	3K	HAMPROGS.DOC	(1) Doc on BMAINT, BREPORT,
				    RTTY, etc.
41.8	2K	LABELS.BAS	(1) Print return labels
41.9	6K	MOONLOC.DOC	(1) Doc on 41.10-41.13 which
41.10	3K	MOONLOC1.BAS	    are various versions of
41.11	3K	MOONLOC2.BAS	    programs to locate the
41.12	7K	MOONLOC3.BAS	    moon's position to do
41.13	5K	MOONLOC5.BAS	    moon bounces
41.14	8K	MORSE.ASM	(1) Morse send/receive prog.
41.15	7K	PONG.ASM	(3) PONG for the VDM (re-
				    release of CP/M U.G. 6.9)
41.16	8K	PRACTICE.ASM	(1) Morse code teacher
41.17	2K	RANDTEXT.BAS	(1) Generate text for 41.16
41.18	2K	RESIZE.DOC	(1) Part of ham maillist system
41.19	5K	RESIZE2.BAS	(1) Part of ham maillist system
41.20	5K	RESIZE3.BAS	(1) Part of ham maillist system
41.21	26K	RTTY.ASM	(1) RTTY send receive program
41.22	12K	SSPLIB.FOR	(4) Curve fitter/simultaneous
				    linear equation solver.
41.23	10K	TEACH.ASM	(1) Morse Code teaching prog.
41.24	9K	TTY.ASM		(1) Baudot-coded-ASCII to ASCII
41.25	5K	TTYR.ASM	(1) Variation of 41.24
41.26	5K	TTYR1.ASM	(1) Variation of 41.24
41.27	5K	TTYX.ASM	(1) Xmit ASCII via conversion
				    to Baudot-coded-ASCII


VOLUME 42

(1) Disassemblers; 
(2) Diablo Driver;
(3) Clock routines;
..and much more

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.042	CONTENTS OF CP/M VOL. 42
	   	ABSTRACT.042	Abstracts on some of the files
42.1	9K	BIDI.ASM	(2) Bidirect. diablo driver
42.2	3K	CLKROM.ASM	(3) Computime(R) routines
42.3	1K	CT82.COM	SWTPC CT82 initializer
42.4	6K	CT82.Z80	TDL Z-80 source for above
42.5	44K	DIS.ASM		(1) TDL Z-80 Disassembler
42.6	5K	DIS.DOC		(1) Doc on above
42.7	3K	HOW2BS.DOC	Put backspace into your BIOS
42.8	2K	INIT.TEL	ZTEL-CT82 routines
42.9	17K	LIFE8.ASM	Fast, comprehensive life..
42.10	3K	LIFE8.COM	..program for the VDM
42.11	2K	LIFE8.DOC	Doc on above
42.12	27K	MNEMONIC.ASM	Memory test (look up MNEMONIC
				in your dictionary)
42.13	7K	NBIOS.ASM	BIOS for TEI CP/M
42.14	4K	PTSRCNVT.ASM	Proc. Tech. Pkg. 1 or ALS-8..
42.15	2K	PTSRCNVT.COM	..to CP/M file conversion..
42.16	2K	PTSRCNVT.DOC	..program
42.17	13K	QUOTES.PRN	Words of wit and wisdom re-
				lated to computers.
42.18	6K	RESOURCE.COM	(1) Conversational disassembler
42.19	26K	RESOURCE.DOC	(1) Doc on above
42.20	5K	START.ASM	Compucolor 8001 initializer
42.21	1K	START.COM	COM of above
42.22	2K	T.ASM		(3) Print time on..
42.23	1K	T.COM		    ..console
42.24	3K	TIME.ASM	(3) Compu-time (R) routine
42.25	2K	TIME.BAS	(3) Time display in MBASIC
42.26	5K	TIMESET.BAS	(3) Time set/read in MBASIC
42.27	25K	XT.ASM		(3) List to printer with..
42.28	2K	XT.COM		    ..time/date stamp
42.29	1K	XYZZY.COM	[[Type it and see]] (if you
				don't know "Adventure", you
				won't understand)




VOLUME 46	 10/24/80

DESCRIPTION: CP/M utilities.

NUMBER	SIZE	NAME		COMMENTS

	 2K	CATALOG.46	CONTENTS OF CP/M VOL. 46
46.1	11K	ABSTRACT.046	Volume abstracts
46.2	11K	CPM-FDOS.ASM	CPM to ICOM FDOS II transfer
46.3	17K	CPMLABEL.BAS	Make CPMUG disk labels
46.4	 0K	DELETED	
46.5	 5K	CPMLABEL.DOC	DOC on above
46.6	 8K	CRCK3.ASM	Full 16 bit CRC a file
46.7	 1K	CRCK3.COM	COM of above
46.8	16K	DU-8/12.ASM	Disk dump/patch, supports
				many controllers.
46.9	29K	DU-V61.ASM	Later version of CPMUG 40.20,
				single density only
46.10	 2K	DU/MAP.DOC	Doc. on CP/M directory format
46.11	 6K	FDOS-CPM.ASM	ICOM FDOS II to CP/M transfer
46.12	10K	MDIR8/17.ASM	Fancy directory list program,
46.13	 1K	MDIR8/17.COM	CP/M 1.4 (or 2.X, all users)
46.14	 6K	MLIST3.ASM	Type multiple files with lots
				of disk buffering
46.15	20K	PLINK823.ASM	Send/Rcv to memory via modem
46.16	22K	PMMIBYE5.ASM	Remote console program,
46.17	 3K	PMMIBYE5.DOC		update of 40.34
46.18	 2K	PTSRCNVT.COM	Convert Proc. Tech to CP/M ASM
46.19	 2K	PTSRCNVT.DOC	DOC on above
46.20	 7K	RETDL.COM	Disassembler to TDL mnemonics,
				modification of 42.18
46.21	13K	SURVEY3.ASM	Maps system memory/port usage
				as well as disk stat.
46.22	 1K	SURVEY3.COM	COM of above
46.23	20K	XD-7/4.ASM	Fancy directory list program
46.24	 2K	XD-7/4.COM	COM of above

		U-G-FORM.LIB	CPMUG submission form





VOLUME 47

DESCRIPTION:	CP/M Utility Disk. *

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.47	CONTENTS OF CP/M VOL. 47
47.1	7K	ABSTRACT.047	Abstracts and reviews.
47.2	10K	BMAP7/11.ASM	Bit Map program.
47.3	22K	COPYFAST.ASM	Revision of Tarbell's COPY.ASM.
47.4	2K	COPYFAST.COM	COM of above.
47.5	18K	CYBER.ASM	Bob Van Valzah's Modem program
				with buffering to Diablo Hytype.
47.6	22K	DIAL6/23.ASM	Modem program with autodial for PMMI.
47.7	2K	DIAL6/23.DOC	DOC of above.
47.8	8K	DIRS9/8.ASM	Sorted directory program.
47.9	3K	FLIP3.ASM	Flips Answer/Originate mode
				under BYE.COM.
47.10	14K	MODEM.LIB	Maclib library for MODEM7.
47.11	43K	MODEM7.ASM	Latest and greatest revision of
				Ward's "universal" MODEM.ASM.
47.12	8K	MODEM7.COM	COM of above.
47.13	16K	MODEM7.DOC	DOC of above.
47.14	3K	MODEM7.SET	Instructions for patching COM file
				if you don't have MAC*.
47.15	13K	PROM.ASM	Promburner program for the SSM PB1.
47.16	7K	UCOPY.ASM	Bob Van Valzah's version of the
				Tarbell COPY program.

* MAC and CP/M are trademarks of Digital Research, Pacific Grove, CA.





VOLUME 48	National CP/M Users Group
		(CP/M is a trademark of Digital Research, Inc)

DESCRIPTION:	The BDS C Sampler Disk
		November 29, 1980

	Compiled by Leor Zolman, BD Software

-  Manual for BDS-C to give you a "flavor" of the compiler
-  Good programming examples in C
-  Interesting games to play
-  Good use of H19-H89 (Programs with <H> are H19-H89 only)

Most files are included in .COM form to allow you to execute
them without having BDS-C.  Be careful of RALLY.COM as it needs
to do hard-coded I/O to detect console OUT status.

NUMBER	SIZE	NAME		COMMENTS

	 3K	-CATALOG.048	CONTENTS OF CP/M VOL. 48
	 6K	ABSTRACT.048	Abstracts of the programs
48.1	17K	BDS-C.DOC	BDS-C users manual (*)
48.2	 7K	BDSCIO.H	The standard library used to
					compile the programs
48.3	 8K	BUGS.C		<H> makes things crawl
48.4	11K	BUGS.COM		around on your screen
48.5	 9K	HLIFE.C		<H> H19/H89 version of 48.9
48.6	 8K	HLIFE.COM	<H> 	"	"	".10
48.7	13K	HSTONE.C	<H> "Awari" game program -
48.8	12K	HSTONE.COM	"	"
48.9	 9K	LIFE.C		Good implementation of Conway's
48.10	 8K	LIFE.COM		LIFE algorithm
48.11	 5K	MM.C		Mastermind interesting guessing
48.12	 7K	MM.COM			game.  Try it and see
48.13	11K	OTHELLO.C	Game program
48.14	12K	OTHELLO.COM	  "
48.15	 7K	PPONG.C		<H> "Polish Pong" bounce the
48.16	 7K	PPONG.COM		ball off "/" and "\"
48.17	 8K	PRESSUP.C	Game program
48.18	 8K	PRESSUP.COM	"	"
48.19	 1K	R2.MAP		<H> map for rally game
48.20	10K	RALLY.C		<H> road rally arcade game
48.21	10K	RALLY.COM	<H> .COM of 48.20, but...
		========= --->	Caution!! Hard-coded I/O req'd
48.22	 2K	RALLY.MAP	<H> another map for 48.21
48.23	10K	STONE.C		"Awari" game with "very smart
48.24	 9K	STONE.COM		computer" opponent
48.25	 2K	TABIFY.C	Turn multiple spaces into
48.26	 6K	TABIFY.COM		proper CP/M tabs
48.27	 7K	TTT.C		Tic-Tac-Toe that "exhaustively"
48.28	 6K	TTT.COM			tests for best move
48.29	 3K	VOLUME48.DOC	Leor's own comments

(*) The original was 22K, but "TABIFY" deleted 5K of spaces!!





VOLUME 49

DESCRIPTION:	FORTRAN, RATIONAL FORTRAN PROGRAMS.
		CDOS ROUTINES FOR CP/M.

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.049	CONTENTS OF CP/M VOL. 49
49.1	4K	4FDCBIOS.DOC	Files for running CP/M 2.0+
49.2	2K	4FDCBIOS.HEX
49.3	13K	4FDCBIOS.Z80	  on CDOS systems using this
49.4	1K	4FDCBOOT.HEX
49.5	2K	4FDCBOOT.Z80	  BIOS and BOOT.
49.6	11K	ABSTRACT.049	Abstracts of the files on this
				disk.
49.7	1K	ASMDEF.RAT	Used by LCAT, part of RATFOR.
49.8	6K	ASTRO.FOR	FORTRAN Astronomy program.
49.9	10K	CDOS.DOC	Comments on CDOS features.
49.10	2K	CDOSCOPY.COM	Full disk copy program
49.11	2K	CDOSCOPY.DOC	  for CDOS systems,
49.12	4K	CDOSCOPY.HEX	  single or double
49.13	26K	CDOSCOPY.PRN	  density, and single
49.14	12K	CDOSCOPY.Z80	  or double sided.
49.15	1K	CONSTS.RAT	Definitions of some frequently
				used constants (RATFOR).
49.16	1K	F77.DOC		FORTRAN 77 Documentation.
49.17	1K	F77DEF.RAT	FORTRAN 77 Functions.
49.18	2K	F77LIB.FOR	Definitions of some intrinsic
				FORTRAN 77 functions.
49.19	3K	FILTER.Z80	Source code for emulating CDOS
49.20	1K	FILTER.HEX	  calls under standard CP/M.
49.21   6K	FILTER2.Z80	Modified version of FILTER
49.22	1K	FILTER2.HEX	  (above)
49.23	2K	INDEX.Z80	RATFOR Subroutine.
49.24	1K	INDEXT.FOR	Test for INDEX.Z80.
49.25	1K	IOER.Z80	Used by LCAT (RATFOR).
49.26	1K	LCAT.DOC	Used to concatenate Microsoft
49.27	3K	LCAT.RAT	  .REL files.
49.28	2K	MINV.DOC	Matrix Inversion Determinant
49.29	3K	MINV.FOR	  Calculator, FORTRAN and
49.30	3K	MINV.RAT	  RATFOR source code.
49.31	2K	RATCOMNS.RAT	Used by RATFOR.
49.32	3K	RATFOR.DOC	Documentation of RATFOR.
49.33	40K	RATFOR.FOR	FORTRAN source code for RATFOR.
49.34	25K	RATFOR.RAT	RATFOR source code for RATFOR.
49.35	17K	RATFOR.REL	Microsoft .REL file, does not
				include library routines.
49.36	1K	READLB.Z80	Subroutine for SCOPY (RATFOR).
49.37	1K	RFG.CMD		CDOS equivelent of a submit
				file. (^=$).
49.38	1K	SCOPY.DOC	Direct Disk I/O (RATFOR).
49.39	2K	SCOPY.FOR	  FORTRAN source code.
49.40	1K	SORTI.DOC	Quicksort program (RATFOR).
49.41	2K	SORTI.FOR	  FORTRAN Source code.
49.42	3K	SORTI.RAT	  RATFOR Source code.
49.43	1K	TRNSLT.Z80	Used by RATFOR.

NOTE:  Most of the FORTRAN files on this disk will run on
Z-80 processors only, some will run only with Cromemco CDOS.
Check the abstracts and .DOC files for more details.





CP/MUG: VOLUME 50

DESCRIPTION:	Bob Van Valzah's "Pascal Pascal Compiler" & a
		few miscellaneous programs for printing via UNIX.

NUMBER	SIZE	NAME		COMMENTS

		-CATALOG.050	CONTENTS OF CP/M VOL. 50
		UGFORM.LIB	SUBMITTAL FORM

50.1	1K	A.OCO		Sample program, eight queens
				problem, ready to be
				linked to RTP.COM (OCO=obj code)
50.2	1K	A.PCO		Sample program P-code, ready
				for PFET.COM		
50.3	5K	ABSTRACT.050	Abstracts for this volume.
50.4	2K	COMPARE.COM	Vital program for
				compiler writers.
50.5	2K	CPMDIR.C	Prints CP/M DIR on UNIX.
50.6	2K	CRCK.COM	CRC program for validating
				files on this disk.
50.7	2K	CRCKLIST.CRC	CRC list of files on this disk.
50.8	3K	DISK.DOC	Bob's comments.
50.9 	3K	EQ.COM		Prints all solutions to the
50.10	2K	EQ.PAS		   eight queens problem.
50.11	5K	FROMCPM.C	Print CP/M file via UNIX stdout.
50.12	1K	FWD.PAS		Forward Procedure Declarations.
50.13	6K	HW5.COM		Builds optimal binary search
50.14	15K	HW5.PAS		   tree & decodes a message.
50.15	1K	HW5DATA.	Sample data for above program.
50.16	6K	PASYNTAX.DOC	Syntax graphs for PPC compiler.
50.17	1K	PC.SUB		Submit file to compile a PPC
				   program.
50.18	7K	PFET.COM	Object code of Pcode to 8080
				   translator.
50.19	11K	PFET.PAS	Source of above.
50.20	1K	PHONE.C		C program to print words you
				   can spell with your phone #.
50.21	1K	PLAYDATA.	Sample data for above program.
50.22	13K	PLAYKAL.PAS	PPC program to determine best
				   moves in game of Kalah.
50.23	2K	POPS.DOC	DOC for Pcodes used by PPC.
50.24	1K	POWTWO.PAS	PPC Program to print negative
				   powers of two.
50.25	16K	PPC.COM		Pascal Pascal Compiler.
50.26	10K	PPC.DOC		DOC for above file.
50.27	26K	PPC.PAS		Pascal source for above file.
50.28	2K	PSTACK.DOC	DOC on run-time P-machine stack.
50.29	3K	REGEN.DOC	Notes on how to modify & compile
				   PPC.PAS.
50.30	11K	RTP.ASM		Source for run-time package.
50.31	2K	RTP.COM		Object of above.
50.32	1K	STIRLING.PAS	Prints a table of Stirling
				   Numbers.
50.33	4K	TESTER.PAS	Tests functionality of PPC.
50.34	1K	VALIDATE.SUB	Submit file to make sure you
				   have a "fertile" computer.





VOLUME 51	The CP/M Users Group

DESCRIPTION: STAGE2 MACRO PROCESSOR

By:	Dick Curtiss			
	843 NW 54th
	Seattle, WA 98107

<<Congratulations to Dick for a superb User's group contribution: A major
  work, well documented, good examples, a good reference book, etc.>>

STAGE2 is a macro programming language, documented
sufficiently on this disk to effectively use it.  Examples
given include a library of extensions for assembler
programming, (ALX) including WHILE, REPEAT, IF, BRANCH (a CASE
statement), etc.  STAGE2 is a general-purpose text-replacement
processor, not limited to programming language applications.
Those interested in transporting it to other machines, or in
studying its background and implementation will want to
purchase:

	"Software Tools for Non-Numeric Applications"

    by: Wm. M. Waite

  from: Prentice Hall, Inc.

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.051	CONTENTS OF CP/M VOL. 51
51.1	2K	ABSTRACT.051	Overview of volume
51.2	16K	ALX.S2M		Assembly Language Extension macros
51.3	3K	ALX-.DOC	Doc on above
51.4	3K	ALXTEST.ALX	Sample macros to test above, including
		ALXTEST.ALX		errors to be detected.
51.5	4K	CIO.ALX		Console I/O routines in ALX
51.6	2K	CRCK.COM	Keith Petersen's program to CRC check files
51.7	1K	CRCKLIST.CRC	Contains the CRCs for all files on this
					disk. (except itself)
51.8	2K	DEMO.S2M	Interactive STAGE2 demo macros.
51.9	17K	DISKIO2.SRC	(*) disk I/O for STAGE2 processor
51.10	6K	DISKIO2-.DOC	(*) DOC on above
51.11	5K	FLD1.DAT	(*) Sample data for FLUB test
51.12	4K	FLD2.DAT	(*) 		"
51.13	13K	FLT1.FLB	(*) Sample program for FLUB test
51.14	11K	FLT2.FLB	(*)		"
51.15	1K	FLUB$.SUB	(*) Submit file for FLT1, FLT2, STG2.
51.16	4K	FLUB8080.S2M	(*) Macros to turn FLUB into 8080 asm
51.17	3K	HELP.DOC	First-timer's "to do" list.
51.18	2K	IMPL.DOC	(*) Notes on implementing STAGE2
51.19	2K	INTERACT.S2M	Another macro demo.
51.20	22K	INTRO.DOC	Sufficient info to "read" STAGE2 macros,
					and with diligence, write them.
51.22	1K	IOOP$.SUB	(*) submit file for macro pass + asm of above
51.21	16K	IOOP.SRC	(*) I/O processor 8080 source
51.23	1K	MEMORY.INP	Another macro demo.
51.24	2K	ST2T.DAT	(*)
51.25	12K	STAGE2.COM	The executable macro processor itself.
51.26	48K	STG2.FLB	(*) Source for STAGE2 in FLUB code
51.27	5K	STG2MATH.ASM	(*) STAGE2 support routines
51.28	5K	STG2SUP.ASM	(*)		"
51.29	8K	TERM.ALX	Sample 8080 terminal program w/ALX macros.
51.30	3K	TERMSUP.ASM	Subroutines for TERM.ALX
51.31	2K	USE.DOC		How to execute STAGE2.
51.32	6K	VDB.ALX		TDL video driver in ALX, a "state machine".
51.33	5K	VOLUME51.DOC	Dick Curtiss' own excellent documentation.

(*)	Files are necessary only to change STAGE2.

NOTE:	Included on this volume for the first time, is a file
	of CRC's for each file.  Thus people that are concerned that
	a copy went wrong somewhere, can check the CRC of the
	file, and compare it to the one stored in CRCKLIST.CRC.

	Thanks to Keith Petersen for this excellent program.




SOURCE.COM	(1) Conversational disassembler
42.19	26K	RESOURCE.DOC	(1) Doc on above
42.20	5K	START.ASM	Compucolor 8001 initializer
42.21	1K	START.COM	COM of above
42.22	2K	T.ASM		(3) Print time on..
42.23	1K	T.COM		    ..console
42.24	3K	TIME.ASM	(3) ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГCRCK.COM 4.2 10/6/80!  9"1Нd:] ю ВLН§++NO FILE NAME SPECIFIED++
$НWCRCK ver 4.2
CTL-S pauses, CTL-C aborts
 :m 2ІюFВ~ГЇ CRCKLIST$$$ Н–°ГшН–жД‚yж0°  –Г4х*«л*­}“|љЪ$!  "­л*«{•zњТ*©лН €Н ·ВхЂ *­"­ГЗ	Н сГ
DISK FULL: CRCFILE$Ђ Н !  "­л*©лс*­#"­ЙЇ2”2Ё!  "«!  "­€Н €Н <В~	fН Г
NO DIR SPACE: CRCFILE$1НЉТF:¶·К¤Н:++FILE NOT FOUND++$:ІюFВ<*­}жВё"«>хНІсВ¬€Н <Вр	ЩН Гр
CANNOT CLOSE CRCFILE$Г CRCKLISTCRC 
DISK FULL: CRCFILуН Г3е 	w#В$СН Й!€уНН§
DONE$!e Н К~!] w Н/!e Ђ Н/НW
--> FILE:  XXXXXXXX.XXX		CRC =  \ Н <В«Н:++OPEN FAILED++$!  "і! "П*П|ю КвН ·КУН юК@\ Н ·Вр!Ђ ~2µ#"ПН#Г·юВ:ґН@> Нk:іН@НdГ~Н:++FILE READ ERROR++$*і|жЂх):µ…oсК<|о g}о—o"іЙхНIсжю
ЪRЖЖ0Гkг~Нk#~·ВXгЙ>Нk>
ЕХеж_ХНСН бСБЙ:ІюFА{НІЙЂ Н Ї2h 2| :¶·КЙ!\ · Н/:\ 2Г!·\  Н/\ Н Гс!Г\  Н/\ Н !·\  Н/\ Н <7И=ж‡‡‡‡‡ЖЃo& еД Н/б]  Н/Ї2h 2| 2¶ЙН(АН(А~жю$#Й~#x±В/ЙС	Н :ІюFВ”*­}жВT"«>хНІсВH€Н <ВЊ	uН ГЊ
CANNOT CLOSE CRCFILE$€Н Н§

++ABORTED++$С	Н *щЙ                                                                             :  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
--> FILE:  CCP     .ASM		CRC = 9C FE

--> FILE:  U-G-FORM.LIB		CRC = FD 46

--> FILE:  CRCK    .COM		CRC = 2D 47

--> FILE:  CPMLIB  .DOC		CRC = D3 20

--> FILE:  TEXTED  .DOC		CRC = 55 ED

--> FILE:  EDIT    .MAC		CRC = D7 03

--> FILE:  ED111   .COM		CRC = 83 CC

--> FILE:  ED111   .ASM		CRC = AF D9

--> FILE:  HELP    .MAC		CRC = 9A 98

--> FILE:  ED111   .IMP		CRC = 9B 73

--> FILE:  UK2     .DOC		CRC = 5B 71

--> FILE:  -CATALOG.02-		CRC = 97 8C
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;CP/M TEXT EDITOR
;
BDOS EQU 5
BOOT EQU 0
CR EQU 0DH
LF EQU 0AH
;
ORG 100H
BEGIN:	JMP START
SIGNON:	DB CR,LF,'CP/M EDITOR, D.R.BACK VERSION 1.2',CR,LF,0
BRKMS:	DB CR,LF,'*BREAK*',CR,LF,0
BBMS:	DB ':BB: '
SWCH:	DB 1FH
	DB 0FFH,0DBH,0FFH,0EFH
SPC1MS:	DB '    '
SPC2MS:	DB ' '
TXTMS:	DB 'TEXT: '
FREEMS:	DB '     ',CR,LF,'FREE: '
UCMS:	DB '     ',CR,LF,'UC: '
CRMS:	DB '     ',CR,LF,0
NWFILM:	DB 'NEW FILE',CR,LF,0
STKFMS:	DB 'STACK FAULT',0
BUFLMS:	DB 7,'BUFFER FULL',0
DR0RDY:	DB 'DRIVE 0 NOT READY',0
BDMCFL:	DB 'BAD MACROFILE',CR,LF,0
SPCRMS:	DB '  ',CR,0
NOFIL:	DB 'NO OUTPUT FILE',CR,LF,0
BAKMS:	DB 'BAK',0
TOMS:	DB 'TO',0
NOTFND:	DB 'CANNOT FIND "',0
QUITMS:	DB 'QUIT? ',0
EXITMS:	DB 'EXIT',0
ESCMS:	DB 'NEW ESC!',0
KILLMS:	DB 'N-KILL? ',0
ILEGMS:	DB '" ILLEGAL CONTEXT',CR,LF,0
;================
;
START:	LXI SP,STACK
	LXI H,81H
	SHLD CIPNT
	XRA A
	CMA
	STA INITSW
	CALL STRTUP
X378DH:	LHLD BB1PNT
	MOV B,H
	MOV C,L
	CALL AOPEN3
	LHLD BB1PNT
	MOV B,H
	MOV C,L
	CALL ISERCK
X379DH:	LHLD BB2PNT
	MOV B,H
	MOV C,L
	CALL AOPEN4
	LDA STATUS
	CPI 00H
	JZ X37B9H
	LXI H,BBMS
	SHLD BB2PNT
	CALL OPNOFL
	JMP X379DH
X37B9H:	LXI B,TXTBUF
	LXI D,MSIZ1
	CALL AP0100
	XCHG
	LXI H,000CH
	CALL AP0029
	XCHG
	SHLD X5C6AH
	CALL AP0033
	XCHG
	LXI H,E14UF
	CALL AP0104
	JNC X37E3H
	LHLD X5C6AH
	SHLD X5C6EH
	JMP X37E9H
X37E3H:	LHLD E14UF
	SHLD X5C6EH
X37E9H:	LXI B,X5C6EH
	LXI D,MSIZ1
	CALL AP0098
	SHLD BFPNT
	SHLD TXTND
	LXI B,X5C6AH
	LXI D,BFPNT
	CALL AP0098
	XCHG
	LXI H,TXTBUF
	CALL AP0095
	SHLD X5C66H
	CALL X5790H
	LDA X5D91H
	RAR
	JNC X381DH
	LHLD X5C66H
	MOV B,H
	MOV C,L
	CALL APPND
X381DH:	LXI H,X5D91H
	MVI M,0FFH
	CALL X4039H
	LXI H,CITMP
	MVI M,0FFH
	CALL MACRX
ERRBK:	LXI SP,STACK
	LXI B,BRKMS
	CALL WRSTR
ERRST:	LXI SP,STACK
	LXI H,X5D63H
	MVI M,00H
	CALL X4039H
ERRLP:	LXI SP,STACK
LOOP:	LXI H,X5D5FH
	MVI M,00H
	LXI H,0001H
	SHLD X5D54H
X384FH:	CALL GETCMD
	STA CITMP
	STA X5D58H
	CPI '-'
	JNZ X3867H
	LDA X5D5FH
	CMA
	STA X5D5FH
	JMP X384FH
X3867H:	LDA CITMP
	SUI 2EH
	SUI 01H
	SBB A
	STA X5D5EH
	LDA CITMP
	SUI '/'
	SUI 01H
	SBB A
	STA X5D56H
	LDA X5D5AH
	CPI 01H
	JNZ X388BH
	CALL X475DH
	SHLD X5D54H
X388BH:	LHLD X5D58H
	MOV C,L
	CALL X5035H
	RAR
	JNC X3899H
	CALL X4F7AH
X3899H:	LDA X5D5AH
	CPI 00H
	JZ CMDBRN
	CALL X4CB9H
CMDBRN:	LDA CITMP
	ORI 20H
	SUI 61H
	MOV C,A
	MVI B,00H
	LXI H,X3C98H
	DAD B
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	PCHL
;
AA:	LDA X5D56H
	RAR
	JNC X38C5H
	LHLD X5C66H
	SHLD X5D54H
X38C5H:	MVI A,00H
	LXI H,X5D54H
	CALL AP0103
	JNC X38E1H
	LHLD X5D22H
	SHLD X5D20H
	LHLD X5D54H
	MOV B,H
	MOV C,L
	CALL APPND
	CALL STRST
X38E1H:	CALL OPUCMS
	JMP X3CCCH
;
AB:	CALL SETLBP
	JMP X3CCCH
;
AC:	CALL X5106H
	CALL LPMOVE
	JMP X3CCCH
;
AD:	CALL X5106H
	CALL X51C9H
	JMP X3CCCH
;
AE:	CALL COMAND
	STA CITMP
	LXI H,X5DB9H
	CMP M
	JNZ X3912H
	CALL EXSUB
	CALL AEXIT
X3912H:	LDA CITMP
	CPI 'R'
	JNZ X3920H
	CALL EXSUB
	JMP X378DH
X3920H:	JMP SYNERR
	JMP X3CCCH
;
F:	CALL FIND
	JMP X3CCCH
;
G:	CALL X4A20H
	LDA X5DC2H
	RAR
	JNC X39D4H
	LXI H,X5D5FH
	MVI M,00H
	LXI B,X5D22H
	LXI D,VSTACK+2
	CALL AP0098
	ORA L
	JNZ X394EH
	LHLD TXTND
	SHLD VSTACK+2
X394EH:	LHLD TXTND
	SHLD X5C80H
	LHLD VSTACK+2
	SHLD TXTND
	CALL X4830H
	SHLD X5C6EH
	LXI D,X5D22H
	LXI B,X5C6EH
	CALL AP0098
	SBB A
	LXI B,TXTND
	LXI D,VSTACK+2
	PUSH PSW
	CALL AP0098
	SBB A
	POP B
	MOV C,B
	ANA C
	RAR
	JNC X397FH
	JMP SYNERR
X397FH:	LHLD X5C80H
	SHLD TXTND
	LHLD X5C6EH
	XCHG
	LHLD X5D22H
	DAD D
	XCHG
	LHLD VSTACK+2
	CALL AP0095
	SHLD X5C80H
	MVI A,0AH
	LXI D,TXTND
	PUSH H
	CALL AP0101
	XCHG
	POP H
	CALL AP0095
	JNC X39ABH
	CALL X3FD8H
X39ABH:	LXI B,VSTACK+2
	LXI D,X5C6EH
	CALL AP0098
	JNC X39BAH
	JMP SYNERR
X39BAH:	LHLD VSTACK+2
	PUSH H
	LHLD X5C6EH
	DCX H
	MOV B,H
	MOV C,L
	LHLD X5D22H
	XCHG
	CALL X55CCH
	LHLD X5C80H
	SHLD X5D22H
	JMP X3A05H
X39D4H:	MVI C,01H
	CALL X49F2H
X39D9H:	CALL X3DFEH
	XCHG
	LHLD X5D22H
	MOV B,H
	MOV C,L
	CALL AREAD1
	LHLD ACTUAL
	XCHG
	LHLD X5D22H
	DAD D
	SHLD X5D22H
	CALL X3DFEH
	XCHG
	MVI A,0AH
	CALL AP0096
	JNC X3A02H
	CALL X4DF8H
	JMP X39D9H
X3A02H:	CALL ACLOS1
X3A05H:	JMP X3CCCH
;
AH:	CALL X5106H
	LDA X5D5FH
	RAR
	JC X3A18H
	LHLD TXTND
	SHLD X5C80H
X3A18H:	LXI H,0001H
	SHLD X5C6EH
X3A1EH:	LXI D,X5D54H
	LXI B,X5C6EH
	CALL AP0098
	JC X3A80H
	LHLD X5C80H
	MOV E,M
	MVI D,00H
	LXI H,0010H
	CALL AP0029
	MOV C,E
	CALL X5787H
	MOV C,A
	CALL CONSOP
	LHLD X5C80H
	MVI A,0FH
	ANA M
	MOV C,A
	CALL X5787H
	MOV C,A
	CALL CONSOP
	MVI C,20H
	CALL CONSOP
	CALL CTLSWT
	LHLD X5C6EH
	XCHG
	LHLD E3UF
	MVI H,00H
	CALL AP0029
	MVI A,00H
	CALL AP0094
	ORA L
	JNZ X3A6CH
	CALL CRLF
X3A6CH:	LHLD X5C80H
	INX H
	SHLD X5C80H
	LXI D,0001H
	LHLD X5C6EH
	DAD D
	SHLD X5C6EH
	JNC X3A1EH
X3A80H:	CALL CRLF
	JMP X3CCCH
;
I:	CALL X5140H
	RAR
	JNC X3A93H
	CALL INSSTR
	JMP I
X3A93H:	JMP X3CCCH
;
J:	CALL X5140H
	RAR
	JNC X3AB8H
	LDA X5D5FH
	RAR
	JNC X3AAEH
	LHLD CITMP
	MOV C,L
	CALL CO
	JMP X3AB5H
X3AAEH:	LHLD CITMP
	MOV C,L
	CALL CONSOP
X3AB5H:	JMP J
X3AB8H:	JMP X3CCCH
;
K:	CALL X4830H
	SHLD X5C80H
	CALL X51C9H
	JMP X3CCCH
;
AL:	CALL X4830H
	SHLD X5C80H
	CALL LPMOVE
	JMP X3CCCH
;
AM:	CALL COMAND
	STA CITMP
	CALL X4056H
	MVI C,4EH
	CALL CNDCO
	LDA X5D5FH
	RAR
	JNC X3AEDH
	MVI C,01H
	CALL CNDCO
X3AEDH:	LHLD X5C76H
	INX H
	INX H
	XCHG
	LXI H,X5C72H
	CALL AP0104
	JNC X3B09H
	LHLD X5C72H
	MOV C,M
	CALL CNDCO
	CALL X430EH
	JMP X3AEDH
X3B09H:	CALL X4E31H
	JMP X3CCCH
;
N:	LDA X5DC4H
	CPI 00H
	JZ X3B1AH
	JMP SYNERR
X3B1AH:	CALL COMAND
	CPI 20H
	JNZ X3B38H
	LXI B,KILLMS
	CALL WRSTR
	CALL X4EA7H
	RAR
	JNC X3B35H
	LHLD MSIZ2
	SHLD MSIZ1
X3B35H:	JMP X3C13H
X3B38H:	LHLD X5D4EH
	SHLD X5C7CH
	LHLD X5C70H
	SHLD X5C78H
	CALL X4610H
	RAR
	JNC X3B63H
X3B4BH:	CALL X576DH
	RAR
	JNC X3B5CH
	LHLD X5D4EH
	DCX H
	SHLD X5D4EH
	JMP X3B4BH
X3B5CH:	LHLD X5D4EH
	INX H
	SHLD X5C78H
X3B63H:	LHLD MSIZ1
	DCX H
	SHLD X5C72H
	LDA CITMP
	MOV M,A
	CALL X430EH
	LXI B,X5C78H
	LXI D,X5C7CH
	CALL AP0098
	LXI D,0005H
	DAD D
	SHLD X5C74H
	LXI D,MSIZ1
	CALL AP0102
	XCHG
	DCX H
	MOV M,E
	INX H
	MOV M,D
	LXI H,X5C84H
	CALL AP0104
	JNC X3BA3H
	LHLD X5C74H
	XCHG
	LHLD MSIZ1
	DAD D
	SHLD MSIZ1
	CALL X3FD8H
X3BA3H:	LHLD X5C78H
	PUSH H
	LHLD MSIZ1
	INX H
	INX H
	INX H
	XCHG
	LHLD X5C7CH
	MOV B,H
	MOV C,L
	CALL X55CCH
	LXI H,X5E41H
	MVI M,0FFH
X3BBBH:	LHLD MSIZ1
	INX H
	INX H
	INX H
	LXI D,X5C72H
	CALL AP0102
	JC X3BEDH
	LHLD X5C72H
	MOV A,M
	CPI 01H
	JNZ X3BD9H
	CALL X430EH
	JMP X3BE7H
X3BD9H:	LHLD X5C72H
	MOV A,M
	SUI 02H
	SUI 01H
	SBB A
	LXI H,X5E41H
	ADD M
	MOV M,A
X3BE7H:	CALL X430EH
	JMP X3BBBH
X3BEDH:	LHLD X5C72H
	LDA X5E41H
	MOV M,A
	CALL X430EH
	CALL X430EH
	LHLD X5C72H
	PUSH H
	LHLD X5C74H
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	CALL X402DH
	CALL X4610H
	RAR
	JC X3C13H
	JMP ERRST
X3C13H:	JMP X3CCCH
;
O:	CALL COMAND
	CPI 4FH
	JZ X3C21H
	JMP SYNERR
X3C21H:	CALL X4907H
	JMP X3CCCH
;
P:	CALL X4A20H
	MVI C,02H
	CALL X49F2H
	LXI B,X4E14H
	CALL WROP
	CALL ACLOS1
	JMP X3CCCH
;
Q:	CALL QUITR
	JMP X3CCCH
;
R:	CALL COMAND
	STA CITMP
	CALL MACRX
	JMP X3CCCH
;
S:	CALL FIND
	LDA X5DB8H
	LXI D,X5D22H
	CALL AP0101
	XCHG
	DCX H
	MOV M,E
	INX H
	MOV M,D
	JMP I
	JMP X3CCCH
;
T:	LXI B,X3E08H
	CALL WROP
	JMP X3CCCH
;
U:	CALL X51E0H
	JMP X3CCCH
;
V:	CALL SETV
	JMP X3CCCH
;
W:	CALL NWFLSH
	JMP X3CCCH
;
X:	LXI B,WROP2
	CALL WROP
	JMP X3CCCH
;
Y:	CALL X4E5AH
	MOV C,A
	CALL X5042H
	JMP X3CCCH
;
Z:	CALL SETLPZ
	JMP X3CCCH
;==========
X3C98H:	DW AA,AB,AC,AD
	DW AE,F,G,AH
	DW I,J,K,AL
	DW AM,N,O,P
	DW Q,R,S,T
	DW U,V,W,X
	DW Y,Z
;==============
X3CCCH:	JMP LOOP
SYNERR:	LXI SP,STACK
	MVI A,20H
	LXI H,CITMP
	SUB M
	SBB A
	PUSH PSW
	MOV A,M
	SUI 7EH
	ADI 0FFH
	SBB A
	POP B
	MOV C,B
	ANA C
	RAR
	JNC X3CFFH
	CALL CRLF
	MVI C,22H
	CALL CO
	LHLD CITMP
	MOV C,L
	CALL CONSOP
	LXI B,ILEGMS
	CALL WRSTR
	CALL X4039H
X3CFFH:	JMP ERRLP
	EI
	HLT
;=========================
;SUBROUTINES FOLLOW
;===================
X3D04H:	LXI H,X5DF3H
	MOV M,C
	LHLD X5DF3H
	MOV C,L
	LXI D,SWCH
	CALL X580FH
	RET
;================
CONIP:	LDA E10UF
	RRC
	RAR
	JNC X3D27H
	LXI D,0001H
	LXI B,X5DF4H
	CALL ACIRD
	JMP X3D2DH
X3D27H:	CALL CI
	STA X5DF4H
X3D2DH:	LDA X5DF4H
	ANI 7FH
	RET
;==================
CONSTS:	CALL CSTS
	RAR
	JNC X3D48H
	CALL CONIP
	STA CITMP
	CPI 03H; CTRL C
	JNZ X3D48H
	JMP ERRBK
X3D48H:	RET
;================
CTLSWT:	LDA X5DF5H
	INR A
	STA X5DF5H
	CPI 00H
	JNZ X3D66H
	CALL CONSTS
X3D58H:	LDA CITMP
	CPI 13H; CTRL S
	JNZ X3D66H
	CALL CONSTS
	JMP X3D58H
X3D66H:	RET
;================
CONSOP:	LXI H,X5DF6H
	MOV M,C
	LXI H,X5DF7H
	MVI M,00H
	LDA X5DB9H
	DCX H
	CMP M
	JNZ X3D7EH
	LDA E12UF
	STA X5DF6H
X3D7EH:	LDA X5DF6H
	CPI 09H; CTRL I
	JNZ X3DA5H
	LDA E11UF
	DCR A
	LHLD X5D59H
	MVI H,00H
	XCHG
	LHLD E11UF
	MVI H,00H
	PUSH PSW
	CALL AP0029
	POP PSW
	CALL AP0094
	XCHG
	LXI H,X5DF7H
	MOV M,E
	DCX H
	MVI M,' '
X3DA5H:	LDA X5DF6H
	CPI CR
	JNZ X3DB2H
	LXI H,X5D59H
	MVI M,0FEH
X3DB2H:	LHLD X5DF6H
	MOV C,L
	CALL X3D04H
	RAR
	JNC X3DCEH
	MVI C,'^'
	CALL CO
	LDA X5DF6H
	ADI 40H
	STA X5DF6H
	LXI H,X5D59H
	INR M
X3DCEH:	LXI H,X5DF8H
	MVI M,00H
X3DD3H:	LDA X5DF7H
	LXI H,X5DF8H
	CMP M
	JC X3DFDH
	LXI H,X5D59H
	INR M
	LDA X5DF6H
	CPI ' '
	JNZ X3DEFH
	LDA E1UF
	STA X5DF6H
X3DEFH:	LHLD X5DF6H
	MOV C,L
	CALL CO
	LXI H,X5DF8H
	INR M
	JNZ X3DD3H
X3DFDH:	RET
;==============
X3DFEH:	LXI B,X5D22H
	LXI D,TXTND
	CALL AP0098
	RET
;=============
X3E08H:	LXI H,X5DFCH
	MOV M,D
	DCX H
	MOV M,E
	DCX H
	MOV M,B
	DCX H
	MOV M,C
X3E12H:	LXI B,X5DFBH
	LXI D,X5DF9H
	CALL AP0098
	JNC X3E32H
	LHLD X5DF9H
	MOV C,M
	CALL CONSOP
	CALL CTLSWT
	LHLD X5DF9H
	INX H
	SHLD X5DF9H
	JMP X3E12H
X3E32H:	RET
;===============
WRSTR:	LXI H,X5DFEH
	MOV M,B
	DCX H
	MOV M,C
X3E39H:	LHLD X5DFDH
	MOV A,M
	CPI 00H
	JZ X3E53H
	LHLD X5DFDH
	MOV C,M
	CALL CO
	LHLD X5DFDH
	INX H
	SHLD X5DFDH
	JMP X3E39H
X3E53H:	RET
;===============
CRLF:	MVI C,CR
	CALL CONSOP
	MVI C,LF
	CALL CONSOP
	RET
;=================
STKFLT:	LXI H,X5E00H
	MOV M,B
	DCX H
	MOV M,C
	LHLD X5DFFH
	MOV A,M
	INR A
	MOV M,A
	MOV C,A
	MVI A,LF
	CMP C
	JNC X3E7BH
	LXI B,STKFMS
	CALL WRSTR
	JMP ERRBK
X3E7BH:	RET
;===============
LDUCMS:	LXI H,X5E04H
	MOV M,D
	DCX H
	MOV M,E
	DCX H
	MOV M,B
	DCX H
	MOV M,C
	LXI B,SPC1MS
	PUSH B
	LHLD X5E03H
	XCHG
	LXI B,SPC2MS
	CALL X55CCH
	LXI H,X5D5BH
	MVI M,10H
X3E99H:	LHLD X5E01H
	XCHG
	LHLD E3UF
	MVI H,00H
	CALL AP0029
	MOV C,L
	CALL X5787H
	PUSH PSW
	LDA X5D5BH
	DCR A
	STA X5D5BH
	MOV C,A
	MVI B,00H
	LXI H,X5E05H
	DAD B
	POP B
	MOV C,B
	MOV M,C
	LHLD X5E01H
	XCHG
	LHLD E3UF
	MVI H,00H
	CALL AP0029
	XCHG
	SHLD X5E01H
	MVI A,00H
	CALL AP0094
	JNC X3ED6H
	JMP X3E99H
X3ED6H:	LHLD X5D5BH
	MVI H,00H
	LXI B,X5E05H
	DAD B
	PUSH H
	LHLD X5E03H
	XCHG
	LXI B,X5E14H
	CALL X55CCH
	LXI H,X5D5BH
	MVI A,10H
	SUB M
	MOV M,A
	RET
;============
LPMOVE:	LXI B,X5D22H
	LXI D,X5C80H
	CALL AP0098
	ORA L
	JNZ X3F00H
	RET
X3F00H:	CALL X3DFEH
	SHLD X5D4AH
	LXI D,X5D22H
	LXI B,X5C80H
	CALL AP0098
	JNC X3F57H
	LXI B,TXTND
	LXI D,X5C80H
	CALL AP0098
	JNC X3F24H
	LHLD TXTND
	SHLD X5C80H
X3F24H:	LHLD TXTND
	SHLD X5D50H
	LHLD TXTND
	PUSH H
	LHLD X5C80H
	MOV B,H
	MOV C,L
	LHLD X5D22H
	XCHG
	CALL X55CCH
	LHLD X5D4AH
	CALL AP0041
	SHLD X5D4AH
	XCHG
	LHLD X5C80H
	DAD D
	SHLD X5D22H
	LHLD X5C80H
	SHLD TXTND
	SHLD X5D4CH
	JMP X3F89H
X3F57H:	LHLD X5D22H
	SHLD X5D4CH
	LHLD X5C80H
	PUSH H
	LHLD X5D22H
	DCX H
	PUSH H
	CALL X3DFEH
	PUSH H
	LHLD X5C80H
	POP B
	DAD B
	XCHG
	POP B
	CALL X55CCH
	LHLD X5D4AH
	XCHG
	LHLD X5C80H
	DAD D
	SHLD TXTND
	LHLD X5C80H
	SHLD X5D22H
	INX H
	SHLD X5D50H
X3F89H:	CALL X5E42H
	RET
;===============
X5E42H:	LHLD X5D50H
	SUB A
	SUB L
	MOV L,A
	MVI A,00H
	SBB H
	MOV H,A
	SHLD X5E6AH
	LHLD X5D4CH
	MOV A,H
	CMA
	MOV H,A
	MOV A,L
	CMA
	MOV L,A
	SHLD X5E71H
	MVI A,09H
	LXI H,X5D0FH
	PUSH H
X5E61H:	POP H
X5E62H:	DCR A
	RM
	INX H
	MOV E,M
	INX H
	MOV D,M
	PUSH H
	DB 21H
X5E6AH:	DW 0000H
	DAD D
	JNC X5E61H
	DB 21H
X5E71H:	DW 0000H
	DAD D
	JC X5E61H
	LHLD X5D4AH
	DAD D
	XCHG
	POP H
	MOV M,D
	DCX H
	MOV M,E
	INX H
	JMP X5E62H
;=================
ISERCK:	LXI H,X5E16H
	MOV M,B
	DCX H
	MOV M,C
	LDA STATUS
	CPI 00H
	JNZ X3F9CH
	RET
X3F9CH:	LHLD X5E15H
	MOV B,H
	MOV C,L
	CALL X5A4AH
X3FA4H:	CALL X5962H
	RAR
	JC X3FB8H
	LHLD ISERNO
	MOV C,M
	CALL CONSOP
	CALL X599FH
	JMP X3FA4H
X3FB8H:	CALL AERROR
	LXI H,X5F36H
	MVI M,0FFH
	JMP ERRBK
	RET
;==============
SETLBP:	LXI H,TXTBUF
	SHLD X5C80H
	CALL LPMOVE
	RET
;===============
SETLPZ:	LHLD BFPNT
	SHLD X5C80H
	CALL LPMOVE
	RET
;===============
X3FD8H:	LXI B,BUFLMS
	CALL WRSTR
	JMP ERRBK
	RET
;================
X3FE2H:	CALL X3DFEH
	XCHG
	MVI A,0AH
	CALL AP0096
	JNC X3FF1H
	CALL X3FD8H
X3FF1H:	RET
;===============
X3FF2H:	LDA E13UF
	RAR
	JNC X3FFAH
	RET
X3FFAH:	XRA A
	CMA		;DUMMY TEST FOR DISK STATUS
	RAR
	JC X400AH
	LXI B,DR0RDY
	CALL WRSTR
	JMP ERRBK
X400AH:	RET
;==============
X402DH:	LXI H,X5DC0H
	MVI M,0FFH
	LHLD MSIZ1
	SHLD X5C70H
	RET
;===============
X4039H:	LHLD BFPNT
	SHLD X5C84H
	CALL X402DH
	LHLD X5C70H
	DCX H
	SHLD X5D4EH
	LXI B,0035H
	PUSH B
	MVI E,00H
	LXI B,X5DBAH
	CALL X5847H
	RET
;==============
X4056H:	LHLD MSIZ1
	SHLD X5C72H
X405CH:	LHLD X5C72H
	MVI A,00H
	CALL AP0103
	ORA L
	JZ X408DH
	LHLD X5C72H
	SHLD X5C76H
	LXI D,X5C72H
	CALL AP0012
	DCX H
	XCHG
	DCX H
	MOV M,E
	INX H
	MOV M,D
	LXI H,CITMP
	LDAX D
	CMP M
	JNZ X4083H
	RET
X4083H:	LHLD X5C72H
	INX H
	SHLD X5C72H
	JMP X405CH
X408DH:	JMP SYNERR
	RET
;==============
STKCK:	LXI B,X5DDBH
	CALL STKFLT
	LHLD X5DDCH
	MVI H,00H
	LXI B,X5DC5H
	DAD H
	DAD B
	PUSH H
	LHLD X5D4EH
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	RET
;=============
X40ABH:	LHLD X5DDBH
	MVI H,00H
	LXI B,X5CE4H
	DAD H
	DAD B
	PUSH H
	LHLD X5D4EH
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	LHLD X5C72H
	DCX H
	SHLD X5D4EH
	LHLD X5DDBH
	MVI H,00H
	LXI B,X5D24H
	DAD H
	DAD B
	PUSH H
	LHLD X5D54H
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	LHLD X5DDBH
	MVI H,00H
	LXI B,X5CB8H
	DAD B
	LDA X5D5FH
	MOV M,A
	LHLD X5DDBH
	MVI H,00H
	LXI B,X5CC3H
	DAD B
	MVI M,00H
	LXI H,X5DDCH
	INR M
	JMP ERRLP
	RET
;==============
MACRX:	CALL X4056H
	CALL STKCK
	LHLD X5C76H
	INX H
	INX H
	MVI A,0FFH
	SUB M
	STA X5E19H
	CPI 00H
	JZ X4153H
X410EH:	MVI A,00H
	LXI H,X5E19H
	SUB M
	SBB A
	LXI D,X5C70H
	LXI B,X5D4EH
	PUSH PSW
	CALL AP0098
	SBB A
	POP B
	MOV C,B
	ANA C
	RAR
	JNC X4153H
	LHLD X5D4EH
	MOV A,M
	CPI 01H
	JNZ X413AH
	LHLD X5D4EH
	DCX H
	SHLD X5D4EH
	JMP X4149H
X413AH:	LHLD X5D4EH
	LDA X5DB9H
	SUB M
	SUI 01H
	SBB A
	LXI H,X5E19H
	ADD M
	MOV M,A
X4149H:	LHLD X5D4EH
	DCX H
	SHLD X5D4EH
	JMP X410EH
X4153H:	CALL X40ABH
	RET
;===============
EDMCLD:	LXI B,BFPNT
	LXI D,MSIZ1
	CALL AP0098
	XCHG
	MVI A,0F0H
	CALL AP0096
	SHLD X5C6EH
	LHLD BFPNT
	MOV B,H
	MOV C,L
	LHLD X5C6EH
	XCHG
	CALL AREAD1
	CALL ACLOS1
	LXI B,X5C6EH
	LXI D,ACTUAL
	CALL AP0098
	ORA L
	JNZ X4188H
	CALL X3FD8H
X4188H:	MVI A,10H
	LXI H,ACTUAL
	CALL AP0103
	JNC X420CH
	LXI D,0010H
	LHLD BFPNT
	DAD D
	PUSH H
	LHLD ACTUAL
	XCHG
	LHLD BFPNT
	DAD D
	DCX H
	LXI B,ACTUAL
	LXI D,MSIZ1
	PUSH H
	CALL AP0098
	LXI D,0010H
	DAD D
	SHLD X5C72H
	SHLD X5E1AH
	XCHG
	POP B
	CALL X55CCH
X41BDH:	LXI B,MSIZ1
	LXI D,X5C72H
	CALL AP0098
	ORA L
	JZ X4206H
	LHLD X5C72H
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD X5C6EH
	LXI B,X5C72H
	PUSH D
	LXI D,MSIZ1
	CALL AP0098
	XCHG
	POP H
	DCX H
	CALL AP0104
	JNC X41F8H
	LXI B,BDMCFL
	CALL WRSTR
	LDA X5DBAH
	RAR
	JNC X41F5H
	RET
X41F5H:	JMP ERRBK
X41F8H:	LHLD X5C6EH
	XCHG
	LHLD X5C72H
	DAD D
	SHLD X5C72H
	JMP X41BDH
X4206H:	LHLD X5E1AH
	SHLD MSIZ1
X420CH:	LXI B,000BH
	LHLD BFPNT
	DAD B
	MOV A,M
	CPI 00H
	JZ X422CH
	LHLD BFPNT
	PUSH H
	LXI D,000FH
	LHLD BFPNT
	DAD D
	MOV B,H
	MOV C,L
	LXI D,X5D91H
	CALL X55CCH
X422CH:	CALL X402DH
	LDA X5DBAH
	RAR
	JNC X4237H
	RET
X4237H:	LXI H,CITMP
	MVI M,0FEH
	CALL MACRX
	RET
;================
APPND:	LXI H,X5E1DH
	MOV M,B
	DCX H
	MOV M,C
	CALL X3FF2H
	CALL SETLPZ
	CALL X3DFEH
	XCHG
	MVI A,0F0H
	CALL AP0096
	XCHG
	LHLD X5E1CH
	MOV B,H
	MOV C,L
	CALL X583EH
	SHLD X5E1CH
	LHLD X5D22H
	MOV B,H
	MOV C,L
	LHLD X5E1CH
	XCHG
	CALL AREAD3
	LHLD ACTUAL
	XCHG
	LHLD X5D22H
	DAD D
	SHLD X5D22H
	CALL SETLBP
	RET
;===============
INSSTR:	CALL X3FE2H
	LHLD X5D22H
	LDA CITMP
	MOV M,A
	LHLD X5D22H
	INX H
	SHLD X5D22H
	RET
;==============
CNDCO:	LXI H,X5E1EH
	MOV M,C
	LDA X5E1EH
	STA CITMP
	LDA X5D5FH
	RAR
	JNC X42A3H
	CALL INSSTR
	RET
X42A3H:	LHLD CITMP
	MOV C,L
	CALL CONSOP
	RET
;================
X42ABH:	LXI H,X5E1FH
	MOV M,C
	LDA E10UF
	RAR
	JC X42BDH
	LHLD X5E1FH
	MOV C,L
	CALL CONSOP
X42BDH:	LHLD X5C70H
	DCX H
	SHLD X5C70H
	LDA X5E1FH
	MOV M,A
	LHLD X5D22H
	XCHG
	LHLD MSIZ1
	DAD D
	PUSH H
	LHLD TXTND
	XCHG
	LHLD X5C70H
	DAD D
	POP D
	CALL AP0095
	XCHG
	MVI A,03H
	CALL AP0096
	JNC X42EBH
	MVI C,07H;BELL
	CALL CO
X42EBH:	RET
;==============
DELCHR:	LXI H,X5D59H
	DCR M
	LHLD E2UF
	MOV C,L
	CALL CO
	LHLD E1UF
	MOV C,L
	CALL CO
	LHLD E2UF
	MOV C,L
	CALL CO
	RET
;=================
WRPRM:	LHLD E6UF
	MOV C,L
	CALL CONSOP
	RET
;==============
X430EH:	LHLD X5C72H
	DCX H
	SHLD X5C72H
	RET
;===============
SPCCO:	LXI B,SPCRMS
	CALL WRSTR
	LHLD X5C70H
	SHLD X5C72H
X4322H:	LXI B,MSIZ1
	LXI D,X5C72H
	CALL AP0098
	SBB A
	XCHG
	DCX H
	MOV C,M
	INX H
	MOV B,M
	PUSH PSW
	LDAX B
	SUI LF
	ADI 0FFH
	SBB A
	POP B
	MOV C,B
	ANA C
	RAR
	JNC X4349H
	LHLD X5C72H
	INX H
	SHLD X5C72H
	JMP X4322H
X4349H:	LXI B,X5C70H
	LXI D,X5C72H
	CALL AP0098
	ORA L
	JZ X4363H
	CALL X430EH
	LHLD X5C72H
	MOV C,M
	CALL CONSOP
	JMP X4349H
X4363H:	RET
;===============
X4364H:	LDA CITMP
	STA X5DBFH
	MOV C,A
	CALL X42ABH
	CALL CONIP
	STA CITMP
	RET
;===============
PRMPT:	CALL WRPRM
	LHLD E2UF
	MOV C,L
	CALL CO
	LXI H,X5D59H
	DCR M
	RET
;================
LDCMD:	LDA X5D63H
	RAR
	JNC X438EH
	CALL PRMPT
X438EH:	CALL X4039H
	CALL CONIP
	STA CITMP
	CPI 7FH; RUBOUT
	JNZ X43A4H
	MVI C,07H; BELL
	CALL CO
	JMP LDCMD
X43A4H:	LDA CITMP
	CPI 7EH
	JNZ X43AFH
	JMP LDCMD
X43AFH:	LDA X5D63H
	RAR
	JC X43DAH
	LHLD CITMP
	MOV C,L
	CALL X3D04H
	RAR
	JNC X43CDH
	LHLD X5C70H
	DCX H
	SHLD X5C70H
	LDA CITMP
	MOV M,A
	RET
X43CDH:	LDA CITMP
	ANI 5FH
	SUI 49H
	ADI 0FFH
	SBB A
	STA X5DBBH
X43DAH:	LXI H,X5DB9H
	LDA CITMP
	SUB M
	ADI 0FFH
	SBB A
	PUSH PSW
	LDA X5DBFH
	SUB M
	ADI 0FFH
	SBB A
	POP B
	MOV C,B
	ORA C
	RAR
	JNC X450DH
X43F3H:	LDA CITMP
	SUI 01H
	SUI 01H
	SBB A
	PUSH PSW
	LDA CITMP
	SUI 7EH
	SUI 01H
	SBB A
	POP B
	MOV C,B
	ORA C
	RAR
	JNC X4421H
	CALL X4364H
	LDA CITMP
	CPI 7FH;RUBOUT
	JZ X4419H
	CALL X4364H
X4419H:	LXI H,X5DBFH
	MVI M,00H
	JMP X43F3H
X4421H:	LDA CITMP
	CPI 03H;CTRL C
	JNZ X442CH
	JMP ERRBK
X442CH:	LDA CITMP
	CPI CR
	JNZ X4451H
	LDA X5DBBH
	RAR
	JNC X4440H
	MVI C,07H;BELL
	CALL CO
X4440H:	LDA E10UF
	RAR
	JC X4451H
	MVI C,CR
	CALL X42ABH
	LXI H,CITMP
	MVI M,LF
X4451H:	LDA CITMP
	CPI 12H;CTRL R
	JNZ X4468H
	CALL CRLF
	CALL SPCCO
	CALL CONIP
	STA CITMP
	JMP X450AH
X4468H:	LDA CITMP
	CPI 1AH;CTRL Z
	JNZ X4481H
	CALL CRLF
	CALL CONIP
	STA CITMP
	LXI H,X5DBBH
	MVI M,00H
	JMP X450AH
X4481H:	LDA CITMP
	CPI 7FH;RUBOUT
	JNZ X44CEH
	CALL DELCHR
	LHLD X5C70H
	MOV A,M
	STA X5DBFH
	MOV C,A
	CALL X3D04H
	RAR
	JNC X449EH
	CALL DELCHR
X449EH:	LHLD X5C70H
	INX H
	SHLD X5C70H
	LDA X5DBFH
	CPI 0DH
	JNZ X44B0H
	CALL SPCCO
X44B0H:	LXI H,X5DBFH
	MVI M,00H
	LXI B,MSIZ1
	LXI D,X5C70H
	CALL AP0098
	ORA L
	JNZ X44C5H
	JMP LDCMD
X44C5H:	CALL CONIP
	STA CITMP
	JMP X450AH
X44CEH:	LDA CITMP
	CPI 18H;CTRL X
	JNZ X4507H
	MVI C,'#'
	CALL CONSOP
	CALL CRLF
X44DEH:	LHLD X5C70H
	MOV A,M
	CPI LF
	JZ X44FEH
	LHLD X5C70H
	INX H
	SHLD X5C70H
	LXI D,MSIZ1
	CALL AP0102
	ORA L
	JNZ X44FBH
	JMP LDCMD
X44FBH:	JMP X44DEH
X44FEH:	CALL CONIP
	STA CITMP
	JMP X450AH
X4507H:	CALL X4364H
X450AH:	JMP X43DAH
X450DH:	LHLD CITMP
	MOV C,L
	CALL X42ABH
	CALL CRLF
	LXI H,X5D63H
	MVI M,00H
	LHLD X5D4EH
	INX H
	SHLD ISERNO
X4523H:	LHLD ISERNO
	DCX H
	SHLD ISERNO
	PUSH H
	LHLD X5C70H
	INX H
	POP D
	CALL AP0095
	JC X45D4H
X4536H:	LHLD ISERNO
	MOV A,M
	CPI 01H
	JNZ X454AH
	LHLD ISERNO
	DCX H
	DCX H
	SHLD ISERNO
	JMP X4536H
X454AH:	LHLD ISERNO
	MOV A,M
	SUI 04H;CTRL D
	SUI 01H
	SBB A
	STA CITMP
	RAR
	JNC X455FH
	LHLD ISERNO
	MVI M,00H
X455FH:	LDA X5DBDH
	STA X5D61H
	LXI H,CITMP
	XRA M
	STA X5DBDH
	LDA X5D61H
	RAR
	JNC X45CCH
	LDA X5DBEH
	CMA
	STA X5DBEH
	RAR
	JNC X45A0H
	CALL X590FH
	RAR
	JNC X4593H
	CALL X5985H
	STA X5D5DH
	LHLD ISERNO
	MVI M,01H
	JMP X459DH
X4593H:	LXI H,X5DBEH
	MVI M,00H
	LHLD ISERNO
	MVI M,00H
X459DH:	JMP X45C9H
X45A0H:	CALL X590FH
	RAR
	JNC X45C2H
	LHLD X5D5DH
	MVI H,00H
	DAD H
	DAD H
	DAD H
	DAD H
	PUSH H
	CALL X5985H
	MOV E,A
	MVI D,00H
	POP H
	DAD D
	PUSH H
	LHLD ISERNO
	POP B
	MOV M,C
	JMP X45C9H
X45C2H:	LHLD ISERNO
	LDA X5D5DH
	MOV M,A
X45C9H:	JMP X45D1H
X45CCH:	LXI H,X5DBEH
	MVI M,00H
X45D1H:	JMP X4523H
X45D4H:	RET
;=============
X45D5H:	LDA X5DDCH
	DCR A
	STA X5DDCH
	CPI 00H
	JNZ X45EBH
	LDA X5DC0H
	RAR
	JNC X45EBH
	JMP ERRST
X45EBH:	RET
;===============
X45ECH:	LHLD X5DDBH
	MVI H,00H
	LXI B,X5CE4H
	DAD H
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD X5D4EH
	LDA X5DDBH
	DCR A
	STA X5DDBH
	CPI 0FFH
	JNZ X460CH
	JMP SYNERR
X460CH:	CALL X45D5H
	RET
;==============
X4610H:	MVI A,00H
	LXI H,X5DDCH
	SUB M
	SBB A
	RET
;===================
GETCMD:	LXI D,MSIZ1
	LXI B,X5D4EH
	CALL AP0098
	JNC X462EH
	CALL X4610H
	RAR
	JC X462EH
	JMP ERRST
X462EH:	LHLD X5D4EH
	INX H
	LXI D,X5C70H
	CALL AP0102
	ORA L
	JNZ X4642H
	CALL WRPRM
	CALL LDCMD
X4642H:	CALL CTLSWT
	LHLD X5D4EH
	MOV A,M
	STA X5E20H
	MOV C,A
	CALL X570CH
	STA X5D5AH
	LHLD X5D4EH
	DCX H
	SHLD X5D4EH
	LDA X5DC1H
	RAR
	JNC X4669H
	LXI H,X5DC1H
	MVI M,00H
	JMP X4759H
X4669H:	LDA X5E20H
	CPI 00H
	JNZ X4674H
	JMP X462EH
X4674H:	MVI A,00H
	LXI H,X5DDBH
	CMP M
	JNC X474EH
	LDA X5E20H
	CPI 02H
	JNZ X46D7H
	CALL X4610H
	RAR
	JC X468FH
	JMP ERRBK
X468FH:	LXI B,X5DDBH
	CALL STKFLT
	LHLD X5DDBH
	MVI H,00H
	LXI B,X5CC3H
	DAD B
	MVI M,0FFH
	LHLD X5DDBH
	MVI H,00H
	LXI B,X5CE4H
	DAD H
	DAD B
	PUSH H
	LHLD X5D4EH
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	CALL X45D5H
	LHLD X5DDCH
	MVI H,00H
	LXI B,X5DC5H
	DAD H
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD X5D4EH
	XCHG
	LXI H,X5C70H
	CALL AP0104
	JNC X46D4H
	JMP ERRBK
X46D4H:	JMP X4642H
X46D7H:	LDA X5E20H
	CPI 05H;CTRL E
	JNZ X46EAH
	LXI H,X5D63H
	MVI M,0FFH
	CALL LDCMD
	JMP X4642H
X46EAH:	LXI H,X5DB9H
	LDA X5E20H
	CMP M
	JNZ X4720H
	LHLD X5DDBH
	MVI H,00H
	LXI B,X5CC3H
	DAD B
	MOV A,M
	RAR
	JNC X4720H
	LHLD X5DDCH
	MVI H,00H
	LXI B,X5DC5H
	DAD H
	DAD B
	PUSH H
	LHLD X5D4EH
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	LXI H,X5DDCH
	INR M
	INR M
	CALL X45ECH
	JMP X4642H
X4720H:	LDA X5E20H
	CPI 06H;CTRL F
	JNZ X474EH
	CALL PRMPT
	CALL CONIP
	STA X5E20H
	MOV C,A
	CALL CONSOP
	LHLD X5E20H
	MOV C,L
	CALL X570CH
	STA X5D5AH
	LDA X5E20H
	CPI 03H;CTRL C
	JNZ X474AH
	JMP ERRBK
X474AH:	LDA X5E20H
	RET
X474EH:	LDA X5E20H
	SUI 01H
	SUI 01H
	SBB A
	STA X5DC1H
X4759H:	LDA X5E20H
	RET
;===============
X475DH:	LDA CITMP
	SUI '0'
	SBB A
	PUSH PSW
	MVI A,3AH
	LXI H,CITMP
	SUB M
	SBB A
	POP B
	MOV C,B
	ORA C
	RAR
	JNC X4778H
	CALL GETCMD
	STA CITMP
X4778H:	LXI H,0000H
	SHLD X5E21H
X477EH:	LDA X5D5AH
	CPI 01H
	JNZ X47B5H
	LHLD X5E21H
	DAD H
	DAD H
	PUSH H
	LHLD X5E21H
	POP B
	DAD B
	DAD H
	LDA CITMP
	SUI '0'
	MOV E,A
	MVI D,00H
	DAD D
	SHLD X5E21H
	LDA CITMP
	CPI ':'
	JNZ X47ACH
	LXI H,0FFFFH
	SHLD X5E21H
X47ACH:	CALL GETCMD
	STA CITMP
	JMP X477EH
X47B5H:	MVI A,00H
	LXI D,X5E21H
	CALL AP0101
	ORA L
	JNZ X47EDH
	LDA X5D5EH
	LXI H,X5D5FH
	ORA M
	PUSH PSW
	LDA X5D58H
	SUI ';'
	SUI 01H
	SBB A
	POP B
	MOV C,B
	ORA C
	PUSH PSW
	LDA X5D58H
	SUI '='
	SUI 01H
	SBB A
	POP B
	MOV C,B
	ORA C
	RAR
	JNC X47E8H
	LXI H,0001H
	RET
X47E8H:	LXI H,X5D5FH
	MVI M,0FFH
X47EDH:	LHLD X5E21H
	RET
;=================
LDCK:	MVI A,07H
	LXI D,X5D54H
	CALL AP0025
	MOV A,L
	RET
;================
SETV:	CALL LDCK
	MOV C,A
	MVI B,00H
	LXI H,VSTACK
	DAD B
	DAD B
	PUSH H
	LHLD X5D22H
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	RET
;===============
LDSCLN:	CALL LDCK
	MOV C,A
	MVI B,00H
	LXI H,SCOLON
	DAD B
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	RET
;================
LDVMRK:	CALL LDCK
	MOV C,A
	MVI B,00H
	LXI H,VSTACK
	DAD B
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	RET
;================
X4830H:	LDA X5D5EH
	RAR
	JNC X483BH
	CALL LDVMRK
	RET
;================
X483BH:	LXI B,0FFFFH
	LXI D,X5D54H
	CALL AP0100
	ORA L
	JNZ X4857H
	LDA X5D5FH
	RAR
	JNC X4853H
	LXI H,TXTBUF
	RET
X4853H:	LHLD BFPNT
	RET
X4857H:	LDA X5D5FH
	RAR
	JNC X4872H
	LXI B,TXTBUF
	LXI D,X5D22H
	CALL AP0100
	INX H
	MOV B,H
	MOV C,L
	LHLD X5D22H
	XCHG
	CALL X5678H
	RET
X4872H:	LXI B,TXTND
	LXI D,BFPNT
	CALL AP0098
	MOV B,H
	MOV C,L
	LHLD TXTND
	XCHG
	CALL X56A3H
	RET
;===============
WROPND:	LXI H,X5E26H
	MOV M,D
	DCX H
	MOV M,E
	DCX H
	MOV M,B
	DCX H
	MOV M,C
	LXI B,X5E23H
	LXI D,X5E25H
	CALL AP0098
	XCHG
	LHLD X5E23H
	MOV B,H
	MOV C,L
	CALL AWRIT4
	LHLD BB2PNT
	MOV B,H
	MOV C,L
	CALL ISERCK
	RET
;===============
WROP:	LXI H,WRBRAN+1
	MOV M,B
	DCX H
	MOV M,C
	CALL X4830H
	SHLD X5C6EH
	LXI D,X5D22H
	CALL AP0102
	ORA L
	ADI 0FFH
	SBB A
	LXI B,TXTND
	LXI D,X5C6EH
	PUSH PSW
	CALL AP0098
	ORA L
	ADI 0FFH
	SBB A
	POP B
	MOV C,B
	ANA C
	RAR
	JNC X4906H
	LXI B,X5C6EH
	LXI D,X5D22H
	CALL AP0098
	JNC X48F5H
	LHLD TXTND
	MOV B,H
	MOV C,L
	LHLD X5C6EH
	XCHG
	LXI H,X48F2H
	PUSH H
	LHLD WRBRAN
	PCHL
;
X48F2H:	JMP X4906H
X48F5H:	LHLD X5C6EH
	MOV B,H
	MOV C,L
	LHLD X5D22H
	XCHG
	LXI H,X4906H
	PUSH H
	LHLD WRBRAN
	PCHL
;
X4906H:	RET
;==================
X4907H:	LXI B,WROPND
	CALL WROP
	RET
;===============
STRST:	LHLD X5D20H
	SHLD X5C80H
	CALL LPMOVE
	RET
;================
NWFLSH:	LHLD X5D22H
	SHLD X5D20H
	CALL SETLBP
	CALL X4907H
	LHLD X5C6EH
	SHLD TXTND
	CALL STRST
	RET
;==================
X492EH:	LXI H,X5D64H
	SHLD X5C6EH
	MOV A,M
	STA X5E29H
X4938H:	CALL GETCMD
	LHLD X5C6EH
	MOV M,A
	LXI H,X5DB9H
	CMP M
	JZ X4972H
	LHLD X5C6EH
	MOV A,M
	CPI 01H
	JNZ X4956H
	CALL GETCMD
	LHLD X5C6EH
	MOV M,A
X4956H:	LXI B,X5D64H
	LXI D,X5C6EH
	CALL AP0100
	XCHG
	MVI A,1FH
	CALL AP0096
	JNC X496FH
	LHLD X5C6EH
	INX H
	SHLD X5C6EH
X496FH:	JMP X4938H
X4972H:	LXI B,X5D64H
	LXI D,X5C6EH
	CALL AP0100
	ORA L
	SUI 01H
	SBB A
	STA X5DC2H
	RAR
	JNC X498EH
	LHLD X5C6EH
	LDA X5E29H
	MOV M,A
	RET
X498EH:	LXI B,X5D64H
	LXI D,X5C6EH
	CALL AP0100
	XCHG
	LXI H,X5DB8H
	MOV M,E
	RET
;===================
X499DH:	LXI B,TXTBUF
	LXI D,X5D22H
	CALL AP0100
	RET
;==================
X49A7H:	LXI B,TXTND
	LXI D,BFPNT
	CALL AP0098
	RET
;==================
OPUCMS:	LDA E3UF
	CPI 0AH
	JNC X49BEH
	LXI H,E3UF
	MVI M,0AH
X49BEH:	CALL X499DH
	PUSH H
	CALL X49A7H
	POP B
	DAD B
	MOV B,H
	MOV C,L
	LXI D,FREEMS
	CALL LDUCMS
	CALL X3DFEH
	MOV B,H
	MOV C,L
	LXI D,UCMS
	CALL LDUCMS
	LXI B,BFPNT
	LXI D,MSIZ1
	CALL AP0098
	MOV B,H
	MOV C,L
	LXI D,CRMS
	CALL LDUCMS
	LXI B,TXTMS
	CALL WRSTR
	RET
;================
X49F2H:	LXI H,X5E2AH
	MOV M,C
	LDA X5DC2H
	RAR
	JNC X4A00H
	JMP SYNERR
X4A00H:	CALL X3FF2H
	LHLD X5E2AH
	XCHG
	LXI B,X5D64H
	CALL AOPEN1
	LXI B,X5D64H
	CALL ISERCK
	RET
;=================
OPNOFL:	LXI H,X5D62H
	MVI M,0FFH
	LXI B,NOFIL
	CALL WRSTR
	RET
;================
X4A20H:	CALL X492EH
	LDA X5DC2H
	RAR
	JNC X4A2BH
	RET
X4A2BH:	LXI H,X5F36H
	MVI M,00H
	RET
;================
X4A31H:	LHLD X5DC4H
	MVI H,00H
	LXI B,X5CCEH
	DAD H
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD X5E2BH
	LXI H,X5D61H
	MVI M,01H
X4A47H:	MVI A,00H
	LXI H,X5D61H
	CMP M
	JNC X4A79H
	LHLD X5E2BH
	MOV A,M
	CPI 01H
	JNZ X4A63H
	LHLD X5E2BH
	DCX H
	SHLD X5E2BH
	JMP X4A6FH
X4A63H:	LHLD X5E2BH
	MOV C,M
	CALL X573AH
	LXI H,X5D61H
	ADD M
	MOV M,A
X4A6FH:	LHLD X5E2BH
	DCX H
	SHLD X5E2BH
	JMP X4A47H
X4A79H:	LHLD X5E2BH
	RET
;=================
X4A7DH:	LXI H,X5E2DH
	MOV M,C
	LHLD X5C84H
	LDA X5E2DH
	MOV M,A
	LHLD X5C84H
	INX H
	SHLD X5C84H
	RET
;================
X4A90H:	LXI D,BAKMS
	LXI B,X5DA1H
	CALL X57C9H
	LXI H,X5D84H
	SHLD BB2PNT
	CALL X57A1H
	STA X5D86H
	RET
;================
WROP2:	LXI H,X5E31H
	MOV M,D
	DCX H
	MOV M,E
	DCX H
	MOV M,B
	DCX H
	MOV M,C
	MVI C,0FFH
	CALL X4A7DH
	LHLD X5DB9H
	MOV C,L
	CALL X4A7DH
	LHLD X5DB9H
	MOV C,L
	CALL X4A7DH
X4AC3H:	LXI B,X5E30H
	LXI D,X5E2EH
	CALL AP0098
	JNC X4AE7H
	LHLD X5E30H
	DCX H
	SHLD X5E30H
	PUSH H
	LHLD X5C84H
	POP B
	LDAX B
	MOV M,A
	LHLD X5C84H
	INX H
	SHLD X5C84H
	JMP X4AC3H
X4AE7H:	LHLD X5C84H
	SHLD X5C72H
	CALL STKCK
	CALL X40ABH
	RET
;=================
X4AF4H:	CALL X57A1H
	SUI 39H
	SBB A
	RET
;==================-
STRTUP:	LXI H,X5F36H
	MVI M,0FFH
	LXI H,X5F34H
	MVI M,00H
	CALL MEMSIZ
	XCHG
	MVI A,0AH
	CALL AP0096
	SHLD MSIZ2
	SHLD MSIZ1
	LXI B,X5DA1H
	PUSH B
	LHLD MSIZ1
	XCHG
	LXI B,X5DAAH
	CALL X55CCH
	LXI H,CIBUF
	SHLD ISERNO
	MOV B,H
	MOV C,L
	CALL AWHOCN
	CALL X4AF4H
	STA X5D60H
	LXI D,0032H
	LXI B,CIBUF
	CALL ACIRD
	XRA A
	STA X5D61H
	MVI A,'0'		;EDIT MAC MUST BE ON DRIVE 0
	STA X5D66H
	LXI B,X5951H
	CALL X59D4H
	LHLD ISERNO
	SHLD X5C68H
	MOV A,M
	SUI 2CH
	SBB A
	STA X5D91H
	RAR
	JNC X4B7EH
	MVI E,01H
	LXI B,X5D64H
	CALL AOPEN1
	LDA STATUS
	CPI 00H
	JNZ X4B7EH
	CALL EDMCLD
X4B7EH:	CALL X4039H
	LXI B,SIGNON
	CALL WRSTR
	CALL X5962H
	RAR
	JC X4B91H
	CALL X599FH
X4B91H:	CALL X5A43H
	LDA X5D60H
	STA E10UF
	CALL X5962H
	RAR
	JNC X4BA7H
	CALL OPNOFL
	JMP X4C0CH
X4BA7H:	CALL X4A90H
	LHLD ISERNO
	MOV B,H
	MOV C,L
	LHLD ISERNO
	XCHG
	CALL ARENAM
	LDA STATUS
	SUI 0DH
	SUI 01H
	SBB A
	STA X5DC3H
	RAR
	JC X4BCBH
	LHLD ISERNO
	SHLD BB1PNT
X4BCBH:	LHLD ISERNO
	SHLD BB3PNT
	LXI B,X5951H
	CALL X59D4H
	CALL X5A43H
	LXI B,TOMS
	CALL X59F3H
	RAR
	JNC X4C0CH
	CALL X5A43H
	LDA X5DC3H
	RAR
	JNC X4BF6H
	LHLD X5C68H
	MOV B,H
	MOV C,L
	CALL ISERCK
X4BF6H:	LHLD ISERNO
	SHLD BB3PNT
	CALL X4A90H
	CALL X4AF4H
	RAR
	JC X4C0CH
	LHLD ISERNO
	SHLD BB2PNT
X4C0CH:	LDA X5DC3H
	RAR
	JNC X4C19H
	LXI B,NWFILM
	CALL WRSTR
X4C19H:	RET
;==================
X4C1AH:	CALL X5751H
	LXI B,STRTUP
	DAD B
	RET
;================
X4C22H:	LDA X5DC4H
	CPI 00H
	JNZ X4C2DH
	JMP ERRBK
X4C2DH:	LHLD X5DC4H
	MVI H,00H
	LXI B,X5CFAH
	DAD H
	DAD B
	MOV C,M
	INX H
	MOV B,M
	DCX B
	DCX H
	MOV M,C
	INX H
	MOV M,B
	LXI D,0000H
	CALL AP0097
	JNC X4C67H
	LHLD X5DC4H
	MVI H,00H
	LXI B,X5CCEH
	DAD H
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD X5D4EH
	CALL X4C1AH
	MOV B,H
	MOV C,L
	LXI D,X5DC5H
	CALL X5668H
	JMP X4CA1H
X4C67H:	LHLD X5DC4H
	MVI H,00H
	LXI B,X5DDDH
	DAD H
	DAD B
	MVI A,00H
	CALL AP0103
	ORA L
	JNZ X4C8CH
	CALL X4A31H
	PUSH H
	LHLD X5DC4H
	MVI H,00H
	LXI B,X5DDDH
	DAD H
	DAD B
	POP B
	MOV M,C
	INX H
	MOV M,B
X4C8CH:	LHLD X5DC4H
	MVI H,00H
	LXI B,X5DDDH
	DAD H
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD X5D4EH
	LXI H,X5DC4H
	DCR M
X4CA1H:	RET
;================
X4CA2H:	LHLD X5DC4H
	MVI H,00H
	LXI B,X5CFAH
	DAD H
	DAD B
	MVI A,01H
	MOV M,A
	INX H
	MVI M,00H
	CALL X4C22H
	JMP ERRLP
	RET
;=================
X4CB9H:	MVI A,7FH
	LXI H,CITMP
	CMP M
	JNC X4CC8H
	CALL X45ECH
	JMP ERRLP
X4CC8H:	LHLD CITMP
	MOV C,L
	CALL X573AH
	STA X5D61H
	RAR
	JNC X4D54H
	LDA X5D61H
	CPI 01H
	JNZ X4D3BH
	LXI B,X5DC4H
	CALL STKFLT
	CALL X4C1AH
	XCHG
	LXI B,X5DC5H
	CALL X5668H
	LHLD X5DC4H
	MVI H,00H
	LXI B,X5CCEH
	DAD H
	DAD B
	PUSH H
	LHLD X5D4EH
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	LHLD X5DC4H
	MVI H,00H
	LXI B,X5DDDH
	DAD H
	DAD B
	MVI A,00H
	MOV M,A
	INX H
	MVI M,00H
	LHLD X5DC4H
	MVI H,00H
	LXI B,X5CFAH
	DAD H
	DAD B
	PUSH H
	LHLD X5D54H
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	MVI A,00H
	CALL AP0096
	ORA L
	SUI 01H
	SBB A
	LXI H,X5D5FH
	ORA M
	RAR
	JNC X4D38H
	CALL X4CA2H
X4D38H:	JMP ERRLP
X4D3BH:	LHLD X5DC4H
	MVI H,00H
	LXI B,X5DDDH
	DAD H
	DAD B
	PUSH H
	LHLD X5D4EH
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	CALL X4C22H
	JMP ERRLP
X4D54H:	LHLD CITMP
	MOV C,L
	CALL X3D04H
	RAR
	JNC X4D62H
	CALL MACRX
X4D62H:	JMP SYNERR
	RET
;===================
FIND:	CALL X492EH
	LHLD BFPNT
	SHLD X5C6CH
	LDA X5D5EH
	RAR
	JNC X4D95H
	CALL LDVMRK
	XCHG
	LXI H,X5D22H
	CALL AP0104
	JNC X4D8FH
	CALL LDVMRK
	SHLD X5C80H
	CALL SETV
	CALL LPMOVE
X4D8FH:	CALL LDVMRK
	SHLD X5C6CH
X4D95H:	LXI H,X5D5CH
	MVI M,00H
	LXI D,TXTND
	LXI B,X5C6CH
	CALL AP0098
	JNC X4DCDH
	LHLD TXTND
	MOV B,H
	MOV C,L
	LHLD X5C6CH
	XCHG
	CALL X56C2H
	STA X5D5CH
	RAR
	JNC X4DCDH
	LHLD X5D52H
	SHLD X5C80H
	XCHG
	LDA X5DB8H
	CALL AP0096
	SHLD X5D20H
	CALL LPMOVE
	RET
X4DCDH:	MVI A,00H
	LXI H,X5DC4H
	CMP M
	JNC X4DD9H
	CALL X4CA2H
X4DD9H:	LXI B,NOTFND
	CALL WRSTR
	LHLD X5DB8H
	MVI H,00H
	LXI B,X5D64H
	DAD B
	XCHG
	CALL X3E08H
	MVI C,'"'
	CALL CO
	CALL CRLF
	JMP ERRBK
	RET
;==================
X4DF8H:	LXI B,TXTBUF
	LXI D,X5D22H
	CALL AP0100
	XCHG
	CALL AWRIT4
	LHLD BB2PNT
	MOV B,H
	MOV C,L
	CALL ISERCK
	LXI H,TXTBUF
	SHLD X5D22H
	RET
;==================
X4E14H:	LXI H,X5E35H
	MOV M,D
	DCX H
	MOV M,E
	DCX H
	MOV M,B
	DCX H
	MOV M,C
	LXI B,X5E32H
	LXI D,X5E34H
	CALL AP0098
	XCHG
	LHLD X5E32H
	MOV B,H
	MOV C,L
	CALL AWRIT1
	RET
;====================
X4E31H:	MVI C,0DH
	CALL CNDCO
	MVI C,0AH
	CALL CNDCO
	RET
;==================
DTAIL:	LHLD X5C68H
	SHLD ISERNO
X4E42H:	CALL X5962H
	RAR
	JC X4E56H
	LHLD ISERNO
	MOV C,M
	CALL CNDCO
	CALL X599FH
	JMP X4E42H
X4E56H:	CALL X4E31H
	RET
;===================
X4E5AH:	LDA X5DBCH
	RAR
	JNC X4E71H
	CALL CONSTS
	LXI H,CITMP
	MVI M,'G'
	MVI C,'G'
	CALL CONSOP
	JMP X4E7BH
X4E71H:	CALL CI
	STA CITMP
	MOV C,A
	CALL CONSOP
X4E7BH:	CALL CRLF
	LDA CITMP
	CPI 03H;CTRL C
	JNZ X4E89H
	JMP ERRBK
X4E89H:	LDA CITMP
	ANI 5FH
	STA CITMP
	CPI 'G'
	JNZ X4E9EH
	LXI H,X5DBCH
	MVI M,0FFH
	MVI A,0FFH
	RET
X4E9EH:	LDA CITMP
	SUI 'Y'
	SUI 01H
	SBB A
	RET
;===================
X4EA7H:	LDA E10UF
	RRC
	RAR
	JNC X4EB2H
	MVI A,0FFH
	RET
X4EB2H:	CALL X4E5AH
	RET
;======================
QUITR:	LXI B,QUITMS
	CALL WRSTR
	CALL X4EA7H
	RAR
	JNC X4ED1H
	CALL ACLOS4
	LHLD BB2PNT
	MOV B,H
	MOV C,L
	CALL ADELET
	CALL AEXIT
X4ED1H:	JMP ERRBK
	RET
;======================
EXSUB:	CALL X3FF2H
	CALL SETLPZ
	LDA X5D62H
	RAR
	JNC X4EE8H
	CALL OPNOFL
	CALL QUITR
X4EE8H:	LXI B,X5D22H
	LXI D,MSIZ1
	CALL AP0098
	XCHG
	LHLD X5D22H
	MOV B,H
	MOV C,L
	CALL AREAD3
	LHLD ACTUAL
	XCHG
	LHLD X5D22H
	DAD D
	SHLD X5D22H
	LXI D,TXTBUF
	CALL AP0095
	JNC X4F14H
	CALL X4DF8H
	JMP X4EE8H
X4F14H:	CALL ACLOS3
	CALL ACLOS4
	LXI B,BB3PNT
	LXI D,BB1PNT
	CALL AP0098
	ORA L
	JNZ X4F38H
	LXI B,X5DA1H
	CALL ADELET
	LHLD BB3PNT
	MOV B,H
	MOV C,L
	LXI D,X5DA1H
	CALL ARENAM
X4F38H:	LXI B,X5D84H
	LXI D,BB2PNT
	CALL AP0100
	ORA L
	JNZ X4F5FH
	LHLD BB3PNT
	MOV B,H
	MOV C,L
	CALL ADELET
	LHLD BB3PNT
	XCHG
	LXI B,X5D84H
	CALL ARENAM
	LHLD BB3PNT
	MOV B,H
	MOV C,L
	CALL ISERCK
X4F5FH:	LHLD BB3PNT
	SHLD BB1PNT
	SHLD ISERNO
	CALL X4A90H
	LXI B,EXITMS
	CALL WRSTR
	LXI H,X5D5FH
	MVI M,00H
	CALL DTAIL
	RET
;======================
X4F7AH:	LDA X5D5EH
	RAR
	JNC X4FA7H
	CALL LDVMRK
	LXI D,X5D22H
	CALL AP0102
	SBB A
	CMA
	STA X5D5FH
	CMA
	PUSH PSW
	CALL LDVMRK
	XCHG
	LXI H,TXTND
	CALL AP0104
	SBB A
	POP B
	MOV C,B
	ANA C
	RAR
	JNC X4FA6H
	CALL SETV
X4FA6H:	RET
;===================
X4FA7H:	LDA X5D58H
	CPI '='
	JNZ X4FD1H
	LHLD X5DDBH
	MVI H,00H
	LXI B,X5D24H
	DAD H
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD X5D54H
	LHLD X5DDBH
	MVI H,00H
	LXI B,X5CB8H
	DAD B
	LDA X5D5FH
	XRA M
	STA X5D5FH
	RET
X4FD1H:	LDA X5D56H
	RAR
	JNC X4FE7H
	CALL SETLBP
	LXI H,0FFFFH
	SHLD X5D54H
	LXI H,X5D5FH
	MVI M,00H
	RET
X4FE7H:	CALL LDSCLN
	SHLD X5D54H
	LXI D,7FFFH
	CALL AP0095
	SBB A
	STA X5D61H
	RAR
	JNC X5004H
	LHLD X5D54H
	CALL AP0041
	SHLD X5D54H
X5004H:	LDA X5D61H
	LXI H,X5D5FH
	XRA M
	MOV M,A
	RET
;===================
COMAND:	CALL GETCMD
	STA CITMP
	LDA X5DC1H
	RAR
	JNC X5021H
	CALL GETCMD
	STA CITMP
	RET
X5021H:	LDA X5D5AH
	CPI 00H
	JNZ X5031H
	LDA CITMP
	ANI 5FH
	STA CITMP
X5031H:	LDA CITMP
	RET
;==================
X5035H:	LXI H,X5E36H
	MOV M,C
	LHLD X5E36H
	MOV C,L
	CALL X575EH
	CMA
	RET
;=================
X5042H:	LXI H,X5E37H
	MOV M,C
	LDA X5E37H
	LXI H,X5D5FH
	XRA M
	RAR
	JNC X5052H
	RET
X5052H:	CALL X4C22H
	RET
;===================
ROLDN:	LXI H,X5E39H
	MOV M,B
	DCX H
	MOV M,C
	LXI B,000EH
	LHLD X5E38H
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD X5C6EH
	LHLD X5E38H
	PUSH H
	LXI D,000DH
	LHLD X5E38H
	DAD D
	PUSH H
	LHLD X5E38H
	INX H
	INX H
	XCHG
	POP B
	CALL X55CCH
	LHLD X5E38H
	PUSH H
	LHLD X5C6EH
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	RET
;===============
ROLUP:	LXI H,X5E3BH
	MOV M,B
	DCX H
	MOV M,C
	LHLD X5E3AH
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD X5C6EH
	LHLD X5E3AH
	INX H
	INX H
	PUSH H
	LXI D,000FH
	LHLD X5E3AH
	DAD D
	MOV B,H
	MOV C,L
	LHLD X5E3AH
	XCHG
	CALL X55CCH
	LXI B,000EH
	LHLD X5E3AH
	DAD B
	PUSH H
	LHLD X5C6EH
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	RET
;==================
X50C4H:	LXI H,X5E3DH
	MOV M,B
	DCX H
	MOV M,C
	LHLD X5E3CH
	INX H
	INX H
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD X5C72H
	CALL LDCK
	MOV L,A
	MVI H,00H
	DAD H
	XCHG
	LHLD X5E3CH
	DAD D
	PUSH H
	LHLD X5E3CH
	INX H
	INX H
	XTHL
	MOV C,M
	INX H
	MOV B,M
	POP H
	MOV M,C
	INX H
	MOV M,B
	CALL LDCK
	MOV L,A
	MVI H,00H
	DAD H
	XCHG
	LHLD X5E3CH
	DAD D
	PUSH H
	LHLD X5C72H
	XCHG
	POP H
	MOV M,E
	INX H
	MOV M,D
	RET
;=====================
X5106H:	LDA X5D5FH
	RAR
	JNC X5128H
	CALL X499DH
	XCHG
	LHLD X5D54H
	MOV B,H
	MOV C,L
	CALL X583EH
	SHLD X5D54H
	LXI D,X5D22H
	CALL AP0102
	SHLD X5C80H
	JMP X513FH
X5128H:	CALL X49A7H
	XCHG
	LHLD X5D54H
	MOV B,H
	MOV C,L
	CALL X583EH
	SHLD X5D54H
	XCHG
	LHLD TXTND
	DAD D
	SHLD X5C80H
X513FH:	RET
;===================
X5140H:	CALL GETCMD
	STA CITMP
	LXI H,X5DB9H
	CMP M
	JNZ X5150H
	MVI A,00H
	RET
X5150H:	LDA X5DC1H
	RAR
	JNC X515DH
	CALL GETCMD
	STA CITMP
X515DH:	MVI A,0FFH
	RET
;=================
X5160H:	LXI B,BFPNT
	LXI D,TXTND
	CALL AP0098
	ORA L
	JNZ X5170H
	MVI A,00H
	RET
X5170H:	LHLD TXTND
	MOV A,M
	STA X5E3EH
	LXI H,X5E3FH
	MVI M,00H
X517CH:	CALL X5140H
	RAR
	JNC X51C5H
	LDA CITMP
	STA X5D61H
	CALL X5140H
	RAR
	JC X51A3H
	LXI H,X5D61H
	LDA X5E3EH
	CMP M
	JNZ X519FH
	LXI H,X5E3FH
	MVI M,0FFH
X519FH:	LDA X5E3FH
	RET
X51A3H:	LDA X5E3EH
	LXI H,X5D61H
	SUB M
	SBB A
	CMA
	PUSH PSW
	LDA CITMP
	LXI H,X5E3EH
	SUB M
	SBB A
	CMA
	POP B
	MOV C,B
	ANA C
	RAR
	JNC X51C2H
	LXI H,X5E3FH
	MVI M,0FFH
X51C2H:	JMP X517CH
X51C5H:	LDA X5E3FH
	RET
;==================
X51C9H:	LDA X5D5FH
	RAR
	JNC X51D9H
	LHLD X5C80H
	SHLD X5D22H
	JMP X51DFH
X51D9H:	LHLD X5C80H
	SHLD TXTND
X51DFH:	RET
;======================-
;COMMAND BRANCH
;=======================
X51E0H:	CALL COMAND
	SUI 41H
	STA X5D61H
	MOV C,A
	MVI A,19H
	CMP C
	JNC X51F2H
	JMP SYNERR
X51F2H:	LHLD X5D61H
	MOV C,L
	MVI B,00H
	LXI H,X5597H
	DAD B
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG
	PCHL
;
UA:	LDA X5D5FH
	RAR
	JNC X521AH
	LXI B,SCOLON+2
	LXI D,SCOLON+4
	CALL AP0098
	XCHG
	DCX H
	MOV M,E
	INX H
	MOV M,D
	JMP X5225H
X521AH:	LHLD SCOLON+2
	XCHG
	LHLD SCOLON+4
	DAD D
	SHLD SCOLON+4
X5225H:	LXI B,SCOLON
	CALL ROLUP
	JMP X55CBH
;
UB:	CALL STRST
	JMP X55CBH
;
UC:	LDA X5D5FH
	RAR
	JNC X5244H
	LXI H,0FFFFH
	SHLD E14UF
	JMP X5275H
X5244H:	CALL SETLPZ
	LHLD X5D54H
	XCHG
	LXI B,00F0H
	CALL X5835H
	LXI B,X5D22H
	LXI D,MSIZ1
	PUSH H
	CALL AP0098
	XCHG
	POP B
	CALL X583EH
	SHLD E14UF
	LXI B,E14UF
	LXI D,MSIZ1
	CALL AP0098
	SHLD BFPNT
	SHLD TXTND
	CALL OPUCMS
X5275H:	JMP X55CBH
;
UD:	LXI H,X5E40H
	MVI M,00H
	LHLD MSIZ1
	SHLD X5C72H
X5283H:	LHLD X5C72H
	LXI D,X5C72H
	CALL AP0012
	DCX H
	XCHG
	DCX H
	MOV M,E
	INX H
	MOV M,D
	LXI H,MSIZ2
	CALL AP0104
	JNC X52C2H
	MVI C,20H
	CALL CNDCO
	LHLD X5C72H
	MOV C,M
	CALL CNDCO
	LDA X5E40H
	INR A
	STA X5E40H
	ANI 0FH
	CPI 00H
	JNZ X52B8H
	CALL X4E31H
X52B8H:	LHLD X5C72H
	INX H
	SHLD X5C72H
	JMP X5283H
X52C2H:	CALL X4E31H
	JMP X55CBH
;
UE:	CALL LDSCLN
	LXI D,SCOLON+2
	CALL AP0102
	ORA L
	SUI 01H
	SBB A
	MOV C,A
	CALL X5042H
	JMP X55CBH
;
UF:	CALL COMAND
	PUSH PSW
	MVI A,0FH
	LXI D,X5D54H
	CALL AP0025
	LXI B,X5D91H
	DAD B
	POP B
	MOV C,B
	MOV M,C
	JMP X55CBH
;
UG:	CALL X4A20H
	MVI C,01H
	CALL X49F2H
	CALL EDMCLD
	JMP ERRST
	JMP X55CBH
;
UH:	CALL LDCK
	MOV C,A
	MVI B,00H
	LXI H,SCOLON
	DAD B
	DAD B
	LDA X5D5FH
	INR A
	MOV E,A
	MVI D,00H
	DAD D
	SHLD X5C72H
	LHLD X5C72H
	MVI M,00H
	JMP X55CBH
UI:	LHLD TXTND
	SHLD X5C72H
	PUSH H
	CALL LDCK
	MOV C,A
	MVI B,00H
	LXI H,SCOLON
	DAD B
	DAD B
	XTHL
	MOV C,M
	INX H
	MOV B,M
	POP H
	MOV M,C
	INX H
	MOV M,B
	JMP X55CBH
;
UJ:	LDA X5D5FH
	RAR
	JNC X5349H
	CALL DELCHR
	RET
X5349H:	LHLD E8UF
	MOV C,L
	CALL CO
	LHLD E9UF
	MOV C,L
	CALL CO
	LXI H,X5D59H
	MVI M,00H
	JMP X55CBH
;
UK:	CALL COMAND
	STA CITMP
	CALL X4056H
	LXI D,MSIZ2
	LXI B,X5C76H
	CALL AP0098
	JNC X5377H
	JMP SYNERR
X5377H:	LHLD X5C76H
	LXI D,MSIZ1
	CALL AP0012
	SHLD X5C6EH
	LHLD MSIZ1
	PUSH H
	LHLD X5C76H
	DCX H
	MOV B,H
	MOV C,L
	LHLD X5C6EH
	XCHG
	CALL X55CCH
	LHLD X5C6EH
	SHLD MSIZ1
	MVI A,00H
	LXI H,X5DDBH
	CMP M
	JNC X53A6H
	JMP ERRST
X53A6H:	JMP X55CBH
;
UL:	CALL LDSCLN
	LXI D,SCOLON+2
	CALL AP0102
	SBB A
	MOV C,A
	CALL X5042H
	JMP X55CBH
;
UM:	LDA X5D5FH
	RAR
	JNC X53E2H
	LHLD SCOLON+4
	XCHG
	LHLD SCOLON+2
	CALL AP0029
	SHLD X5C80H
	LHLD SCOLON+4
	XCHG
	CALL AP0030
	XCHG
	SHLD SCOLON+4
	LHLD X5C80H
	SHLD SCOLON+2
	JMP X53F5H
X53E2H:	LHLD SCOLON+4
	XCHG
	LHLD SCOLON+2
	CALL AP0034
	SHLD SCOLON+4
	LXI B,SCOLON
	CALL ROLUP
X53F5H:	JMP X55CBH
;
UN:	LDA X5D5FH
	RAR
	JNC X5408H
	LHLD X5D54H
	CALL AP0041
	SHLD X5D54H
X5408H:	LHLD X5D54H
	SHLD SCOLON+2
	JMP X55CBH
;
UO:	CALL X3FE2H
	LHLD X5D22H
	SHLD X5C72H
	CALL LDSCLN
	PUSH H
	LHLD X5C72H
	POP B
	MOV M,C
	INX H
	MOV M,B
	LHLD X5D22H
	INX H
	INX H
	SHLD X5D22H
	JMP X55CBH
;
UP:	CALL X4A20H
	MVI C,02H
	CALL X49F2H
	LDA X5D5FH
	RAR
	JNC X5448H
	LXI H,BRKMS
	SHLD X5C6EH
	JMP X544EH
X5448H:	LXI H,X5D91H
	SHLD X5C6EH
X544EH:	LXI D,0010H
	LHLD X5C6EH
	DAD D
	XCHG
	LHLD X5C6EH
	MOV B,H
	MOV C,L
	CALL X4E14H
	LHLD MSIZ1
	MOV B,H
	MOV C,L
	LHLD MSIZ2
	XCHG
	CALL X4E14H
	CALL ACLOS1
	JMP X55CBH
;
UQ:	LXI H,TXTBUF
	SHLD X5D22H
	SHLD TXTND
	JMP X55CBH
;
UR:	CALL X5160H
	MOV C,A
	CALL X5042H
	JMP X55CBH
;
US:	LDA X5D5FH
	RAR
	JNC X5496H
	LXI B,SCOLON
	CALL ROLUP
	JMP X549CH
X5496H:	LXI B,SCOLON
	CALL ROLDN
X549CH:	JMP X55CBH
;
UT:	LXI B,0713H
	LXI D,X5D54H
	CALL AP0100
	ORA L
	JNZ X54BBH
	CALL COMAND
	STA X5DB9H
	LXI B,ESCMS
	CALL WRSTR
	JMP ERRBK
X54BBH:	LXI B,BFPNT
	LXI D,TXTND
	CALL AP0098
	ORA L
	SUI 01H
	SBB A
	LXI H,X5D5FH
	ORA M
	RAR
	JNC X54E0H
	LHLD X5DC4H
	MVI H,00H
	LXI B,X5CFAH
	DAD H
	DAD B
	MVI A,01H
	MOV M,A
	INX H
	MVI M,00H
X54E0H:	JMP X55CBH
;
UU:	CALL DTAIL
	JMP X55CBH
;
UV:	LDA X5D5FH
	RAR
	JNC X54F9H
	LXI B,VSTACK
	CALL ROLUP
	JMP X54FFH
X54F9H:	LXI B,VSTACK
	CALL ROLDN
X54FFH:	JMP X55CBH
;
UW:	LDA X5D5FH
	RAR
	JNC X5521H
	LHLD X5D54H
	DCX H
	DCX H
	MVI A,0EH
	CALL AP0094
	JC X551EH
	LHLD X5D54H
	XCHG
	LXI H,E3UF
	MOV M,E
X551EH:	JMP X553EH
X5521H:	CALL X3FE2H
	CALL LDSCLN
	MOV B,H
	MOV C,L
	LHLD X5D22H
	XCHG
	CALL LDUCMS
	LDA X5D5BH
	LXI D,X5D22H
	CALL AP0014
	XCHG
	DCX H
	MOV M,E
	INX H
	MOV M,D
X553EH:	JMP X55CBH
;
UX:	LDA X5D5FH
	RAR
	JNC X5551H
	LXI B,VSTACK
	CALL X50C4H
	JMP X5557H
X5551H:	LXI B,SCOLON
	CALL X50C4H
X5557H:	JMP X55CBH
;
UY:	LHLD X5D5CH
	MOV C,L
	CALL X5042H
	JMP X55CBH
;
UZ:	LDA X5D5FH
	RAR
	JNC X5581H
	CALL X499DH
	PUSH H
	CALL LDCK
	MOV C,A
	MVI B,00H
	LXI H,SCOLON
	DAD B
	DAD B
	POP B
	MOV M,C
	INX H
	MOV M,B
	JMP X5594H
X5581H:	CALL X49A7H
	PUSH H
	CALL LDCK
	MOV C,A
	MVI B,00H
	LXI H,SCOLON
	DAD B
	DAD B
	POP B
	MOV M,C
	INX H
	MOV M,B
X5594H:	JMP X55CBH
;
X5597H:	DW UA,UB,UC,UD
	DW UE,UF,UG,UH
	DW UI,UJ,UK,UL
	DW UM,UN,UO,UP
	DW UQ,UR,US,UT
	DW UU,UV,UW,UX
	DW UY,UZ
;
X55CBH:	RET
;======================================
X55CCH:	POP H
	XTHL
	MOV A,C
	SUB L
	MOV C,A
	MOV A,B
	SBB H
	MOV B,A
	MOV A,E
	SUB L
	MOV A,D
	JZ X55DEH
	SBB H
	JMP X55E0H
X55DEH:	SBB H
	RZ
X55E0H:	PUSH H
	LXI H,X5636H
	JC X55F0H
	POP H
	DAD B
	PUSH H
	XCHG
	DAD B
	XCHG
	LXI H,X565FH
X55F0H:	INX B
	MOV A,B
	RRC
	RRC
	RRC
	MOV B,A
	MVI A,07H
	ANA C
	PUSH PSW
	XRA C
	RRC
	RRC
	RRC
	XRA B
	ANI 1FH
	XRA B
	MOV C,A
	MVI A,1FH
	ANA B
	MOV B,A
	INR B
	INR C
	POP PSW
	RLC
	RLC
	PUSH B
	CMA
	MOV C,A
	MVI B,0FFH
	INX B
	DAD B
	POP B
	XTHL
	RET
;==================
X5616H:	MOV A,M
	STAX D
	INX H
	INX D
	MOV A,M
	STAX D
	INX H
	INX D
	MOV A,M
	STAX D
	INX H
	INX D
	MOV A,M
	STAX D
	INX H
	INX D
	MOV A,M
	STAX D
	INX H
	INX D
	MOV A,M
	STAX D
	INX H
	INX D
	MOV A,M
	STAX D
	INX H
	INX D
	MOV A,M
	STAX D
	INX H
	INX D
X5636H:	DCR C
	JNZ X5616H
	DCR B
	JNZ X5616H
	RET
;======================
X563FH:	MOV A,M
	STAX D
	DCX H
	DCX D
	MOV A,M
	STAX D
	DCX H
	DCX D
	MOV A,M
	STAX D
	DCX H
	DCX D
	MOV A,M
	STAX D
	DCX H
	DCX D
	MOV A,M
	STAX D
	DCX H
	DCX D
	MOV A,M
	STAX D
	DCX H
	DCX D
	MOV A,M
	STAX D
	DCX H
	DCX D
	MOV A,M
	STAX D
	DCX H
	DCX D
X565FH:	DCR C
	JNZ X563FH
	DCR B
	JNZ X563FH
	RET
;==================
X5668H:	MOV H,B
	MOV L,C
	LXI B,0104H
	JMP X5636H
;=================
X5678H:	CALL X5697H
X567BH:	CALL X568AH
	DCR E
	JNZ X567BH
	DCR D
	JNZ X567BH
	INX H
	RET
;=================
X5688H:	CMP M
	RZ
X568AH:	DCX H
	DCR C
	JNZ X5688H
	DCR B
	JNZ X5688H
	INX H
	INX H
	POP PSW
	RET
;=================
X5697H:	LDA E5UF
	LHLD X5D54H
	XCHG
	INR B
	INR C
	INR D
	INR E
	RET
;=================
X56A3H:	CALL X5697H
	JMP X56ACH
X56A9H:	CALL X56B8H
X56ACH:	DCR E
	JNZ X56A9H
	DCR D
	JNZ X56A9H
	RET
;===============
X56B5H:	CMP M
	INX H
	RZ
X56B8H:	DCR C
	JNZ X56B5H
	DCR B
	JNZ X56B5H
	POP PSW
	RET
;=================
X56C2H:	LHLD X5DB8H
	LDA E4UF
	MOV H,A
	MOV A,E
	SUB C
	MOV E,A
	MOV A,D
	SBB B
	MOV D,A
	PUSH B
	XTHL
	POP B
	INR D
	INR E
X56D4H:	LDA X5D64H
	CALL X5701H
	PUSH B
	PUSH D
	PUSH H
	LXI D,X5D64H
X56E0H:	DCR C
	INX D
	JZ X56F5H
	LDAX D
	CMP M
	INX H
	JZ X56E0H
	CMP B
	JZ X56E0H
	POP H
	POP D
	POP B
	JMP X56D4H
X56F5H:	POP PSW
	POP PSW
	POP PSW
	SHLD X5D52H
	MVI A,0FFH
	RET
;================
X56FEH:	CMP M
	INX H
	RZ
X5701H:	DCR E
	JNZ X56FEH
	DCR D
	JNZ X56FEH
	POP PSW
	SUB A
	RET
;=================
X570CH:	MVI B,00H
	MOV A,C
	CPI 2BH
	JZ X5737H
	CPI 2DH
	JC X5736H
	SUI 3CH
	JC X5737H
	DCR A
	JZ X5737H
	SUI 04H
	JC X5736H
	CPI 1AH
	JC X5738H
	SUI 20H
	JC X5736H
	CPI 1AH
	JC X5738H
X5736H:	INR B
X5737H:	INR B
X5738H:	MOV A,B
	RET
;================
X573AH:	MVI A,60H
	ANA C
	RZ
	CPI 20H
	JNZ X5744H
	DCR C
X5744H:	XRA C
	SUI 1AH
	CPI 01H
	RZ
	SUI 04H
	CPI 0FFH
	RZ
	SUB A
	RET
;==================
X5751H:	LDA X5DC4H
	MOV C,A
	ADD A
	ADD C
	ADD A
	ADD A
	ADD A
	MOV L,A
	MVI H,00H
	RET
;==================
X575EH:	MOV A,C
	SUI 2EH
	RZ
	DCR A
	RZ
	SUI 0EH
	RZ
	ADI 02H
	RZ
X576AH:	MVI A,0FFH
	RET
;=================
X576DH:	LHLD X5D4EH
	MVI A,0DH
	CMP M
	JZ X5778H
	ORA M
	RP
X5778H:	LDA X5DB9H
	INX H
	CMP M
	JNZ X576AH
	INX H
	CMP M
	JNZ X576AH
	SUB A
	RET
;===============
X5787H:	MVI A,'0'
	ADD C
	CPI ':'
	RC
	ADI 07H
	RET
;================
X5790H:	LXI D,TXTBUF
	MVI C,0AH
	LXI H,VSTACK
X5798H:	MOV M,E
	INX H
	MOV M,D
	INX H
	DCR C
	JNZ X5798H
	RET
;=================
X57A1H:	LHLD ISERNO
	MOV B,H
	MOV C,L
	CALL X5A4AH
	CALL X5903H
	CPI ':'
	JZ X57B4H
	MVI A,'0'
	RET
X57B4H:	CALL X599FH
	CALL X5903H
	CPI 'F'
	JZ X57C2H
	MVI A,0C8H
	RET
X57C2H:	CALL X599FH
	CALL X5903H
	RET
;=================
X57C9H:	LXI H,X5E87H
	MOV M,D
	DCX H
	MOV M,E
	DCX H
	MOV M,B
	DCX H
	MOV M,C
	LHLD ISERNO
	MOV B,H
	MOV C,L
	CALL X5A4AH
	LHLD X5E84H
	MOV B,H
	MOV C,L
	CALL X58CBH
X57E3H:	CALL X5951H
	PUSH PSW
	CALL X5903H
	SUI '.'
	ADI 0FFH
	SBB A
	POP B
	MOV C,B
	ANA C
	RAR
	JNC X57FCH
	CALL X58E2H
	JMP X57E3H
X57FCH:	MVI C,'.'
	CALL X585AH
	LHLD X5E86H
	MOV B,H
	MOV C,L
	CALL X58A5H
	MVI C,00H
	CALL X585AH
	RET
;==================
X580FH:	LDAX D
	CMP C
	MVI A,00H
	RC
	INX D
	XCHG
	MOV D,A
	MOV A,C
	ANI 0F8H
	RRC
	RRC
	RRC
	MOV E,A
	DAD D
	MOV A,C
	ANI 07H
	MOV E,A
	MOV A,M
	LXI H,X582DH
	DAD D
	ANA M
	RZ
	MVI A,0FFH
	RET
;===================
X582DH:	DB 80H,40H,20H,10H
	DB 08H,04H,02H,01H
;==================
X5835H:	XCHG
	MOV A,C
	SUB L
	MOV A,B
	SBB H
	RC
	MOV H,B
	MOV L,C
	RET
;================
X583EH:	XCHG
	MOV A,C
	SUB L
	MOV A,B
	SBB H
	RNC
	MOV H,B
	MOV L,C
	RET
;===============
X5847H:	POP H
	XTHL
	MOV A,E
	INR L
	INR H
	JMP X5851H
X584FH:	STAX B
	INX B
X5851H:	DCR L
	JNZ X584FH
	DCR H
	JNZ X584FH
	RET
;===============
X585AH:	LXI H,X5E8AH
	MOV M,C
	LHLD X5E88H
	LDA X5E8AH
	MOV M,A
	LHLD X5E88H
	INX H
	SHLD X5E88H
	RET
;===============
X58A5H:	LXI H,X5E8FH
	MOV M,B
	DCX H
	MOV M,C
X58ABH:	LHLD X5E8EH
	MOV A,M
	CPI 00H
	JZ X58C5H
	LHLD X5E8EH
	MOV C,M
	CALL X585AH
	LHLD X5E8EH
	INX H
	SHLD X5E8EH
	JMP X58ABH
X58C5H:	LHLD X5E88H
	MVI M,00H
	RET
;=================
X58CBH:	POP D
	LHLD X5E88H
	PUSH H
	LXI H,X58DBH
	PUSH H
	MOV H,B
	MOV L,C
	SHLD X5E88H
	PUSH D
	RET
;===================
X58DBH:	XCHG
	POP H
	SHLD X5E88H
	XCHG
	RET
;================
X58E2H:	LHLD ISERNO
	MOV C,M
	CALL X585AH
	CALL X599FH
	RET
;===============
X58EDH:	LHLD ISERNO
	MOV A,M
	MOV B,A
	RET
;=================
X58F3H:	CALL X58EDH
	CPI 30H
	JC X5920H
	CPI 3AH
	JNC X5920H
X5900H:	STC
	SBB A
	RET
X5903H:	CALL X58EDH
	CPI 61H
	RC
	CPI 7BH
	RNC
	SUI 20H
	RET
X590FH:	CALL X58F3H
	RC
	CALL X5903H
	CPI 'A'
	JC X5920H
	CPI 'G'
	JC X5900H
X5920H:	SUB A
	RET
X5922H:	CALL X5903H
	CPI 'A'
	JC X5920H
	CPI 5BH;'['
	JC X5900H
	SUB A
	RET
X5931H:	CALL X5922H
	RC
	CALL X58F3H
	RC
	SUB A
	RET
	CALL X5931H
	RC
	MOV A,B
	CPI '?'
	JZ X5900H
	CPI 'A'
	JZ X5900H
	CPI 5FH;BACKSPACE CURSOR
	JZ X5900H
	SUB A
	RET
X5951H:	CALL X5931H
	RC
	MOV A,B
	CPI ':'
	JZ X5900H
	CPI '.'
	JZ X5900H
	SUB A
	RET
X5962H:	CALL X58EDH
	CPI CR
	JZ X5900H
	CPI LF
	JZ X5900H
	CPI 1BH;ESC
	JZ X5900H
	SUB A
	RET
X5976H:	CALL X58EDH
	CPI 09H;CTRL I
	JZ X5900H
	CPI ' '
	JZ X5900H
	SUB A
	RET
;==================
X5985H:	CALL X58EDH
	SUI '0'
	CPI 0AH
	RC
	SUI 07H
	ANI 5FH
	RET
;=================
X5992H:	LHLD ISERNO
	MOV A,M
	SUI 00H
	SUI 01H
	SBB A
	STA X5E92H
	RET
;================
X599FH:	CALL X5992H
	LDA X5E92H
	INR A
	LXI D,ISERNO
	CALL AP0014
	XCHG
	DCX H
	MOV M,E
	INX H
	MOV M,D
	CALL X5992H
	RET
;==================
X59D4H:	LXI H,X5E95H+1
	MOV M,B
	DCX H
	MOV M,C
	CALL X5A3DH
X59DDH:	CALL X5E9BH
	RAR
	JNC X59F2H
	CALL X599FH
	LDA X5E92H
	RAR
	JNC X59EFH
	RET
X59EFH:	JMP X59DDH
X59F2H:	RET
;=================-
X59F3H:	LXI H,X5E98H
	MOV M,B
	DCX H
	MOV M,C
	CALL X5992H
	LHLD ISERNO
	SHLD X5E99H
X5A02H:	CALL X5903H
	LHLD X5E97H
	SUB M
	SUI 01H
	SBB A
	PUSH PSW
	LDA X5E92H
	CMA
	POP B
	MOV C,B
	ANA C
	RAR
	JNC X5A31H
	LHLD X5E97H
	INX H
	SHLD X5E97H
	CALL X599FH
	LHLD X5E97H
	MOV A,M
	CPI 00H
	JNZ X5A2EH
	MVI A,0FFH
	RET
X5A2EH:	JMP X5A02H
X5A31H:	LHLD X5E99H
	SHLD ISERNO
	CALL X5992H
	MVI A,00H
	RET
;================
X5A3DH:	MOV H,B
	MOV L,C
	SHLD X5E9CH
	RET
;===============
X5A43H:	LXI B,X5976H
	CALL X59D4H
	RET
;================
X5A4AH:	POP D
	LHLD ISERNO
	PUSH H
	LXI H,X5A5AH
	PUSH H
	MOV H,B
	MOV L,C
	SHLD ISERNO
	PUSH D
	RET
;==================
X5A5AH:	XCHG
	POP H
	SHLD ISERNO
	MOV B,A
	SUB A
	SUB M
	CMC
	SBB A
	STA X5E92H
	MOV A,B
	XCHG
	RET
;====================-
MEMSIZ:	CALL MEMCK
	MOV H,B
	MOV L,A
	RET
;=============================
;CP/M INTERFACE
;==============================
ADELET:	LXI H,DELETE+1
	MOV M,B
	DCX H
	MOV M,C
	MVI A,02H
	JMP X5B2BH
AOPEN1:	LXI H,ACCES1
	MOV M,E
	DCX H
	CALL X5B56H
	LHLD WRITE1
	SHLD READ1
	SHLD CLOSE1
	RET
ACLOS1:	LXI D,CLOSE1
	JMP X5B5FH
AREAD1:	LXI H,READ1+5
	JMP X5B5AH
AWRIT1:	LXI H,WRITE1+5
	JMP X5B20H
AOPEN3:	LXI H,OPEN3+3
	CALL X5B56H
	LHLD READ3
	SHLD CLOSE3
	RET
ACLOS3:	LXI D,CLOSE3
	JMP X5B5FH
AREAD3:	LXI H,READ3+5
	JMP X5B5AH
AOPEN4:	LXI H,OPEN4+3
	CALL X5B56H
	LHLD WRITE4
	SHLD CLOSE4
	RET
ACLOS4:	LXI D,CLOSE4
	JMP X5B5FH
AWRIT4:	LXI H,WRITE4+5
	JMP X5B20H
ACIRD:	LXI H,CIREAD+5
	JMP X5B5AH
ARENAM:	MVI A,07H
	LXI H,RENAME+3
	MOV M,D
	DCX H
	MOV M,E
	DCX H
	MOV M,B
	DCX H
	MOV M,C
	JMP X5B2BH
AWHOCN:	MVI A,0DH
	LXI H,WHOCON+3
	JMP X5B26H
X5B20H:	MVI A,04H
X5B22H:	MOV M,D
	DCX H
	MOV M,E
	DCX H
X5B26H:	MOV M,B
	DCX H
	MOV M,C
	DCX H
	DCX H
X5B2BH:	XCHG
	MOV C,A
X5B2DH:	CALL ISIS
	LHLD STATUS
	MOV A,H
	ORA L
	RZ
	MVI A,0FFH
	STA X5F35H
	LDA X5F34H
	RAR
	RNC
AERROR:	MVI C,0CH
	LXI D,STATUS
	CALL ISIS
	LDA X5F36H
	RAR
	RNC
AEXIT:	MVI C,09H
	LXI D,EXIT
	CALL ISIS
	RST 0
X5B56H:	SUB A
	JMP X5B26H
X5B5AH:	MVI A,03H
	JMP X5B22H
X5B5FH:	MVI C,01H
	JMP X5B2DH
;=====================
CO:	MOV E,C
	MVI C,6		;DIRECT O/P
	CALL BDOS
	RET
;=================
CI:	MVI C,6
	MVI E,0FFH	;DIRECT I/P
	CALL BDOS
	ORA A
	JZ CI
	RET
;====================
CSTS:	MVI C,11
	CALL BDOS
	ORA A
	RET
;===================
MEMCK:	LHLD BOOT+6
	DCX H
	MOV B,H
	MOV A,L
	RET
;========================
;REQUIRES C=ISIS FUNCTION CODE
;DE=.ISIS CONTROL BLOCK
ISIS:	LXI H,0
	DAD SP
	SHLD USERSP
	LXI SP,USERSP
	MVI A,14	;CALLS 0 TO 14 VALID
	SUB C
	JC ISERR
	MOV L,C
	MVI H,0
	DAD H
	LXI B,ISBASE
	DAD B
	MOV A,M
	INX H
	MOV H,M
	MOV L,A
	PCHL		;TO SIMULATED ISIS PROCEDURE
;
ISBASE:	DW OPEN
	DW CLOSE
	DW DXLETE
	DW READ
	DW WRITE
	DW ISERR
	DW ISERR
	DW RXNAME
	DW ISERR
	DW XIT
	DW ISERR
	DW ISERR
	DW ERROR
	DW WHXCON
	DW ISERR
;=====================
OPEN:	CALL OPN
	JMP ISRET
OPN:	XCHG
	SHLD ISCBL
	LXI H,TABLE2
	LXI D,TABLEN
	MVI C,6
OPN1:	MOV A,M
	ORA A
	JZ OPNFND
	DAD D
	DCR C
	JNZ OPN1
	LXI B,3
	JMP ERR		;NO TABLE SPACE
OPNFND:	CMA
	MOV M,A		;RECORD ALLOCATION
	SHLD OPNTAB	;SAVE .TABLE
	INX H
	INX H
	MOV C,M
	INX H
	MOV B,M		;BC=AFTN
	LHLD ISCBL
	MOV E,M
	INX H
	MOV D,M		;RETURN OAFT
	XCHG
	MOV M,C
	INX H
	MOV M,B
	XCHG
	LXI D,5
	DAD D
	XRA A
	CMP M		;TEST ECHO
	INX H
	JNZ ECHERR
	CMP M
	JZ OPN2
ECHERR:	LXI B,25
	JMP ERR		;ILLEGAL ECHO
OPN2:	DCX H
	DCX H
	DCX H
	MOV A,M		;ACCESS
	ORA A
	JZ OPN3
	CPI 4
	JC OPN4
OPN3:	LXI B,22
	JMP ERR
OPN4:	XCHG
	LHLD OPNTAB
	INX H
	MOV M,A		;ACCESS
	XCHG
	DCX H
	DCX H		;FILENAME POINT
	MOV C,M
	INX H
	MOV B,M
	LXI D,14
	LHLD OPNTAB
	DAD D
	PUSH B
	PUSH H
	XRA A
	MVI C,36
	CALL CLEAR	;CLEAR FCB TO NULLS
	POP D
	POP H
	PUSH D
	CALL MAKFCB
	RAR
	POP D
	JNC OPN5
	LHLD OPNTAB
	XRA A
	MOV M,A		;REMOVE TABLE ALLOC
	LHLD ISCBL
	INX H
	INX H
	MOV E,M
	INX H
	MOV D,M		;DE=.ISIS FILENAME
	CALL LTST	;LEGAL DEVICE ?
	CPI 0FFH
	JNZ OPN6
	LXI B,5
	JMP OPN10	;ILLEGAL DEVICE
OPN6:	CPI 2
	JC OPN17
	ADI 6
OPN17:	MOV C,A
	MVI B,0		;BC=AFTN
	LXI D,0
	CALL SAVST	;RETURN AFTN
	LXI B,0
	JMP OPN10
OPN5:	LHLD OPNTAB
	INX H
	INX H
	MOV B,M		;CURRENT AFTN
	MVI C,6
	LXI H,TABLE2
OPN15:	MOV A,M		;TEST FOR OPEN TABLE
	ORA A
	PUSH D
	PUSH H
	JZ OPN20
	INX H
	INX H
	MOV A,B
	CMP M
	JZ OPN20
	PUSH B
	LXI B,12
	DAD B
	MVI C,12
OPN16:	LDAX D
	CMP M
	JNZ OPN19
	INX H
	INX D
	DCR C
	JNZ OPN16
	POP B
	POP H
	POP D
	LXI B,12
	JMP ERR		;ALREADY OPEN
OPN19:	POP B
OPN20:	POP H
	LXI D,TABLEN
	DAD D
	POP D
	DCR C
	JNZ OPN15
	PUSH D
	MVI C,15	;OPEN
	CALL BDOS
	POP D
	INR A
	JNZ OPN8
	LHLD OPNTAB	;FILE NON EXISTING
	INX H
	MOV A,M		;ACCESS
	CPI 2
	JZ OPN7
	CPI 3
	JZ OPN7
	LXI B,13
	JMP ERR		;NO SUCH FILE
OPN7:	PUSH D
	MVI C,22	;MAKE
	CALL BDOS
	INR A
	POP D
	JNZ OPN21
	LXI B,9
	JMP ERR		;DIR FULL
OPN8:	LXI H,9
	DAD D
	MOV A,M
	ANI 80H		;WR PROT BIT
	JZ OPN9A
	LHLD OPNTAB
	INX H
	MOV A,M
	DCR A
	JZ OPN30
	LXI B,14	;WRITE PROTECTED
ERR:	LHLD OPNTAB
	MVI M,0
	JMP OPN10
OPN9A:	LHLD OPNTAB
	INX H
	MOV A,M
	CPI 2		;WRITE
	JNZ OPN30
	PUSH D
	MVI C,19	;DELETE THEN MAKE
	CALL BDOS
	POP D
	JMP OPN7
OPN30:	PUSH D		;SAVE .FCB
	LXI D,3
	DAD D
	MOV E,M
	INX H
	MOV D,M		;DE=.BUFF
	MVI C,26	;SET DMA
	CALL BDOS
	POP D
	MVI C,20	;READ
	CALL BDOS
OPN21:	CALL SETEOF	;NON ZERO=EOF
OPN9:	LHLD OPNTAB
	LXI D,4
	DAD D
	MOV E,M
	INX H
	MOV D,M
	INX H
	MOV M,E
	INX H
	MOV M,D		;INIT CURRENT BYTE POINT
	LXI B,0		;NO ERROR
OPN10:	LXI D,8		;RETURN STATUS
	CALL SAVST
	RET
;========================
CLOSE:	CALL CLOS
	JMP ISRET
CLOS:	XCHG
	SHLD ISCBL
	MOV A,M		;AFTN
	CPI 8
	JC CLO1
CLO0:	LXI B,0
	JMP CLER
CLO1:	SUI 2
	JM CLO0
	LXI H,TABLE2
	LXI D,TABLEN
CLO2:	JZ CLO3
	DAD D
	DCR A
	JMP CLO2
CLO3:	SHLD OPNTAB
	MOV A,M
	ORA A
	LXI B,2
	JZ CLER		;TABLE NOT OPEN
	CALL CLO6	;CLOSE TABLE
	LHLD OPNTAB
	MVI M,0		;CLOSE TABLE
	LXI B,0
CLER:	LXI D,2		;RETURN STATUS
	CALL SAVST
	RET
;========================
DXLETE:	XCHG
	SHLD GPCB
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD DBLK+2
	LXI H,3
	SHLD DBLK+4	;UPDATE
	LXI D,DBLK	;ISIS OPEN
	CALL OPN
	LHLD DSTAT
	MOV A,L
	ORA A
	JZ DELET1
	MOV C,L
	MOV B,H
	JMP DELET3
DELET1:	LXI B,17
	LDA DAFT
	CPI 8
	JNC DELET2	;NOT DISK FILE
	SUI 2
	JM DELET2
	LHLD OPNTAB	;.TABLE
	LXI D,14
	DAD D
	XCHG		;DE=.FCB
	MVI C,19	;DELETE
	CALL BDOS
	INR A
	JZ IOERR	;NOT FOUND, FATAL
	LXI B,0		;NO ERROR
DELET2:	LHLD OPNTAB
	XRA A
	MOV M,A		;DE ALLOCATE TABLE
DELET3:	LHLD GPCB
	SHLD ISCBL
	LXI D,2		;RETURN STATUS
	CALL SAVST
	JMP ISRET
;========================
READ:	LXI H,0
	SHLD ACT	;SET ACTUAL=0
	XCHG
	SHLD ISCBL
	MOV A,M		;AFTN
	ORA A
	JNZ RD1
	LXI B,8
	JMP RDERR	;OPEN FOR WRITE
RD1:	CPI 1
	JNZ RD2
	XRA A
	CMA
	STA CONSW	;SET :CI: SWITCH
	LHLD CIPNT
	SHLD INPTR
	JMP RD8
RD2:	CPI 8
	JC RD3
	LXI B,8
	JMP RDERR	;ILLEGAL ACCESS
RD3:	SUI 2
	LXI H,TABLE2
	LXI D,TABLEN	;FIND TABLE
RD4:	JZ RD5
	DAD D
	DCR A
	JMP RD4
RD5:	SHLD OPNTAB	;SAVE TABLE POINT
	MOV A,M
	ORA A
	JNZ RD6
	LXI B,2
	JMP RDERR	;FILE NOT OPEN
RD6:	INX H
	MOV A,M
	CPI 1
	JZ RD7
	CPI 3
	JZ RD7
	LXI B,8
	JMP RDERR	;ILLEGAL ACCESS
RD7:	CALL RWSET1
RD8:	CALL RWSET2
GETNXT:	LHLD LEN
	XCHG
	LHLD ACT
	MOV A,E
	SUB L
	JNZ GETN1
	MOV A,D
	SUB H
	JZ RD80
GETN1:	LDA CONSW
	RAR
	JNC GETN3
	LHLD IBFPNT
	XCHG
	LHLD INPTR
	LDA INITSW
	RAR
	JC RD10
	PUSH D
	PUSH H
RD9:	MVI E,0FFH
	MVI C,6		;READ CI
	CALL BDOS
	ORA A
	JZ RD9		;WAIT FOR CHAR
	POP H
	POP D
	STAX D
	JMP RD11
RD10:	MOV A,M
	STAX D
	INX H
RD11:	CALL TERMTS
	JNC GETN2
	LXI H,81H
	SHLD INPTR	;START OF BUF
	XRA A
	STA INITSW
	LHLD IBFPNT
	INX H
	MVI M,LF
	LHLD ACT
	INX H
	INX H
	SHLD ACT
	JMP RD80
GETN3:	LHLD OPNTAB
	XCHG
	LXI H,8
	DAD D
	MOV A,M		;TEST EOF SW
	ORA A
	JNZ RD80
	LXI H,46	;CR
	DAD D
	MOV A,M
	LXI H,29	;RC
	DAD D
	CMP M
	JNZ RD50	;CR<>RC
	LXI H,27	;S1
	DAD D
	MOV A,M
	ANI 7FH		;IGNORE BIT 7
	JZ RD50		;OK FULL BUFFER
	LHLD STRTBF	;FORM END BYTE POINT
	MOV C,A
	MVI B,0
	DAD B
	LXI D,INPTR
	MOV C,L
	MOV B,H
	CALL AP0100
	JNC RD80	;END OF FILE
RD50:	LHLD INPTR
	XCHG
	LHLD IBFPNT
	LDAX D
	MOV M,A
	INX D
	LHLD ENDPTR
	MOV A,E
	SUB L
	JNZ GETN4
	MOV A,D
	SUB H
	JNZ GETN4
	LHLD OPNTAB
	LXI D,14
	DAD D
	XCHG
	MVI C,20	;READ
	CALL BDOS
	CALL SETEOF	;NON ZERO=EOF
	LHLD OPNTAB
	LXI B,4
	DAD B
	MOV E,M
	INX H
	MOV D,M
GETN4:	LHLD IBFPNT
	XCHG		;HL=INPTR (.BUFFER)
GETN2:	SHLD INPTR
	INX D
	XCHG
	SHLD IBFPNT
	LHLD ACT
	INX H
	SHLD ACT
	JMP GETNXT
RD82:	LHLD INPTR
	SHLD CIPNT
	JMP RD81
RD80:	LDA CONSW
	RAR
	JC RD82
	LHLD INPTR
	XCHG
	LHLD OPNTAB
	LXI B,6
	DAD B
	MOV M,E
	INX H
	MOV M,D		;SAVE INPTR IN TABLE
RD81:	LXI B,0
RDERR:	LXI D,8		;RETURN STATUS
	CALL SAVST
	LHLD ACT
	MOV C,L
	MOV B,H
	LXI D,6
	CALL SAVST	;SAVE ACTUAL
	JMP ISRET
;========================
WRITE:	XCHG
	SHLD ISCBL
	MOV A,M		;AFTN
	CPI 1
	JNZ WR1
	LXI B,6		;OPEN FOR I/P
	JMP WRERR
WR1:	ORA A
	JNZ WR2
WR3:	MVI A,0FFH	;NOT DISK
	STA CONSW
	JMP WR8
WR2:	CPI 8
	JNC WR3
	SUI 2
	LXI H,TABLE2
	LXI D,TABLEN	;FIND TABLE
WR4:	JZ WR5
	DAD D
	DCR A
	JMP WR4
WR5:	SHLD OPNTAB	;SAVE TABLE POINT
	MOV A,M
	ORA A
	JNZ WR6
	LXI B,2
	JMP WRERR	;TABLE NOT OPEN
WR6:	INX H
	MOV A,M
	CPI 2
	JZ WR7
	CPI 3
	JZ WR7
	LXI B,6		;ILLEGAL ACCESS
	JMP WRERR
WR7:	CALL RWSET1
WR8:	CALL RWSET2
WR9:	LHLD LEN
	XCHG
	LHLD ACT
	MOV A,E
	SUB L
	JNZ WR10
	MOV A,D
	SUB H
	JZ WR80
WR10:	LHLD IBFPNT
	MOV C,M		;GET CHAR
	INX H
	SHLD IBFPNT
	LHLD ACT
	INX H
	SHLD ACT
	LDA CONSW
	RAR
	JC WR11
	LHLD ENDPTR
	XCHG
	LHLD INPTR
	MOV M,C		;SAVE CHAR IN BUFFER
	INX H
	SHLD INPTR
	MOV A,E
	SUB L
	JNZ WR9
	MOV A,D
	SUB H
	JNZ WR9
	LHLD OPNTAB
	INX H
	MOV A,M		;ACCESS
	DCX H
	CPI 3
	CZ BACKUP
	LHLD OPNTAB
	XCHG
	LXI H,27
	DAD D
	MOV A,M
	ANI 80H
	MOV M,A		;ZERO S1
	XCHG
	CALL CLOWR	;BDOS WRITE
	LHLD OPNTAB
	INX H
	MOV A,M
	LXI B,3
	DAD B
	MOV E,M
	INX H
	MOV D,M
	XCHG		;START OF BUFFER
	SHLD INPTR
	CPI 3
	JNZ WR9
	LHLD OPNTAB
	LXI D,14
	DAD D
	XCHG
	MVI C,20	;READ
	CALL BDOS
	CALL SETEOF
	ORA A
	JZ WR9
	XRA A
	LHLD INPTR
	MVI C,128
	CALL CLEAR	;128 NULLS TO BUFFER
	JMP WR9
WR11:	LHLD ISCBL
	MOV A,M		;AFTN
	ORA A
	JNZ WR9
	MOV E,C		;WRITE TO CO
	MVI C,6
	CALL BDOS
	JMP WR9
WR80:	LDA CONSW
	RAR
	JC WR90
	LHLD INPTR
	XCHG
	LHLD OPNTAB
	LXI B,6
	DAD B
	MOV M,E
	INX H
	MOV M,D		;SAVE INPTR IN TABLE
	CALL UPDCLO	;WRITE BUFFER IF REQUIRED
WR90:	LXI B,0
WRERR:	LXI D,6		;RETURN STATUS
	CALL SAVST
	JMP ISRET
;========================
RXNAME:	XCHG
	SHLD GPCB
	INX H
	INX H
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD DBLK+2
	LXI H,1		;ACCESS=READ
	SHLD DBLK+4
	LXI D,DBLK
	CALL OPN	;ISIS OPEN
	LDA DSTAT
	CPI 13
	LXI B,11
	JNZ RENER
	LHLD OPNTAB
	LXI D,14
	DAD D
	XCHG
	LXI H,RENTMP
	MVI C,16
REN2:	LDAX D		;MOVE FCB TO BUFFER
	MOV M,A
	INX D
	INX H
	DCR C
	JNZ REN2
	LHLD GPCB
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD DBLK+2
	LXI D,DBLK
	CALL OPN	;ISIS OPEN
	LDA DSTAT
	LXI B,13
	ORA A
	JNZ RENER
	LHLD OPNTAB
	LXI D,14
	DAD D
	PUSH H		;.FCB
	LXI D,16
	DAD D
	XCHG
	LXI H,RENTMP
	MVI C,16
REN3:	MOV A,M
	STAX D
	INX H
	INX D
	DCR C
	JNZ REN3
	POP D		;.FCB
	LDAX D
	LXI H,16
	DAD D
	CMP M		;SAME DRIVES?
	LXI B,10
	JNZ RENER
	MVI C,23	;RENAME
	CALL BDOS
	INR A
	JZ IOERR	;FATAL
	LXI B,0
RENER:	LHLD OPNTAB
	XRA A
	MOV M,A		;REMOVE ALLOC
	LHLD GPCB
	SHLD ISCBL
	LXI D,4		;RETURN STATUS
	CALL SAVST
	JMP ISRET
;========================
XIT:	XCHG
	SHLD ISCBL
	MVI C,6
	LXI H,TABLE2
EXIT1:	MOV A,M
	ORA A
	JZ EXIT2	;ZERO=NOT OPEN
	PUSH H
	PUSH B
	CALL CLO6	;CLOSE TABLE
	POP B
	POP H
	MVI M,0		;DE ALLOCATE TABLE
EXIT2:	LXI D,TABLEN
	DAD D
	DCR C
	JNZ EXIT1
	JMP BOOT	;SAFEST RETURN TO CCP
;========================
ERROR:	XCHG
	SHLD ISCBL
	XCHG
	CALL XERROR
	LXI B,0
	LXI D,2		;SAVE STATUS
	CALL SAVST
	JMP ISRET
XERROR:	XCHG
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD VALUE
	LXI H,EBUF
	SHLD BUFADR
	MVI A,10
	STA BASE
	MVI A,' '
	STA PADCHR
	MVI A,4
	STA SIZE
	CALL CONV
	MVI C,9
	LXI D,EMSSG
	CALL BDOS
	RET
;========================
WHXCON:	XCHG
	SHLD ISCBL
	MOV A,M
	INX H
	INX H
	MOV E,M
	INX H
	MOV D,M
	MVI C,15
	LXI H,WHCO
	ORA A
	JZ WHOC1
	LXI H,WHCI
WHOC1:	CALL WHMOV	;MOVE NAME TO BUFFER
	LXI B,0
	LXI D,4		;SAVE STATUS
	CALL SAVST
	JMP ISRET
;========================
;NORMAL AND NON FATAL ERROR RETURN
ISRET:	LHLD USERSP
	SPHL
	RET
;=============================
;FATAL ERROR RETURNS
DSKFUL:	LXI H,7		;DISK FULL
	JMP ISERR1
IOERR:	LXI H,24	;I/O ERROR
	JMP ISERR1
ISERR:	LXI H,33	;ILLEGAL SYSTEM CALL
ISERR1:	SHLD EBUF
	LXI D,EBUF
	CALL XERROR
	JMP BOOT
;
;======SUBROUTINES==============
;HL=.ISIS BUFFER  DE=.FCB
;RETURNS A=0 IF OK ELSE A=FF
MAKFCB:	XRA A
	CMA
	STA FSTSW
	SHLD IBFPNT	;FIRST CHAR OF SOURCE
	XCHG
	SHLD FCBST
	MVI M,1		;ISIS DEFAULT DRIVE 0
	INX H
	SHLD FCBPNT
	MVI C,11	;INITIALISE FCB
	MVI A,' '
	CALL CLEAR
	MVI C,6		;CHAR COUNT
NXTCHR:	LHLD IBFPNT
	MOV A,M
	CALL COCAS
	CALL DELTST
	JZ DEL
	CALL TERMTS
	JC DEL
	CPI ':'
	JZ COLON
	CPI '.'
	JZ DOT
	CPI '*'
	JZ INVAL
	LHLD FCBPNT
	MOV M,A
	INX H
	SHLD FCBPNT
	XRA A
	STA FSTSW
	DCR C
	JM INVAL
INCBUF:	LHLD IBFPNT
	INX H
	SHLD IBFPNT
	JMP NXTCHR
DEL:	MOV B,A
	LDA FSTSW
	RAR
	JNC VAL
	MOV A,B
	CALL TERMTS
	JC VAL
	JMP INCBUF
COCAS:	CPI 'a'
	RC
	CPI 'Z'+1
	RNC
	SUI 20H
	RET
DOT:	LDA FSTSW
	RAR
	JC INVAL
	MVI C,3
	LXI D,9
	LHLD FCBST
	DAD D
	SHLD FCBPNT
	JMP INCBUF
COLON:	LDA FSTSW
	RAR
	JC COLON1
	LHLD FCBST
	INX H
	MOV A,M
	CPI '0'
	JC INVAL
	CPI '5'+1	;DRIVES 0 TO 5 ARE OK
	JNC INVAL
	SUI 2FH
	DCX H
	MOV M,A
	INX H
	SHLD FCBPNT
	MVI A,' '
	MOV M,A
	MVI C,6
	JMP INCBUF
COLON1:	LHLD IBFPNT
	INX H
	SHLD IBFPNT
	MOV A,M
	CPI 'F'
	JZ INCBUF
	CPI 'f'
	JZ INCBUF
INVAL:	XRA A
	CMA
	RET
VAL:	XRA A
	RET
;==========================
;DELIMITER TEST
DELTST:	CPI ' '
	RZ
	CPI 9H		;TAB
	RZ
	CPI ','
	RZ
	CPI '='
	RZ
	CPI '<'
	RZ
	CPI '"'
	RET
;===========================
;TERMINATOR TEST, CY SET=TERMINATOR
TERMTS:	CPI ' '
	RC
	CPI 7BH
	CMC
	RET
;===================
;TEST FOR LEGAL DEVICE
;REQUIRES DE=.ISIS DEVICE NAME
;RETURNS A=DEVICE COUNT IF LEGAL ELSE A=FF
;RETURNS E=DEVICE NO.
LTST:	XRA A
	STA DEVCNT
	MVI A,18H
	STA DEVNO
	LXI B,DEVLEN
	LXI H,LEGDEV
LTST1:	PUSH D
	PUSH H
LTST2:	LDAX D
	CALL COCAS
	CMP M
	JNZ LTST3
	INX H
	INX D
	DCR C
	JNZ LTST2
	POP H
	POP D
	LDA DEVNO	;RETURN DEVICE NO
	MOV E,A
	LDA DEVCNT	;RETURN DEVICE COUNT
	RET
LTST3:	POP H
	POP D
	LXI B,DEVLEN
	DAD B
	LDA DEVCNT
	INR A
	STA DEVCNT
	LDA DEVNO
	DCR A
	STA DEVNO
	XRA A
	CMP M
	JNZ LTST1
	MVI A,0FFH
	RET
LEGDEV:	DB ':CO:'	;CONSOLE O/P
DEVLEN EQU $-LEGDEV
	DB ':CI:'	;CONSOLE I/P
	DB ':BB:'	;BYTE BUCKET
	DB ':L1:'	;USER LIST 1
	DB ':LP:'	;LINE PRINTER
	DB ':P2:'	;USER PUNCH 2
	DB ':P1:'	;USER PUNCH 1
	DB ':HP:'	;HIGH SPEED PUNCH
	DB ':TP:'	;TELETYPE PUNCH
	DB ':R2:'	;USER READER 2
	DB ':R1:'	;USER READER 1
	DB ':HR:'	;HIGH SPEED READER
	DB ':TR:'	;TELETYPE READER
	DB ':O1:'	;USER CO
	DB ':I1:'	;USER CI
	DB ':VO:'	;CRT O/P
	DB ':VI:'	;CRT I/P
	DB ':TO:'	;TELETYPE O/P
	DB ':TI:'	;TELETYPE I/P
NODEV EQU ($-LEGDEV)/DEVLEN
	DB 0		;END TAB MARK
;======================
;SETS EOF SW TO A
SETEOF:	LHLD OPNTAB
	LXI D,8
	DAD D
	MOV M,A
	RET
;=====================
RWSET1:	XRA A
	STA CONSW
	LXI B,4
	LHLD OPNTAB
	DAD B
	MOV E,M
	INX H
	MOV D,M		;DE=.ITM IO BUFF
	PUSH D
	INX H
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD INPTR	;CURRENT BYTE POINT
	POP H
	SHLD STRTBF
	XCHG
	LXI H,80H
	DAD D
	SHLD ENDPTR	;SET END POINTER
	MVI C,26	;SET DMA
	CALL BDOS
	RET
;===========================
RWSET2:	LHLD ISCBL
	INX H
	INX H
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD IBFPNT	;ISIS I/O BUFFER POINT
	XCHG
	INX H
	MOV E,M
	INX H
	MOV D,M
	XCHG
	SHLD LEN	;LENGTH OF READ/WRITE
	LXI H,0
	SHLD ACT	;ACTUAL R/W
	RET
;=========================
;RETURN HL=BUFFER POINT-.BUFFER
GETBYT:	LHLD OPNTAB
	LXI D,4
	DAD D
	MOV E,L
	MOV D,H
	INX H
	INX H
	XCHG
	CALL AP0099
	RET
;========================
;SAVE DATA IN ISIS CONTROL BLOCK
;BC=DATA  DE=ISIS BLOCK ADD FACTOR
SAVST:	LHLD ISCBL
	DAD D
	MOV E,M
	INX H
	MOV D,M
	XCHG
	MOV M,C
	INX H
	MOV M,B
	RET
;==================
WHMOV:	MOV A,M
	STAX D
	INX H
	INX D
	DCR C
	JNZ WHMOV
	RET
;========================
CLEAR:	MOV M,A
	INX H
	DCR C
	JNZ CLEAR
	RET
;=========================
;CLOSE DISK FILE I/O TABLE
;REQUIRES HL=.OPEN TABLE
CLO6:	SHLD TMPTAB
	INX H		;ACCESS
	MOV A,M
	CPI 2
	JNZ CLO4
	INX H
	INX H
	INX H
	MOV C,M		;.BUFFER
	INX H
	MOV B,M
	PUSH B
	INX H
	XCHG
	CALL AP0100
	SHLD BYTDIF
	POP D		;.BUFFER
	MOV A,L
	ORA H
	JZ CLO5
	MVI C,26	;SET DMA
	CALL BDOS
	LHLD TMPTAB
	CALL CLOWR	;BDOS WRITE
CLO5:	LHLD TMPTAB
	LXI B,27
	DAD B		;S1
	MOV A,M
	ANI 80H
	MOV C,A
	LDA BYTDIF
	ANI 7FH		;ENSURE MAX BYTDIF=7F
	ORA C		;COMBINE WITH S1
	MOV M,A		;SAVE LO BYTDIF IN S1
CLO4:	LHLD TMPTAB
	LXI D,14
	DAD D
	XCHG
	MVI C,16	;CLOSE
	CALL BDOS
	INR A
	JZ IOERR	;FATAL
	RET
;=====================
;REQUIRES HL=.OPEN TABLE
CLOWR:	LXI D,14
	DAD D
	XCHG
	MVI C,21	;WRITE
	CALL BDOS
	ORA A
	JNZ DSKFUL	;FATAL
	RET
;======================
UPDCLO:	LHLD OPNTAB
	INX H
	MOV A,M
	CPI 3
	RNZ
	CALL GETBYT	;BYTEPOINT-.BUFFER
	SHLD BYTDIF
	MOV A,L
	ORA H
	RZ
	LHLD OPNTAB
	CALL BACKUP
	LHLD OPNTAB
	CALL CLOWR	;BDOS WRITE
	LHLD OPNTAB
	CALL BACK1	;BACKUP
	LHLD OPNTAB
	XCHG
	LXI H,8
	DAD D
	MOV A,M
	ORA A		;EOF SW
	JNZ UPDCL1
	LXI H,46	;CR
	DAD D
	MOV A,M
	LXI H,29	;RC
	DAD D
	CMP M
	RNZ
	LXI H,27
	DAD D
	MOV A,M		;S1
	ANI 7FH
	LHLD STRTBF
	MOV C,A
	MVI B,0
	DAD B
	PUSH D
	LXI D,INPTR
	MOV C,L
	MOV B,H
	CALL AP0100
	POP D
	RC		;INPTR < END BYTE
UPDCL1:	LXI H,27
	DAD D		;S1
	MOV A,M
	ANI 80H
	MOV C,A		;SAVE HI BIT OF S1
	LDA BYTDIF
	ANI 7FH
	ORA C
	MOV M,A
	RET
;==========================
;DECREMENT CR FOR UPDATE WRITE
;REQUIRES HL=.OPEN TABLE
BACK1:	XCHG
	LXI H,8
	DAD D
	XRA A
	CMP M
	JNZ BACK2
	RET
BACKUP:	XCHG
	LXI H,8
	DAD D
	XRA A
	CMP M		;EOF SW
	RNZ
BACK2:	LXI H,14+32	;CR
	DAD D
	MOV A,M
	DCR A
	MOV M,A
	RET
;================================-
;BIN TO ASCII, VARIABLE BASE
CONV:	LXI H,INT
	MVI M,1
CONV1:	LDA SIZE
	CMP M
	RC
	LDA INT
	DCR A
	JZ A1
	LHLD VALUE
	MOV A,L
	ORA H
	JNZ A1
	LDA PADCHR
	JMP A2
A1:	LHLD VALUE
	XCHG
	LHLD BASE
	MVI H,0
	CALL AP0029
	XCHG
	SHLD VALUE
	LXI H,'0'
	DAD D
	MOV A,L		;REMAINDER+'0'
	CPI '9'+1
	JC A2
	ADI 7
A2:	MOV E,A
	LXI H,INT
	LDA SIZE
	SUB M
	MOV C,A
	MVI B,0
	LHLD BUFADR
	DAD B
	MOV M,E		;J INTO BUFFER
	LXI H,INT
	INR M
	JMP CONV1
;=======FILE I/O TABLES============
TABLE2:	DB 0		;OPEN MARK
	DB 0		;ACCESS MODE
	DW 2		;AFTN
	DW BUFF2	;.BUFFER
	DW 0		;CURRENT BYTE POINTER
	DW 0		;EOF SW (LO BYTE)
	DW 0		;SPARE
	DW 0		;SPARE
	DS 36		;ICOS80 FCB
TABLEN EQU $-TABLE2
TABLE3:	DB 0
	DB 0
	DW 3
	DW BUFF3
	DW 0
	DW 0
	DW 0
	DW 0
	DS 36
TABLE4:	DB 0
	DB 0
	DW 4
	DW BUFF4
	DW 0
	DW 0
	DW 0
	DW 0
	DS 36
TABLE5:	DB 0
	DB 0
	DW 5
	DW BUFF5
	DW 0
	DW 0
	DW 0
	DW 0
	DS 36
TABLE6:	DB 0
	DB 0
	DW 6
	DW BUFF6
	DW 0
	DW 0
	DW 0
	DW 0
	DS 36
TABLE7:	DB 0
	DB 0
	DW 7
	DW BUFF7
	DW 0
	DW 0
	DW 0
	DW 0
	DS 36
EMSSG:	DB CR,LF,'ITM ERROR '
EBUF:	DS 4
	DB CR,LF,'$'
;========================
COAFT:	DW 0		;AFT OF CURRENT CO FILE
CIAFT:	DW 1		;AFT OF CURRENT CI FILE
WHCI:	DB ':CI: '	;CURRENT CI FILE
	DS 10
WHCO:	DB ':CO: '	;CURRENT CO FILE
	DS 10
;=============================
;CLOSE BLOCK
CBLK:	DS 2		;AFTN
	DW DSTAT	;.STATUS
;==========================
;OPEN BLOCK
DBLK:	DW DAFT		;AFTN POINT
	DS 2		;FILENAME POINT
	DS 2		;ACCESS
	DW 0		;ECHO
	DW DSTAT
DAFT:	DS 2		;AFTN
DSTAT:	DS 2		;STATUS
;====DATA MEMORY AREA===========
	DS 100		;ITM STACK
USERSP:	DS 2		;ISIS STACK POINT
;
ISCBL:	DS 2		;.ISIS CONTROL BLOCK
GPCB:	DS 2		;.GENERAL PURPOSE ISIS BLOCK
OPNTAB:	DS 2		;.CURRENT TABLE
ACT:	DS 2		;TEMP ACTUAL
LEN:	DS 2		;TEMP LENGTH
DOTFCB:	DS 2		;.FCB READ
BIAS:	DS 2		;LOAD BIAS
STRTBF:	DS 2		;.START OF BUFFER
INPTR:	DS 2		;INPUT BUF PNT
ENDPTR:	DS 2		;.BUFFER END
FCBPNT:	DS 2
FSTSW:	DS 1		;FIRST SWITCH
IBFPNT:	DS 2		;ISIS BUF PNT
FCBST:	DS 2		;.FCB
;
INITSW:	DS 1		;INITIAL READ SW
CONSW:	DS 1		;:CI: SWITCH
CIPNT:	DS 2		;CI BUF POINT
RENTMP:	DS 16		;RENAME BUFFER
;
TMPTAB:	DS 2		;USED BY CLO6
BYTDIF:	DS 2		;USED BY CLO6
;
DEVCNT:	DS 1		;DEVICE COUNTER
DEVNO:	DS 1		;DEVICE NUMBER
;
VALUE:	DS 2		;USED BY CONV
BUFADR:	DS 2
BASE:	DS 1
PADCHR:	DS 1
SIZE:	DS 1
INT:	DS 1
;==================
;PLM80.LIB MODULES
;===================
AP0012:	MOV C,M
	INX H
	MOV B,M
	LDAX D
	ADD C
	MOV L,A
	INX D
	LDAX D
	ADC B
	MOV H,A
	RET
;================
AP0014:	XCHG
	MOV E,A
	MVI D,00H
	XCHG
	LDAX D
	ADD L
	MOV L,A
	INX D
	LDAX D
	ADC H
	MOV H,A
	RET
;==================
AP0025:	XCHG
	MOV E,A
	MVI D,00H
	XCHG
	LDAX D
	ANA L
	MOV L,A
	INX D
	LDAX D
	ANA H
	MOV H,A
	RET
;==================
AP0029:	MOV B,H
	MOV C,L
AP0030:	LXI H,0000H
	MVI A,10H
X5B92H:	PUSH PSW
	DAD H
	XCHG
	SUB A
	DAD H
	XCHG
	ADC L
	SUB C
	MOV L,A
	MOV A,H
	SBB B
	MOV H,A
	INX D
	JNC X5BA4H
	DAD B
	DCX D
X5BA4H:	POP PSW
	DCR A
	JNZ X5B92H
	RET
;====================
AP0033:	DAD H
	PUSH H
	DAD H
	DAD H
	POP B
	DAD B
	RET
;================
AP0034:	MOV B,H
	MOV C,L
AP0035:	LXI H,0000H
	MVI A,10H
X5BBCH:	DAD H
	XCHG
	DAD H
	XCHG
	JNC X5BC4H
	DAD B
X5BC4H:	DCR A
	JNZ X5BBCH
	RET
;=================
AP0041:	SUB A
	SUB L
	MOV L,A
	MVI A,00H
	SBB H
	MOV H,A
	RET
;================
AP0094:	MOV E,A
	MVI D,00H
AP0095:	MOV A,E
	SUB L
	MOV L,A
	MOV A,D
	SBB H
	MOV H,A
	RET
;===================
AP0096:	MOV C,A
	MVI B,00H
AP0097:	MOV A,E
	SUB C
	MOV L,A
	MOV A,D
	SBB B
	MOV H,A
	RET
;=================
AP0098:	MOV L,C
	MOV H,B
AP0099:	MOV C,M
	INX H
	MOV B,M
AP0100:	LDAX D
	SUB C
	MOV L,A
	INX D
	LDAX D
	SBB B
	MOV H,A
	RET
;===================
AP0101:	MOV L,A
	MVI H,00H
AP0102:	LDAX D
	SUB L
	MOV L,A
	INX D
	LDAX D
	SBB H
	MOV H,A
	RET
;=================
AP0103:	MOV E,A
	MVI D,00H
AP0104:	MOV A,E
	SUB M
	MOV E,A
	MOV A,D
	INX H
	SBB M
	MOV D,A
	XCHG
	RET
;==================
X5C66H:	DS 2
X5C68H:	DS 2
X5C6AH:	DS 2
X5C6CH:	DS 2
X5C6EH:	DS 2
X5C70H:	DS 2
X5C72H:	DS 2
X5C74H:	DS 2
X5C76H:	DS 2
X5C78H:	DS 2
MSIZ1:	DS 2
X5C7CH:	DS 2
MSIZ2:	DS 2
X5C80H:	DS 2
TXTND:	DS 2
X5C84H:	DS 2
CIBUF:	DS 50
X5CB8H:	DS 11
X5CC3H:	DS 11
X5CCEH:	DS 22
X5CE4H:	DS 22
X5CFAH:	DS 21
X5D0FH:	DS 1
VSTACK:	DS 16
X5D20H:	DS 2
X5D22H:	DS 2
X5D24H:	DS 22
SCOLON:	DS 16
X5D4AH:	DS 2
X5D4CH:	DS 2
X5D4EH:	DS 2
X5D50H:	DS 2
X5D52H:	DS 2
X5D54H:	DS 2
X5D56H:	DS 1
CITMP:	DS 1
X5D58H:	DS 1
X5D59H:	DS 1
X5D5AH:	DS 1
X5D5BH:	DS 1
X5D5CH:	DS 1
X5D5DH:	DS 1
X5D5EH:	DS 1
X5D5FH:	DS 1
X5D60H:	DS 1
X5D61H:	DS 1
X5D62H:	DB 0
X5D63H:	DB 0
X5D64H:	DB ':F'
X5D66H:	DB '0:EDIT.MAC '
	DS 19
;
;
X5D84H:	DB ':F'
X5D86H:	DB 'X:EDIT.TMP '
X5D91H:	DB 0
E1UF:	DB ' '
E2UF:	DB 8
E3UF:	DB 10
E4UF:	DB '?'
E5UF:	DB LF
E6UF:	DB '*',0
E8UF:	DB 1AH
E9UF:	DB 0
E10UF:	DB 0
E11UF:	DB 8
E12UF:	DB '!'
E13UF:	DB 0
E14UF:	DW 0FFFFH
X5DA1H:	DB 04H,00H,0FFH
	DB 0FEH,04H,00H,0FFH
	DB 0FFH,00H
X5DAAH:	DB 00H,00H
	DB 00H,00H,00H,00H
BB1PNT:	DW BBMS
BB2PNT:	DW BBMS
BB3PNT:	DW BBMS
BFPNT:	DW TXTBUF
X5DB8H:	DB 0CH
X5DB9H:	DB 1BH
X5DBAH:	DB 0FFH
X5DBBH:	DS 1
X5DBCH:	DS 1
X5DBDH:	DS 1
X5DBEH:	DS 1
X5DBFH:	DS 1
X5DC0H:	DS 1
X5DC1H:	DS 1
X5DC2H:	DS 1
X5DC3H:	DS 1
X5DC4H:	DS 1
X5DC5H:	DS 22
X5DDBH:	DS 1
X5DDCH:	DS 1
X5DDDH:	DS 22
X5DF3H:	DS 1
X5DF4H:	DS 1
X5DF5H:	DS 1
X5DF6H:	DS 1
X5DF7H:	DS 1
X5DF8H:	DS 1
X5DF9H:	DS 2
X5DFBH:	DS 1
X5DFCH:	DS 1
X5DFDH:	DS 1
X5DFEH:	DS 1
X5DFFH:	DS 1
X5E00H:	DS 1
X5E01H:	DS 2
X5E03H:	DS 1
X5E04H:	DS 1
X5E05H:	DS 15
X5E14H:	DS 1
X5E15H:	DS 1
X5E16H:	DS 1
X5E19H:	DS 1
X5E1AH:	DS 2
X5E1CH:	DS 1
X5E1DH:	DS 1
X5E1EH:	DS 1
X5E1FH:	DS 1
X5E20H:	DS 1
X5E21H:	DS 2
X5E23H:	DS 2
X5E25H:	DS 1
X5E26H:	DS 1
WRBRAN:	DS 2
X5E29H:	DS 1
X5E2AH:	DS 1
X5E2BH:	DS 2
X5E2DH:	DS 1
X5E2EH:	DS 2
X5E30H:	DS 1
X5E31H:	DS 1
X5E32H:	DS 2
X5E34H:	DS 1
X5E35H:	DS 1
X5E36H:	DS 1
X5E37H:	DS 1
X5E38H:	DS 1
X5E39H:	DS 1
X5E3AH:	DS 1
X5E3BH:	DS 1
X5E3CH:	DS 1
X5E3DH:	DS 1
X5E3EH:	DS 1
X5E3FH:	DS 1
X5E40H:	DS 1
X5E41H:	DS 1
;======================
X5E84H:	DS 2
X5E86H:	DS 1
X5E87H:	DS 1
X5E88H:	DS 2
X5E8AH:	DS 1
X5E8BH:	DS 2
X5E8DH:	DS 1
X5E8EH:	DS 1
X5E8FH:	DS 1
ISERNO:	DW 0
X5E92H:	DS 1
X5E95H:	DS 2
X5E97H:	DS 1
X5E98H:	DS 1
X5E99H:	DS 2
X5E9BH:	DB 0C3H
X5E9CH:	DW 0
;
;
X5F34H:	DB 0FFH
X5F35H:	DB 0
X5F36H:	DB 0
;
DELETE:	DW 0
	DW STATUS
;
OPEN1:	DW WRITE1
	DW 0
ACCES1:	DW 0
	DW 0
	DW STATUS
;
CLOSE1:	DW 0
	DW STATUS
;
READ1:	DW 1
	DW 0
	DW 0
	DW ACTUAL
	DW STATUS
;
WRITE1:	DW 0
	DW 0
	DW 0
	DW STATUS
;
OPEN3:	DW READ3
	DW 0
	DW 1 ;READ
	DW 0
	DW STATUS
;
CLOSE3:	DW 0
	DW STATUS
;
READ3:	DW 1
	DW 0
	DW 0
	DW ACTUAL
	DW STATUS
;
OPEN4:	DW WRITE4
	DW 0
	DW 2 ;WRITE
	DW 0
	DW STATUS
;
CLOSE4:	DW 0
	DW STATUS
;
WRITE4:	DW 0
	DW 0
	DW 0
	DW STATUS
;
CIREAD:	DW 1
	DW 0
	DW 0
	DW ACTUAL
	DW STATUS
;
RENAME:	DW 0
	DW 0
	DW STATUS
;
WHOCON:	DW 1;CI
	DW 0
	DW STATUS
;
ACTUAL:	DW 0
;
;ERROR & EXIT
STATUS:	DW 0
EXIT:	DW STATUS
;
;
	DS 100		;STACK
STACK:
;BUFFER AREA
BUFF2:	DS 128		;FILE I/O BUFFERS
BUFF3:	DS 128
BUFF4:	DS 128
BUFF5:	DS 128
BUFF6:	DS 128
BUFF7:	DS 128
TXTBUF:	DS 1
END BEGIN
	DS 128		;FILE I/O BUFFERS
BUFF3:	DS 128ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГ
CP/M EDITOR, D.R.BACK VERSION 1.2
 
*BREAK*
 :BB: яЫяп     TEXT:      
FREE:      
UC:      
 NEW FILE
 STACK FAULT BUFFER FULL DRIVE 0 NOT READY BAD MACROFILE
    NO OUTPUT FILE
 BAK TO CANNOT FIND " QUIT?  EXIT NEW ESC! N-KILL?  " ILLEGAL CONTEXT
 1Y4!Ѓ "У0Ї/2С0НЄ*Ь2DMНа$*Ь2DMН_
*Ю2DMНщ$:с3ю КI!5"Ю2НГГ-Y7¦1Нs1л! Н1л"–1Н71л!Л2Н‰1Тs*–1"љ1Гy*Л2"љ1љ1¦1Нn1"в2"®1–1в2Нn1л!Y7Н]1"’1Н(":Ѕ2Т­*’1DMНп!Ѕ26яНи
!ѓ26яН§1Y4)НГ1Y4!Џ26 Ни
1Y4!‹26 ! "Ђ2НЗ2ѓ22„2ю-Вч:‹2/2‹2ГЯ:ѓ2Ц.Цџ2Љ2:ѓ2Ц/Цџ2‚2:†2юВН"Ђ2*„2MНХТ)Н:†2ю К4НY:ѓ2ц ЦaO !(		^#Vлй:‚2ТU*’1"Ђ2> !Ђ2Н†1Тq*N2"L2*Ђ2DMНпНЅН`Г\Н–
Г\Н¦Н‚	Г\Н¦НiГ\Н­2ѓ2!е2ѕВўНuН\%:ѓ2юRВ°НuГГ_Г\НГ\НП:о2Тd!‹26 N2>2Нn1µВЮ*®1">2*®1"¬1*>2"®1НЯ"љ1N2љ1Нn1џ®1>2хНn1џБHЎТГ_*¬1"®1*љ1л*N2л*>2Н]1"¬1>
®1еН{1лбН]1Т;НЄ
>2љ1Нn1ТJГ_*>2е*љ1+DM*N2лНl *¬1"N2Г•НЎНЋл*N2DMНФ$*п3л*N2"N2НЋл>
Нd1Т’НГiНО$Г\Н¦:‹2ЪЁ*®1"¬1! "љ1Ђ2љ1Нn1Ъ*¬1^ ! Н1KН"OНч*¬1>¦OН"OНч НчНЩ*љ1л*А2& Н1> НZ1µВьНд*¬1#"¬1 *љ1"љ1Т®НдГ\НаТ#Н+ГГ\НаТH:‹2Т>*ѓ2MНs%ГE*ѓ2MНчГ&Г\НЯ"¬1НiГ\НЯ"¬1Н‚	Г\Н­2ѓ2НNН=:‹2Т}Н=*ў1##л!ћ1Н‰1Т™*ћ1NН=НЅГ}НСГ\:р2ю КЄГ_Н­ю ВИпНГНGТЕ*Є1"¦1ГЈ*z2"Ё1*њ1"¤1НїТуН"Тм*z2+"z2ГЫ*z2#"¤1*¦1+"ћ1:ѓ2wНЅ¤1Ё1Нn1 " 1¦1Н~1л+s#r!°1Н‰1Т3* 1л*¦1"¦1НЄ
*¤1е*¦1###л*Ё1DMНl !k36я*¦1###ћ1Н~1Ъ}*ћ1~юВiНЅГw*ћ1~ЦЦџ!k3†wНЅГK*ћ1:k3wНЅНЅ*ћ1е* 1лбs#rНЬ
НїЪЈГЖГ\Н­юOК±Г_Н¶Г\НПНЎґНYНО$Г\НVГ\Н­2ѓ2Н§Г\Н:д2N2Н{1л+s#rГГ\НYГ\НЂГ\НЄГ\НЗГ\UНYГ\НъOНвГ\Н 
Г\Hw}†Џ¶ј&KWcџ¦·ЛСЭфэ	"ГФ1Y4> !ѓ2–џх~Ц~ЖяџБHЎТЏНд"Нs%*ѓ2MНчшНГНи
ГСыv!3q*3M:Н§"Й:З2Т·  3Н%ГЅНz%2 3: 3жЙН†%ТШНЈ2ѓ2юВШГЅЙ:!3<2!3ю ВцНГ:ѓ2юВцНГГиЙ!"3q!#36 :е2+ѕВ:Й22"3:"3ю	В5:И2=*…2& л*И2& хН1сНZ1л!#3s+6 :"3юВB!…26ю*"3MН”Т^^Нs%:"3Ж@2"3!…24!$36 :#3!$3ѕЪЌ!…24:"3ю В:ѕ22"3*"3MНs%!$34ВcЙN2®1Нn1Й!(3r+s+p+q'3%3Нn1ТВ*%3NНчНЩ*%3#"%3ГўЙ!*3p+q*)3~ю Кг*)3NНs%*)3#")3ГЙЙНч
НчЙ!,3p+q*+3~<wO>
№Т	uНГГЅЙ!03r+s+p+q?Е*/3лCНl !‡26*-3л*А2& Н1MН"х:‡2=2‡2O !13	БHq*-3л*А2& Н1л"-3> НZ1Тf	Г)	*‡2& 13	е*/3л@3Нl !‡2>–wЙN2¬1Нn1µВђ	ЙНЋ"v2N2¬1Нn1Тз	®1¬1Нn1Тґ	*®1"¬1*®1"|2*®1е*¬1DM*N2лНl *v2НR1"v2л*¬1"N2*¬1"®1"x2Г
*N2"x2*¬1е*N2+еНЋе*¬1Б	лБНl *v2л*¬1"®1*¬1"N2#"|2Н
Й*|2—•o> њg"E
*x2|/g}/o"L
>	!;2еб=ш#^#Vе!  Т<
!  Ъ<
*v2лбr+s#Г=
!B3p+q:с3ю Вn
Й*A3DMН‹$НВ#ЪЉ
*x3NНчНя#Гv
НO%!†36яГЅЙ!Y7"¬1Н‚	Й*в2"¬1Н‚	ЙЃНГГЅЙНЋл>
Нd1ТГ
НЄ
Й:К2ТМ
ЙЇ/ЪЫ
ЋНГГЅЙ!м26я*¦1"њ1Й*в2"°1НЬ
*њ1+"z25 Е ж2НЯ"Й*¦1"ћ1*ћ1> Н†1µК<*ћ1"ў1ћ1Ну0+л+s#r!ѓ2ѕВ2Й*ћ1#"ћ1ГГ_Й3Нп*3& с2)	е*z2лбs#rЙ*3& 2)	е*z2лбs#r*ћ1+"z2*3& P2)	е*Ђ2лбs#r*3& д1	:‹2w*3& п1	6 !34ГСЙНН@*ў1##>я–2C3ю К> !C3–џњ1z2хНn1џБHЎТ*z2~юВй*z2+"z2Гш*z2:е2–Цџ!C3†w*z2+"z2ГЅНZЙв2¦1Нn1л>рНd1"љ1*в2DM*љ1лНФ$НО$љ1п3Нn1µВ7НЄ
>!п3Н†1Т» *в2е*п3л*в2+п3¦1еНn1 "ћ1"D3лБНl ¦1ћ1Нn1µКµ*ћ1^#Vл"љ1ћ1Х¦1Нn1лб+Н‰1Т§ НГ:ж2Т¤ЙГЅ*љ1л*ћ1"ћ1Гl*D3"¦1 *в2	~ю КЫ*в2е *в2DMЅ2Нl НЬ
:ж2ТжЙ!ѓ26юН§Й!G3p+qНД
Н 
НЋл>рНd1л*F3DMНЦ""F3*N2DM*F3лНу$*п3л*N2"N2Н–
ЙНґ
*N2:ѓ2w*N2#"N2Й!H3q:H32ѓ2:‹2ТRН+Й*ѓ2MНчЙ!I3q:З2Ъl*I3MНч*њ1+"њ1:I3w*N2л*¦1е*®1л*њ1СН]1л>Нd1ТљНs%Й!…25*ї2MНs%*ѕ2MНs%*ї2MНs%Й*Г2MНчЙ*ћ1+"ћ1Й°НГ*њ1"ћ1¦1ћ1Нn1џл+N#Fх
Ц
ЖяџБHЎТш*ћ1#"ћ1ГСњ1ћ1Нn1µКНЅ*ћ1NНчГшЙ:ѓ22л2OНZНЈ2ѓ2ЙНµ*ї2MНs%!…25Й:Џ2Т=Н$Ни
НЈ2ѓ2юВSНs%Г3:ѓ2ю~В^Г3:Џ2Ъ‰*ѓ2MН”Т|*њ1+"њ1:ѓ2wЙ:ѓ2ж_ЦIЖяџ2з2!е2:ѓ2–Жяџх:л2–ЖяџБH±Тј:ѓ2ЦЦџх:ѓ2Ц~ЦџБH±ТРН:ѓ2юКИН!л26 Гў:ѓ2юВЫГЅ:ѓ2юВ :з2ТпНs%:З2Ъ НZ!ѓ26
:ѓ2юВНдНЕНЈ2ѓ2Г№:ѓ2юВ0НдНЈ2ѓ2!з26 Г№:ѓ2юВ}Н›*њ1~2л2OН”ТMН›*њ1#"њ1:л2юВ_НЕ!л26 ¦1њ1Нn1µВtГ3НЈ2ѓ2Г№:ѓ2юВ¶#НчНд*њ1~ю
К­*њ1#"њ1¦1Н~1µВЄГ3ГЌНЈ2ѓ2Г№НГ‰*ѓ2MНZНд!Џ26 *z2#"x3*x3+"x3е*њ1#СН]1Ъѓ*x3~юВщ*x3++"x3Ге*x3~ЦЦџ2ѓ2Т*x36 :й22Ќ2!ѓ2®2й2:Ќ2Т{:к2/2к2ТOНo#ТBНе#2‰2*x36ГL!к26 *x36 ГxНo#Тq*‰2& ))))еНе#_ бе*x3БqГx*x3:‰2wГЂ!к26 ГТЙ:3=23ю Вљ:м2ТљГЖЙ*3& 2)	^#Vл"z2:3=23юяВ»Г_Н„Й> !3–џЙ¦1z2Нn1ТЭНїЪЭГЖ*z2#њ1Н~1µВсНµН3НЩ*z2~2J3OН¤!2†2*z2+"z2:н2Т!н26 Г:J3ю В#ГЭ> !3ѕТэ:J3юВ†НїЪ>ГЅ3Нп*3& п1	6я*3& 2)	е*z2лбs#rН„*3& с2)	^#Vл"z2л!њ1Н‰1ТѓГЅГс:J3юВ™!Џ26яН3Гс!е2:J3ѕВП*3& п1	~ТП*3& с2)	е*z2лбs#r!344Н›Гс:J3юВэН$НЈ2J3OНч*J3MН¤!2†2:J3юВщГЅ:J3Й:J3ЦЦџ2н2:J3Й:ѓ2Ц0џх>:!ѓ2–џБH±Т'НЗ2ѓ2!  "K3:†2юВd*K3))е*K3Б	):ѓ2Ц0_ "K3:ѓ2ю:В[!яя"K3НЗ2ѓ2Г-> K3Н{1µВњ:Љ2!‹2¶х:„2Ц;ЦџБH±х:„2Ц=ЦџБH±Т—! Й!‹26я*K3Й>Ђ2Н1}ЙН O !<2		е*N2лбs#rЙН O !f2		^#VлЙН O !<2		^#VлЙ:Љ2ТкНПЙяяЂ2Нs1µВ:‹2Т!Y7Й*в2Й:‹2Т!Y7N2Нs1#DM*N2лН!Й®1в2Нn1DM*®1лН;!Й!P3r+s+p+qM3O3Нn1л*M3DMН%*Ю2DMН_
Й!R3p+qНЯ"љ1N2Н~1µЖяџ®1љ1хНn1µЖяџБHЎТµљ1N2Нn1Т¤*®1DM*љ1л!Ўе*Q3йГµ*љ1DM*N2л!µе*Q3йЙ4НYЙ*L2"¬1Н‚	Й*N2"L2Н–
Н¶*љ1"®1НЅЙ!ђ2"љ1~2S3НЗ*љ1w!е2ѕК!*љ1~юВНЗ*љ1wђ2љ1Нs1л>Нd1Т*љ1#"љ1Гзђ2љ1Нs1µЦџ2о2Т=*љ1:S3wЙђ2љ1Нs1л!д2sЙY7N2Нs1Й®1в2Нn1Й:А2ю
Тm!А26
НLеНVБ	DMJН	НЋDMWН	в2¦1Нn1DMbН	DНГЙ!T3q:о2ТЇГ_НД
*T3лђ2Нј$ђ2Н_
Й!Ћ26яґНГЙНЭ:о2ТЪЙ!†36 Й*р2& ъ1)	^#Vл"U3!Ќ26> !Ќ2ѕТ(*U3~юВ*U3+"U3Г*U3NНТ!!Ќ2†w*U3+"U3Гц*U3Й!W3q*°1:W3w*°1#"°1ЙЕН2Нa"!°2"Ю2Н9"2І2Й![3r+s+p+qяН,*е2MН,*е2MН,Z3X3Нn1Т–*Z3+"Z3е*°1Б
w*°1#"°1Гr*°1"ћ1Н@НZЙН9"Ц9џЙ!†36я!„36 Н«$л>
Нd1"Є1"¦1Н2Е*¦1лЦ2Нl !І1"x3DMН'%НЈ2Њ22 І1Н%Ї2Ќ2>02’2±#Н$*x3"”1~Ц,џ2Ѕ2Тђ2Нј$:с3ю ВННи
НГНВ#Ъ1Ня#Н„$:Њ22З2НВ#ТGНГГ¬Н?*x3DM*x3лН%:с3ЦЦџ2п2Ъk*x3"Ь2*x3"а2±#Н$Н„$ЙН4$Т¬Н„$:п2Т–*”1DMН_
*x3"а2Н?НЈЪ¬*x3"Ю2:п2Т№jНГЙНй!Є	Й:р2ю ВНГЅ*р2& &2)	N#F+q#p  Нg1Т*р2& ъ1)	^#Vл"z2НєDMс2Н!ГA*р2& 	3)	> Н†1µВ,Нае*р2& 	3)	Бq#p*р2& 	3)	^#Vл"z2!р25Й*р2& &2)	>w#6 НВГСЙ>!ѓ2ѕТhН›ГС*ѓ2MНТ!2Ќ2Тф:Ќ2юВЫр2НпНєлс2Н!*р2& ъ1)	е*z2лбs#r*р2& 	3)	> w#6 *р2& &2)	е*Ђ2лбs#r> Нd1µЦџ!‹2¶ТШНBГС*р2& 	3)	е*z2лбs#rНВГС*ѓ2MН”ТН§Г_ЙНЭ*в2"1:Љ2Т5НПл!N2Н‰1Т/НП"¬1НЄН‚	НП"1!€26 ®11Нn1Тm*®1DM*1лНZ!2€2Тm*~2"¬1л:д2Нd1"L2Н‚	Й> !р2ѕТyНBМНГ*д2& ђ2	лН"Нs%НдГЅЙY7N2Нs1лН%*Ю2DMН_
!Y7"N2Й!_3r+s+p+q\3^3Нn1л*\3DMНЪ$ЙН=
Н=Й*”1"x3НВ#Ъц*x3NН=Ня#ГвНСЙ:и2ТНГ!ѓ26GGНчГНz%2ѓ2OНчНд:ѓ2юВ)ГЅ:ѓ2ж_2ѓ2юGВ>!и26я>яЙ:ѓ2ЦYЦџЙ:З2ТR>яЙНъЙЪНГНGТqН%*Ю2DMН±$Н\%ГЅЙНД
Н 
:Ћ2Т€НГНVN2¦1Нn1л*N2DMНу$*п3л*N2"N2Y7Н]1ТґНГ€Нн$Н%а2Ь2Нn1µВШН2Н±$*а2DMН2Н%°2Ю2Нs1µВя*а2DMН±$*а2л°2Н%*а2DMН_
*а2"Ь2"x3Н?бНГ!‹26 НЬЙ:Љ2ТGНПN2Н~1џ/2‹2/хНПл!®1Н‰1џБHЎТFНЄЙ:„2ю=Вq*3& P2)	^#Vл"Ђ2*3& д1	:‹2®2‹2Й:‚2Т‡Н–
!яя"Ђ2!‹26 ЙНї"Ђ2яН]1џ2Ќ2Т¤*Ђ2НR1"Ђ2:Ќ2!‹2®wЙНЗ2ѓ2:н2ТБНЗ2ѓ2Й:†2ю ВС:ѓ2ж_2ѓ2:ѓ2Й!`3q*`3MНц!/Й!a3q:a3!‹2®ТтЙНВЙ!c3p+q *b3	^#Vл"љ1*b3е *b3е*b3##лБНl *b3е*љ1лбs#rЙ!e3p+q*d3^#Vл"љ1*d3##е *d3DM*d3лНl  *d3	е*љ1лбs#rЙ!g3p+q*f3##^#Vл"ћ1Н o& )л*f3е*f3##гN#Fбq#pН o& )л*f3е*ћ1лбs#rЙ:‹2ТИНLл*Ђ2DMНЦ""Ђ2N2Н~1"¬1ГЯНVл*Ђ2DMНЦ""Ђ2л*®1"¬1ЙНЗ2ѓ2!е2ѕВр> Й:н2ТэНЗ2ѓ2>яЙв2®1Нn1µВ> Й*®1~2h3!i36 НаТe:ѓ22Ќ2НаЪC!Ќ2:h3ѕВ?!i36я:i3Й:h3!Ќ2–џ/х:ѓ2!h3–џ/БHЎТb!i36яГ:i3Й:‹2Тy*¬1"N2Г*¬1"®1ЙН­ЦA2Ќ2O>№Т’Г_*Ќ2M !7 		^#Vлй:‹2Тєh2j2Нn1л+s#rГЕ*h2л*j2"j2f2Н-Гk НЅГk :‹2Тд!яя"Л2ГН 
*Ђ2лр НН"N2¦1еНn1лБНЦ""Л2Л2¦1Нn1"в2"®1Н`Гk !j36 *¦1"ћ1*ћ1ћ1Ну0+л+s#r!Є1Н‰1Тb Н=*ћ1NН=:j3<2j3жю ВXНС*ћ1#"ћ1Г#НСГk Нїh2Н~1µЦџOНвГk Н­х>Ђ2Н1Ѕ2	БHqГk НПНЎНГЖГk Н O !f2		:‹2<_ "ћ1*ћ16 Гk *®1"ћ1еН O !f2		гN#Fбq#pГk :‹2ТйН›Й*Е2MНs%*Ж2MНs%!…26 Гk Н­2ѓ2НЄ1ў1Нn1ТГ_*ў1¦1Ну0"љ1*¦1е*ў1+DM*љ1лНl *љ1"¦1> !3ѕТFГЖГk Нїh2Н~1џOНвГk :‹2Т‚*j2л*h2Н1"¬1*j2лН1л"j2*¬1"h2Г•*j2л*h2Н>1"j2f2Н-Гk :‹2ТЁ*Ђ2НR1"Ђ2*Ђ2"h2Гk Нґ
*N2"ћ1Нїе*ћ1Бq#p*N2##"N2Гk НПНЎ:‹2Ти!)"љ1Го!Ѕ2"љ1 *љ1л*љ1DMНґ*¦1DM*Є1лНґНО$Гk !Y7"N2"®1Гk Н OНвГk :‹2Т6f2Н-Г<f2НцГk Ђ2Нs1µВ[Н­2е2жНГГЅв2®1Нn1µЦџ!‹2¶ТЂ*р2& &2)	>w#6 Гk НЬГk :‹2Т™<2Н-Гџ<2НцГk :‹2ТБ*Ђ2++>НZ1Ъѕ*Ђ2л!А2sГЮНґ
НїDM*N2лН	:‡2N2Ню0л+s#rГk :‹2Тс<2НdГчf2НdГk *€2MНвГk :‹2Т! НLеН O !f2		Бq#pГ4 НVеН O !f2		Бq#pГk ўОФh|’ЈБЮяIZ±Р&?ѓ‰ўбъ Йбгy•OxњG{•zК~ њГЂ њИе!Ц Ъђ б	ел	л!я xG>Ўх©ЁжЁO> GсЕ/Oя	БгЙ~#~#~#~#~#~#~#~#В¶ В¶ Й~+~+~+~+~+~+~+~+ВЯ ВЯ Й`iГЦ Н/!Н"!В!В!#ЙѕИ+В !В !##сЙ:В2*Ђ2лЙН/!ГD!НP!ВA!ВA!Йѕ#ИВM!ВM!сЙ*д2:Б2g{‘_zWЕгБ:ђ2Н™!ЕХеђ2КЌ!ѕ#Кx!ёКx!бСБГl!ссс"~2>яЙѕ#ИВ–!В–!с—Й yю+КП!ю-ЪО!Ц<ЪП!=КП!ЦЪО!юЪР!Ц ЪО!юЪР!xЙ>`ЎИю ВЬ!©ЦюИЦюяИ—Й:р2O‡Ѓ‡‡‡o& ЙyЦ.И=ИЦИЖИ>яЙ*z2>ѕК"¶р:е2#ѕВ"#ѕВ"—Й>0Ѓю:ШЖЙY7
!<2s#r#В0"Й*x3DMН‹$Нc#ю:КL">0ЙНя#Нc#юFКZ">ИЙНя#Нc#Й!o3r+s+p+q*x3DMН‹$*l3DMН+#Н±#хНc#Ц.ЖяџБHЎТ”"НB#Г{".Нт"*n3DMН# Нт"Й№> ШлWyжш_yж_~!Е"¦И>яЙЂ@ лy•xњШ`iЙлy•xњР`iЙбг{,$Гй"-Вз"%Вз"Й!r3q*p3:r3w*p3#"p3Й!w3p+q*v3~ю К%#*v3NНт"*v3#"v3Г#*p36 ЙС*p3е!;#е`i"p3ХЙлб"p3лЙ*x3NНт"Ня#Й*x3~GЙНM#ю0ЪЂ#ю:ТЂ#7џЙНM#юaШю{РЦ ЙНS#ШНc#юAЪЂ#юGЪ`#—ЙНc#юAЪЂ#ю[Ъ`#—ЙН‚#ШНS#Ш—ЙН‘#Шxю?К`#юAК`#ю_К`#—ЙН‘#Шxю:К`#ю.К`#—ЙНM#юК`#ю
К`#юК`#—ЙНM#ю	К`#ю К`#—ЙНM#Ц0ю
ШЦж_Й*x3~Ц Цџ2z3ЙНт#:z3<x3Ню0л+s#rНт#Й!|3p+qН~$НЃ3Т3$Ня#:z3Т0$ЙГ$Й!~3p+qНт#*x3"3Нc#*}3–Цџх:z3/БHЎТr$*}3#"}3Ня#*}3~ю Вo$>яЙГC$*3"x3Нт#> Й`i"‚3ЙЦ#Н$ЙС*x3е!›$е`i"x3ХЙлб"x3G—–?џ2z3xлЙНЌ%`oЙ!€3p+q>Г:%!Џ3s+Нe%*Ј3"™3"•3Й•3Гn%!ћ3Гi%!Ё3Г/%!®3Нe%*№3"µ3Йµ3Гn%!ѕ3Гi%!Ж3Нe%*С3"Н3ЙН3Гn%!Ц3Г/%!Ю3Гi%>!ж3r+s+p+qГ:%>!м3Г5%>r+s+p+q++лOН”%*с3|µИ>я2…3:„3Рс3Н”%:†3Р	у3Н”%З—Г5%>Г1%Г<%YН ЙяН ·Кz%ЙН ·Й* +D}Й!  9"ґ01ґ0>‘Ъ¶+i& )±%	~#foйП%T'љ'ц'n)¶+¶+‡*¶+!+¶+¶+C+Ђ+¶+НХ%ГҐ+л"¶0!Э.2 ~·Кс%Вб% Г
'/w"є0##N#F*¶0^#Vлq#pл Їѕ#В&ѕК& Г
'+++~·К'&юЪ-& Г
'л*є0#wл++N#F *є0ЕеЇ$НЁ-СбХНЕ+СТ„&*є0Їw*¶0##^#VНЈ,юяВn& ГM'юЪu&ЖO   Н“-  ГM'*є0##F!Э.~·ХеК№&##xѕК№&Е 	ѕВё&#В¤&БбС Г
'Бб2 СВЏ&ХН С<Вф&*є0#~юКг&юКг& Г
'ХН <СВ9'	 Г
'!	 ~жЂК'*є0#~=К&' *є06 ГM'*є0#~юВ&'ХН СГг&Х ^#VН СН Н5-*є0 ^#V#s#r   Н“-ЙНZ'ГҐ+л"¶0~юЪj'  Г“'Цъd'!Э.2 К}'=Гu'"є0~· К“'НЇ-*є06    Н“-Йл"ё0^#Vл"D0! "F0B0НХ%*N0}·Кѕ'MDГз' :L0юТв'Цъв'*є0 лН <К°+  *є0Їw*ё0"¶0 Н“-ГҐ+!  "ј0л"¶0~·В( ГZ)юВ(Ї/2Т0*У0"Ж0Г\(юЪ)( ГZ)Ц!Э.2 К9(=Г1("є0~·ВG( ГZ)#~юКY(юКY( ГZ)Н>-Нg-*ѕ0л*ј0{•Вp(z”КB):Т0Тј(*Н0л*Ж0:С0Ъ(ХеяН ·К‡(бСГ›(~#Нњ,Т')!Ѓ "Ж0Ї2С0*Н0#6
*ј0##"ј0ГB)*є0л! ~·ВB)!. ~! ѕВт(! ~жКт(*Д0O 	Ж0MDНs1ТB)*Ж0л*Н0w*И0{•В#)z”В#)*є0 лН Н5-*є0 	^#V*Н0л"Ж0л"Н0*ј0#"ј0Г_(*Ж0"У0ГW):Т0Ъ9)*Ж0л*є0 	s#r   Н“-*ј0MD Н“-ГҐ+л"¶0~юВ~) Г~*·ВЉ)>я2Т0ГВ)юТ‚)Ц!Э.2 Кџ)=Г—)"є0~·В­) Г~*#~юКї)юКї) Г~*Н>-Нg-*ѕ0л*ј0{•ВЦ)z”Кc**Н0N#"Н0*ј0#"ј0:Т0ЪR**И0л*Ж0q#"Ж0{•ВЕ)z”ВЕ)*є0#~+юМ{.*є0л! ~жЂwлНэ-*є0#~ 	^#Vл"Ж0юВЕ)*є0 лН Н5-·КЕ)Ї*Ж0ЂНЁ-ГЕ)*¶0~·ВЕ)YН ГЕ):Т0Ъ{**Ж0л*є0 	s#rН.   Н“-ГҐ+л"ё0##^#Vл"D0! "F0B0НХ%:N0ю В+*є0 л!Х0w#Вё**ё0^#Vл"D0B0НХ%:N0 ·В+*є0 е л!Х0~#Вм*С! ѕ
 В+Н <К°+  *є0Їw*ё0"¶0 Н“-ГҐ+л"¶0!Э.~·К8+еЕНЇ-Бб6 2 В*+Г  л"¶0лНW+   Н“-ГҐ+л^#Vл"л0!0"н0>
2п0> 2р0>2с0Н‹.		0Н Йл"¶0~##^#V!/0·К–+! 0Нџ-   Н“-ГҐ+*ґ0щЙ! Г№+! Г№+!! "00НW+Г  Ї/2М0"Н0л"П06#"К0> НЁ-*Н0~Н.,НЉ,К,Нњ,Ъ,ю:КM,ю.К7,ю*К…,*К0w#"К0Ї2М0ъ…,*Н0#"Н0Га+G:М0Т€,xНњ,Ъ€,Г,юaШю[РЦ Й:М0Ъ…,	 *П0"К0Г,:М0Ъs,*П0#~ю0Ъ…,ю6Т…,Ц/+w#"К0> wГ,*Н0#"Н0~юFК,юfК,Ї/ЙЇЙю Ию	Ию,Ию=Ию<Ию"Йю Шю{?ЙЇ2й0>2к0 !и,ХеН.,ѕВМ,#Вґ,бС:к0_:й0ЙбС 	:й0<2й0:к0=2к0ЇѕВІ,>яЙ:CO::CI::BB::L1::LP::P2::P1::HP::TP::R2::R1::HR::TR::O1::I1::VO::VI::TO::TI: *є0 wЙЇ2Т0 *є0	^#VХ#^#Vл"Ж0б"Д0л!Ђ "И0Н Й*¶0##^#Vл"Н0л#^#Vл"ѕ0!  "ј0Й*є0 ]T##лНp1Й*¶0^#Vлq#pЙ~#Вџ-Йw#ВЁ-Й"е0#~юВл-###N#FЕ#лНs1"з0С}ґКЩ-Н *е0Нэ-*е0 	~жЂO:з0ж±w*е0 лН <К°+Й лН ·ВЄ+Й*є0#~юАНѓ-"з0}ґИ*є0Н{.*є0Нэ-*є0Нp.*є0л! ~·В`.!. ~! ѕА! ~ж*Д0O 	ХЖ0MDНs1СШ! ~жЂO:з0ж±wЙл! ЇѕВѓ.Йл! ЇѕА!. ~=wЙ!т06:с0ѕШ:т0=КЄ.*л0}ґВЄ.:р0ГЖ.*л0л*п0& Н1л"л0!0 }ю:ЪЖ.Ж_!т0:с0–O *н0	s!т04Гђ.   Y4        *е0 лН <К°+Й лН ·ВЄ+Й*є0   Щ4        *є0Н{.*є0Нэ-*є0Нp.*є0л! ~·В`.!. ~   Y5        Д0O 	ХЖ0MDНs1СШ! ~жЂO:з0ж±wЙл!   Щ5        ѕА!. ~=wЙ!т06:с0ѕШ:т0=КЄ.*л0}ґВЄ.:   Y6        Н1л"л0!0 }ю:ЪЖ.Ж_!т0:с0–O *н0	s!   Щ6              *е0 лН <К°+Й лН ·В
ITM ERROR     
$   :CI: 0Нэ-*є0Нp.:CO:  ~·В`.!. N0L0 Y5   N0   Д0O 	ХЖ0MDНs1СШ! ~жЂO:з0ж±wЙл!   Щ5        ѕА!. ~=wЙ!т06:с0ѕШ:т0=КЄ.*л0}ґВЄ.:   Y6        Н1л"л0!0 }ю:ЪЖ.Ж_!т0:с0–O *н0	s!   Щ6              *е0 лN#FЃo€gЙл_ л…oЊgЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТ11	с=В1Й)е))Б	ЙDM!  >)л)лТM1	=ВE1Й—•o> њgЙ_ {•ozњgЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙ0ѕШ:т0=КЄ.*л0}ґВЄ.:   Y6        Н1л"л0!0 }ю:ЪЖ.Ж_!т0:с0–O *н0	s!   Щ6              *е0 лN#FЃo€gЙл_ л…oЊgЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТ11	с=В1Й)е))Б	ЙDM!  >)л)лТM1	=ВE1Й—•o> њgЙ_ {•ozњgЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#  :F0:EDIT.MAC л0}ґВЄ.:   Y6     :FX:EDIT.TMP   
?
*   ! яя яю яя       555Y7я    *е0 лN#FЃo€gЙл_ л…oЊgЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТ11	с=В1Й)е))Б	ЙDM!  >)л)лТM1	=ВE1Й—•o> њgЙ_ {•ozњgЙO {‘ozgЙi`N#F‘o  Йo& •oГ  я    с3Ј3      с3  с3     п3с3      с3№3     с3  с3     п3с3С3     с3  с3      с3     п3с3    с3   с3    с3           PEED PUNCH
	DB ':TP:'	;TELETYPE PUNCH
	DB ':R2:'	;USER READER 2
	DB ':R1:'	;USER READER 1
	DB ':HR:'	;HIGH SPEED READER
	DB ':TR:'	;TELETYPE READER
	DB ':O1:'	;USER CO
	DB ':I1:'	;USER CI
	DB ':VO:'	;CRT O/P
	DB ':VI:'	;CRT I/P
	DB ':TO:'	;TELETYееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееNOTES ON IMPLEMENTING THE ED111 TEXT EDITOR ON YOUR SYSTEM.
***********************************************************

	THE ED111 TEXT EDITOR COMPRISES AN ALMOST UNMODIFIED COPY OF
EDITX111 FROM THE INTEL USERS LIBRARY WHICH HAS BEEN LINKED WITH TRANSLATOR
MODULES ALLOWING CP/M TO PROCESS ALL CALLS TO THE INTEL OPERATING SYSTEM
ISIS-II. THE TRANSLATOR MODULES ARE UNIVERSAL IN THAT THEY PROVIDE ALL THE
FACILITIES NORMALLY FROVIDED BY THE MORE POWERFUL ISIS AND BECAUSE OF THIS
THEY COULD BE LINKED WITH ANY PROGRAM ORIGINALLY WRITTEN FOR ISIS-II
OPERATING SYSTEM, THE PROGRAM WOULD THEN OPERATE UNDER CP/M.
	A COMPLETE SET OF MODULES HAVE BEEN WRITTEN BUT ONLY THOSE NEEDED
BY THE EDITOR HAVE BEEN INCLUDED HERE. BY USING THESE MODULES I AM ABLE TO RUN
THE INTEL MACROASSEMBLER AND PL/M PLUS MANY OTHER INTEL PROGRAMS UNDER CP/M.
	NOTE THAT ALL ERROR NUMBERS CORRESPOND WITH THOSE PRODUCED BY ISIS.
MORE INFORMATION ABOUT ISIS IS AVAILABLE IN THE ISIS-II USERS GUIDE WHICH
IS AVAILABLE FROM INTEL. IT IS MANUAL NO.9800306D.
	BECAUSE ISIS READS AND WRITES FILES TO AN EXACT LENGTH, IT HAS
BEEN NECESSARY TO USE THE LOWER SEVEN BITS OF BYTE S1 OF THE CP/M FCB
TO RECORD THE BUFFER POINTER POSITION OF THE LAST RECORD OF EVERY FILE.
MY VERSION OF CP/M (WHICH WAS NOT WRITTEN BY DIGITAL RESEARCH) DOES NOT
USE BYTE S1 FOR ANY PURPOSE OTHER THAN THIS. IF YOUR VERSION USES THIS
BYTE OR MODIFIES ITS VALUE IN ANY WAY THEN THE EDITOR WILL NOT WORK
CORRECTLY. EVIDENCE OF THIS WILL SHOW AS FAILURE OF EDIT.MAC TO LOAD
PROPERLY AND FOR UP TO 127 UNWANTED CHARACTERS TO BE INSERTED AT THE END
OF EVERY FILE. SINCE THE EDITOR BOTH READS AND WRITES FILES TO AN EXACT
LENGTH IT DOES NOT NEED ^Z OR ANY OTHER INDICATION OF END OF FILE,
CONSEQUENTLY NONE IS INSERTED. IF ^Z IS REQUIRED IT MAY BE INSERTED
MANUALLY OR AN EXIT MACRO MAY BE WRITTEN WHICH WILL DO IT AUTOMATICALLY.
	ADDITIONALLY SINCE THE EDITOR WAS WRITTEN FOR ISIS-II OPERATING
SYSTEM IT REQUIRES THE USE OF ISIS FILENAME CONVENTION. THIS IS ALMOST
THE SAME AS CP/M CONVENTION BUT LIMITS FILENAMES TO SIX CHARACTERS PLUS
A THREE CHARACTER EXTENSION. ISIS USES A DIFFERENT CONVENTION FOR
INDICATING DISK DRIVES I.E :F0: & :F1: INSTEAD OF A: & B:, ALSO IT
USES DIFFERENT NAMES FOR DEVICES :CO: & :CI: INSTEAD OF CON:. NOTE THAT
ISIS TREATS ALL DEVICES THE SAME AS FILES. (TRY THE COMMAND
ED111 :CI: TO FILE). ALSO NOTE THAT ISIS ALWAYS DEFAULTS TO DRIVE :F0:.
	SINCE THE NORMAL DIGITAL RESEARCH CCP DOES NOT SUPPORT ISIS
FILENAMES, (AS FAR AS I KNOW ANYWAY), A SPECIAL REPLACEMENT CCP IS PROVIDED
HERE WHICH ALLOWS BOTH CP/M AND ISIS FILENAME CONVENTIONS. IT ALSO HAS
A DIRECTORY FORMAT WHICH SHOWS FILE ATTRIBUTES W FOR WRITE PROTECTED AND
S FOR SYSTEM IF THESE HAVE BEEN SET. SYSTEM FILES ARE NOT DISPLAYED UNLESS
A SWITCH S IS USED IN THE DIR COMMAND. THIS CCP ALSO INDICATES THE NUMBER
OF FILES AND THE AMOUNT OF FREE DISK SPACE. IT IS THE SAME SIZE AS THE
STANDARD CCP AND MAY BE INCORPORATED INTO YOUR SYSTEM. A MINOR MODIFICATION
WILL BE REQUIRED FOR SYSTEMS WHICH USE A TWO BYTE ALLOC.
	IF YOU REQUIRE TO ACTIVATE THE PROTECTION AGAINST EXITING WITH YOUR
DISK DRIVE DOOR OPEN, SWITCHED OFF, WRITE PROTECTED ETC. YOU SHOULD INSERT
YOUR OWN DISK STATUS PROCEDURE WHERE INDICATED. A DUMMY PROCEDURE HAS BEEN
INCLUDED FOR NOW AS CP/M DOES NOT APPEAR TO HAVE ANY PROVISON TO FIND
DISK STATUS UNTIL AFTER IT IS TOO LATE TO BE OF USE.
	THE MACRO FACILITIES OF THIS EDITOR ARE VERY POWERFUL, THE MACRO
LIBRARY PROVIDED IS THAT PROVIDED BY THE INTEL USERS LIBRARY AND IS ONLY
A SAMPLE OF WHAT MAY BE DONE. TRY WRITING A MACRO TO AUTOMATICALLY INSERT :
AFTER EVERY LABEL (BUT NOWHERE ELSE) IN A FILE. IT CAN BE DONE BUT REQUIRES
MORE THAN THE AVERAGE AMOUNT OF THOUGHT.

D.R.BACK. 20 JULY 1981.

T NOWHERE ELSE) IN A FILE. IT CAN SOURCE.COM	(1) Conversational disassembler
42.19	26K	RESOURCE.DOC	(1) Doc on above
42.20	5K	START.ASM	Compucolor 8001 initializer
42.21	1K	START.COM	COM of above
42.22	2K	T.ASM		(3) Print time on..
42.23	1K	T.COM		    ..console
42.24	3K	TIME.ASM	(3) я 
?
*   $ яя я>
JK8.T8.WUSU<8V8; яT32L32JU1 яT32JU0 я
0.7V CAM.TIDEJ я яAUNU1SU @H э>TU>><Y? won tiuQJTT0SL7.<Y? eruSJT^JT7.L8.^JT0V7BUV8F<=S# ю>? eroM
J-T6.BU   FV6<>Y<4 я>TUL8.>JR<01:PL:P7.L41V7L01-V8L3RORRE ***F<= яK8.:PL:P8.> 
 I<=V8JЇ э>VU-L.VU-L.VU-L.VU-L.<> TU->L4.K1.L2.Y<
?lanigiro eteleD
J-G2.L4.Y
?tcerroc siht sI
J-T4
J-T0L2.
.
.
.
J-T
J-T4-L1.V2TUFV1BUV3TUFL3.<:V3BV4VVUVVUVVUVVUMb э>VU-L.VU-L.VU-L.<>L3.K1.L2.Y<>
?lanigiro paZ
J-G2.L3.V2LяFBV1BUяFBV3VVUVVUVVU<G ю>TUTT0яF</F ю>TUT<.>J-T0F< я>TUK8.FV8BUяF</D
 яT=L=C яX>DR<X
 яIT0I я>BR<W=>DR<W яE>DR<E# яSU->TUAUNUSULIWUяI</NUSUB	 юP/P я>TUK8.FV8BUяF</D
 яT:  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееRA       INPUTS 'N' BYTES AND ASSIGNS NEW LINE NUMBERS. FORMAT (N)RA.

RB       GENERATE LINE NUMBERS. USES '0FFH' AND '7FH' AS MARKERS.

RC       ADVANCES THE POINTER 'N' LINES AND DISPLAYS THE NEXT 'N' LINES.
	FORMAT (N)RC.

RD       DELETE LINE NUMBERS. USES '0FFH' AND '7FH' AS MARKERS.

RE       REMOVE LINE NUMBERS AND EXIT.


R^E      FIND PLM ERRORS IN A LISTING AND DISPLAY THEM WITH A FEW SURROUNDING
	LINES. FORMAT <Number of errors to be found, /,:,etc>R^E


RF       FINDS A LINE AND DISPLAYS IT. FORMAT RF<LINENUMBER>.POINTER IS
	LEFT AFTER THE NUMBER.
 
R^F      FINDS A CHARACTER STRING. INDICATES POINTER BY '>.<'.
	FORMAT R^F<STRING>.

RG       TAKES THE DATA FROM THE FIRST SPECIFIED LINE NUMBER TO THE END OF
	THE SECOND SPECIFIED LINE AND INSERTS IT AT THE CURRENT POINTER
	POSITION. THE ORIGINAL DATA MAY BE DELETED BY RESPONDING WITH A
	'Y' OR 'G' TO 'Zap original?' .  ANY OTHER RESPONSE WILL LEAVE THE
	ORIGINAL DATA INTACT.

RI       ACTS LIKE INSERT, BUT NEW DATA IS CORRECTLY POSITIONED.

RJ       OUPUTS LINEFEEDS TO PRINTER. FORMAT <Number of linefeeds>RJ

RP       OUTPUTS CONTENTS OF BUFFER TO SIDE FILE WITH LINE NUMBERS.
	FORMAT RP<FILENAME>.
 
RM       'MOVE'--ALLOWS BLOCK DATA MOVES. DEFINE THE FIRST STRING OF THE
	BLOCK, FOLLOWED BY THE SECOND STRING.THE BEGINNING AND END OF THE
	BLOCK FOUND WILL BE DISPLAYED - ANSWER THE PROMPT BY 'Y' IF IT IS
	THE CORRECT BLOCK. IF IT IS NOT CORRECT ANSWER BY 'N' AND THE SEARCH
	WILL CONTINUE. THE SEARCH ALWAYS STARTS FROM THE BEGINNING OF THE
	BUFFER.
		BLOCK IS MOVED TO THE CURRENT LINE POSITION.
	      AFTER MOVING THE DATA THE ORIGINAL MAY BE DELETED BY ANSWERING
	'Y' TO THE PROMPT.
	FORMAT RM(First string)(ESC)(Second string)(ESC)(ESC)

RS       ALLOWS SUBSTITUTIONS GIVING A DISPLAY OF THE STRING TO BE REPLACED
	PRIOR TO SUBSTITUTION.
	FORMAT <Number of attempts at substitution to be attempted>RS<First
	string><ESC><Second string><ESC><ESC>.
	RESPONCE
	   Beginning of line ^First string^ End of line
	   Sure ? " Type Y or N "
	IF 'Y' THEN NEW LINE AFTER SUBSTITUTION WILL BE DISPLAYED FOLLOWED
	BY
	   Quit now? "Type Y or N"


RW       OUTPUTS FIRST 'N'LINES WITHOUT LINE NUMBERS, FLUSHES FROM MEMORY
	AND RE-ASSIGNS LINE NUMBERS. FORMAT (N)RW.

RX       ACTS LIKE 'X' BUT STRIPS LINE NUMBERS BEFORE 'X' COMMAND.

R0	DISPLAYS FIRST 23 LINES OF THE FILE.

R1	MOVES ON TO THE NEXT 23 LINES AND DISPLAYS THEM.

R;	DISPLAYS CURRENT VALUES OF THE SEMICOLON STACK.

S OF THE FILE.

R1	MOVES ON TO Tееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
                  MACRO TEXT EDITOR FOR CP/M SYSTEM.
                  **********************************

The Text Editor described herein is based upon an excellent Editor (X111)
available from the Intel Program Library. It is a very fast random
access Text Editor with first class capability. Macro commands are stored
on a disc file and are automatically loaded when the edit session is started.
A backup file is automatically created and maintained for text security.

******************
RUNNING THE EDITOR
******************

EDITOR SYNTAX: ED111[,] [:FX:INFILE] TO [:FX:OUTFILE]

,	Comma after ED111 suppresses auto append and EDIT.MAC readin

:FX:INFILE may be either a new or existing file. If :FX:OUTFILE is not specified
the INFILE will be opened for input and a temporary file EDIT.TMP created for
output. When the session is ended with E or ER command all files are closed
and INFILE is renamed INFILE.BAK and EDIT.TMP is renamed INFILE.
If OUTFILE is specified then EDIT.TMP is renamed OUTFILE. In all cases a
backup file is automatically maintained and contains the file content prior to
this edit session.
The editor itself may be located on any disc drive but EDIT.MAC must be on
drive :F0: else it will not load automatically. The backup file and EDIT.TMP
will be located on the same drive as INFILE.

*************
COMMAND ENTRY
*************

When you are using the editor an asterisk * is displayed at the left margin
if the editor is ready to accept a command. The commands are all one or two
letters and must be terminated by two escape characters. The escapes are
echoed as $$.


COMMAND PARAMETERS.
*******************
There are two types of parameters that may be included with editor commands,
these are iteration and data parameters.
An iteration parameter specifies how many times the command is to be performed
and always comes before the command code.
A data parameter specifies the data on which the command is to operate and
always comes after the command code. An escape character is required to
separate multiple fields in a data parameter.

DISPLAY OF CONTROL KEYS.
************************
Control keys other than tab,escape and carriage return are displayed as
an up arrow followed by the corresponding control letter. E.g. Control A
is echoed as ^A, Null is echoed as ^@ .

ABORTING COMMANDS.
******************
A command may be aborted completely before it has been terminated by entering
^C. ^C can also be used to terminate the execution of a command in progress.

CORRECTING TYPING ERRORS.
*************************
You may correct typing errors in command or text strings by pressing the
RUBOUT key which will backspace the cursor and delete one character each time
it is pressed. You may also use ^X to delete a line and ^R to re-display a line
already typed.

^A-LITERALISE.
**************
To input escape characters into your file, precede them with ^A.
^A is a literalising character which overrides the editor semantics
of the following character. ^A's are kept in the command string
only and do not get into the text buffer.

^Z-ECHO CARRIAGE RETURN.
************************
An unliteralised ^Z, when typed in the middle of a command string, will
cause a carriage return/line feed to be echoed to the console, but nothing
will go into the command string.

TEXT FORMATTING
***************
When entering formatted text it is not necessary to enter line feeds
as they are inserted automatically.

^I-Tab
******
Tab characters make it easy to line up columns and may be entered using ^I.
The tabs are initially defined for every 8 character positions. When ^I is
entered the cursor advances to the next tab position.

CONTROL OF PROCESSING
*********************


^S and ^Q Suspend and resume processing.
****************************************
Entry of a ^S whilst the Editor is processing a command will cause processing
to be suspended until a ^Q is entered.


***************
EDITOR COMMANDS
***************

Many editor commands may have iterative and/or data parameters. You may
enter multiple commands on the same line. Execution is from left to right.
When data is included it must be separated from the next command by a single
escape. An escape must also be used as a separator between multiple data fields.

TEXT POINTER
************
The editor keeps a pointer into the data in a file at all times. It always
points between characters. When many of the editor commands are issued the
action takes place from where the pointer is located. The following B,Z,L,C
and F commands all manipulate the pointer.

B-Beginning of Text
*******************
The B command moves the pointer before the first character in the file. It
is the normal default pointer position for commands which do not specifically
move it elsewhere.

Z-End of Text
*************
The Z command moves the pointer immediately following the last character
of the file.

L-Line
******
The L command moves the pointer before the first character of the next line
in the file. You may specify an iterative parameter to move the pointer
backwards or forwards as many lines as you please. If no parameter is specified
a value of 1 is assumed.
A value 0 will move the pointer to the beginning of the current line.

C-Character
***********
The C command moves the pointer a specified number of characters forward or
backward in the file. You may specify a positive or negative iterative
parameter with the command. A negative parameter moves the pointer backward.
If the beginning or end of the file is reached before the specified number
is reached the pointer stops at the beginning or end.

F-Find
******
The F command searches the file for a character string specified in the
command. The search begins at the current pointer location and continues until
the string is found or the end of file is encountered. If the string is found
the pointer is left immediately following the last character of the string.
If the string is not found the pointer is not moved from its current position.
If the F command is used inside a string of commands an escape must be used
to terminate the character string. For a match all characters must match,
including non printing characters.

If you use a null string for the F command (or the first string of an S
command) then the editor will use the last string you specified in a similar
command. For example if you type FXYZ$0LT$$ and get the wrong XYZ, you
can type F$0LT$$ and get the next XYZ. You must not use intervening commands
which accept filenames as they use the same buffer as F and S.

UB-Backup to Beginning of found string.
***************************************
If you execute an F find, then the UB command will backspace the current 
pointer to the beginning of the found string.

I-Insert
********
The I command inserts text into the file immediately before the pointer. All
data following the I command is inserted until a command terminator is entered.
The pointer remains immediately following the data.The total length of an I
command may not exceed the command buffer size.

S-Substitute Text
*****************
The S command finds a character string and substitutes another character
string for it. The substitution is made only if an exact match is found. After
a successful match the pointer is left immediately following the inserted data.
The search is started from the current pointer location and continues until
an exact match is found or the end of file is encountered. There is no limit
to the amount of data that can be inserted with an S command but the search
argument may not exceed 31 characters. If more characters are supplied only
the first 31 are used and only the first 31 are replaced with the new text.

D-Delete Character
******************
The D command deletes the number of characters specified in the command. If
the iterative parameter is positive or unsigned the deletions are done from
the pointer forward. If the parameter is negative the deletions are done from
the pointer backwards. The pointer is left between the remaining characters on
either side of the deletion.

K-Kill Line
***********
The K command deletes all characters in a line beginning at the current
location of the pointer. Characters in the line which precede the pointer are
not deleted. The carriage return at the end of the line is deleted. If the
iterative parameter is positive or unsigned the command deletes the remaining
portion of the line containing the pointer and the following specified number
of lines up to the end of file. If the parameter is negative the command starts
at the pointer and deletes backward the number of lines specified. If no
parameter is specified then 1 is assumed.

T-Type
******
The T command displays a line on the console output device. If the iterative
parameter is positive the editor starts displaying at the pointer and continues
for the specified number of lines. If the iterative parameter is negative the
editor displayes the required number of lines that precede the pointer. A
parameter of zero displays from the beginning of a line to the pointer and
a parameter of one displays from the pointer to just after the next carriage
return. The T command does not move the pointer.


TERMINATING AND SAVING YOUR FILE.
*********************************
There are two basic commands to exit the editor and return control to CP/M,
one saves work from the editing session on to disc and the other does not.

E-Exit
******
The E command saves the entire file from beginning to end. If the beginning
of the file has already been written out (using W) this part, plus the part
which may be in memory and any remaining on disc up to the end of file is
saved. Control is then returned to CP/M.

ER-Exit and Repeat.
*******************
This command functions as the E but restarts the edit. It allows one to
save work that has been done and eliminates the overhead of retyping the
command to start again. The buffer pointer will be positioned at the beginning
of the workspace.

Q-Quit
******
The Q command causes a query QUIT? If the response is Y then the editor
returns control to CP/M without updating INFILE. If the response is not
Y then the editor prompts for a new command.

W-Write
*******
The W command saves on disc a specified number of lines from the beginning of
the file. All lines that are output are deleted from memory thus avoiding
any possibility that these lines will be duplicated when an E command is
issued. The W command is usually used when editing large files which cannot
be completely contained in memory.

DISK ERROR PROTECT.
*******************
The editor will not let you do an E,ER,G,P,UG or UP command if the disc
drives are not ready.
If disaster strikes upon exit, e.g. disc full, text may be recovered
from memory by the following procedure.
	a.Enter the editor via ED111, [filename]. Be sure to use the
comma to prevent EDIT.MAC or any other file from loading.
	b.When the editor signs on type UQ$$
	c.You now have all of free memory to edit. Delete what is not
required.
	d.Use the /P command to send memory to the desired file.
	e.Quit via Q.

READING TEXT FROM DISC.
**********************

A-Append
********
The A command reads bytes of text from disc into memory. The text is appended
at the end of that already in memory. After appending the current size of text,
gap and command buffer are displayed.

AUTO APPEND.
************
When editing a file that currently exists memory will automatically be
filled from the file. This is done before the prompt is given and may
be suppressed by placing a comma immediately after the word ED111 in the console
invocation.


MEMORY STRUCTURE.
*****************
The command buffer is fixed at 1/12 of available memory. Auto append fills up
to 5/6 with text, leaving a minimum gap of another 1/12.

0A-Allocation of Memory
***********************
The 0A command gives the current size of text, gap and command buffer.

UC-Update command buffer size.
******************************
You may change the size of the command buffer by the command nUC$$ where n
is the required size. The minimum size allowable is 240 and this value will
be assumed unless n is greater than 240. The command buffer size is saved
by th UP command, if the normal default size needs to be restored before
saving the command -UC will restore this value but not change the current
size.

COMMAND SIZE EXCEEDS GAP WARNING.
*********************************
A warning bell will sound whenever the size of your typed command is within
3 of the size of the gap. This prevents you from unintentionally inserting
more text than will fill the gap. You will get the warning after the UQ
command, since the gap size is then zero.

COMMAND OPERATORS.
******************

/ Slash
*******
The symbol / can be substituted for the iterative parameter in the A command,
and in all line oriented commands. Its semantics are "apply the following
function to the entire text buffer".
	/A	Fill up the entire text buffer (5/6 of available memory)
		with input.
	/K	Kill the entire text buffer
	/L	Same as Z
	/OO	Output the text buffer and keep in memory
	/Pf	Put the entire text buffer to a side file f
	/T	Type the entire text buffer
	/W	Write the text buffer and flush from memory
Except for the /L command the pointer is always left at the beginning of the
text buffer.

: Colon
*******
A colon placed before a command in place of a number will cause the command
to act upon all text between the current pointer and the end of file. If a
minus sign precedes the colon, the command acts upon all text between the
beginning of the file and the current pointer.

VALUE STACK.
************

; SEMICOLON VALUE STACK.
************************
There is an 8 word array in which you can store 16 bit values generated by
various means. You may recall these values by typing ; ;2 ;3 ;4 ;5 ;6 ;7 or ;8

anywhere a number is expected. You may set the bottom ; to n by typing nUN.
You may roll the stack up with US and down with -US. You may input two bytes
from the text file into ;n with the command nUI. If you want the second byte
masked out, use the command nUH. You may output ;n as two bytes of text
inserted into the file with the command nUO.
If a semicolon value exceeds 32767, it will be interpreted as a negative
number when it is recalled. Conversely, negative numbers input via UN are
input as sixteen bit quantities with the top bit set.

ARITHMETIC.
***********
The command UA adds ;2 to ; and collapses the stack downward, leaving the
sum in ; . The command -UA subtracts ; from ;2 and the command UM multiplies
;2 by ; . Both these operations collapse the stack in the same way as addition.
The command -UM divides ;2 by ; leaving the quotient in ;2 and the remainder
in ;  no stack collapsing takes place. All arithmetic operations interpret
the stack values as unsigned 16 bit integers.

UX-EXCHANGE.
************
nUX exchanges ;n with ; and -nUX exchanges .n with .1 . These commands, in
conjunction with the roll commands, allow you to permute the stack members
as may be required.

V MARKERS.
**********
The V command sets a marker at the current location of the text pointer
Eight of these markers may be set using
		nV where 1<=n<=8
These markers may then be used to delimit line oriented commands and to
perform block moves. To delimit line oriented commands use
	.nK	delete all text between V marker n and the current pointer
	.nL	return to V mark n
	.nOO	output text between V mark n and present pointer
	.nPf	put text between V mark n and present pointer to side file f
	.nT	type all text between V mark n and present pointer
	.nW	write and flush text between V mark n and present pointer
	.nFs	find string s between V mark n and present pointer
	.nSss	substitute string s between V mark n and present pointer

ROLLING THE V STACK
You may roll the 8 values up with the command UV and roll them down with
-UV (i.e. UV sends marker N to marker N+1 and marker 8 to 1, -UV sends
marker N to marker N-1 and marker 1 to marker 8). Thus you can use the 
array as a stack with UVV being the push operation and .L-UV being the pop
operation. This allows definition of macros which use the V marks but
preserve the bottom V marks.

TEXT SWITCHING OR REARRANGING.
******************************

P-Put.
******
The P command allows one to put lines of text to a specified file. The number 
of lines is taken from the current pointer position. The syntax of the 
command is
	nPf$	where	n = number of lines (positive or negative)
			P = the command
			f = any CP/M device or filename
			$ = delimiting escape character
Lines written out are not deleted from the workspace.


G-Get
*****
The G command allows one to get text from any CP/M file. The
text is inserted at the current position of the buffer pointer. If there
is not room in the buffer for the file, all text from the beginning of
the workspace to the buffer pointer is written out until the remaining
text fits into the buffer. If text is written out and you want to edit
that text use ER to restart the edit. The syntax of the command is
	Gf$	where	f is any CP/M device or filename.
If you leave out the filename you will get an inline block move from the
V mark.

BLOCK MOVES
***********
The command nG$$ will get n lines from the .1 V mark and insert them
at the present position. The escape key must immediately follow the G.
The 8 V marks allow you to delimit in-memory block moves from both
ends. You can mark the beginning of your source block with V, the end with
2V, and then go to the destination insert point. The command .2G$$ will
now move the block (but will not delete the source block).

OO-Output
*********
The OO command acts like the W command, except that lines are output from the
current pointer position rather than from the beginning, and the lines are
not flushed from memory. The command is most useful when extensively
rearranging a file.

COMMAND STRING ITERATIONS
*************************
You may repeat a command string or a single command any number of times
by enclosing the command string in angle brackets < > preceded by a number
that specifies the number of times that the command string is to be performed.
Note that a single escape $ character is required to separate a data string
from the final angle bracket.
Iteration command strings may be nested up to 8 deep.

CONDITION TESTING ON ITERATION OPERATIONS.
******************************************
You can, within iterations do condition testing. If the condition is true,
control proceeds normally. If the condition is false, commands between the
test and the next iteration are skipped. The iteration either exits or loops
depending on whether the iteration value has been exhausted. The tests are
as follows
	nUE	tests ; = ;n
	-nUE	tests ; <> ;n
	nUL	tests ; < ;n
	-nUL	tests ; >= ;n

Y-Yes prompt.
*************
A special condition test is the Y command, which pauses for console input
and returns condition true if a Y is typed, and condition false if anything
other than a Y or G is typed. If a G is typed, condition true is returned
for this yes prompt and for all future yes prompts until the next * prompt
is given.

URx-Character test.
*******************
Continue if the character following the current pointer is x.


UY-String found test.
*********************
Continue if the string in the previous Fs command was found.

UT-Until Terminate test.
************************
The command UT is a test with slightly different semantics than the Y,UL,UE
tests. UT is placed at the end of an iteration, if when it is encountered
the current pointer is at the end of the text buffer, the iteration value
is reduced to 1 so that the iteration is exited. For example the command
/<IXXX$LUT>$$ places the string XXX at the beginning of every line.
The command -UT does the iteration exit unconditionally, it is invoked in
situations where you want to loop until a previous condition tests true.


*******
MACROS.
*******

Command strings may be named and recalled.

N-Name
******
To define a macro, type N followed by an ASCII character other than a blank.
Then type the command string. The definition is terminated by a double escape
which is included in the definition. You may define as many macros as you
want. You may delete ALL macros by typing N $$.

R-Recall.
*********
To recall a macro command string, type R followed by the ASCII character which
was used to name it.

MACROFILES.
***********

UP-U Put
********
The command UP followed by a file name will send all macros to that file. In
addition, the user adjustable internal flags (auto append switch, rubout
semantics, line semantics, joker character, number base and command buffer
size) are sent to the file.

UG-U Get.
*********
The command UG followed by a filename reads
the macrofile in. The internal flags are overwritten, but the macro buffer
is merely added to. Thus you can collect macros from different files. In
addition, the file EDIT.MAC if it exists will be automatically loaded when
the editor signs on. If EDIT.MAC contains a macro whose name is 0FFH
(defined by N^DFF^Dstring), then that macro is automatically executed after
the input file is read in. You can thus use the J literal output command
to have your macrofile sign on, and/or perform automatic manipulations on
your file.


MACRO DISPLAY AND DELETION.
***************************

UD-U Display.
*************
The command UD will display a list of all macros currently in memory. The
names are given in reverse order of when they were defined.

Mx-Macro x.
***********
The command Mx will display the definition string of macro x.

UKx-U Kill x.
*************
Command UKx will delete macro x. A macro need not be deleted before defining
another with the same name but only the last one defined will be accessable for
use or deletion.

MACRO PARAMETERS.
*****************
You may pass four kinds of parameters to macros. You may pass a single
value n into a macro by putting n before the call. The value is substituted
for every occurance of an = sign in the macro. For example you can define
NA=L=T$$ and call 23RA$$ to get 23L23T$$. You can pass up to 127 strings
to a macro by placing the strings following the macro call. The strings
are delimited by single escapes. To read the strings, place ^B's in the
macro. The strings (without the delimiting escapes) will be substituted
for the ^B's in the order that they are encountered in the macro. For
iteration loops, the string pointer is reset to what it was at the beginning
of the iteration, so that ^B's within iterations will give the same strings
over and over again. For example, NS=<S^B$^B$0TT>$$ defines a macro which
repeatedly substitutes and displays the line on which substitution occurs.
If you type 10RSABC$XYZ$$ you will get 10 substitutions of XYZ for ABC with
the 10 involved lines displayed.
Each ^F in a macro will cause a prompt for console input of one character.
After entry of the character macro expansion will continue with the ^F
replaced by the entered character.
The fourth kind of parameter passing is the post execution parameter.
If an unliteralised ^E is encountered in a macro expansion, the editor
exits completely from the macro expansion mode and prompts for more keyboard
input. The advantage here is that you can be in the middle of a command
when this happens. For example the macro NI-5TI^E$$ prints for insertion
input. Furthermore, the ^E prompt is always followed by a backspace, so
that what you are typing in will appear on the screen just as it will in
the file (i.e. without a *I).

MACRO CALL NESTING.
*******************
You may nest macro calls to a depth of 8. Control B string substitutions
count as a nesting level. You may not define macros within macro calls.

EDITING MACROS.
***************
Two commands are available which allow you to edit a macro without deleting
and redefining it.


-Mx-Get macro to text.
**********************
The -Mx command will get macro x from the macro store and insert it into
the text buffer at the current pointer position. If the macro is to be
edited and returned to the macro store then the text buffer must be emptied
before getting the macro.

X-Replace macro.
****************
The X command will move a macro from the text buffer into the macro store.

-UD-Get macro menue to text.
****************************
The -UD command may be used to get the current macro menue to the text
buffer at the current pointer position.

***********************
MISCELLANEOUS COMMANDS.
***********************

^D-Hexidecimal input.
*********************
This is valuable for editing hex (binary code) files. To enter the hex input
mode, use control D. Any number of hex digits may now be entered (subject to
memory limitations). Any characters which are not legal hex digits will not
be accepted and will not be echoed. The hex string must be terminated by
another control D. If an odd number of digits was entered, the editor will
reprompt with D, the final digit should then be entered and followed by
control D. Control R may be typed at any time. If it is typed after the final
control D, the characters displayed may not all be properly printable.
Warning:
Do not rubout across either the terminating or beginning control D as the
editor will get confused about whether it is in hex mode or not. Use control X
and retype the line.

H-Hexidecimal display.
**********************
The command nH will display in hex the next n bytes from the pointer. n may
be negative. With care it is possible to edit object or other non ASCII files.

J-Message output.
*****************
The command J followed by a string outputs that string to the console. The
command -J does the same thing, only control characters are sent directly
instead of being translated into up arrow characters.
These message commands are useful for several purposes. You can write
display macros which mark the current position with a special character in
the display. You can put a sign-on message in your default 0FFH macro. You
can put a question message before a yes prompt.

UJ-Clear screen
***************
The command UJ is intended as a "clear screen" command. It sends two
characters which may be set for your terminal by 8UFx and 9UFx.

UU-Command tail display.
************************
The command UU displays the command tail which invoked this edit session
(without the word EDIT). The command tail is also displayed with the word
EXIT whenever an E or ER is executed.


UZ-Input file size.
*******************
The nUZ command sets ;n to the number of text bytes between the current
pointer and the end of file. The -nUZ command sets ;n to the number of bytes
between the beginning of the file and the current pointer.

******************************
USER ADJUSTABLE INTERNAL FLAGS
******************************

RUBOUT AND BLANK SEMANTICS ADJUST.
**********************************
In the absence of EDIT.MAC the editor loads with a backspace character set
to 08H and a blank character set to 20H (^H and space, respectively). All
blanks are echoed using the blank character, and all rubouts are echoed
backspace-blank-backspace. If your terminal uses other codes to achieve these
characters, you will want to change them. UFx changes the blank character
to x and 2UFx changes the backspace character to x.

SEMANTICS OF LINE ORIENTED COMMANDS.
************************************
All line oriented commands search for line feeds. To change their
semantics so that they search for some other character (e.g. form feeds for
page oriented commands, or carriage returns) type 5UF followed by the new
character.

JOKER CHARACTER.
****************
A question mark, when included anywhere after the first character of an F
string or the first string of an S, will match any character on a one for
one basis. The joker character may be changed from ? to any other character
by issuing the command 4UF followed by the new character.

DECIMAL OUTPUT, BASE CHANGE.
****************************
The command nUW inserts the decimal value of ;n as a string of digits in the
text body. The command -nUW changes the base to any value between 2 and 16.
The base change command also affects the display of the UC command, if the base
is 10 you will get that base in the UC command. If the base is not 10 then
executing UC will change the base back to 10. The base is also used to
determine the width of display in the H command.

ECHO SUPPRESS.
**************
The command 10UF1 causes all console echoing to cease. This facilitates

macros which allow page editing. The command 10UF0 restores the normal echo.

D.R.BACK  21 JULY 1981


Commands (except O) may be either upper or lower case

EDITOR SYNTAX: ED111[,] [:FX:INFILE] TO [:FX:OUTFILE]

.	Full stop after ED111 suppresses auto append and EDIT.MAC readin


nA	Append n bytes from input file to memory; go to beginning
B	Go to beginning
nC	Move pointer n bytes
nD	Delete n bytes
E	Exit
ER	Exit and Reenter editor
Fs	Find string s
nG$	Insert n lines from the first V marker (n>0)
.nG$	Insert the block from .1 to .n at the current position (.1<.n)
Gf	Insert the entire file f at the current position
nH	Display n bytes in Hex
Is	Insert string s
Js	Output string s to console
-Js	Output string s to console without translating controls
nK	Delete n lines
nL	Move pointer n lines
Mx	Display content of macro x
-Mx	Get content of macro x to text at current pointer
Nxs	Name a macro x comprising string s
N $	Delete all macros from memory
nOO	Output n lines from pointer without flushing (n>0)
nPf	Put n lines to a side file f (deletes old f if it exists)
Q	Abort the editing session
Rx	Recall macro x
Sss	Substitute second string for first string
nT	Type n lines
UA	Add ;1 := ;2 + ;1
-UA	Subtract ;1 := ;2 - ;1
UB	Back up to beginning of string just found
nUC	Update command buffer size and display current memory allocation
-UC	Reset command buffer size default
UD	Display macro menu
-UD	Insert macro menu to text at current pointer
nUE	Continue if ;1 = ;n
-nUE	Continue if ;1 <> ;n
UFx	Set blankout character for this console
2UFx	Set backspace character for this console
3UFx	Set number base (display only)
4UFx	Set joker character
5UFx	Set linefeed semantic
6UFx	Set prompt character

8UFx	Set first UJ character
9UFx	Set second UJ character
10UFx	Set command echo 0=on 1=off
11UFx	Set tab length
12UFx	Set delimiter echo character
UGf	Get macro file f
nUH	High byte maskout of ;n
nUI	Insert two ASCII text bytes into ;n
UJ	Clear the console screen (not 4024)
-UJ	Backspace one character (eat prompt)
UKx	Delete macro x
nUL	Continue if ;1 < ;n
-nUL	Continue if ;1 >= ;n
UM	Multiply ;1 := ;1 * ;2
-UM	Divide ;2 by ;1 leave quotient in ;2 remainder in ;1
nUN	Set ;1 to n
nUO	Output ;n (2 bytes ASCII) to text file
UPf	Put all flags and macros to macro file f
UQ	Unquit i.e. edit raw memory
URx	Continue if character after current pointer = x
US	Roll semicolon stack down
-US	Roll semicolon stack up
UT	Until terminate i.e. do not iterate if pointer is at end of text
-UT	Do not iterate under any circumstances
UU	Display edit command tail
UV	Roll V mark stack down
-UV	Roll V mark stack up
nUW	Write ;n in decimal to text
-nUW	Change base from decimal to n for UW and UC commands (n ASCII)
nUX	Exchange ;n and ;1
-nUX	Exchange .n and .1
UY	Continue if string in previous Fs command was found
nUZ	Set ;n to number of text bytes between current position and end
-nUZ	Set ;n to number of text bytes between beginning and current position
nV	Set V mark n to current position
nW	Write n lines from beginning and flush from memory
nX	Replace macro(s) from text to macro store
Y	Yes prompt
Z	Go to end of buffer

:	Apply following command to text between current pointer and end
-:	Apply command to text between beginning and current pointer
;n	Use semicolon stack value for this command
=	Use passed in macro value for this command
/	Apply following A,K,L,O,P,T or W command to entire text buffer
.n	Apply following F,K,L,O,P,S or T command to text between V marker n
	and the current pointer


^A	Literalise the following character
^B	Use string following macro call for input
^C	Return to command status and re prompt
^D	Enter or leave Hex input mode
^E	Exit macro expansion mode (possibly in mid instruction)
^F	In a macro ^F is replaced by a character obtained from console
^I	Tab
^Q	Continue processing (used after ^S)
^R	Redisplay current command line
^S	Suspend processing
^X	Delete current command line
^Z	Echo a carriage return but do not put anything into command string
RUBOUT	Delete one character from current command line
ESCAPE	Delimiter character. Echoed as $. Two escapes terminate current command
<>	Angle brackets. Delimit repeated commands

Special Commands
0A	Display current memory allocation
1811UTx	Change delimiter/command terminator from ESC to x

mmands

Special Commands
0A	Display current memory allocation
181 ':TR:'	;TELETYPE READER
	DB ':O1:'	;USER CO
	DB ':I1:'	;USER CI
	DB ':VO:'	;CRT O/P
	DB ':VI:'	;CRT I/P
	DB ':TO:'	;TELETYееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
U.K. CP/M Users Group - Program Submission Form

Submission Date: 26 FEB 81 

File name: LETTER.BAS - TEXT FORMATTING & JUSTIFICATION PROG. 
           PRINT.BAS - PRINTS COPIES OF JUSTIFIED FILES.

Author: MIKE MAGNAY  
       GANYMEDE WANTAGE RD. ROWSTOCK
        DIDCOT OXON OX11OJU
   TEL ABINGDON 834402

Submitted by: MIKE MAGNAY 
This program is public domain because: 
  AUTHORS MOD OF PREVIOUS U.G.PROG.
Who would this program be useful to: 
   All CP/M users

Briefly describe the program function: 
JUSTIFIES AND FORMATS TEXT. FILE SAVE OF FORMATTED TEXT.

Where is further documentation available: 
INST.FMI IS BOTH THE INSTRUCTIONS & AN EXAMPLE.
MODIFICATION OF <FORMAT> BY B.RATOFF, U.S.U.G.VOL 3.19

Hardware dependencies: 
PRINTER - IT IS INTENDED THAT THE .BAS FILE BE PATCHED BY
THE USER TO SUIT SPECIAL FEATURES OF HIS/HER PRINTER.
PATCHES FOR FUTURE VOLS?

Software dependencies: 
SHOULD COMPILE & RUN ON ALL VERSIONS OF BASIC E.

Source processor: N/A 

How easy is the code to modify: 
   FAIRLY STRAIGHTFORWARD
BE DONE BUT REQUIRES
MORE THAN THE AVERAGE AMOUNT OF THOUGHT.

D.R.BACK. 20 JULY 1981.

T NOWHERE ELSE) IN A FILE. IT CAN SOURCE.COM	(1) Conversational disassembler
42.19	26K	RESOURCE.DOC	(1) Doc on above
42.20	5K	START.ASM	Compucolor 8001 initializer
42.21	1K	START.COM	COM of above
42.22	2K	T.ASM		(3) Print time on..
42.23	1K	T.COM		    ..console
42.24	3K	TIME.ASM	(3) ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееCP/M UK USERS GROUP VOLUME 2

Notes on files on this volume.


CPMLIB.DOC
==========

Catalogue of US User Group disks 1 to 51.
43 to 46 inclusive are reserved for the Osborne business package.



ED111
=====

David Back's incredible Macro Text Editor, adapted from X111 in the Intel users
library to run under CP/M. Lots of improvements and a careful and detailed
documentation. Also a replacement CCP for CP/M2.2 with various improvements.
Part of ICOS-80 David's very own rendition of CP/M to run under ISIS.


=L=C яX>DR<X
 яIT0I я>BR<W=>DR<W яE>DR<E# яSU->TUAUNUSULIWUяI</NUSUB	 юP/P я>TUK8.FV8BUяF</D
 яT:  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееUK Users Group Volume 3

Programmable Calculator Simulation by Electronic Accounting
Services.
Utilities.


NUMBER	SIZE	NAME		COMMENTS

		CATALOG.03	CONTENTS OF CP/M VOL. 03
03.1	2K	BM.OBJ		A routine to run an approximation to PCW
				benchmarks.
03.2	1K	BM.SRC		Source of above.
03.3	5K	BREAK.ASM	File transfer, removing EOF (^Z) characters.
03.4	1K	BREAK.COM	.COM of above.
03.5	13K	CALC.BAS	Calculator program.
03.6	5K	CALC.INT	.INT of above.
03.7	27K	CNOTES.PRN	System notes for calculator package.
03.8	36K	COMPILE.BAS	Simulation compiler.
03.9	14K	COMPILE.INT	.INT of above.
03.10	1K	CRCKLIST.CRC	Checksums for files on this disk.
03.11	21K	EDITOR.BAS	Simulation program editor.
03.12	8K	EDITOR.INT	.INT of above.
03.13	17K	EDITOR1.BAS	Simulation data file editor.
03.14	7K	EDITOR1.INT	.INT of above.
03.15	1K	INIT.BAS	Simulation initialisation program.
03.16	1K	INIT.INT	.INT of above.
03.17	5K	LIST.ASM	List with paginate and tab expand.
03.18	1K	LIST.COM	.COM of above.
03.19	2K	PCALC.BAS	Controlling program for calculator.
03.20	1K	PCALC.INT	.INT of above.
03.21	8K	PROG.BAS	Simulation menu program.
03.22	4K	PROG.INT	.INT of above.
03.23	19K	RUNOBJ.BAS	Runtime module for calculator.
03.24	7K	RUNOBJ.INT	.INT of above.
03.25	2K	SAL.OBJ		Object of SAL.SRC
03.26	2K	SAL.SRC		Routine to generate payslips
 ':TR:'	;TELETYPE READER
	DB ':O1:'	;USER CO
	DB ':I1:'	;USER CI
	DB ':VO:'	;CRT O/P
	DB ':VI:'	;CRT I/P
	DB ':TO:'	;TELETYееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее"002:001:BENCHMARK NUMBER"
"002:002:START"
"002:003:END"
"021:042:"
"011:001:043:256:"
"014:001:274:042:"
"009:001:"
"020:001:008:001:"
"003:019:"
"003:025:"
"003:033:"
"003:042:"
"003:051:"
"003:063:"
"003:065:"
"003:067:"
"015:"
"016:"
"004:BENCHMARK 1"
"010:002:"
"006:044:"
"007:"
"010:003:"
"013:"
"004:BENCHMARK 2"
"010:002:"
"011:004:042:256:"
"014:004:271:044:"
"024:004:"
"015:"
"010:003:"
"013:"
"004:BENCHMARK 3"
"010:002:"
"011:004:042:256:"
"014:004:271:044:"
"024:004:"
"011:005:004:004:255:004:254:004:252:004:253:256:"
"015:"
"010:003:"
"013:"
"004:BENCHMARK 4"
"010:002:"
"011:004:042:256:"
"014:004:271:044:"
"024:004:"
"011:005:004:045:255:046:254:047:252:048:253:256:"
"015:"
"010:003:"
"013:"
"004:BENCHMARK 5"
"010:002:"
"011:004:042:256:"
"014:004:271:044:"
"024:004:"
"011:005:004:045:255:046:254:047:252:048:253:256:"
"003:061:"
"015:"
"010:003:"
"013:"
"004:DUMMY SUBROUTINE"
"013:"
"004:BENCHMARK 6"
"013:"
"004:BENCHMARK 7"
"013:"
"004:BENCHMARK 8"
"010:002:"
"011:004:042:256:"
"014:004:271:049:"
"024:004:"
"011:005:004:045:251:256:"
"011:006:004:265:256:"
"011:007:004:257:256:"
"015:"
"010:003:"
"013:"
"END1"
"0"
"1"
"1000"
"2"
"3"
"4"
"5"
"100"
"END2"
SOURCE.COM	(1) Conversational disassembler
42.19	26K	RESOURCE.DOC	(1) Doc on above
42.20	5K	START.ASM	Compucolor 8001 initializer
42.21	1K	START.COM	COM of above
42.22	2K	T.ASM		(3) Print time on..
42.23	1K	T.COM		    ..console
42.24	3K	TIME.ASM	(3) ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееname r1 BENCHMARK NUMBER
name r2 START
name r3 END
fix 0
r1 = 1
while r1 neq 0
input r1
select r1 max 8
call benchmark 1
call benchmark 2
call benchmark 3
call benchmark 4
call benchmark 5
call benchmark 6
call benchmark 7
call benchmark 8
wend
stop
sub benchmark 1
print r2
do 1000
loop
print r3
return
sub benchmark 2
print r2
r4 = 0
while r4 lt 1000
inc r4
wend
print r3
return
sub benchmark 3
print r2
r4 = 0
while r4 lt 1000
inc r4
r5 = r4 / r4 * r4 + r4 - r4
wend
print r3
return
sub benchmark 4
print r2
r4 = 0
while r4 lt 1000
inc r4
r5 = r4 / 2 * 3 + 4 - 5
wend
print r3
return
sub benchmark 5
print r2
r4 = 0
while r4 lt 1000
inc r4
r5 = r4 / 2 * 3 + 4 - 5
call dummy subroutine
wend
print r3
return
sub dummy subroutine
return
sub benchmark 6
return
sub benchmark 7
return
sub benchmark 8
print r2
r4 = 0
while r4 lt 100
inc r4
r5 = r4 ^ 2
r6 = ln r4
r7 = sin r4
wend
print r3
return
END
sub benchmark 8
print r2
r4 = 0
while r4 ltееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;     COPYRIGHT (c) 1981 ELECTRONIC ACCOUNTING SERVICES.
;PROGRAM TO READ A FILE STRIP OFF ALL CPM END OF FILE (^Z) CHARACTERS
;AND REP WITH ?,WRITING THE RESULT TO A SECOND FILE.
;THE TWO FILE NAMES TO BE SPACIFIED IN THE COMMAND LINE IN THE FORM :
;BREAK ONE.BAS TWO.BAS
;WHERE ONE.BAS IS THE NAME OF THE ORIGINAL FILE AND TWO.BAS IS THE
;NAME OF THE RECEIVING FILE.
;DATA IS SENT SECTOR BY SECTOR INTO A 4K BUFFER WHICH IS PROCESSED
;AND THEN SENT TO THE RECEIVING FILE.
BDOS	EQU	0005H		;BDOS ENTRY POINT
TPA	EQU	0100H		;BASE OF TPA
DMA	EQU	1100H		;ADDRESS FOR DIRECT MEMORY ACCESS
STACK	EQU	1050H		;USER STACK AREA
FCB1	EQU	005CH		;ADDRESS OF FILE CONTROL BLOCK 1
OFCB2	EQU	006CH		;OLD ADDRESS OF FILE CONTROL BLOCK 2
FCB2	EQU	1000H		;NEW ADDRESS OF FILE CONTROL  BLOCK 2
FCB2CR	EQU	FCB2 + 32	;ADDRESS OF CURRENT REC IN FCB2
SECTOR	EQU	128		;NUMBER OF BYTES IN SECTOR
NSECT	EQU	32		;NUMBER OF SECTORS IN BUFFER
SDMA	EQU	1AH		;BDOS FUNCTION 26
OPEN	EQU	0FH		;BDOS FUNCTION 15
MAKE	EQU	16H		;BDOS FUNCTION 22
READ	EQU	14H		;BDOS FUNCTION 20
WRITE	EQU	15H		;BDOS FUNCTION 21
CLOSE	EQU	10H		;BDOS FUNCTION 16
EOF	EQU	1AH		;CPM END OF FILE (^Z)
REP	EQU	1FH		;ASCII ?
	ORG	TPA
	LXI	SP,STACK	;SET LOCAL STACK AREA
	LXI	H,OFCB2		;HL-ADDRESS OF OLD FCB2
	LXI	D,FCB2		;DE-ADDRESS OF NEW FCB2
	MVI	B,16		;SET COUNT TO 16
MOVE	MOV	A,M		;FETCH CONTENTS TO BE MOVED
	STAX	D		;STORE AT NEW LOCATION
	INX	H
	INX	D
	DCR	B
	JNZ	MOVE		;LOOP IF COUNT NOT ZERO
	MVI	A,00H
	STA	FCB2CR		;SET CURRENT RECORD TO ZERO
OPEN1	LXI	D,FCB1
	MVI	C,OPEN
	CALL	BDOS		;FUNCTION 15
	CPI	0FFH
	JZ	ABORT		;IF NO MATCH ABORT
MAKE2	LXI	D,FCB2
	MVI	C,MAKE
	CALL	BDOS		;FUNCTION 22
	CPI	0FFH
	JZ	ABORT		;IF NO DIRECTORY SPACE  ABORT
	MVI	B,00H		;LOAD COUNT WITH ZERO
SDMA1	LXI	D,DMA
	PUSH	D		;SAVE DMA ADDRESS ON STACK
	MVI	C,SDMA
	CALL	BDOS		;FUNCTION 26
READ1	INR	B
	PUSH	B		;SAVE SECTOR COUNT ON STACK
	LXI	D,FCB1
	MVI	C,READ
	CALL	BDOS		;FUNCTION 20
	CPI	00H
	JNZ	FLAG		;IF REAL END OF FILE JUMP OUT OF LOOP
SDMA2	POP	B
	POP	H		;GET PRESENT ADDRESS FOR DMA
	MVI	E,SECTOR	;LOAD SECTOR SIZE INTO LO BYTE OF DE
	MVI	D,00H		;LOAD ZERO INTO HI BYTE OF DE
	DAD	D		;ADD SECTOR OFFSET TO CURRENT DMA
	PUSH	H		;SAVE NEW DMA ADDRESS ON STACK
	PUSH	B
	XCHG			;SWAP REGISTERS HL AND DE
	MVI	C,SDMA
	CALL	BDOS		;FUNCTION 26
	POP	B		;GET PRESENT VALUE OF COUNT FROM STACK
	MOV	A,B
	CPI	NSECT
	JNZ	READ1		;IF = NUMBER OF SECTORS LOOP
	JMP	COMPAR
FLAG	POP	B		;GET COUNT FROM STACK
	DCR	B		;DECREMENT COUNT AS REAL EOF
COMPAR	PUSH	B		;SAVE COUNT ON STACK
	LXI	H,DMA		;HL-START OF DATA BLOCK
LOOP2	MVI	D,SECTOR	;COUNT FOR INNER LOOP
LOOP1	MOV	A,M		;GET BYTE
	ANI	7FH		;SET BIT 7 TO 0
	CPI	EOF
	JNZ	COUNT		;IF NOT CPM EOF JUMP
	MVI	M,REP		;SWAP WITH ?
COUNT	INX	H
	DCR	D
	JNZ	LOOP1		;INNER LOOP
	DCR	B
	JNZ	LOOP2		;OUTER LOOP
SDMA3	LXI	D,DMA
	POP	B
	PUSH	B		;SAVE COUNT ON STACK AS CONTINUE FLAG
	PUSH	D		;SAVE ADDRESS OF DMA ON STACK
	PUSH	B
	MVI	C,SDMA
	CALL	BDOS		;FUNCTION 26
	POP	B		;LOAD SECTOR COUNT FROM STACK
WRITE1	PUSH	B		;SAVE COUNT FOR LOOP
	LXI	D,FCB2
	MVI	C,WRITE
	CALL	BDOS		;FUNCTION 21
	POP	B
	POP	H		;GET DMA ADDRESS FROM STACK
SDMA4	MVI	E,SECTOR	;LOAD SECTOR OFFSET INTO LO BYTE OF DE
	MVI	D,00H		;LOAD ZERO INTO HI BYTE OF DE
	DAD	D		;ADD SECTOR OFFSET TO DMA
	PUSH	H		;SAVE NEW DMA ON STACK
	PUSH	B
	XCHG			;SWAP DE AND HL
	MVI	C,SDMA
	CALL	BDOS		;FUNCTION 26
	POP	B		;GET SECTOR COUNT FROM STACK
	DCR	B
	JNZ	WRITE1		;IF MORE SECTORS LOOP
TFLAG	POP	H
	POP	B		;LOAD CONTINUE FLAG
	MOV	A,B
	CPI	NSECT
	JZ	SDMA1		;IF NOT REAL EOF LOOP BACK FOR NEW BLOK
WRITE2	LXI	D,DMA
	MVI	C,SDMA
	CALL	BDOS		;FUNCTION 26
	MVI	B,SECTOR	;SET COUNT
	LXI	H,DMA
	MVI	M,EOF		;SAVE EOF ^Z
	INX	H
	DCR	B
LOOP3	MVI	M,20H		;ASCII SPACE TO FILL REMAINING SECTOR
	INX	H
	DCR	B
	JNZ	LOOP3		;IF SECTOR NOT FULL LOOP
	LXI	D,FCB2
	MVI	C,WRITE
	CALL	BDOS		;FUNCTION 21
CLOSE1	LXI	D,FCB1
	MVI	C,CLOSE
	CALL	BDOS		;FUNCTION 16
CLOSE2	LXI	D,FCB2
	MVI	C,CLOSE
	CALL	BDOS		;FUNCTION 16
ABORT	NOP
	JMP	0000H		;RETURN TO CPM
=L=C яX>DR<X
 яIT0I я>BR<W=>DR<W яE>DR<E# яSU->TUAUNUSULIWUяI</NUSUB	 юP/P я>TUK8.FV8BUяF</D
 яT:  DB      0DH,0AH,'...ABORTED', 0DH,0AH,'$'
        END
яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1P!l  ~#В> 2 \ Н юяКв Н юяКв  ХН Е\ Н ю ВeБбЂ еЕлН Бxю В=ГgБЕ! Ђ~жюВw6#ВmВk БЕХЕН БЕ Н БбЂ еЕлН БВЌбБxю К4 Н Ђ! 6#6 #ВГ Н \ Н  Н  Г                            BJ		Object of SAL.SRC
03.26	2K	SAL.SRC		Routine to generate payslips
 ':TR:'	;TELETYPE READER
	DB ':O1:'	;USER CO
	DB ':I1:'	;USER CI
	DB ':VO:'	;CRT O/P
	DB ':VI:'	;CRT I/P
	DB ':TO:'	;TELETYееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееcommon clear$,cursor$,c.offset%
common tot.inst%,length%,data.no(1),object$(1)
common instruction$(1),register(1)
common print.flag$,res.flag$,dat.flag$
common comp.flag$,f1$,f2$,f3$
common f4$,f5$
common end.data,delete.data,blank.data
rem :******************************************************************
rem :
rem :  Copyright (c) 1981 by Electronic Accounting Services.
rem :
rem :******************************************************************
print clear$
def fnc$(r%,c%) = cursor$ + chr$(r% + c.offset%) + chr$(c% + c.offset%)
data +,-,*,/,CLR,PI,SQ,RT,CHS,INT,FR,ABS,%,STO,COMB
data REC,PERM,SIN,COS,TAN,ASIN,ACOS,ATAN,PWR,LN,EXP
data LOG,ALOG,DEG,RAD,#D,#R,CLR-R,FACT,D%,END
angle.flag$ = "DEGREES"
b1.line$ = "                       "
b2.line$ = b1.line$ + "      "
blk$ = " "
pic0$ = "/...5/#.###########^^-"
pic1$ = "//##,###,###,###.###########-"
pic2$ = "//##,###,###,###-"
rem *********************************************************
rem : Algabraic calculator program.
rem : Requires a terminal with clear screen
rem : plus an addressable curser.
rem *********************************************************
dim calc.reg(10)
continue.flag$ = "CONTINUE"
k% = 0
while f$ <> "END"
    read f$
    k% = K% + 1
wend
 dim f$(1,(k% + 1))
restore
for i% = 1 to k%
    read f$(1,i%)
next i%
gosub 100 :rem fill screen with fixed labels
while continue.flag$ = "CONTINUE"
    gosub 200 :rem get characters
    gosub 300 :rem select function
    gosub 400 :rem Write blanks to input areas
wend
chain "PCALC"
stop

100 rem ***** Fill screen with fixed labels *****
print clear$
line1$ = "________________________"
line2$ = line1$ + "____________"
print fnc$(14,1);line2$ 
print fnc$(17,1);line2$ 
print fnc$(4,37);line1$ 
print fnc$(19,37);line1$ 
for i% = 1 to 23
    print fnc$(i%,36); ":" 
    print fnc$(i%,61); ":" 
next i%
print fnc$(2,3);"REG" 
print fnc$(3,4);"NO" 
for i% = 4 to 12
    reg% = i% - 3
    print fnc$(i%,2); reg%;":"
next i%
print fnc$(2,40);"CBASIC2 CALCULATOR." 
print fnc$(3,39);"*********************" 
print fnc$(15,14);"RESULT." 
print fnc$(18,2);"From Function :" 
print fnc$(19,2);"First Number." 
print fnc$(21,2);"Second Number." 
print fnc$(5,43);"INPUT AREA." 
print fnc$(7,38);"First Number or R." 
print fnc$(10,38);"     Operator." 
print fnc$(13,38);"Second Number or R." 
print fnc$(17,39);"SYSTEM MESSAGE LINE." 
print fnc$(20,39);"NB R is the result if" 
print fnc$(21,39);"just R but register if" 
print fnc$(22,39);"followed by register" 
print fnc$(23,39);"number." 
print fnc$(2,66);"FUNCTIONS." 
b1$ = " "
b2$ = "  "
b3$ = "   "
b4$ = "    "
for i% = 1 to 12
    i2% = i% + 12
    i3% = i% + 24
    if len(f$(1,i%)) = 1 then text$ = b4$
    if len(f$(1,i%)) = 2 then text$ = b3$
    if len(f$(1,i%)) = 3 then text$ = b2$
    if len(f$(1,i%)) = 4 then text$ = b1$
    text$ = text$ + f$(1,i%)
    text$ = text$ + b1$
    if len(f$(1,i2%)) = 1 then text$ = text$ + b4$
    if len(f$(1,i2%)) = 2 then text$ = text$ + b3$
    if len(f$(1,i2%)) = 3 then text$ = text$ + b2$
    if len(f$(1,i2%)) = 4 then text$ = text$ + b1$
    text$ = text$ + f$(1,i2%)
    text$ = text$ + b1$
    if len(f$(1,i3%)) =1 then text$ = text$ + b4$
    if len(f$(1,i3%)) =2 then text$ = text$ + b3$
    if len(f$(1,i3%)) =3 then text$ = text$ + b2$
    if len(f$(1,i3%)) =4 then text$ = text$ + b1$
    text$ = text$ + f$(1,i3%)
    print fnc$(i% + 3,63); text$ 
next i%
print fnc$(19,64);"Angular Mode."
print fnc$(20,67);angle.flag$
return rem ** end of fill screen with fixed labels **

200 rem ***** get characters *****
print fnc$(8,37);
input f.no$
if ucase$(left$(f.no$,1)) <> "R" \
    then first.number = val(f.no$) \
    else i% = val(right$(f.no$,1)) : \
         first.number = calc.reg(i%)
print fnc$(18,37);"                       " :rem blanks to message line
print fnc$(11,37);
input op$
gosub 500 :rem test for function
print fnc$(14,37);
if function.flag$ = "OPERATOR"  \
    then input s.no$  \
    else s.no$ = "0.0"
if ucase$(left$(s.no$,1)) <> "R" \
    then second.number = val(s.no$) \
    else i% = val(right$(s.no$,1)) : \
         second.number = calc.reg(i%)
return :rem ** End of get characters **

300 rem ***** Select function *****
for i% = 1 To k%
   if ucase$(op$) = f$(1,i%) then select% = i%
next i%
if select% > 0 then \
    on select% gosub \
     600,   \    rem :   +
     700,   \    rem :   -
     800,   \    rem :   *
     900,   \    rem :   /
    1000,   \    rem :   CLR
    1100,   \    rem :   PI
    1200,   \    rem :   SQ
    1300,   \    rem :   RT
    1400,   \    rem :   CHS
    1500,   \    rem :   INT
    1600,   \    rem :   FR
    1700,   \    rem :   ABS
    1800,   \    rem :   %
    1900,   \    rem :   STO
    2000,   \    rem :   COMB
    2100,   \    rem :   REC
    2200,   \    rem :   PERM
    2300,   \    rem :   SIN
    2400,   \    rem :   COS
    2500,   \    rem :   TAN
    2600,   \    rem :   ASIN
    2700,   \    rem :   ACOS
    2800,   \    rem :   ATAN
    2900,   \    rem :   PWR
    3000,   \    rem :   LN
    3100,   \    rem :   EXP
    3200,   \    rem :   LOG
    3300,   \    rem :   ALOG
    3400,   \    rem :   DEG
    3500,   \    rem :   RAD
    3600,   \    rem :   #D
    3700,   \    rem :   #R
    3800,   \    rem :   CLR-R
    3900,   \    rem :   FACT
    4000,   \    rem :   D%
    4100    \    rem :   END
    else print fnc$(18,37);"ERROR ON OPERATOR !  "
select% = 0
return :rem ** End of select function **

400 rem ***** Write blanks to input areas *****
print fnc$(8,37);b1.line$
print fnc$(11,37);b1.line$
print fnc$(14,37);b1.line$
return :rem ** End of write blanks to input areas **

500 rem ***** Test for function *****
function.flag$ = "FUNCTION"
    if        op$  = "+" then function.flag$ = "OPERATOR" :return
    if        op$  = "-" then function.flag$ = "OPERATOR" :return
    if        op$  = "*" then function.flag$ = "OPERATOR" :return
    if        op$  = "/" then function.flag$ = "OPERATOR" :return
    if        op$  = "%" then function.flag$ = "OPERATOR" :return
    if ucase$(op$) = "PWR" then function.flag$ = "OPERATOR" :return
    if ucase$(op$) = "COMB" then function.flag$ = "OPERATOR" :return
    if ucase$(op$) = "PERM" then function.flag$ = "OPERATOR" :return
    if ucase$(op$) = "D%" then function.flag$ = "OPERATOR"
return :rem ** End of test for function **

600 rem : +
calc.reg(0) = first.number + second.number
gosub 7000 :rem display results
return

700 rem : -
calc.reg(0) = first.number - second.number
gosub 7000 :rem display results
return

800 rem : *
calc.reg(0) = first.number * second.number
gosub 7000 :rem display results
return

900 rem : /
calc.reg(0) = first.number / second.number
gosub 7000 :rem display results
return

1000 rem :clr
return

1100 rem :pi
calc.reg(0) = first.number * 3.141592654
gosub 7000 :rem display results
return

1200 rem :sq
calc.reg(0) = first.number * first.number
gosub 7000 :rem display results
return

1300 rem :rt
calc.reg(0) = sqr(first.number)
gosub 7000 :rem display results
return

1400 rem :chs
calc.reg(0) = 1 - first.number
gosub 7000 :rem display results
return

1500 rem :int
calc.reg(0) = int(first.number)
gosub 7000 :rem display results
return

1600 rem :fr
temp = int(first.number)
calc.reg(0) = first.number - temp
gosub 7000 :rem display results
return

1700 rem :abs
calc.reg(0) = abs(first.number)
gosub 7000 :rem display results
return

1800 rem :%
calc.reg(0) = first.number * second.number / 100
gosub 7000 :rem display results
return

1900 rem :sto
print fnc$(16,37);
input "Type in reg no : ";reg.no%
print fnc$(16,37);"                      " 
calc.reg(reg.no%) = first.number
display = calc.reg(reg.no%)
movecursor$ = fnc$(reg.no% + 3,6)
print movecursor$;
gosub 5000 :rem display
return

2000 rem :comb
nn% = int%(first.number)
rr% = int%(second.number)
pp% = nn% - rr%
result1 = 1.0
result2 = 1.0
if rr% > 25 then \
    print fnc$(18,37);"Second number too large." : \
    return
for i% = 1 to rr%
    result1 = result1 * nn%
    nn% = nn% - 1
next i%
if pp% > 42 then  \
    print fnc$(18,37);"Difference too large." : \
    return
for i% = 1 to rr%
    result2 = result2 * i%
next i%
calc.reg(0) = result1 / result2 
gosub 7000 :rem display result
return

2100 rem :rec
calc.reg(0) = 1 / first.number
gosub 7000 :rem display results
return

2200 rem :perm
nn% = int%(first.number)
rr% = int%(second.number)
if rr% > 25 then \
    print fnc$(18,37);"Second number too large." : \
    return
calc.reg(0) = 1.0
for i% = 1 to rr%
    calc.reg(0) = calc.reg(0) * nn%
    nn% = nn% - 1
next i%
gosub 7000 :rem display result
return

2300 rem :sin
gosub 8000 :rem test for degrees
calc.reg(0) = sin(no.of.radians)
gosub 7000 :rem display results
return

2400 rem :cos
gosub 8000 :rem test for degrees
calc.reg(0) = cos(no.of.radians)
gosub 7000 :rem display results
return

2500 rem :tan
gosub 8000 :rem test for degrees
calc.reg(0) = tan(no.of.radians)
gosub 7000 :rem display results
return

2600 rem :asin
temp = first.number / (sqr(1.0 - first.number * first.number))
temp = atn(temp)
if angle.flag$ = "DEGREES" \
    then calc.reg(0) = temp / 1.74532925E-2 \
    else calc.reg(0) = temp
gosub 7000 :rem display results
return

2700 rem :acos
pi = 3.141592654
temp = first.number / sqr(1.0 - first.number * first.number)
temp = pi / 2.0 - atn(temp)
if angle.flag$ = "DEGREES" \
    then calc.reg(0) = temp / 1.74532925E-2 \
    else calc.reg(0) = temp
gosub 7000 :rem display results
return

2800 rem :atan
temp = atn(first.number)
if angle.flag$ = "DEGREES" \
    then calc.reg(0) = temp / 1.74532925E-2 \
    else calc.reg(0) = temp
gosub 7000 :rem display results
return

2900 rem :pwr
calc.reg(0) = first.number ^ second.number
gosub 7000 :rem display results
return

3000 rem :ln
calc.reg(0) = log(first.number)
gosub 7000 :rem display results
return

3100 rem :exp
calc.reg(0) = exp(first.number)
gosub 7000 :rem display results
return

3200 rem :log
calc.reg(0) = log(first.number) / log(10)
gosub 7000 :rem display results
return

3300 rem :alog
calc.reg(0) = 10 ^ first.number
gosub 7000 :rem display results
return

3400 rem :deg
calc.reg(0) = first.number / 1.74532925E-2
gosub 7000 :rem display results
return

3500 rem :rad
calc.reg(0) = first.number * 1.74532925E-2
gosub 7000 :rem display results
return

3600 rem :#d
angle.flag$ = "DEGREES"
print fnc$(20,67);"         "
print fnc$(20,67);angle.flag$
return

3700 rem :#r
angle.flag$ = "RADIANS"
print fnc$(20,67);"         "
print fnc$(20,67);angle.flag$
return

3800 rem :clr-r
for reg.no% = 1 to 9
    calc.reg(reg.no%) = 0.0
    display = calc.reg(reg.no%)
    movecursor$ = fnc$(reg.no% + 3,6)
    print movecursor$;
    gosub 5000 :rem display
next reg.no%
return

3900 rem :fact
if first.number > 49 then \
    print fnc$(18,38);"Number too large." : \
    return
calc.reg(0) = 1.0
for i% = 1 to int%(first.number)
  calc.reg(0) = calc.reg(0) * i%
next i%
gosub 7000 :rem display results
return

4000 rem :d%
temp = first.number - second.number
calc.reg(0) = temp / second.number * 100
gosub 7000 :rem display results
return

4100 rem :end
continue.flag$ = "STOP"
return

5000 rem ***** Form display picture *****
print b2.line$ 
print movecursor$;
if display = 0 then \
    print using pic2$;blk$,display : \
    return
if abs(display) > 99999999999  or abs(display) < 1.0E-2 \
    then print using pic0$; blk$,display :  \
    return
dd$ = str$(display)
p% = match(".",dd$,1)
if p% = 0 then \
    print using pic2$;blk$,display : \
    return
print using pic1$;blk$,display
return :rem ** End of form display picture **

7000 rem ***** Display results *****
movecursor$ = fnc$(16,6)
print movecursor$;
display = calc.reg(0)
gosub 5000 :rem display
movecursor$ = fnc$(20,6)
print movecursor$;
display = first.number
gosub 5000 :rem display
movecursor$ = fnc$(22,6)
print movecursor$;
display = second.number
gosub 5000 :rem display
print fnc$(18,16);"       "
print fnc$(18,16);op$ 
return :rem ** End of display results **

8000 rem ***** test for degrees *****
if angle.flag$ = "DEGREES"  \
   then no.of.radians = first.number * 1.74532925E-2  \
   else no.of.radians = first.number
return :rem ** End of test for degrees **
zer
42.21	1K	START.COM	COM of above
42.22	2K	T.ASM		(3) Print time on..
42.23	1K	T.COM		    ..console
42.24	3K	TIME.ASM	(3) ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1$3.141592654$1.0$1.74532925E-2$2.0$0.0$99999999999$1.0E-2$* @< Ќ  ~ ~~  ~~~~~~~~~~   ~А $d46 АААRААR3 +,-,*,/,CLR,PI,SQ,RT,CHS,INT,FR,ABS,%,STO,COMB, 3 REC,PERM,SIN,COS,TAN,ASIN,ACOS,ATAN,PWR,LN,EXP, 3 LOG,ALOG,DEG,RAD,#D,#R,CLR-R,FACT,D%,END, ЂDEGREES Ђ                        ЂА       Ђ  Ђ/...5/#.###########^^- Ђ//##,###,###,###.###########- Ђ//##,###,###,###- ЂЂ
Ђ ЂCONTINUE Ђ Ђ А!END 7 ЮЂ!<Ђ А Ђ6 ГЂ"ЂА ЂЂ /Ђ#Ђ6А Ђ#А#
7ЂА#А"Ђ!<6 х9АCONTINUE 70…oN6PCALC yА $d4Ђ$________________________ Ђ%А$____________ ЂЂЂЂ $А%$d4ЂЂЂЂ $А%$d4ЂЂЂЂ% $А$$d4ЂЂЂЂ% $А$$d4Ђ#Ђ6РЂЂ#А#
7ыЂА#ЂЂ$ $: $d4ЂА#ЂЂ= $: $d46ГЂЂЂЂ $REG $d4ЂЂЂЂ $NO $d4Ђ#Ђ6;ЂЂ#А#
7^Ђ&А#ЂЂА#ЂЂ $А&p#: $d46.ЂЂЂЂ( $CBASIC2 CALCULATOR. $d4ЂЂЂЂ' $********************* $d4ЂЂЂЂ $RESULT. $d4ЂЂЂЂ $From Function : $d4ЂЂЂЂ $First Number. $d4ЂЂЂЂ $Second Number. $d4ЂЂЂЂ+ $INPUT AREA. $d4ЂЂЂЂ& $First Number or R. $d4ЂЂ
ЂЂ& $     Operator. $d4ЂЂЂЂ& $Second Number or R. $d4ЂЂЂЂ' $SYSTEM MESSAGE LINE. $d4ЂЂЂЂ' $NB R is the result if $d4ЂЂЂЂ' $just R but register if $d4ЂЂЂЂ' $followed by register $d4ЂЂЂЂ' $number. $d4ЂЂЂЂB $FUNCTIONS. $d4Ђ'  Ђ(   Ђ)    Ђ*     Ђ#Ђ6јЂЂ#А#
7QЂ+А#ЂЂ,А#ЂЂА#А"Ђ!TЂ7гЂ-А*ЂА#А"Ђ!TЂ7ъЂ-А)ЂА#А"Ђ!TЂ7Ђ-А(ЂА#А"Ђ!TЂ7(Ђ-А'Ђ-А-ЂА#А"Ђ!Ђ-А-А'ЂА+А"Ђ!TЂ7ZЂ-А-А*ЂА+А"Ђ!TЂ7tЂ-А-А)ЂА+А"Ђ!TЂ7ЋЂ-А-А(ЂА+А"Ђ!TЂ7ЁЂ-А-А'Ђ-А-ЂА+А"Ђ!Ђ-А-А'ЂА,А"Ђ!TЂ7ЪЂ-А-А*ЂА,А"Ђ!TЂ7фЂ-А-А)ЂА,А"Ђ!TЂ7Ђ-А-А(ЂА,А"Ђ!TЂ7(Ђ-А-А'Ђ-А-ЂА,А"Ђ!ЂА#ЂЂЂ? $А-$d46ЇЂЂЂЂ@ $Angular Mode. $d4ЂЂЂЂC $А$d4ЂЂЂЂ% $dЂ n;Ђ.1'А.ЂSsR 7ґЂ/А.X6ЙЂ#А.ЂVX:Ђ/А#АЂ!ЂЂЂЂ% $                        $d4ЂЂЂЂ% $dЂ n;Ђ01'€ЂЂЂЂ% $dА1OPERATOR 7:Ђ n;Ђ21'6BЂ20.0 А2ЂSsR 7YЂ3А2X6nЂ#А2ЂVX:Ђ3А#АЂ!Ђ#Ђ6„А Ђ#А#
7ћА0sЂА#А"Ђ!7›Ђ4А#6wА4Ђ 7 А4bЂ$^96	z6	‹6	њ6	­6	ѕ6	ї6	С6	в6	с6
6
6
+6
:6
O6
Т6ґ6И6L6^6p6‚6З66N6_6n6}6‘6Ґ6·6Й66A6Љ6х66HЂЂЂЂ% $ERROR ON OPERATOR !   $d4Ђ4Ђ ЂЂЂЂ% $А$d4ЂЂЂЂ% $А$d4ЂЂЂЂ% $А$d4Ђ1FUNCTION А0+ 7­Ђ1OPERATOR А0- 7ЕЂ1OPERATOR А0* 7ЭЂ1OPERATOR А0/ 7хЂ1OPERATOR А0% 7	Ђ1OPERATOR А0sPWR 7	(Ђ1OPERATOR А0sCOMB 7	DЂ1OPERATOR А0sPERM 7	`Ђ1OPERATOR А0sD% 7	yЂ1OPERATOR Ђ АЂ!А/А3 ‘Ђ АЂ!А/А3‘Ђ АЂ!А/А3‘Ђ АЂ!А/А3‘Ђ АЂ!А/. ‘Ђ АЂ!А/А/‘Ђ АЂ!А/I‘Ђ АЂ!ЂА/p‘Ђ АЂ!А/B‘Ђ5А/BЂ АЂ!А/А5‘Ђ АЂ!А/A‘Ђ АЂ!А/А3Ђdp‘ЂЂЂЂ% $dType in reg no :  n;Ђ6":'ЂЂЂЂ% $                       $d4А6АЂ!А/Ђ7А6АЂ!Ђ8ЂА6ЂЂЂ А8$dЂ9А/rЂ:А3rЂ;А9А:Ђ<. Ђ=. А:Ђ7'ЂЂЂЂ% $Second number too large. $d4Ђ#Ђ6<А:Ђ#А#
7PЂ<А<А9pЂ9А9Ђ6/А;Ђ*7‚ЂЂЂЂ% $Difference too large. $d4Ђ#Ђ6—А:Ђ#А#
7ЈЂ=А=А#p6ЉЂ АЂ!А<А=‘Ђ АЂ!ЂА/p‘Ђ9А/rЂ:А3rА:Ђ7	ЂЂЂЂ% $Second number too large. $d4Ђ АЂ!. Ђ#Ђ6)А:Ђ#А#
7HЂ АЂ!Ђ АЂ!А9pЂ9А9Ђ6‘Ђ АЂ!А>E‘Ђ АЂ!А>F‘Ђ АЂ!А>H‘Ђ5А/. А/А/IЂ5А5GАDEGREES 7№Ђ АЂ!А5. 6ГЂ АЂ!А5‘Ђ?. Ђ5А/. А/А/IЂ5А?. А5GАDEGREES 7Ђ АЂ!А5. 6Ђ АЂ!А5‘Ђ5А/GАDEGREES 7@Ђ АЂ!А5. 6JЂ АЂ!А5‘Ђ АЂ!А/А3‘Ђ АЂ!А/N‘Ђ АЂ!А/K‘Ђ АЂ!А/NЂ
pN‘Ђ АЂ!Ђ
А/p‘Ђ АЂ!А/. ‘Ђ АЂ!А/. ‘ЂDEGREES ЂЂЂЂC $          $d4ЂЂЂЂC $А$d4ЂRADIANS ЂЂЂЂC $          $d4ЂЂЂЂC $А$d4Ђ6Ђ6VЂ	Ђ6А6
7‰А6АЂ!. Ђ7А6АЂ!Ђ8ЂА6ЂЂЂ А8$d6IА/Ђ1p7№ЂЂЂЂ& $Number too large. $d4Ђ АЂ!. Ђ#Ђ6ЪА/rЂ#А#
7сЂ АЂ!Ђ АЂ!А#p6М‘Ђ5А/А3Ђ АЂ!А5А3Ђdp‘ЂSTOP А$d4А8$dА7Ђ p7<АcА$5А7#d4А7A. А7A. 7]АcА$5А7#d4Ђ@А7WЂA. А@Ђ\АAЂ 7„АcА$5А7#d4АcА$5А7#d4Ђ8ЂЂЂЂ А8$dЂ7Ђ АЂ!Ђ8ЂЂЂЂ А8$dЂ7А/Ђ8ЂЂЂЂ А8$dЂ7А3ЂЂЂЂ $        $d4ЂЂЂЂ $А0$d4АDEGREES 75Ђ>А/. 6:Ђ>А/Ђ JЂ АЂ!А5‘Ђ АЂ!А/А3‘Ђ АЂ!А/N‘Ђ АЂ!А/K‘Ђ АЂ!А/яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее




















                         Programmable Calculator Simulation.
                        *************************************



                                    System Notes.
                                   ---------------






                    Copyright (c) Electronic Accounting Services 1981.  

                    All rights reserved.  






                                     Disclaimer of liability.

                          In no event can Electronic  Accounting  Services  be
                    held liable for consequential losses or damages.  






















                              Programmable Calculator Simulation.



                                            Contents.
                                           ***********












        No                         Title                           Page No.
        
         1 : Introduction  ------------------------------------------  2
        
         2 : System Initialisation  ---------------------------------  4
        
         3 : Program Editor  ----------------------------------------  5
        
         4 : Data File Editor  --------------------------------------  7
        
         5 : Language Specification  --------------------------------  8
        
         6 : Compiler Program  -------------------------------------- 12
        
         7 : Runtime System  ---------------------------------------- 13




















                    NB : Note throughout these notes :- 

                        1)  @ = Carriage Return.  

                        2)  # = ASCII (23H) more normally seen as 


                                           1





                              Programmable Calculator Simulation.


                                        1 : Introduction.
                                       *******************


              The    simulation  takes  the  form  of  a  series  of  programs
        specifically tailored to  write,develop,test  and  run  programs,in  a
        manner similar to a programmable calculator.This has been done so that
        programs  can  be  written  simply  and  quickly  to achieve transient
        objectives where it would seem uneconomic to use  a  more  traditional
        programming language.  

              The programs have been written with a bias towards the needs  of
        the  business  or financial user.Calculations are therefore not geared
        for speed,but for high precision in  a  fixed  point  mode  (with  the
        number  of  decimal  places selected by the user).For the same reasons
        all output is aligned on the decimal point,with commas inserted in the
        appropriate places.  

              The  simulation  cannot  handle  text  or  strings  but  like  a
        calculator  deals  with  registers  (r1  to  r40) and not variables.To
        increase clarity each register may be named so that whenever  data  is
        output,or  input  is  requested  the  associated  name  will  be  used
        automatically by the runtime system ie.   If  R1  is  named  as  GROSS
        PAY,`INPUT  R1'  would  produce  the  prompt  `INPUT  GROSS  PAY  : ',
        similarly if R1 has a value  of  12563.72  `PRINT  R1'  would  produce
        `GROSS PAY        12,563.72'.  

              The instructions accepted by the simulation are drawn from  many
        of  the  major  languages  and are essentially block structured.  Goto
        statements are strictly limited to jumps within a  block,  jumping  to
        labels  and  not  line  numbers.No  line  numbers  are used except for
        reference in the editor and error reports.  

              The main blocks are :- 

                1 : DO                                        LOOP 

                2 : WHILE                                     WEND 

                3 : IF                  ELSE                  FEND 

                4 : SELECT     rX       MAX        X          TIMES          X

              All subroutines are called by name to aid readability and may be
        called recursively,allowing up to 20 levels of static nesting  and  50
        levels of dynamic nesting.  

              The programs supplied are :- 

            1 : CALC.INT :A calculator program displaying data and results  on
                a single screen.  

            2 : EDITOR.INT :An editor program used to  write  programs  to  be
                used by the simulation.  



                                           2





                              Programmable Calculator Simulation.


            3 : EDITOR1.INT :An editor program used to  construct  data  files
                which  will be used by the  program constructed by (2) and the
                simulation.  

            4 : COMPILE.INT :A compiler which reads in a  program  constructed
                by  (2)  and  generates  an  object  program usable by (5).Any
                errors detected in the first pass generates a  screen  showing
                the  offending  line plus the 9 lines which preceed it and the
                10 which follow.The opportunity is then given for the user  to
                insert  a line,alter the offending line, delete that line,skip
                the line and continue or abort the compilation.    The  second
                pass detects context dependant errors and flags the errors for
                later amendment.  

            5 : RUNOBJ.INT :A runtime  module  which  will  establish  whether
                program  output  is  to be echoed to the printer,a disc output
                file or a disc input file,or any combination  and  if  a  disc
                file is to be used for data input.The runtime module will then
                as the name suggests run the object program.  

            6 :    PROG.INT  :  The  programmable  calculator  control  module
                supplying the main menu where 2 to 5  above  are  selected  as
                required.  

            7 : INIT.INT : A  module  which  is  automatically  selected  when
                required  to  initialise  the  system  variables common to all
                modules of the programmable calculator.  

            8 : PCALC.INT :The program which controls all modules and  is  the
                only one called from operating system level ie.CRUN2 PCALC@.  

              There follows a more detailed outline of each  of  the  programs
        and the associated language.  
























                                           3





                              Programmable Calculator Simulation.



                              2 : System Initialisation.
                             ****************************



              The programme suite uses 3 variables which are system  dependant
        and  will  therefore  need  to  be  set  to your own values before the
        programmes are run.The variables are all set in the first 20 lines  of
        'PCALC.BAS'  which is included on the disc (with all other source code
        in the corresponding '.BAS' files also on the disc).The  variables  in
        question are :- 

            1 : CLEAR$ :Which holds the character  or  characters  which  when
                printed will clear the screen.  

            2 : CURSOR$ :Which holds the character or  characters  which  when
                printed with the row and column number following will move the
                cursor to the appropriate location.  

            3 : C.OFFSET% :Which holds the offset used by your  system  to  be
                added  to  the row and column number when moving the cursor.If
                your system does not use an offset,set C.OFFSET% = 0.  

              The program assumes a 80 column display on the terminal if there
        is less than this the program will not run in a comprehensible way.  

              The program 'PCALC.BAS' when alterred as above will then need to
        be re-compiled ie. CBAS2 PCALC $B@.  

              The programme can then be run by typing  CRUN2  PCALC  and  when
        loaded all further programmes are called by menu selection.  

























                                           4





                              Programmable Calculator Simulation.



                                 3 : Program Editor.
                                *********************



              The editor is constructed as three levels each utilising  single
        letter  commands  to  carry  out a specific function or enter the next
        level.At level 1 the outer level the command  character  is  typed  in
        after  the program prompt of # (ASCII 23H).  Wherever possible once an
        option is selected the editor reverts  to  an  interactive  format  to
        actually  carry out the designated task.In this way for example when S
        is    selected    the  filename  format  is  displayed  and  the  name
        requested.Once any function is completed the program prompt returns.  

              The commands are listed below giving firstly  the  level  number
        ie.1  to  3  where  level 2 and 3 can only be used after command T has
        been called from level 1 and level  1  can  only  be  used  after  the
        program  prompt.This  is  followed by the command letter, then a brief
        description and in parentheses any information provided by the program
        at that point and information requested.  Then in square brackets  the
        actual input required using the following conventions :- 
           1 : all command letters are in capitals.  
           2 : f = the first line number of a block (or perhaps only).  
           3 : s = the first line number of the second block.  
           4 : x = the size of the block in lines.  
        The above  conventions  only  relate  to  the  way  the  commands  are
        described  below  in  practice any combination of upper and lower case
        may be used except in search and replace strings.  

            1 : S : Save buffer in disc file (form of disc file  name  allowed
              and requests the filename) [S] 

            1 : L : Load buffer from disc file (form of disc file name allowed
              plus size of file loaded in lines  and  requests  the  filename)
              [L].  

            1 : P : Print buffer or part of buffer  on  list  device  with  or
              without  pagination  (size  of buffer in lines and then requests
              the option.If only part of the buffer is selected,the first  and
              last line number of the selected section is requested) [P].  

            1 : C :Clear buffer so that a new file may be created[C].  

            1 : I :Insert text (the current size of the buffer  in  lines  and
              request  the  line  number where text is to be inserted) until #
              (ASCII 23H) is typed as the only character on a line [I].  

            1 : T :Type 40 lines of program  on  a  single  screen  and  enter
              second level where editing is carried out on the displayed lines
              by updating the buffer in place,so that the display always shows
              the  current contents of the buffer (size of buffer and requests
              the line number where the display should start)[T].  

            2 : I :Insert line [fI] 


                                           5





                              Programmable Calculator Simulation.



            2 : R :Replace line (the old line is displayed at  the  bottom  of
              the screen and the replacement requested) [fR].  

            2 : D :Delete line [fD].  

            2 : S :Swap lines [fSs].  

            2 : P :Display next page of 40 lines [P] 

            2 : -P :Display previous page of 40 lines [-P].  

            2 : T :type 40 lines from line number [fT].  

            2 : C :Close up deleted lines.This is used because when lines  are
              deleted  they are saved as blanks for insertions etc.If there is
              not going to be an insertion then close up blanks [C].  

            3 : BC :Copy a block from  one  part  of  the  buffer  to  another
              [fBCx:s]  NB  : Note use of colon to seperate size of block from
              start of second block.  

            3 : BI :Insert a block [fBIx].  

            3 : BR :Replace a block [fBRx].  

            3 : BM :Move a block [fBMx:s].  

            3 : BD :Delete a block which automatically closes up text  [fBDx].

            2 : $ :Search and replace line(s) either [f$find$replace with]  or
              [f:s$find$replace  with]  where  find and replace with represent
              the appropriate strings.  

            1 : $ :as level 2 $ but  will  also  accept  [$find$replace  with]
              which searches the whole buffer.  

            2 : E :Exit to level 1 [E].  

            1 : E :Exit from program [E].  

















                                           6





                              Programmable Calculator Simulation.



                                4 : Data File Editor.
                               ***********************





              The editor for data input files is constructed to handle numeric
        as opposed to string data,but in all other aspects is identical to the
        program editor.  

              I do not therefore propose to repeat the commands here but refer
        the reader to section (3).The only command which is available  in  the
        program editor but is not available in the data file editor is [$] the
        string search facility.  









































                                           7





                              Programmable Calculator Simulation.



                             5 : Language Specification.
                            *****************************



              The language described below  is  a  subset  of  many  languages
        dealing with only numeric data in as simple way as possible.  

              The instructions and the way they are used is listed below.There
        are also two programs on disc which  should  give  a  better  idea  of
        program structure,use the editor to inspect them.The examples are :- 

            1) `SAL.SRC' :A routine to  generate  a  payslip  for  a  salaried
            employee.  

            2) `BM.SRC'      :A  routinte  to  run  an  approximation  to  PCW
            benchmarks.  



            INPUT / OUTPUT.  
                READ r1...... ,INPUT r1.......... ,PRINT r1...........  

                  I/O from  a  series  of  registers  specified  on  the  line
                    seperated  by  spaces.Both  INPUT  and  PRINT will use the
                    names associated with particular registers if specified.  

                1 : READ : Reads into registers from a data file.  

                2 :    INPUT  :  Accepts  input  from  the  keyboard  to  each
                    register.Each register is requested seperately  ie.  INPUT
                    name  .and  each  item  input  is  followed  by a carriage
                    return.  

                3 : PRINT : Outputs the contents of registers to the  terminal
                    after  printing  a blank line.Each register is output on a
                    seperate   line  and  all  the  values  are  automatically
                    formatted.If previously selected the output will be echoed
                    to the list device,a disc output file,a disc input file or
                    any combination.  

            PROGRAM BLOCKS.  

               1 : DO rx 


                   LOOP :Will exicute whatever lines appear between DO &  LOOP
                    register x number of times.  

               2 : WHILE r1 LT r2 


                   WEND :Will exicute whatever lines appear  between  WHILE  &
                    WEND  continuously  so  long  as  the expression following


                                           8





                              Programmable Calculator Simulation.


                    WHILE remains true.The relationships which may  be  tested
                    are :- 
                        LT : Less than 
                        GT : Greater than 
                        EQU : Equal to 
                        NEQ : Not equal to 
                        LTE : Less than or equal to 
                        GTE : Greater than or equal to 

                    Tests  may  be  applied  against  registers  or  constants
                    ie.WHILE R1 LT R2 or WHILE R12 GTE 128.  

               3 : IF r1 LT r2 


                   ELSE 


                   FEND :Will exicute the lines  between  IF  &  ELSE  if  the
                    expression  is  true  or  the lines between ELSE & FEND if
                    false.If there is no ELSE then control is  passed  to  the
                    statement after FEND if false.The relationships tested are
                    the same as those used in while - wend.  

               4 : SELECT r1 MAX 12 TIMES 3 :This is a many way  switch  which
                    will  exicute  a  number  of  lines  specified  by   times
                    (defaults  to  1 if TIMES is not present) according to the
                    value of  the  specified  register.    Range  checking  is
                    applied  automatically  against  the  contents   of    the
                    specified  register  at  runtime  according  to  the value
                    specified by MAX.  NB:lines which are not required  except
                    to maintain the necessary symmetry of the select block can
                    be comment lines ie.a line with just `;'.None of the three
                    other types of block may appear in a SELECT block.  

            CONTROL.  

                STOP : The last statement of the main program and must  appear
                    before any subroutines.  

                EXIT : Exit from program which may appear any number of  times
                    at any part of the program.  

            SUBROUTINES.  

                CALL NAME : Calls subroutine by name.  

                SUB NAME :  Labels the first line of a subroutine.  

                RETURN : Last statement of a subroutine which returns  control
                    to  the  main  program.NB  Only  one  RETURN statement may
                    appear in a subroutine.  

            TRANSFER OF CONTROL.  



                                           9





                              Programmable Calculator Simulation.


                1 : GOTO labelno : Jumps to specified label ie. GOTO 2 

                2 : LABEL x : Labels the destination line of a  jump.ie  LABEL
                    2.    NB:The  label  must  appear in the same block as the
                    goto,but this does not mean  that  label  numbers  may  be
                    repeated in other blocks.  

            OTHER INSTRUCTIONS.  

                NAME r1 name : Names specified register ie.NAME r6 GROSS  PAY.
                    NB  :  The  whole name string will be reproduced including
                    spaces.  

                FIX 2 : Sets the maximum number of decimal  places  between  0
                    and  9  (this example sets registers to 2 decimal places).
                    If   not  specified  the  default  setting  is  3  decimal
                    places.FIX may be used anywhere in the program any  number
                    of  times.It  will have the effect of setting all register
                    values to the set number of decimal places until a new FIX
                    is executed which will change the number of places in  all
                    registers.  

                ; : Labels a line as a comment line which will  therefore  not
                    be exicuted.  

                INC r1 : Increments the specified register by 1.  

                DEC r1 : Decrements the specified register by 1.  

            Expressions.  

                All expressions are expressed algebraically  using  registers,
                    constants and pi.  
                    ie. r6 = 6 + 7 / pi * r2.  
                    Conventional           hierarchy        is        observed
                    ie.brackets,functions,powers,   multiply  &  devide,add  &
                    subtract.The functions operands  do  not  need  to  be  in
                    brackets ie. r2 = sin 3 




                    The operators and functions are listed on the next page :-














                                          10





                              Programmable Calculator Simulation.








                        1 : +        : Plus
                        2 : -        : Minus
                        3 : *        : Multiply
                        4 : /        : Divide
                        5 : ^        : Power (root = ^ (1 / 2) or ^ 0.5 etc.)
                        6 : SIN      : Sin of number in radians
                        7 : COS      : Cosine of number in radians
                        8 : TAN      : Tangent of number in radians
                        9 : ASIN     : Arc sine of number
                       10 : ACOS     : Arc cosine of number
                       11 : ATAN     : Arc tangent of number
                       12 : LOG      : Log to base 10 of number
                       13 : ALOG     : Anti-log to base 10 of number
                       14 : LN       : Naperian logarithm base e
                       15 : EXP      : e to power of number
                       16 : SQ       : Square of number
                       17 : RT       : Square root of number
                       18 : RAD      : Convert number from degrees to radians
                       19 : DEG      : Convert number from radians to degrees
                       20 : ABS      : Absolute value of number
                       21 : FACT     : Factorial of number






























                                          11





                              Programmable Calculator Simulation.



                                6 : Compiler Program.
                               ***********************


              The compiler is called by selecting option 7 from the  menu  and
        will compile the source program already in memory.  

              In the first pass the program compiles each  line  into  a  form
        more  acceptable  to  a  machine  and checking for context independant
        errors.If any  errors  are  found  the  program  gives  the  user  the
        opportunity  to alter the source program whilst still in the compiler.

              Before requesting the replacement line the program  displays  20
        lines  from  the  source  program.The  lines displayed are the 9 lines
        which preceed the erroneous line,the line  itself  and  the  10  lines
        which  follow  it.If the user does not wish to replace the line he can
        call on any one of the following options instead :- 

            1 : INS : Insert a line before the incorrect line.ie. If no `STOP'
                    has been found when a subroutine is reached `STOP' may  be
                    inserted if there are no other errors.  

            2 : DEL : Delete incorrect line.  

            3 : SKIP : Skip incorrect line and  continue  compilation.If  this
                    option is selected it wil be impossible to save the object
                    file when compilation is complete.  

            4 : ABORT : Stop compilation 


              While the  program  is  compiling  the  lines  it  displays  the
        partially  compiled  lines  on  the  console.This is done for no other
        reason than to show how much of the program has been compiled.  

              Once the first pass is completed  the  second  pass  will  start
        which  is primarily looking for context dependant errors but will also
        produce the final object program.Any errors  detected  at  this  stage
        will  not  correspond  to  any particular line and will therefore just
        produce a series of reports for subsequant alteration in the editor.  

              When the second pass is completed a request is made for any  key
        to  be  pressed  before the program continues.This is done so that the
        user will have time to note down  any  error  messages  before  a  new
        display appears.  

              The opportunity will then be given to save the source and object
        files on disc,depending on the errors found.  








                                          12





                              Programmable Calculator Simulation.



                                 7 : Runtime System.
                                *********************



              The runtime system is loaded by selecting option 8 of  the  menu
        and  will  run the object file plus any data file which are already in
        memory.  

              The program will echo output to printer and/or disc  (input  and
        output files) according to selections already made from the menu.  

              NB a disc input file will contain just the bare unformatted data
        so that it can be used as an input file in  another  run  of  this  or
        another  file.Whereas  a disc output file will contain fully formatted
        output including associated register names.  

              If data input files are being used for data input or output  and
        they  reach  the  end  whilst  running  the runtime system will ask if
        another file should be opened.In this  way  although  data  files  are
        limited to 400 lines they can be interactively chained together.A file
        which  was  produced during the run as an output file may also be used
        later in the run as an input  file  if  necessary  (providing  it  was
        echoed in input form).
































                                          13


 more  traditional
   БЕХЕН БЕ Н БбЂ еЕлН БВЌбБxю К4 Н Ђ! 6#6 #ВГ Н \ Н  Н  Г                            BJ		Object of SAL.SRC
03.26	2K	SAL.SRC		Routine to generate payslips
 ':TR:'	;TELETYPE READER
	DB ':O1:'	;USER CO
	DB ':I1:'	;USER CI
	DB ':VO:'	;CRT O/P
	DB ':VI:'	;CRT I/P
	DB ':TO:'	;TELETYееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееcommon clear$,cursor$,c.offset%
common tot.inst%,length%,data.no(1),object$(1)
common instruction$(1),register(1)
common print.flag$,res.flag$,dat.flag$
common comp.flag$,f1$,f2$,f3$
common f4$,f5$
common end.data,delete.data,blank.data
rem :******************************************************************
rem :
rem :  Copyright (c) 1981 by Electronic Accounting Services.
rem :
rem :******************************************************************
def fnc$(r%,c%) = cursor$ + chr$(r% + c.offset%) + chr$(c% + c.offset%)
rem *********************************************************
rem : Compiler to take a source program previously read in,
rem : in an algebraic form and compile it into an internal
rem : form using reverse polish notation.This is done by
rem : using the technique of operator-precidence tables.
rem : The results forming an object file which is then
rem : written to disc.
rem : This program requires the use of a terminal with
rem : clear screen and an addressable curser.
rem ********************************************************
stop.flag$ = "NO STOP"
reg.range% = 40
if.flag% =0
while.flag% = 0
do.flag% = 0
sub.flag% = 0
blk$ = " "
top1% = 42
comp.flag$ = "ERROR"
nest.level% = 0
dim nest%(20)
dim reg$(202)
reg$(top1%) = "END2"
top.stack% = 1
dim stack$((length% + 1))
dim stack%((length% + 1))
rem : Write zeroes and blanks to register and object arrays.
for i% = 1 to 200
    object$(i%) = " "
    register(i%) = 0
next i%
for i% = 201 to 400
    object$(i%) = " "
next i%
object$(1) = "END1"
rem : First level selection labels (25 seperate labels).
DATA :,NAME,CALL,SUB,LABEL,DO,LOOP,READ,INPUT,PRINT,=,IF
DATA RETURN,WHILE,WEND,STOP,GOTO,ELSE,FEND,SELECT,FIX,EXIT,INC,DEC,END
dim label$(26)
for i% = 1 to 25
    read label$(i%)
next i%
rem : Operator precidence table for parsing expressions.
DATA =,0,256,(,1,-(-,),2,-)-,+,3,252,-,3,253,*,4,254,/,4,255,^,5,251
DATA ASIN,6,260,SIN,6,257,ACOS,6,261,COS,6,258
DATA ATAN,6,262,TAN,6,259,ALOG,6,264,LOG,6,263,EXP,6,266,LN,6,265
DATA SQ,6,267,RT,6,268,DEG,6,271,RAD,6,272,FACT,6,269,ABS,6,270
dim op$(25),op%(25),ob.op$(25)
for i% = 1 to 24
    read op$(i%)
    read op%(i%)
    read ob.op$(i%)
next i%
error.flag$ = "NO ERRORS"
perm.error.flag$ = "NO ERRORS"
print clear$
line.no% = 1
while instruction$(line.no%) <> "END"
    object.no% = object.no% + 1
    label.flag$ = "NOT FOUND"
    label.no% = 1
    instr$ = ucase$(instruction$(line.no%)) 
    p% = match("!",instr$,1)
    if p% = 0 then \
        label.flag$ = "BLANK LINE" : \
        obj$ = " "
    while (label.flag$ = "NOT FOUND") and (label.no% <> 26)
        if match(label$(label.no%),instr$,1) > 0 then \
            gosub 100 : \ rem select label
            label.flag$ = "FOUND"
        label.no% = label.no% + 1
    wend
    if label.flag$ = "NOT FOUND" then \
        message$ = "Syntax error,unable to trace instruction:" : \
        gosub 10000 :rem display error
    print using "&###&&";"Line no. ";line.no%;" :";obj$
    line.no% = line.no% + 1
wend
print :print :print
print "LINE BY LINE COMPILATION COMPLETE."
print :print
print "TESTING FOR CONTEXT DEPENDANT ERRORS."
if if.flag% > 0 then \
    print "There are ";if.flag%; : \
    print " unmatched if statements." : \
    print : \
    perm.error.flag$ = "ERROR"
if if.flag% < 0 then \
    print "There are ";abs(if.flag%); : \
    print " unmatched ifend statements." : \
    print : \
    perm.error.flag$ = "ERROR"
if while.flag% > 0 then \
    print "There are ";while.flag%; : \
    print " unmatched while statements." : \
    print : \
    perm.error.flag$ = "ERROR"
if while.flag% < 0 then \
    print "There are ";abs(while.flag%); : \
    print " unmatched wend statements." : \
    print : \
    perm.error.flag$ = "ERROR"
if do.flag% > 0 then \
    print "There are ";do.flag%; : \
    print " unmatched do statements." : \
    print : \
    perm.error.flag$ = "ERROR"
if do.flag% < 0 then \
    print "There are ";abs(do.flag%); : \
    print " unmatched loop statements." : \
    print : \
    perm.error.flag$ = "ERROR"
gosub 15000 :rem pre-run module checks
print
print "Type any character to continue : ";
dummy% = conchar%
print clear$
gosub 11000 :rem save files
if perm.error.flag$ <> "ERROR" then \
    comp.flag$ = "NO ERROR"
chain "PROG"
stop

100 rem ***** Select label *****
if ucase$(instruction$(line.no%)) = "END" then \
    return
object$(object.no% + 1) = "END1"
t% = len(instr$)
on label.no% gosub \
    150 , \  : : [comment]
    200 , \  : NAME
    300 , \  : CALL
    400 , \  : SUB
    500 , \  : LABEL
    600 , \  : DO
    700 , \  : LOOP
    800 , \  : READ
    900 , \  : INPUT
   1000 , \  : PRINT
   1100 , \  : =
   1200 , \  : IF
   1300 , \  : RETURN
   1400 , \  : WHILE
   1500 , \  : WEND
   1600 , \  : STOP
   1700 , \  : GOTO
   1800 , \  : ELSE
   1900 , \  : FEND
   2000 , \  : SELECT
   2100 , \  : FIX
   2200 , \  : EXIT
   2400 , \  : INC
   2500 :rem : DEC
object$(object.no%) = obj$ 
return :rem ** End of select function **

150 rem ***** : [comment] *****
obj$ = "023:"
return :rem ** End of : [comment] **

200 rem ***** Name register *****
p% = match("R",instr$,1)
o% = match("#",instr$,1)
if p% <> (o% - 1) then \
    message$ = "No valid register number:" : \
    gosub 10000 : \ rem display error
    return
put% = int%(val(right$(instr$,(t% - o% + 1))))
if put% = 0 or put% > 40 then \
    message$ = "No valid register number :" : \
    gosub 10000 : \ rem display error
    return
p% = match("!",instr$,o%)
f$ = right$(instruction$(line.no%),(t% - p% + 1))
f$ = left$(f$,20)
rem :NB f$ includes lower case labels.
obj$ = "002:"
gosub 11500 :rem place number
obj$ = obj$ + f$
return :rem ** End of name register **

300 rem ***** Call subroutine *****
obj$ = "003:"
p% = match("CALL",instr$,1)
f$ = right$(instr$,(t% - p% - 3))
t% = len(f$)
p% = match("!",f$,1)
f$ = right$(f$,(t% - p% + 1))
obj$ = obj$ + left$(f$,20)
return :rem ** End of call subroutine **

400 rem ***** Sub ( subroutine label ) *****
if stop.flag$ = "NO STOP" then \
    message$ = "NO 'STOP' instruction found before subroutines." : \
    gosub 10000 : \ rem display error
    return
if sub.flag% <> 0 then \
    message$ = "Previouse subroutine not ended:" : \
    gosub 10000 : \ rem error display
    return
sub.flag% = 1
obj$ = "004:"
p% = match("SUB",instr$,1)
f$ = right$(instr$,(t% - p% - 2))
t% = len(f$)
p% = match("!",f$,1)
f$ = right$(f$,(t% - p% + 1))
obj$ = obj$ + left$(f$,20)
return :rem ** End of sub ( subroutine label ) **

500 rem ***** Label *****
p% = match("#",instr$,1)
put% = int%(val(right$(instr$,(t% - p% + 1))))
if put% = 0 then \
    message$ = "Label number missing :" : \
    gosub 10000 : \ rem display error
    return
obj$ = "005:"
gosub 11500 :rem place number
return :rem ** End of label **

600 rem ***** Do ******
obj$ = "006:"
p% = match("R",instr$,1)
o% = match("#",instr$,1)
if p% = 0 and o% = 0 then \
    message$ = "Instruction incomplete :" : \
    gosub 10000 : \ rem display error
    return
if p% > 0 and p% <> (o% - 1) then \
    message$ = "R not followed by register number :" : \
    gosub 10000 : \ rem display error
    return
if p% <> (o% - 1) \
    then gosub 11600 : \ rem place constant
         put% = 0 \
    else put% = int%(val(right$(instr$,(t% - o% + 1)))) : \
         gosub 11500 :rem place number
if put% > 40 then \
    message$ = "The register number is greater than 40" : \
    gosub 10000 : \ rem error display
    return
do.flag% = do.flag% + 1
nest.level% = nest.level% + 1
nest%(nest.level%) = 3
return :rem ** End of do **

700 rem ***** Loop *****
obj$ = "007:"
if nest%(nest.level%) <> 3 then \
    message$ = "NESTING CONFLICT." : \
    gosub 10000 : \ rem display error
    return
do.flag% = do.flag% - 1
nest.level% = nest.level% - 1
return :rem ** End of loop **

800 rem ***** Read *****
obj$ = "008:"
p% = match("R",instr$,1) + 1
gosub 1050 :rem Place registers
return :rem ** End of read **

900 rem ***** Input *****
obj$ = "009:"
p% = 1
gosub 1050 :rem Place registers
return :rem ** End of input **

1000 rem ***** Print *****
obj$ = "010:"
p% = match("R",instr$,1) + 1
gosub 1050 :rem Place registers
return :rem ** End of print **

1050 rem ***** Place registers *****
while p% <> length% and p% <> 0
    o% = match("#",instr$,p%)
    p% = match("R",instr$,p%)
    if p% <> (o% - 1) and (p% - o%) <> 0 then \
        message$ = "Invalid register number:" : \
        gosub 10000 : \ rem display error
        return
    if o% > 0 then  \
        put% = int%(val(right$(instr$,(t% - o% + 1)))) : \
        gosub 11500 :rem place number
wend
i% = 0
p% = 1
t% = len(obj$)
while p% <> t%
    put% = 1
    i% = i% + 1
    p% = match(":",obj$,p%)
    if p% <> t% then \
        put% = int%(val(right$(obj$,(t% - p%)))) : \
        p% = p% + 1
    if put% = 0 or put% > 40 then \
        message$ = "Item no. " + str$(i%) +"is not a valid reg no:": \
        gosub 10000 : \ rem display error
        return
wend
return :rem ** End of place registers **

1100 rem ***** = (expressions) *****
top.stack% = 1
stack$(top.stack%) = " "
stack%(top.stack%) = -1
p% = match("R41",instr$,1)
if p% > 0 then \
    message$ = "Register number 41 is beyond permissable range." : \
    gosub 10000 : \ rem display error
    return
p% = match("PI",instr$,1)
while p% > 0
    aa$ = left$(instr$,(p% - 1)) + "R41"
    aa$ = aa$ + right$(instr$,(t% - p% - 1))
    instr$ = aa$
    t% = t% + 1
    s% = p% + 2
    p% = match("PI",instr$,s%)
    reg.range% = 41
wend
brackets% = 0
obj$ = "011:"
p% = 1
exp.flag$ = "EXPECTING OPERAND"
token.flag$ = "MORE"
s% = 0
token% = 0
while token.flag$ = "MORE"
    exp.err.flag$ = "NO ERROR"
    token% = token% + 1
    o% = match("#",instr$,p%)
    if o% = 0 then \
        o% = t% + 1
    q% = match("R#",instr$,p%)
    if q% = 0 then \
        q% = t% + 1
    if s% < p% then \
        gosub 1140 :rem scan for next operator
    if (o% < q%) and (o% < s%) and token% = 1 then \
        message$ = "First token not a register number :" : \
        gosub 10000 : \ rem display error
        return
    if (o% < q%) and (o% < s%) then \
        gosub 1120 : \ rem test for error
        gosub 11600 : rem place constant
    if (q% < o%) and (q% < s%) then \
        put% = int%(val(right$(instr$,(t% - q%)))) : \
        gosub 1130 : \ rem test for error
        gosub 11500 :  rem place number
    if (s% < o%) and (s% < q%) then \
        i% = s2% : \
        gosub 1160 :rem select operator
    if q% = o% and o% = s% then \
        token.flag$ = "NO MORE"
    if p% = (t% + 1) then \
        token.flag$ = "NO MORE"
    if exp.err.flag$ = "ERROR" then \
        message$ = "Token no " + str$(token%) + "is operator when" : \
        message$ = message$ + " operand was expected:" : \
        gosub 10000 : \ rem display error
        return
    if exp.err.flag$="ERROR CON" or exp.err.flag$="ERROR REG 1" then \
        message$ = "Token no " + str$(token%) + "is operand when" : \
        message$ = message$ + " operator was expected:" : \
        gosub 10000 : \ rem display error
        return
    if exp.err.flag$ = "ERROR LB" then \
        message$ = "Token no " + str$(token%) + "is a left bracket" : \
        message$ = message$ + " when an operator was expected:" : \
        gosub 10000 : \ rem display error
        return
    if exp.err.flag$ = "ERROR RB" then \
        message$ = "Token no " + str$(token%) + "is a right bracket" :\
        message$ = message$ + " when an operator was expected:" : \
        gosub 10000 : \ rem display error
        return
    if exp.err.flag$ = "ERROR REG 2" then \
        message$ = "Token no " + str$(token%) : \
        message$ = message$ + " is not a valid register" : \
        gosub 10000 : \ rem display error
        return
wend
if brackets% > 0 then \
    message$ = str$(brackets%) + "unmatched left bracket/s" : \
    gosub 10000 : \ rem display error
    return
if brackets% < 0 then \
    message$ = str$(abs(brackets%)) + "unmatched right bracket/s" : \
    gosub 10000 : \ rem display error
    return
gosub 1180 :rem unstack operands still on stack
reg.range% = 40
return :rem ** End of = (expressions) **
 
1120 rem ***** Test for error (constant) *****
if exp.flag$ = "EXPECTING OPERATOR" then \
    exp.err.flag$ = "ERROR CON"
exp.flag$ = "EXPECTING OPERATOR"
return :rem ** End of test for error (constant) **

1130 rem ***** Test for error (register) *****
if exp.flag$ = "EXPECTING OPERATOR" then \
    exp.err.flag$ = "ERROR REG 1"
if put% = 0 or put% > reg.range% then \
    exp.err.flag$ = "ERROR REG 2"
exp.flag$ = "EXPECTING OPERATOR"
return :rem ** End of test for error (register) **

1140 rem ***** Select operator *****
s1% = t% + 1
for i% = 1 to 24
    s% = match(op$(i%),instr$,p%)
    if s% > 0 and op$(i%) = "-" then \
        gosub 1150 : rem test for unary minus
    if s% < s1% and s% > 0 then \
        s1% = s% : \
        s2% = i%
next i%
s% = s1%
return :rem ** End of select operator **

1150 rem ***** Test for unary minus *****
ss% = match("#",instr$,s%)
if ss% = (1 + s%) then \
    s% = match("-",instr$,ss%)
return :rem ** End of test for unary minus **

1160 rem ***** Check operator stack *****
p% = s% + len(op$(i%))
if op$(i%) = "(" and exp.flag$ = "EXPECTING OPERATOR" then \
    exp.err.flag$ = "ERROR LB" : \
    return
if op$(i%) = "(" and exp.flag$ = "EXPECTING OPERAND" then \
    brackets% = brackets% + 1 : \
    top.stack% = top.stack% + 1 : \
    stack$(top.stack%) = ob.op$(i%) : \
    stack%(top.stack%) = op%(i%) : \
    return
if op$(i%) = ")" and exp.flag$ = "EXPECTING OPERAND" then \
    exp.err.flag$ = "ERROR RB" : \
    return
if op$(i%) = ")" and exp.flag$ = "EXPECTING OPERATOR" then \
    brackets% = brackets% - 1 : \
    gosub 1170 : \ rem unstack to '('
    return
rem ********** OPERATOR TEST **********
if exp.flag$ = "EXPECTING OPERAND" and i% < 9 then \
    exp.err.flag$ = "ERROR"
rem ********** FUNCTION TEST **********
if exp.flag$ = "EXPECTING OPERATOR" and i% >= 9 then \
    exp.err.flag$ = "ERROR"
rem ********** RESET FLAG    **********
exp.flag$ = "EXPECTING OPERAND"
while stack%(top.stack%) >= op%(i%)
    obj$ = obj$ + stack$(top.stack%) + ":"
    top.stack% = top.stack% - 1
wend
top.stack% = top.stack% + 1
stack%(top.stack%) = op%(i%)
stack$(top.stack%) = ob.op$(i%)
return :rem ** End of check operator stack **

1170 rem ***** Unstack to '(' *****
while stack$(top.stack%) <> "-(-"
    obj$ = obj$ + stack$(top.stack%) + ":"
    top.stack% = top.stack% - 1
wend
top.stack% = top.stack% - 1
return :rem ** End of unstack to '(' **

1180 rem ***** Unstack at end of expression *****
while stack$(top.stack%) <> "256"
    obj$ = obj$ + stack$(top.stack%) + ":"
    top.stack% = top.stack% - 1
wend
obj$ = obj$ + "256:"
return :rem ** End of unstack at end of expression **

1200 rem ***** IF *****
obj$ = "012:"
p% = 1
gosub 1250 :rem match register
if match.flag$ = "NO MATCH" then \
    return
s% = p%
gosub 1280 :rem find test
if func.flag$ = "NOT FOUND" then \
    return
p% = s%
gosub 1250 :rem match register
if match.flag$ = "NO MATCH" then \
    return
if.flag% = if.flag% + 1
nest.level% = nest.level% + 1
nest%(nest.level%) = 1
rem : Check for > & >= and replace with < & <= ,swapping registers.
t% = val(right$(obj$,8))
if t% < 275 then \
    return
tt1% = val(right$(obj$,12))
tt2% = val(right$(obj$,4))
t% = t% -4
obj$ = "012:"
put% = tt2%
gosub 11500 :rem place number
obj$ = obj$ + str$(t%) + ":"
put% = tt1%
gosub 11500 :rem place number
return :rem ** End of if **

1250 rem ***** Match register *****
match.flag$ = "MATCH"
q% = match("R",instr$,p%)
if q% = 0 then \
    q% = t%
o% = match("#",instr$,p%)
if q% = t% and o% = 0 then \
    message$ = "Syntax error :" : \
    gosub 10000 : \ rem display error
    match.flag$ = "NO MATCH" : \
    return
if q% < o% and q% <> (o% - 1) then \
    message$ = "R not followed by register number :" : \
    gosub 10000 : \ rem display error
    match.flag$ = "NO MATCH" : \
    return
if q% <> (o% - 1) \
    then gosub 11600 : \ rem place constant
         put% = 0 \
    else put% = int%(val(right$(instr$,(t% - o% + 1)))) : \
         gosub 11500 :rem place number
if put% > 40 then \
    message$ = "The first register number is greater than 40" : \
    gosub 10000 : \ rem error display
    match.flag$ = "NO MATCH" : \
    return
return :rem ** End of match register **

1280 rem ***** Find test *****
func.flag$ = "NOT FOUND"
p% = match("LTE",instr$,s%)
if p% > 0 then \
    func.flag$ = "FOUND" : \
    obj$ = obj$ + "272:"
p% = match("GTE",instr$,s%)
if p% > 0 then \
    func.flag$ = "FOUND" : \
    obj$ = obj$ + "276:"
p% = match("EQU",instr$,s%)
if p% > 0 then \
    func.flag$ = "FOUND" : \
    obj$ = obj$ + "273:"
p% = match("NEQ",instr$,s%)
if p% > 0 then \
    func.flag$ = "FOUND" : \
    obj$ = obj$ + "274:"
p% = match("LT",instr$,s%)
if (p% > 0) and (func.flag$ = "NOT FOUND") then \
    func.flag$ = "FOUND" : \
    obj$ = obj$ + "271:"
p% = match("GT",instr$,s%)
if (p% > 0) and (func.flag$ = "NOT FOUND") then \
    func.flag$ = "FOUND" : \
obj$ = obj$ + "275:"
if func.flag$ = "NOT FOUND" then \
    message$ = "Test not found" : \
    gosub 10000 : \ rem error display
    return
return :rem ** End of find test **

1300 rem ***** Return from subroutine *****
if sub.flag% <>  1 then \
    message$ = "Return from non existant subroutine:" : \
    gosub 10000 : \ rem error display
    return
obj$ = "013:"
sub.flag% = 0
return :rem ** End of return from subroutine **

1400 rem ***** While *****
obj$ = "014:"
p% = 1
gosub 1250 :rem match register
if match.flag$ = "NO MATCH" then \
    return
s% = p%
gosub 1280 :rem find test
if func.flag$ = "NOT FOUND" then \
    return
p% = s%
gosub 1250 :rem match register
if match.flag$ = "NO MATCH" then \
    return
while.flag% = while.flag% + 1
nest.level% = nest.level% + 1
nest%(nest.level%) = 2
rem : Check for > & >= and replace with < & <= ,swapping registers.
t% = val(right$(obj$,8))
if t% < 275 then \
    return
tt1% = val(right$(obj$,12))
tt2% = val(right$(obj$,4))
t% = t% -4
obj$ = "014:"
put% = tt2%
gosub 11500 :rem place number
obj$ = obj$ + str$(t%) + ":"
put% = tt1%
gosub 11500 :rem place number
return :rem ** End of while **

1500 rem ***** Wend *****
obj$ = "015:"
if nest%(nest.level%) <> 2 then \
    message$ = "NESTING CONFLICT." : \
    gosub 10000 : \ rem display error
    return
while.flag% = while.flag% - 1
nest.level% = nest.level% - 1
return :rem ** End of wend **

1600 rem ***** Stop *****
if stop.flag$ = "STOP" then \
    message$ = "'STOP' appeared in line " + str$(stop.label%) : \
    message$ = message$ + " and may only appear once." : \
    gosub 10000 : \ rem display error
    return
stop.flag$ = "STOP"
obj$ = "016:"
stop.label% = object.no%
return :rem ** End stop **

1700 rem ***** Goto *****
p% = match("#",instr$,1)
no1% = int%(val(right$(instr$,(t% - p% + 1))))
if no1% = 0 then \
    message$ = "Jump label number missing :" : \
    gosub 10000 : \ rem display error
    return
obj$ = "017:"
put% = no1%
gosub 11500 :rem place number
return :rem ** End of goto **

1800 rem ***** Else *****
if if.flag% = 0 then \
    message$ = "No if statement preceeds this else statement." : \
    gosub 10000 : \ rem display error
    return
obj$ = "018:"
return :rem ** End of else **

1900 rem ***** FEND *****
obj$ = "019:"
if nest%(nest.level%) <> 1 then \
    message$ = "NESTING CONFLICT." : \
    gosub 10000 : \ rem display error
    return
if.flag% = if.flag% - 1
nest.level% = nest.level% - 1
return :rem ** End of fend **

2000 rem ***** Select *****
obj$ = "020:"
o% = match("#",instr$,1)
t% = len(instr$)
put% = val(right$(instr$,(t% - o% + 1)))
if put% = 0 or put% > 40 then \
    message$ = "No valid register number." : \
    gosub 10000 : \ rem display error
    return
gosub 11500 :rem place number
o% = match("MAX",instr$,p%)
if o% = 0 then \
    message$ = "NO 'MAX' in select instruction" : \
    gosub 10000 : \ rem display error
    return
p% = o% + 1
o% = match("#",instr$,p%)
if o% = 0 then \
    message$ = "No constant in select instruction." : \
    gosub 10000 : \ rem display error
    return
put% = val(right$(instr$,(t% - o% + 1)))
gosub 11500 :rem place number
o% = match("TIMES",instr$,p%)
if o% = 0 then \
    obj$ = obj$ + "001:" : \ rem default to 1
    return
p% = o% + 1
o% = match("#",instr$,p%)
if o% = 0 then \
    message$ = "No constant when 'times' used." : \
    gosub 10000 : \ rem display error
    return
put% = val(right$(instr$,(t% - o% + 1)))
gosub 11500 :rem place number
return :rem ** End of select **

2100 rem ***** Fix *****
obj$ = "021:"
p% = match("R",instr$,1)
o% = match("#",instr$,1)
if o% = 0 then \
    message$ = "Number of decimal places in fix not specified." : \
    gosub 10000 : \ rem display error
    return
t% = len(instr$)
s% = match("-",instr$,1)
put% = val(right$(instr$,(t% - o% + 1)))
if s% = (o% -1) then \
    message$ = "Negative numbers may not appear in fix statements." : \
    gosub 10000 : \ rem display error
    return
if p% = 0 and put% > 10 then \
    message$ = "Number of decimal places too high to fix." : \
    gosub 10000 : \ rem display error
    return
if p% = 0 then \
    gosub 11600 : \ rem place constant
    return
gosub 11500 : rem place number
return :rem ** End of fix **

2200 rem ***** Exit *****
obj$ = "022:"
return :rem ** End of exit **

2400 rem ***** Increment *****
obj$ = "024:"
o% = match("#",instr$,1)
if o% = 0 then \
    message$ = "Register number missing." : \
    gosub 10000 : \ rem display error
    return
put% = val(right$(instr$,(t% - o% + 1)))
if o% > reg.range% then \
    message$ = "Number beyond register range." : \
    gosub 10000 : \ rem display error
    return
gosub 11500 :rem place number
return :rem ** End of increment **

2500 rem ***** Decrement *****
obj$ = "025:"
o% = match("#",instr$,1)
if o% = 0 then \
    message$ = "Register number missing." : \
    gosub 10000 : \ rem display error
    return
put% = val(right$(instr$,(t% - o% + 1)))
if o% > reg.range% then \
    message$ = "Number beyond register range." : \
    gosub 10000 : \ rem display error
    return
gosub 11500 :rem place number
return :rem ** End of decrement **

10000 rem ***** Error trap 1 *****
object.no% = object.no% - 1
gosub 12000 :rem display instructions
print
print message$;
print " in line number ";line.no%;"."
print "Object string so far is : ";obj$
print
print "       : Re-type instruction ."
print "[-OR-] : Type 'INS' if a line is to be inserted."
print "[-OR-] : Type 'DEL' if the line is to be deleted ."
print "[-OR-] : Type 'SKIP' if the compiler should skip the line ."
print "[-OR-] : Type 'ABORT' to stop compilation :"
print
print fnc$(21,6);
input replacement$
while len(replacement$) > length%
    print fnc$(21,6);
    print "                                                         "
    print "                                                         "
    print fnc$(21,6);
    print "Line has ";len(replacement$);" characters max accepted is ";
    print length%
    input "Re-input line : ";replacement$
wend
if ucase$(replacement$) = "INS" then \
    gosub 10100 : \ rem insert instruction
    line.no% = line.no% - 1 : \
    error.flag$ = "ERROR" : \
    return
if ucase$(replacement$) = "DEL" then \
    instruction$(line.no%) = "DEL" : \
    error.flag$ = "ERROR" : \
    return
if ucase$(replacement$) = "SKIP" then \
    perm.error.flag$ = "ERROR" : \
    return
if ucase$(replacement$) = "ABORT" then \
    chain "PROG"
instruction$(line.no%) = replacement$
obj$ = " "
line.no% = line.no% - 1
error.flag$ = "ERROR"
print clear$
return :rem ** End of error trap 1 **

10100 rem ***** Insert instruction *****
while instruction$(i%) <> "END"
    i% = i% + 1
wend
if i% = 400 then \
    print "Program too long to insert another instruction" : \
    print "Type any character to continue : "; : \
    dummy% = conchar% : \
    return
l% = 40
while l% > 35
    print fnc$(21,6);
    print "                                                      "
    print "                                                      "
    print fnc$(21,6);
    print "Type in new instruction not more than 35 characters."
    input "    : ";replacement$
    l% = len(replacement$)
wend
while i% >= line.no%
    instruction$(i% + 1) = instruction$(i%)
    i% = i% - 1
wend
instruction$(line.no%) = replacement$
return rem ** End of insert instruction **
 
11000 rem ***** Save files *****
if perm.error.flag$ = "ERROR" then \
    gosub 11100 : \ rem permanent error
    return
if error.flag$ = "ERROR" then \
    gosub 11200 : \ rem corrected error
    return
print :print
print "Compilation complete with no errors."
answer$ = "Y"
while ucase$(answer$) <> "N"
    print
    print "Do you wish to save the object program ";
    input "on disc Y/N : ";answer$
    if ucase$(answer$) = "Y" \
        then gosub 11300 : \ rem save object file
             answer$ = "N" \
        else gosub 11450 :rem set register values
wend
answer$ = "Y"
while ucase$(answer$) <> "N"
    print
    print "Do you wish to save the source program ";
    input "on disc Y/N : ";answer$
    if ucase$(answer$) = "Y" then \
        gosub 11400 : \ rem save source file
        answer$ = "N"
wend
return :rem ** End of save files **

11100 rem ***** Permanant error *****
print
print "Compilation completed but with uncorrected errors still"
print "in the source file."
print "The object file can therefore be neither run nor saved."
answer$ = "Y"
while ucase$(answer$) <> "N"
    print :print
    print "Do you wish to save the current version of the incorrect"
    input "source file on disc Y/N : ";answer$
    if ucase$(answer$) = "Y" then \
        gosub 11250 : \ rem close up file
        gosub 11400 : \ rem save source file
        answer$ = "N"
wend
return :rem ** End of permanent error **

11200 rem ***** Corrected error display *****
print :print
print "Compilation completed with no errors."
print
print "Some errors were however found during compilation and corrected"
print "which means that the source file in memory is not the same as"
print "the file which may previously have been saved on disc."
print
answer$ = "Y"
while ucase$(answer$) <> "N"
    print
    print "Do you therefore wish to save the new source file"
    input "on disc Y/N : ";answer$
    if ucase$(answer$) = "Y" then \
        gosub 11250 : \ rem close up file
        gosub 11400 : \ rem save source file
        answer$ = "N"
wend
print
answer$ = "Y"
while ucase$(answer$) <> "N"
    print
    print "Do you wish to save the object program on disc ";
    input "Y/N : ";answer$
    if ucase$(answer$) = "Y" \
        then gosub 11300 : \ rem save object file
             answer$ = "N" \
        else gosub 11450 :rem set registers
wend
return :rem ** End of corrected error display **

11250 rem ***** Close up file *****
count% = 0
i% = 0
while instruction$(i%) <> "END"
    i% = i% + 1
    if instruction$(i%) = "DEL" \
        then count% = count% + 1 \
        else new% = i% - count% : \
             instruction$(new%) = instruction$(i%)
wend
return :rem ** End of close up file **

11300 rem ***** Save object file *****
print clear$
print :print :print
print "All disc files used by this program to hold object files have"
print "ambiguous filenames of '.OBJ'."
print
print "Only the unambiguous part therefore needs to be specified"
print "in the form 'test@' where @ is carriage return."
print "This will be interpreted as 'TEST.OBJ'."
print :print
input "Type in filename : ";f1$
f1$ = f1$ + ".OBJ"
create f1$ as 1
i% = 0
while object$(i%) <> "END1"
    i% = i% + 1
    print # 1 ;object$(i%)
wend
i% = 41
while reg$(i%) <> "END2"
    i% = i% + 1
    print # 1 ;reg$(i%)
    register(i%) = val(reg$(i%))
wend
close 1
return :rem ** End of save object file **

11400 rem ***** Save source file *****
print clear$
print :print :print
print "All disc files used by this program to hold source files have"
print "ambiguous filenames of '.SRC'."
print
print "Only the unambiguous part therefore needs to be specified"
print "in the form 'test@' where @ is carriage return."
print "This will be interpreted as 'TEST.SRC'."
print :print
input "Type in filename : ";f4$
f4$ = f4$ + ".SRC"
create f4$ as 4
i% = 0
while instruction$(i%) <> "END"
    i% = i% + 1
    print # 4 ;instruction$(i%)
wend
close 4
return :rem ** End of save source file **

11450 rem ***** Set registers *****
for i% = 42 to 200
    register(i%) = val(reg$(i%))
next i%
return :rem ** End of set registers **
 
11500 rem ***** Place number *****
p% = match(" ",instr$,o%)
pp1% = match("R",instr$,o%)
pp2% = match(")",instr$,o%)
if p% = 0 then \
    p% = t% + 1
if pp1% = 0 then \
    pp1% = t% + 1
if pp2% = 0 then \
    pp2% = t% + 1
if pp1% < p% then \
    p% = pp1%
if pp2% < p% then \
    p% = pp2%
number$ = str$(put%)
p1$ = number$
if len(number$) = 1 then \
    p1$ = "00" + number$
if len(number$) = 2 then \
    p1$ = "0" + number$
obj$ = obj$ + p1$ + ":"
return :rem ** End of place number **
 
11600 rem ***** Place constant *****
number = val(right$(instr$,(t% - o% + 1)))
if match("-",instr$,(o% - 1)) = (o% - 1) then \
    number = 0 - number
i% = 42
while reg$(i%) <> "END2"
    if number = val(reg$(i%)) then \
        put% = i% : \
        gosub 11500 : \ rem place number
        return
    i% = i% + 1
wend
if top1% = 201 then \
    print "Too many constants in program." : \
    chain "PROG"
reg$(top1% + 1) = reg$(top1%)
reg$(top1%) = str$(number)
put% = top1%
gosub 11500 :rem place number
top1% = top1% + 1
return :rem ** End of place constant **

12000 rem ***** Display selected instructions *****
print clear$
row% = 0
end.flag$ = "NOT END"
for i% = 9 to 0 step -1
    row% = row% + 1
    print fnc$(row%,1);
    no% = line.no% - i%
    if no% > 0 then \
        print using "###&&" ;no%,":",instruction$(no%)
    print fnc$(row%,41);
    no% = no% +10
    if instruction$(no%) = "END" then \
        end.flag$ = "END"
    if end.flag$ = "NOT END" then \
        print using "###&&" ;no%,":",instruction$(no%)
next i%
return :rem ** End of display selected instructions **

15000 rem ***** Pre-run module checks *****
s1% = 0
p1% = 0
l1% = 0
r1% = 0
i% = 0
while object$(i%) <> "END1"
    i% = i% + 1
    gosub 15200 :rem search for next goto
    gosub 15400 :rem trace associated labels
wend
i% = 0
call.flag$ = "NOT FOUND"
while object$(i%) <> "END1"
    sub.flag$ = "SUBROUTINE FOUND"
    sub.label% = stop.label%
    i% = i% + 1
    if val(object$(i%)) = 3 then \ rem 3 = call
        t% = len(object$(i%)) : \
        call.flag$ = "FOUND" : \
        name1$ = right$(object$(i%),(t% - 4)) : \
        name$ = "004:" + name1$ : \ rem 4 = subroutine
        gosub 15600 : rem scan for subroutine
    if sub.flag$ <> "SUBROUTINE FOUND" then \
        print "Subroutine '";name1$;"' not found."; : \
        print "Called in line number ";i% : \
        print : \
        perm.error.flag$ = "ERROR"
    if sub.label% < stop.label% then \
        print "Subroutine '";name1$;"' appears before stop."; : \
        print "In line number ";sub.label% : \
        print : \
        perm.error.flag$ = "ERROR"
wend
ret.flag$ = "NOT FOUND"
while val(object$(i%)) <> 4 and i% > 0 :rem 4 = subroutine
    i% = i% - 1
    if object$(i%) = "013:" then \ rem 13 = return
        ret.flag$ = "FOUND"
wend
if ret.flag$ <> "FOUND" and call.flag$ = "FOUND" then \
    print "No return instruction follows final subroutine." : \
    print : \
    perm.error.flag$ = "ERROR"
i% = 1
while object$(i%) <> "END1"
    p% = val(object$(i%))
    if p% = 20 then \ rem 20 = select
        gosub 15900 :rem check select options
    i% = i% + 1
wend
return :rem ** End of pre-run module checks **

15200 rem ***** Search for next goto *****
while object$(i%) <> "END1"
    temp% = val(object$(i%))
    if temp% = 4 then \ rem 4 = subroutine
        s1% = s1% + 1
    if temp% = 13 then \ rem 13 = return
        r1% = r1% + 1
    rem  6 = do      14 = while      12 = if
    if temp% = 6 or temp% = 14 or temp% = 12 then \
        p1% = p1% + 1
    rem 7 = loop    15 = wend       19 = ifend
    if temp% = 7 or temp% = 15 or temp% = 19 then \
        l1% = l1% + 1
    if temp% = 17 then \ rem 17 = goto
        p% = val(right$(object$(i%),4)) : \
        return
    i% = i% + 1
wend
p% = 0
return :rem ** End of search for next goto/then **

15400 rem ***** Trace associated labels *****
if p% = 0 then \
    return
p2% = 0
s2% = 0
r2% = 0
l2% = 0
j% = 0
while object$(j%) <> "END1"
    j% = j% + 1
    temp% = val(object$(j%))
    if temp% = 4 then \ rem 4 = subroutine
        s2% = s2% + 1
    if temp% = 13 then \ rem 13 = return
        r2% = r2% + 1
    rem  6 = do       14 = while     12 = if
    if temp% = 6 or temp% = 14 or temp% = 12 then \
        p2% = p2% + 1
    rem  7 = loop      15 = wend    19 = ifend
    if temp% = 7 or temp% = 15 or temp% = 19 then \
        l2% = l2% + 1
    rem 5 = label
    if temp% = 5 and val(right$(object$(j%),4)) = p% then \
        gosub 15500 : \ rem test for error
        return
wend
print "Label number ";p%;" called in line ";i%;" is missing."
print
return :rem ** End of trace associated labels **

15500 rem ***** Test for error *****
sub.error.flag$ = "NO ERROR"
if abs(p1% - p2%) <> abs(l1% -l2%) then \
    print "Jump from line ";i%;" to line ";j%;" illegal." : \
    print : \
    perm.error.flag$ = "ERROR" : \
    sub.error.flag$ = "ERROR"
if s1% <> s2% or r1% <> r2% then \
    print "Jump from line ";i%;" to line ";j%;" illegal." : \
    print : \
    perm.error.flag$ = "ERROR" : \
    sub.error.flag$ = "ERROR"
k% = j%
while object$(k%) <> "END1"
    k% = k% + 1
    temp% = val(object$(k%))
    rem 5 = label
    t% = len(object$(k%))
    if temp% = 5 and val(right$(object$(k%),(t% - 4))) = p% then \
        print "Label appears in both line ";j%;" and ";k% : \
        print : \
        perm.error.flag$ = "ERROR" : \
        sub.error.flag$ = "ERROR"
wend
if sub.error.flag$ <> "ERROR" then \
    temp$ = left$(object$(i%),4) : \
    object$(i%) = temp$ : \
    put% = j% : \
    gosub 15800 :rem place line number
return :rem ** End of test for error **

15600 rem ***** Scan for subroutine *****
while object$(sub.label%) <> "END1"
    sub.label% = sub.label% + 1
    if name$ = object$(sub.label%) then \
        object$(i%) = "003:" : \
        put% = sub.label% : \
        gosub 15800 : \ rem place line number
        return
wend
sub.flag$ = "SUBROUTINE NOT FOUND"
return :rem ** End of scan for subroutine **

15800 rem ***** PLace line number ******
number$ = str$(put%)
p1$ = number$
if len(number$) = 1 then \
    p1$ = "00" + number$
if len(number$) = 2 then \
    p1$ = "0" + number$
object$(i%) = object$(i%) + p1$ + ":"
return :rem ** End of place line number **

15900 rem ***** Check select options *****
rem Acceptable select options are :-
rem : CALL (3) ; GOTO (17) ; EXIT (22) ; EXPRESSION (11) ;
rem : READ (8) ; INPUT (9) ; PRINT (10) ; : [comment] (23) .
p% = val(right$(object$(i%),4)) :rem Times (multiplier)
o% = val(right$(object$(i%),8)) :rem Max (number of options)
j% = i% + 1
p% = j% + (p% * o%) - 1
for i% = j% to p%
    select.flag$ = "NOT ACCEPTABLE"
    o% = val(object$(i%))
    if o% = 3 or o% = 17 or o% = 22 or o% = 11 then \
        select.flag$ = "ACCEPTABLE"
    if o% = 8 or o% = 9 or o% = 10 or o% = 23 then \
        select.flag$ = "ACCEPTABLE"
    if select.flag$ = "NOT ACCEPTABLE" then  \
        print "Select instruction in line ";(j% - 1); : \
        print "points to an" : \
        print "illegal instruction in line ";i% : \
        perm.error.flag$ = "ERROR"
next i%
return :rem ** End of check select options **
1$* 2љdH  ~ ~~  ~~~~~~~~~~   ~6 АААRААRЂNO STOP ЂЂ(ЂЂ ЂЂ ЂЂ ЂЂ Ђ  ЂЂ*ЂERROR 2ЂЂ Ђ ЂЂ Ђ!ЂКЂ АА!Ђ!END2 Ђ"ЂЂ#АЂЂ Ђ$АЂЂ Ђ%Ђ6 ¦ЂИЂ%А%
7 АА%АЂ!  2А%АЂ!Ђ p6 ™Ђ%ЂЙ6 ХЃђЂ%А%
7 дА%АЂ!  26 ИЂАЂ!END1 23 :,NAME,CALL,SUB,LABEL,DO,LOOP,READ,INPUT,PRINT,=,IF, 3 RETURN,WHILE,WEND,STOP,GOTO,ELSE,FEND,SELECT,FIX,EXIT,INC,DEC,END, Ђ&ЂЂ Ђ%Ђ6ЂЂ%А%
7А%А&Ђ!<63 =,0,256,(,1,-(-,),2,-)-,+,3,252,-,3,253,*,4,254,/,4,255,^,5,251, 3 ASIN,6,260,SIN,6,257,ACOS,6,261,COS,6,258, 3 ATAN,6,262,TAN,6,259,ALOG,6,264,LOG,6,263,EXP,6,266,LN,6,265, 3 SQ,6,267,RT,6,268,DEG,6,271,RAD,6,272,FACT,6,269,ABS,6,270, Ђ'ЂЂ Ђ(ЂЂ Ђ)ЂЂ Ђ%Ђ6MЂЂ%А%
7lА%А'Ђ!<А%А(Ђ!=:А%А)Ђ!<6@Ђ*NO ERRORS Ђ+NO ERRORS А $d4Ђ,ЂА,АЂ!END 7ЄЂ-А-ЂЂ.NOT FOUND Ђ/ЂЂ0А,АЂ!sЂ1! А0Ђ\А1Ђ 7фЂ.BLANK LINE Ђ2  А.NOT FOUND А/Ђ79А/А&Ђ!А0Ђ\Ђ 7.
Ђ.FOUND Ђ/А/Ђ6фА.NOT FOUND 7|Ђ3Syntax error,unable to trace instruction: и&###&& cLine no.  $А,p# : $А2$d4Ђ,А,Ђ6’d4d4d4LINE BY LINE COMPILATION COMPLETE. $d4d4d4TESTING FOR CONTEXT DEPENDANT ERRORS. $d4АЂ 7JThere are  $Аp#d unmatched if statements. $d4d4Ђ+ERROR АЂ 7“There are  $АpA#d unmatched ifend statements. $d4d4Ђ+ERROR АЂ 7ЫThere are  $Аp#d unmatched while statements. $d4d4Ђ+ERROR АЂ 7#There are  $АpA#d unmatched wend statements. $d4d4Ђ+ERROR АЂ 7hThere are  $Аp#d unmatched do statements. $d4d4Ђ+ERROR АЂ 7°There are  $АpA#d unmatched loop statements. $d4d4Ђ+ERROR *кd4Type any character to continue :  $dЂ4xА $d4 •А+ERROR 7ЂNO ERROR 2PROG yА,АЂ!sEND 7А-ЂАЂ!END1 2Ђ5А0TА/€bЂ^96”6ћ6a6±6~6О6Ъ6	6	86	J6
t6_6«6р6є6э6j6Д66P6В6Ь6ж6gА-АЂ!А22Ђ2023: Ђ1R А0Ђ\Ђ6# А0Ђ\А1А6Ђ7вЂ3No valid register number: иЂ7А0А5А6ЂVXrА7Ђ А7Ђ(7%Ђ3No valid register number : иЂ1! А0А6\Ђ8А,АЂ!А5А1ЂVЂ8А8ЂSЂ2002: (‰Ђ2А2А8Ђ2003: Ђ1CALL А0Ђ\Ђ8А0А5А1ЂVЂ5А8TЂ1! А8Ђ\Ђ8А8А5А1ЂVЂ2А2А8ЂSАNO STOP 7щЂ3NO 'STOP' instruction found before subroutines. иАЂ 7*Ђ3Previouse subroutine not ended: иЂЂЂ2004: Ђ1SUB А0Ђ\Ђ8А0А5А1ЂVЂ5А8TЂ1! А8Ђ\Ђ8А8А5А1ЂVЂ2А2А8ЂSЂ1# А0Ђ\Ђ7А0А5А1ЂVXrА7Ђ 7БЂ3Label number missing : иЂ2005: (‰Ђ2006: Ђ1R А0Ђ\Ђ6# А0Ђ\А1Ђ А6Ђ 7Ђ3Instruction incomplete : иА1Ђ А1А6Ђ7]Ђ3R not followed by register number : иА1А6Ђ7t)9Ђ7Ђ 6‡Ђ7А0А5А6ЂVXr(‰А7Ђ(7їЂ3The register number is greater than 40 иЂАЂЂАЂАА Ђ!ЂЂ2007: АА Ђ!Ђ7	Ђ3NESTING CONFLICT. иЂАЂЂАЂЂ2008: Ђ1R А0Ђ\Ђ	eЂ2009: Ђ1Ђ	eЂ2010: Ђ1R А0Ђ\Ђ	eА1АА1Ђ 7	бЂ6# А0А1\Ђ1R А0А1\А1А6ЂА1А6Ђ 7	ВЂ3Invalid register number: иА6Ђ 7	ЮЂ7А0А5А6ЂVXr(‰6	eЂ%Ђ Ђ1ЂЂ5А2TА1А57
sЂ7ЂЂ%А%ЂЂ1: А2А1\А1А57
0Ђ7А2А5А1VXrЂ1А1ЂА7Ђ А7Ђ(7
pЂ3Item no.  А%pWis not a valid reg no: и6	сЂ"ЂА"А#Ђ!  А"А$Ђ!ЂЂ1R41 А0Ђ\А1Ђ 7
ЭЂ3Register number 41 is beyond permissable range. иЂ1PI А0Ђ\А1Ђ 7=Ђ9А0А1ЂSR41 Ђ9А9А0А5А1ЂVЂ0А9Ђ5А5ЂЂ:А1ЂЂ1PI А0А:\ЂЂ)6
йЂ;Ђ Ђ2011: Ђ1ЂЂ<EXPECTING OPERAND Ђ=MORE Ђ:Ђ Ђ>Ђ А=MORE 7Ђ?NO ERROR Ђ>А>ЂЂ6# А0А1\А6Ђ 7·Ђ6А5ЂЂ@R# А0А1\А@Ђ 7ФЂ@А5ЂА:А17аЊА6А@А6А:А>Ђ7#Ђ3First token not a register number : иА6А@А6А:79и)9А@А6А@А:7\Ђ7А0А5А@VXr)(‰А:А6А:А@7tЂ%АAА@А6А6А:7ђЂ=NO MORE А1А5Ђ7ЁЂ=NO MORE А?ERROR 7юЂ3Token no  А>pWis operator when Ђ3А3 operand was expected: иА?ERROR CON А?ERROR REG 1 7jЂ3Token no  А>pWis operand when Ђ3А3 operator was expected: иА?ERROR LB 7НЂ3Token no  А>pWis a left bracket Ђ3А3 when an operator was expected: иА?ERROR RB 71Ђ3Token no  А>pWis a right bracket Ђ3А3 when an operator was expected: иА?ERROR REG 2 7|Ђ3Token no  А>pWЂ3А3 is not a valid register и6yА;Ђ 7®Ђ3А;pWunmatched left bracket/s иА;Ђ 7ЯЂ3А;pAWunmatched right bracket/s и#ЂЂ(А<EXPECTING OPERATOR 7Ђ?ERROR CON Ђ<EXPECTING OPERATOR А<EXPECTING OPERATOR 7TЂ?ERROR REG 1 А7Ђ А7А7tЂ?ERROR REG 2 Ђ<EXPECTING OPERATOR ЂBА5ЂЂ%Ђ6©ЂЂ%А%
7рЂ:А%А'Ђ!А0А1\А:Ђ А%А'Ђ!- 7УцА:АBА:Ђ 7нЂBА:ЂAА%6њЂ:АBЂC# А0А:\АCЂА:7Ђ:- А0АC\Ђ1А:А%А'Ђ!TА%А'Ђ!( А<EXPECTING OPERATOR 7_Ђ?ERROR LB А%А'Ђ!( А<EXPECTING OPERAND 7ёЂ;А;ЂЂ"А"ЂА"А#Ђ!А%А)Ђ!А"А$Ђ!А%А(Ђ!А%А'Ђ!) А<EXPECTING OPERAND 7оЂ?ERROR RB А%А'Ђ!) А<EXPECTING OPERATOR 7#Ђ;А;ЂлА<EXPECTING OPERAND А%Ђ	7NЂ?ERROR А<EXPECTING OPERATOR А%Ђ	7zЂ?ERROR Ђ<EXPECTING OPERAND А"А$Ђ!А%А(Ђ!7ВЂ2А2А"А#Ђ!: Ђ"А"Ђ6ђЂ"А"ЂА"А$Ђ!А%А(Ђ!А"А#Ђ!А%А)Ђ!А"А#Ђ!-(- 7Ђ2А2А"А#Ђ!: Ђ"А"Ђ6лЂ"А"ЂА"А#Ђ!256 7RЂ2А2А"А#Ђ!: Ђ"А"Ђ6#Ђ2А2256: Ђ2012: Ђ1Ђ)АDNO MATCH 7‚Ђ:А1MАENOT FOUND 7ќЂ1А:)АDNO MATCH 7·ЂАЂЂАЂАА Ђ!ЂЂ5А2ЂVX:А5Ѓ7еЂFА2ЂVX:ЂGА2ЂVX:Ђ5А5ЂЂ2012: Ђ7АG(‰Ђ2А2А5pW: Ђ7АF(‰ЂDMATCH Ђ@R А0А1\А@Ђ 7LЂ@А5Ђ6# А0А1\А@А5А6Ђ 7‹Ђ3Syntax error : иЂDNO MATCH А@А6А@А6Ђ7ЧЂ3R not followed by register number : иЂDNO MATCH А@А6Ђ7о)9Ђ7Ђ 6Ђ7А0А5А6ЂVXr(‰А7Ђ(7LЂ3The first register number is greater than 40 иЂDNO MATCH ЂENOT FOUND Ђ1LTE А0А:\А1Ђ 7‡ЂEFOUND Ђ2А2272: Ђ1GTE А0А:\А1Ђ 7іЂEFOUND Ђ2А2276: Ђ1EQU А0А:\А1Ђ 7ЯЂEFOUND Ђ2А2273: Ђ1NEQ А0А:\А1Ђ 7ЂEFOUND Ђ2А2274: Ђ1LT А0А:\А1Ђ АENOT FOUND 7FЂEFOUND Ђ2А2271: Ђ1GT А0А:\А1Ђ АENOT FOUND 7ЃЂEFOUND Ђ2А2275: АENOT FOUND 7ЄЂ3Test not found иАЂ7бЂ3Return from non existant subroutine: иЂ2013: ЂЂ Ђ2014: Ђ1Ђ)АDNO MATCH 7Ђ:А1MАENOT FOUND 7.Ђ1А:)АDNO MATCH 7HЂАЂЂАЂАА Ђ!ЂЂ5А2ЂVX:А5Ѓ7vЂFА2ЂVX:ЂGА2ЂVX:Ђ5А5ЂЂ2014: Ђ7АG(‰Ђ2А2А5pW: Ђ7АF(‰Ђ2015: АА Ђ!Ђ7мЂ3NESTING CONFLICT. иЂАЂЂАЂАSTOP 7RЂ3'STOP' appeared in line  АHpWЂ3А3 and may only appear once. иЂSTOP Ђ2016: ЂHА-Ђ1# А0Ђ\ЂIА0А5А1ЂVXrАIЂ 7ІЂ3Jump label number missing : иЂ2017: Ђ7АI(‰АЂ 7Ђ3No if statement preceeds this else statement. иЂ2018: Ђ2019: АА Ђ!Ђ7?Ђ3NESTING CONFLICT. иЂАЂЂАЂЂ2020: Ђ6# А0Ђ\Ђ5А0TЂ7А0А5А6ЂVX:А7Ђ А7Ђ(7¬Ђ3No valid register number. и(‰Ђ6MAX А0А1\А6Ђ 7мЂ3NO 'MAX' in select instruction иЂ1А6ЂЂ6# А0А1\А6Ђ 73Ђ3No constant in select instruction. иЂ7А0А5А6ЂVX:(‰Ђ6TIMES А0А1\А6Ђ 7kЂ2А2001: Ђ1А6ЂЂ6# А0А1\А6Ђ 7®Ђ3No constant when 'times' used. иЂ7А0А5А6ЂVX:(‰Ђ2021: Ђ1R А0Ђ\Ђ6# А0Ђ\А6Ђ 7!Ђ3Number of decimal places in fix not specified. иЂ5А0TЂ:- А0Ђ\Ђ7А0А5А6ЂVX:А:А6Ђ7‰Ђ3Negative numbers may not appear in fix statements. иА1Ђ А7Ђ
7ЛЂ3Number of decimal places too high to fix. иА1Ђ 7Ш)9(‰Ђ2022: Ђ2024: Ђ6# А0Ђ\А6Ђ 7$Ђ3Register number missing. иЂ7А0А5А6ЂVX:А6А7cЂ3Number beyond register range. и(‰Ђ2025: Ђ6# А0Ђ\А6Ђ 7ҐЂ3Register number missing. иЂ7А0А5А6ЂVX:А6А7дЂ3Number beyond register range. и(‰Ђ-А-Ђ*d4А3$d in line number  $А,p#. $d4Object string so far is :  $А2$d4d4       : Re-type instruction . $d4[-OR-] : Type 'INS' if a line is to be inserted. $d4[-OR-] : Type 'DEL' if the line is to be deleted . $d4[-OR-] : Type 'SKIP' if the compiler should skip the line . $d4[-OR-] : Type 'ABORT' to stop compilation : $d4d4ЂЂЂЂ $dЂ n;ЂJ1'АJTА7JЂЂЂЂ $d                                                          $d4                                                          $d4ЂЂЂЂ $dLine has  $АJTp# characters max accepted is  $dАp#d4Re-input line :  n;ЂJ1'6SАJsINS 7mлЂ,А,ЂЂ*ERROR АJsDEL 7“А,АЂ!DEL 2Ђ*ERROR АJsSKIP 7¬Ђ+ERROR АJsABORT 7ВPROG yА,АЂ!АJ2Ђ2  Ђ,А,ЂЂ*ERROR А $d4А%АЂ!END 7Ђ%А%Ђ6лА%Ѓђ7nProgram too long to insert another instruction $d4Type any character to continue :  $dЂ4xЂKЂ(АKЂ#7 aЂЂЂЂ $d                                                       $d4                                                       $d4ЂЂЂЂ $dType in new instruction not more than 35 characters. $d4    :  n;ЂJ1'ЂKАJT6sА%А,7 ‰А%ЂАЂ!А%АЂ!2Ђ%А%Ђ6 aА,АЂ!АJ2А+ERROR 7 §!ЕА*ERROR 7 №"зd4d4Compilation complete with no errors. $d4ЂLY АLsN 7!Xd4Do you wish to save the object program  $don disc Y/N :  n;ЂL1'АLsY 7!R%'ЂLN 6!U(_6 мЂLY АLsN 7!Дd4Do you wish to save the source program  $don disc Y/N :  n;ЂL1'АLsY 7!Б&дЂLN 6!^d4Compilation completed but with uncorrected errors still $d4in the source file. $d4The object file can therefore be neither run nor saved. $d4ЂLY АLsN 7"жd4d4Do you wish to save the current version of the incorrect $d4source file on disc Y/N :  n;ЂL1'АLsY 7"г$Й&дЂLN 6"]d4d4Compilation completed with no errors. $d4d4Some errors were however found during compilation and corrected $d4which means that the source file in memory is not the same as $d4the file which may previously have been saved on disc. $d4d4ЂLY АLsN 7$Td4Do you therefore wish to save the new source file $d4on disc Y/N :  n;ЂL1'АLsY 7$Q$Й&дЂLN 6#аd4ЂLY АLsN 7$Иd4Do you wish to save the object program on disc  $dY/N :  n;ЂL1'АLsY 7$В%'ЂLN 6$Е(_6$\ЂMЂ Ђ%Ђ А%АЂ!END 7%&Ђ%А%ЂА%АЂ!DEL 7%
ЂMАMЂ6%#ЂNА%АMАNАЂ!А%АЂ!26$УА $d4d4d4d4All disc files used by this program to hold object files have $d4ambiguous filenames of '.OBJ'. $d4d4Only the unambiguous part therefore needs to be specified $d4in the form 'test@' where @ is carriage return. $d4This will be interpreted as 'TEST.OBJ'. $d4d4d4Type in filename :  n;Ђ1'ЂА.OBJ 2АЂ ЂЂЂЂkЂ%Ђ А%АЂ!END1 7&џЂ%А%ЂЂ&А%АЂ!,?6&tЂ%Ђ)А%А!Ђ!END2 7&аЂ%А%ЂЂ&А%А!Ђ!,?А%АЂ!А%А!Ђ!X6&¤Ђ@А $d4d4d4d4All disc files used by this program to hold source files have $d4ambiguous filenames of '.SRC'. $d4d4Only the unambiguous part therefore needs to be specified $d4in the form 'test@' where @ is carriage return. $d4This will be interpreted as 'TEST.SRC'. $d4d4d4Type in filename :  n;Ђ1'ЂА.SRC 2АЂ ЂЂЂЂkЂ%Ђ А%АЂ!END 7([Ђ%А%ЂЂ&А%АЂ!,?6(1Ђ@Ђ%Ђ*6(tЂИЂ%А%
7(€А%АЂ!А%А!Ђ!X6(gЂ1  А0А6\ЂOR А0А6\ЂP) А0А6\А1Ђ 7(»Ђ1А5ЂАOЂ 7(МЂOА5ЂАPЂ 7(ЭЂPА5ЂАOА17(лЂ1АOАPА17(щЂ1АPЂQА7pWЂRАQАQTЂ7)ЂR00 АQАQTЂ7),ЂR0 АQЂ2А2АR: ЂSА0А5А6ЂVX- А0А6Ђ\А6Ђ7)hЂSЂ АSpЂ%Ђ*А%А!Ђ!END2 7)¤АSА%А!Ђ!X7)™Ђ7А%(‰Ђ%А%Ђ6)mАЂЙ7)ЧToo many constants in program. $d4PROG yАЂА!Ђ!АА!Ђ!АА!Ђ!АSWЂ7А(‰ЂАЂА $d4ЂTЂ ЂUNOT END Ђ%Ђ	6*CЂ ЂА%Ђ%Ђ Ђ8Ђ97*йЂTАTЂЂАTЂЂ $dЂVА,А%АVЂ 7*€###&& cАVp#5: $5АVАЂ!$d4ЂАTЂЂ) $dЂVАVЂ
АVАЂ!END 7*№ЂUEND АUNOT END 7*ж###&& cАVp#5: $5АVАЂ!$d46*$ЂBЂ ЂWЂ ЂXЂ ЂYЂ Ђ%Ђ А%АЂ!END1 7+'Ђ%А%Ђ-].6+Ђ%Ђ ЂZNOT FOUND А%АЂ!END1 7,xЂ[SUBROUTINE FOUND Ђ\АHЂ%А%ЂА%АЂ!XЂp7+¶Ђ5А%АЂ!TЂZFOUND Ђ]А%АЂ!А5ЂVЂ^004: А]0ЁА[SUBROUTINE FOUND 7,Subroutine ' $А]$' not found. $dCalled in line number  $А%p#d4d4Ђ+ERROR А\АH7,uSubroutine ' $А]$' appears before stop. $dIn line number  $А\p#d4d4Ђ+ERROR 6+:Ђ_NOT FOUND А%АЂ!XЂpА%Ђ 7,ЖЂ%А%ЂА%АЂ!013: 7,ГЂ_FOUND 6,†А_FOUND АZFOUND 7- No return instruction follows final subroutine. $d4d4Ђ+ERROR Ђ%ЂА%АЂ!END1 7-\Ђ1А%АЂ!X:А1Ђ7-Q1SЂ%А%Ђ6-%А%АЂ!END1 7.Ђ`А%АЂ!X:А`Ђ7-ЋЂBАBЂА`Ђ7-џЂYАYЂА`ЂА`ЂА`Ђ7-ѕЂWАWЂА`ЂА`ЂА`Ђ7-ЭЂXАXЂА`Ђ7-чЂ1А%АЂ!ЂVX:Ђ%А%Ђ6-]Ђ1Ђ А1Ђ 7.ЂaЂ ЂAЂ ЂbЂ ЂcЂ ЂdЂ АdАЂ!END1 7.ХЂdАdЂЂ`АdАЂ!X:А`Ђ7.dЂAАAЂА`Ђ7.uЂbАbЂА`ЂА`ЂА`Ђ7.”ЂaАaЂА`ЂА`ЂА`Ђ7.іЂcАcЂА`ЂАdАЂ!ЂVXА1p7.Т/6.+Label number  $А1p# called in line  $А%p# is missing. $d4d4ЂeNO ERROR АWАapAАXАcpA7/~Jump from line  $А%p# to line  $Аdp# illegal. $d4d4Ђ+ERROR ЂeERROR АBАAАYАb7/ШJump from line  $А%p# to line  $Аdp# illegal. $d4d4Ђ+ERROR ЂeERROR ЂfАdАfАЂ!END1 70xЂfАfЂЂ`АfАЂ!X:Ђ5АfАЂ!TА`ЂАfАЂ!А5ЂVXА1p70uLabel appears in both line  $Аdp# and  $Аfp#d4d4Ђ+ERROR ЂeERROR 6/ЭАeERROR 70§ЂgА%АЂ!ЂSА%АЂ!Аg2Ђ7Аd1А\АЂ!END1 70нЂ\А\ЂА^А\АЂ!70кА%АЂ!003: 2Ђ7А\160ЁЂ[SUBROUTINE NOT FOUND ЂQА7pWЂRАQАQTЂ71'ЂR00 АQАQTЂ71:ЂR0 АQА%АЂ!А%АЂ!АR: 2Ђ1А%АЂ!ЂVX:Ђ6А%АЂ!ЂVX:ЂdА%ЂЂ1АdА1А6ЂЂ%Аd61ћА1Ђ%А%
72ЂhNOT ACCEPTABLE Ђ6А%АЂ!X:А6ЂА6ЂА6ЂА6Ђ71лЂhACCEPTABLE А6ЂА6Ђ	А6Ђ
А6Ђ72ЂhACCEPTABLE АhNOT ACCEPTABLE 72•Select instruction in line  $АdЂp#dpoints to an $d4illegal instruction in line  $А%p#d4Ђ+ERROR 61‘Ђ   $А%p# to line  $Аdp# illegal. $d4d4Ђ+ERROR ЂeERROR ЂfАdАfАЂ!sults **

8000 rem ***** test for degrees *****
if angle.flag$ = "DEGREES"  \
   then no.of.radians = first.number * 1.74532925E-2  \
   else no.of.radians = first.number
return :rem ** End of test for degrees **
zer
42.21	1K	START.COM	COM of above
42.22	2K	T.ASM		(3) Print time on..
42.23	1K	T.COM		    ..console
42.24	3K	TIME.ASM	(3) ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГCRCK.COM 4.2 10/6/80!  9"1Нd:] ю ВLН§++NO FILE NAME SPECIFIED++
$НWCRCK ver 4.2
CTL-S pauses, CTL-C aborts
 :m 2ІюFВ~ГЇ CRCKLIST$$$ Н–°ГшН–жД‚yж0°  –Г4х*«л*­}“|љЪ$!  "­л*«{•zњТ*©лН €Н ·ВхЂ *­"­ГЗ	Н сГ
DISK FULL: CRCFILE$Ђ Н !  "­л*©лс*­#"­ЙЇ2”2Ё!  "«!  "­€Н €Н <В~	fН Г
NO DIR SPACE: CRCFILE$1НЉТF:¶·К¤Н:++FILE NOT FOUND++$:ІюFВ<*­}жВё"«>хНІсВ¬€Н <Вр	ЩН Гр
CANNOT CLOSE CRCFILE$Г CRCKLISTCRC 
DISK FULL: CRCFILуН Г3е 	w#В$СН Й!€уНН§
DONE$!e Н К~!] w Н/!e Ђ Н/НW
--> FILE:  XXXXXXXX.XXX		CRC =  \ Н <В«Н:++OPEN FAILED++$!  "і! "П*П|ю КвН ·КУН юК@\ Н ·Вр!Ђ ~2µ#"ПН#Г·юВ:ґН@> Нk:іН@НdГ~Н:++FILE READ ERROR++$*і|жЂх):µ…oсК<|о g}о—o"іЙхНIсжю
ЪRЖЖ0Гkг~Нk#~·ВXгЙ>Нk>
ЕХеж_ХНСН бСБЙ:ІюFА{НІЙЂ Н Ї2h 2| :¶·КЙ!\ · Н/:\ 2Г!·\  Н/\ Н Гс!Г\  Н/\ Н !·\  Н/\ Н <7И=ж‡‡‡‡‡ЖЃo& еД Н/б]  Н/Ї2h 2| 2¶ЙН(АН(А~жю$#Й~#x±В/ЙС	Н :ІюFВ”*­}жВT"«>хНІсВH€Н <ВЊ	uН ГЊ
CANNOT CLOSE CRCFILE$€Н Н§

++ABORTED++$С	Н *щЙ                                                                             ЂЂЂ $А0$d4АDEGREES 75Ђ>А/. 6:Ђ>А/Ђ JЂ АЂ!А5‘Ђ АЂ!А/А3‘Ђ АЂ!А/N‘Ђ АЂ!А/K‘Ђ АЂ!А/яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
--> FILE:  CALC    .BAS		CRC = 2E 34

--> FILE:  CALC    .INT		CRC = 0A 2D

--> FILE:  COMPILE .BAS		CRC = 8D B6

--> FILE:  COMPILE .INT		CRC = 82 6C

--> FILE:  RUNOBJ  .BAS		CRC = ED 70

--> FILE:  RUNOBJ  .INT		CRC = 15 48

--> FILE:  EDITOR  .BAS		CRC = 45 40

--> FILE:  EDITOR  .INT		CRC = E3 32

--> FILE:  EDITOR1 .BAS		CRC = F5 D4

--> FILE:  EDITOR1 .INT		CRC = C9 98

--> FILE:  PROG    .BAS		CRC = 61 D3

--> FILE:  PROG    .INT		CRC = 98 37

--> FILE:  INIT    .BAS		CRC = 3A 75

--> FILE:  INIT    .INT		CRC = E6 C3

--> FILE:  PCALC   .BAS		CRC = 86 02

--> FILE:  PCALC   .INT		CRC = 58 6F

--> FILE:  CNOTES  .PRN		CRC = 34 16

--> FILE:  SAL     .SRC		CRC = D5 07

--> FILE:  SAL     .OBJ		CRC = 6F 84

--> FILE:  BM      .SRC		CRC = 22 56

--> FILE:  BM      .OBJ		CRC = 61 20

--> FILE:  BREAK   .COM		CRC = EF EA

--> FILE:  BREAK   .ASM		CRC = BF BC

--> FILE:  LIST    .ASM		CRC = 44 DF

--> FILE:  LIST    .COM		CRC = 4E 06
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееcommon clear$,cursor$,c.offset%
common tot.inst%,length%,data.no(1),object$(1)
common instruction$(1),register(1)
common print.flag$,res.flag$,dat.flag$
common comp.flag$,f1$,f2$,f3$
common f4$,f5$
common end.data,delete.data,blank.data
rem :******************************************************************
rem :
rem :  Copyright (c) 1981 by Electronic Accounting Services.
rem :
rem :******************************************************************
def fnc$(r%,c%) = cursor$ + chr$(r% + c.offset%) + chr$(c% + c.offset%)
rem ************************************************************
rem : Editor for program source files.ie TEXT.
rem : Requires a terminal with clear screen and an addressable
rem : curser.
rem ************************************************************
print clear$
blk$ = " "
b.line$ = " "
for i% = 2 to length%
    b.line$ = b.line$ + blk$
next i%
dim temp.inst$(tot.inst% + 1)
print :print
print "            Editor."
print "           *********"
print :print
ed.flag$ = "ED"
while ed.flag$ = "ED"
    input "#";answer$
    com$ = ucase$(answer$)
    err$ = "YES"
    if com$ = "I" then err$ = "NO" : \
        gosub 122 :rem insert text
    if com$ = "S" then err$ = "NO" : \
        gosub 123 :rem save on disc
    if com$ = "T" then err$ = "NO" : \
        gosub 124 :rem type page
    if com$ = "L" then err$ = "NO" : \
        gosub 127 :rem load from disc
    if com$ = "P" then err$ = "NO" : \
        gosub 190 :rem print buffer
    if com$ = "C" then err$ = "NO" : \
        gosub 200 :rem clear buffer
    if match("$",com$,1) > 0 then err$ = "NO" : \
        com$ = answer$ : \
        gosub 210 :rem search and replace
    if com$ = "E" then err$ = "NO" : \
        ed.flag$ = "EXIT"
    if err$ = "YES" then print "COMMAND NOT RECOGNISED !"
wend
chain "PROG"
stop

122 rem ***** Insert text *****
top% = 0
while instruction$(top%) <> "END"
    top% = top% + 1
wend
room% = tot.inst% - top%
print "There is room for ";room%;" more lines."
input "Type in line number where text is to be inserted : ";l.no%
if l.no% > top% then l.no% = top%
print clear$
start% = l.no%
line$ = " "
l.no% = l.no% - 1
while line$ <> "#"
    l.no% = l.no% + 1
    if l.no% = room%  \
        then print "BUFFER FULL : Insertion terminated." : \
             line$ = "#" \
        else print l.no%; : \
             input " :";line$
    if line$ <> "#" then \
        temp.inst$(l.no%) = line$
    if len(line$) > length% then \
        l.no% = l.no% - 1 : \
        print "INPUT LINE TOO LONG RE-INPUT !" : \
        print "Line is ";len(line$);" characters." : \
        print "Max permissable is ";length%;" characters."
wend
insert.size% = l.no% - start%
move% = top% - start% + 1
top% = top% + 1
for i% = 1 to move%
    top% = top% - 1
    new% = top% + insert.size%
    instruction$(new%) = instruction$(top%)
next i%
for i% = 0 to (insert.size% - 1)
    new% = start% + i%
    instruction$(new%) = temp.inst$(new%)
next i%
print clear$
return :rem ** End of insert text **

123 rem ***** Save source program *****
gosub 128 :rem name file
create f4$ as 4
i% = 0
while instruction$(i%) <> "END"
    i% = i% + 1
    print #4;instruction$(i%)
wend
close 4
return :rem ** End of save source program **

124 rem ***** Type page *****
pic$ = "###&/...5....0....5....0....5....0..../"
print clear$
print :print
print "Each page typed is 20 lines at 2 instructions per line"
print
print "The bottom 3 lines are used for typing editor commmands."
print
input "Type in the line number where display is to start : ";l.no%
gosub 125 :rem type lines
type.flag$ = "ED"
while type.flag$ = "ED"
    bulk$ = "NOT BULK"
    print fnc$(22,20);"                         "
    print fnc$(22,20);
    input "COMMAND : ";answer$
    com1$ = ucase$(answer$)
    t.flag$ = "NOT FOUND"
    print fnc$(21,10);"                                         "
    if match("$",com1$,1) > 0 then \
        com1$ = answer$ : \
        t.flag$ = "FOUND" : \
        gosub 210 : \ rem search & replace
        com1$ = "$" : \
        gosub 125 :rem type lines
    if com1$ = "P" then \
        l.no% = l.no% + 40 : \
        t.flag$ = "FOUND" : \
        gosub 125 :rem type lines
    if com1$ = "-P" then \
        l.no% = l.no% - 41 : \
        t.flag$ = "FOUND" : \
        gosub 125 :rem type lines
    if match("B",com1$,1) > 0 then \
        bulk$ = "BULK" : \
        gosub 140 : \ rem bulk instructions
        gosub 125 : rem type lines
    if match("T",com1$,1) > 0 then \
        l.no% = abs(val(com1$)) : \
        t.flag$ = "FOUND" : \
        gosub 125 :rem type lines
    if match("D",com1$,1) > 0 and bulk$ <> "BULK" then \
        lin2% = abs(val(com1$)) : \
        t.flag$ = "FOUND" : \
        instruction$(lin2%) = " " : \
        gosub 126 :rem amend display
    if match("R",com1$,1) > 0 and bulk$ <> "BULK" then \
        print fnc$(22,20);"                            " : \
        lin2% = abs(val(com1$)) : \
        t.flag$ = "FOUND" : \
        print fnc$(22,20);"                           " : \
        print fnc$(21,1);lin2%;" : ";instruction$(lin2%);" :  "; : \
        print "Type in instruction." : \
        print lin2%; : \
        input " :";instruction$(lin2%) : \
        print fnc$(21,1);"                                "; : \
        print "                                " : \
        print "                                               " : \
        gosub 126 : rem amend display
    if com1$ = "E" then \
        type.flag$ = "STOP" : \
        print clear$ : \
        t.flag$ = "FOUND"
    if com1$ = "C" then \
        t.flag$ = "FOUND" : \
        gosub 129 : \ rem close up blank lines
        gosub 125 : rem type lines
    if match("I",com1$,1) > 0 and bulk$ <> "BULK" then \
        lin2% = abs(val(com1$)) : \
        t.flag$ = "FOUND" : \
        gosub 130 : \ rem insert line
        gosub 125 :rem type lines
    if match("S",com1$,1) > 0 and bulk$ <> "BULK" then \
        lin2% = abs(val(com1$)) : \
        p% = match("S",com1$,1) : \
        t% = len(com1$) : \
        s% = match("#",com1$,p%) : \
        lin1% = abs(val(right$(com1$,(t% - s% + 1)))) : \
        temp.inst$ = instruction$(lin1%) : \
        instruction$(lin1%) = instruction$(lin2%) : \
        instruction$(lin2%) = temp.inst$ : \
        t.flag$ = "FOUND" : \
        gosub 125 :rem type lines
    if t.flag$ <> "FOUND" then \
        print fnc$(21,10);"ERROR *** COMMAND NOT FOUND ***"
wend
return :rem ** End of type page **

125 rem ***** Type lines *****
if l.no% < 1 then l.no% = 1
top% = 1
while instruction$(top%) <> "END"
    top% = top% + 1
wend
print clear$
for i% = 1 to 20
    print fnc$(i%,1);
    lin1% = l.no% + i% - 1
    lin2% = l.no% + i% + 19
    if lin1% >= top% then return
    print using pic$ ;lin1%,":",instruction$(lin1%)
    if lin2% < top% then \
        print fnc$(i%,41); : \
        print using pic$ ;lin2%,":",instruction$(lin2%)
next i%
return :rem ** End of type lines **

126 rem ***** Amend display *****
rem test for replacement string being too long
while len(instruction$(lin2%)) > length%
    print fnc$(21,1);"ERROR : Line is ";len(instruction$(lin2%)); 
    print " characters long.MAX allowed is ";length%;".RE-INPUT !" 
    b2.line$ = blk$
    for i% = 1 to len(instruction$(lin2%))
        b2.line$ = b2.line$ + blk$
    next i%
    print b2.line$
    print fnc$(22,1);lin2%;
    input " :";instruction$(lin2%)
    print fnc$(22,1);
    print "                                                   "
    print fnc$(21,1);"                                      ";
    print "                                      "
wend
temp% = lin2% - l.no% + 1
if temp% <= 20 \
    then movecursor$ = fnc$(temp%,1) \
    else movecursor$ = fnc$(temp% - 20,41)
print movecursor$;b.line$
print movecursor$;
print using pic$ ;lin2%,":",instruction$(lin2%)
return :rem ** End of amend display **

127 rem ***** Load source program *****
gosub 128 :rem name file
open f4$ as 4
i% = 0
while instruction$(i%) <> "END"
    i% = i% + 1
    read #4 ;instruction$(i%)
wend
n% = i% + 1
for i% = n% to tot.inst%
    instruction$(i%) = "X"
next i%
print "Program loaded is ";(n% - 1);" instructions long."
close 4
return :rem ** End of load source program **

128 rem ***** Name source file *****
print clear$
print :print :print
print "All disc files used by this program to store results have"
print "ambiguous filenames of '.SRC'."
print
print "Only the unambiguous part therefore needs to be specified"
print "in the form 'test@' where @ is carriage return."
print "This will be interpreted as 'TEST.SRC'."
print :print
input "Type in filename : ";f4$
f4$ = f4$ + ".SRC"
return :rem ** End of name file **
 
129 rem ***** Close up blank lines *****
count% = 0
i% = 0
while instruction$(i%) <> "END"
    i% = i% + 1
    if instruction$(i%) = " " \
        then count% = count% + 1 \
        else new% = i% - count% : \
             instruction$(new%) = instruction$(i%)
wend
return :rem ** End of close up blank lines **

130 rem ***** Insert line during 'T' *****
if lin2% < 1 or lin2% > tot.inst% then \
    print "Line number beyond range." : \
    print "Type any key to continue." : \
    dummy% = conchar% : \
    return
i% = lin2%
while instruction$(i%) <> "END" and instruction$(i%) <> " " \
                                and  i% < tot.inst%
    i% = i% + 1
wend
if i% = tot.inst% then \
    print "Too many instructions to insert more." : \
    print "Type any key to continue." : \
    dummy% = conchar% : \
    return
if instruction$(i%) = " " then \
    i% = i% - 1
while i% >= lin2%
    instruction$(i% + 1) = instruction$(i%)
    i% = i% - 1
wend
l% = 40
print fnc$(22,20);"                                     "
while l% > 35
    print fnc$(21,10);"                                      "
    print "                                                       "
    print fnc$(21,10);" Type in line to be inserted."
    input " :";instruction$(lin2%)
    l% = len(instruction$(lin2%))
wend
return :rem ** End of insert line during 'T' *****

140 rem ***** Block instructions *****
lin2% = 0
lin1% = abs(val(com1$))
if lin1% = 0 then \
    return
p% = match("B",com1$,1)
t% = len(com1$)
s% = match("#",com1$,p%)
if s% = 0 then \
    return
lin3% = abs(val(right$(com1$,(t% - s% + 1))))
p% = match(":",com1$,s%)
if p% = 0 then \
    p% = t% + 1
s% = match("#",com1$,p%)
if s% > 0 then \
    lin2% = abs(val(right$(com1$,(t% - s% + 1))))
if match("C",com1$,1) > 0 then \
    t.flag$ = "FOUND" : \
    gosub 145 : \ rem copy lines
    return
if match("M",com1$,1) > 0 then \
    t.flag$ = "FOUND" : \
    gosub 150 : \ rem move lines
    return
if match("R",com1$,1) > 0 then \
    t.flag$ = "FOUND" : \
    gosub 155 : \ rem replace lines
    return
if match("D",com1$,1) > 0 then \
    t.flag$ = "FOUND" : \
    gosub 160 : \ rem delete lines
    return
if match("I",com1$,1) > 0 then \
    t.flag$ = "FOUND" : \
    gosub 165 : \ rem insert lines
    return
return :rem ** End of block instructions **

145 rem ***** Copy lines *****
if lin3% = 1 or lin3% = 0 then \
    gosub 147 : \ rem place line
    instruction$(lin2%) = instruction$(lin1%) : \
    return
top% = 0
while instruction$(top%) <> "END"
    top% = top% + 1
wend
room% = tot.inst% - top%
if lin3% > room% then \
    print "There are too many instructions to insert a block" : \
    print "of ";lin3%;".There are only ";room%;" lines left." : \
    print "Type any character to continue : " : \
    dummy% = conchar% : \
    return
for i% = 1 to lin3%
    l% = lin1% + i% - 1
    temp.inst$(i%) = instruction$(l%)
next i%
top% = top% + 1
while top% > lin2%
    top% = top% - 1
    new% = top% + lin3% 
    instruction$(new%) = instruction$(top%)
wend
for i% = 1 to lin3%
    new% = lin2% + i% - 1
    instruction$(new%) = temp.inst$(i%)
next i%
return :rem ** End of copy lines **

147 rem ***** Place line *****
if lin2% < 1 or lin2% > tot.inst% then \
    print "Line number beyond range." : \
    print "Type any key to continue." : \
    dummy% = conchar% : \
    return
i% = lin2%
while instruction$(i%) <> "END" and instruction$(i%) <> " " \
                                and  i% < tot.inst%
    i% = i% + 1
wend
if i% = tot.inst% then \
    print "Too many instructions to insert more." : \
    print "Type any key to continue." : \
    dummy% = conchar% : \
    return
if instruction$(i%) = " " then \
    i% = i% - 1
while i% >= lin2%
    instruction$(i% + 1) = instruction$(i%)
    i% = i% - 1
wend
return :rem ** End of place line **

150 rem ***** Move lines *****
if lin2% = 0 then \
    return
p% = lin2% - lin1%
if p% > 0 and lin3% >= p% then \
    print :print : \
    print "Error move is within move block." : \
    print "Type any character to continue : " : \
    dummy% = conchar% : \
    return
if lin3% >= (tot.inst% - 1) then \
    return
for i% = 1 to lin3%
    old% = lin1% + i% - 1
    temp.inst$(i%) = instruction$(old%)
next i%
if lin1% < lin2% \
    then gosub 152 \ rem move lines forward
    else gosub 154 : rem move lines backward
for i% = 1 to lin3%
    new% = lin2% + i% - 1
    instruction$(new%) = temp.inst$(i%)
next i%
return :rem ** End of move lines **

152 rem ***** Move lines foreward *****
p% = lin2% - lin1%
for i% = 1 to p%
    old% = lin1% + i% + lin3% - 1
    new% = lin1% + i% - 1
    instruction$(new%) = instruction$(old%)
next i%
return :rem ** End of move lines foreward **

154 rem ***** Move lines backward *****
p% = lin1% - lin2%
for i% = 1 to p%
    old% = lin1% - i%
    new% = lin1% - i% + lin3%
    instruction$(new%) = instruction$(old%)
next i%
return :rem ** End of move lines backward **

155 rem ***** Replace lines *****
if lin3% >= (tot.inst% - 1) then \
    return
if lin3% = 0 then \
    return
if lin3% = 1 then \
    print :print :print : \
    print "Line ";lin1%; : \
    input " : ";instruction$(lin1%) : \
    return
print :print :print
for i% = 1 to lin3%
    new% = lin1% + i% - 1
    l% = 40
    while l% > 35
        print "Line ";new%;
        input " : ";instruction$(new%)
        l% = len(instruction$(new%))
    wend
next i%
return :rem ** End of replace lines **

160 rem ***** Delete lines *****
if lin3% >= tot.inst% then \
    return
if lin3% = 0 then \
    return
if lin3% = 1 then \
    instruction$(lin1%) = " " : \
    return
for i% = 1 to lin3%
    new% = lin1% + i% - 1
    instruction$(new%) = " "
next i%
count% = 0
i% = 0
while instruction$(i%) <> "END"
    i% = i% + 1
    if instruction$(i%) = " " \
        then count% = count% + 1 \
        else new% = i% - count% : \
             instruction$(new%) = instruction$(i%)
wend
return :rem ** End of delete lines **

165 rem ***** Insert lines *****
lin2% = lin1%
if lin3% = 1 or lin3% = 0 then \
    gosub 147 : \ rem place line
    print :print :print : \
    print "Line ";lin1%; : \
    input " : ";instruction$(lin1%) : \
    return
top% = 0
while instruction$(top%) <> "END"
    top% = top% + 1
wend
room% = tot.inst% - top%
if lin3% > room% then \
    print "There are too many instructions to insert a block" : \
    print "of ";lin3%;".There are only ";room%;" lines left." : \
    print "Type any character to continiue : " : \
    dummy% = conchar% : \
    return
top% = top% + 1
while top% > lin2%
    top% = top% - 1
    new% = top% + lin3% 
    instruction$(new%) = instruction$(top%)
wend
print :print :print
for i% = 1 to lin3%
    new% = lin2% + i% - 1
    l% = 40
    while l% > 35
        print "Line ";new%;
        input " : ";instruction$(new%)
        l% = len(instruction$(new%))
    wend
next i%
return :rem ** End of insert lines **

190 rem ***** Print buffer *****
top% = 0
while instruction$(top%) <> "END"
    top% = top% + 1
wend
print "There are ";top%;" lines in the buffer."
print
opt% = 0
while opt% < 1 or opt% > 4
    print "    OPTIONS."
    print
    print "  1 : Print the whole buffer with page ejects."
    print 
    print "  2 : Print the whole buffer without page ejects."
    print
    print "  3 : Print part of buffer with page ejects."
    print
    print "  4 : Print part of buffer without page ejects."
    print
    input "     Type in option number : ";opt%
wend
option% = opt%
while option% > 2
    option% = 1
    print "Specify the first and last line numbers to be printed :-"
    print
    input "First : ";lin1%
    input "Last  : ";lin2%
    if lin1% > = lin2% then \
        option% = 3
    if lin2% > top% then \
        option% = 3
    if lin1% < 1 then \
        option% = 3
wend
if opt% = 1 or opt% = 3 \
    then option% = 1 \
    else option% = 2
lprinter
print :print :print
j% = 1
for i% = lin1% to lin2%
    if option% = 1 and (j% * 60) = i% then \
        j% = j% + 1 : \
        print :print :print : \
        print :print :print
    d$ = str$(i%)
    l% = len(d$)
    if l% = 1 then \
        print "    ";
    if l% = 2 then \
        print "   ";
    if l% = 3 then \
        print "  ";
    print d$;" : ";instruction$(i%)
next i%
while option% = 1 and (j% * 60) <> i%
    print
    i% = i% + 1
wend
if option% = 1 then \
    print :print :print : \
    print
console
return :rem ** End of print buffer **

200 rem ***** Clear buffer *****
answer$ = "N"
while ucase$(answer$) <> "Y"
    input "CLEAR BUFFER.   (Y/N) : ";answer$
    if ucase$(answer$) = "N" then \
        return
wend
for i% = 1 to tot.inst%
    instruction$(i%) = "X"
next i%
instruction$(1) = "END"
return :rem ** End of clear buffer **

210 rem ***** Search and replace *****
if com$ <> "T" then \
    com1$ = com$
t% = len(com1$)
f1% = match("$",com1$,1)
f2% = match("$",com1$,(f1% + 1))
if f2% = (f1% + 1) or f2% = t% then \
    print :print :print : \
    print "ERROR : Search string should follow first $ and replace" : \
    print "        string should follow second $ !" : \
    print :print : \
    print "Type any character to continue : "; : \
    dummy% = conchar% : \
    return
search$ = mid$(com1$,(f1% + 1),(f2% - f1% - 1))
replace$ = right$(com1$,(t% - f2%))
lin1% = 0
lin2% = 0
if f1% > 1 then \
    com1$ = left$(com1$,f1%) : \
    gosub 215 :rem set lin1%
if lin2% = 0 and com$ = "T" then \
    lin2% = lin1%
if lin2% = 0 and com$ <> "T" then \
    lin2% = tot.inst%
if lin1% > lin2% then \
    print :print :print : \
    print "ERROR : Second line less than first." : \
    print "Type any character to continue : " : \
    dummy% = conchar% : \
    return
f1% = len(search$)
if instruction$(lin1%) = "X" then \
    return
if lin1% = lin2% then \
    i% = lin1% : \
    gosub 225 : \ rem search line
    return
if lin2% = (lin1% + 1) then \
    i% = lin1% : \
    gosub 225 : \ rem search line
    return
for i% = lin1% to lin2%
    if instruction$(i%) = "X" then \
        return
    gosub 225 :rem search line
next i%
return :rem ** End of search and replace **

215 rem ***** set lin1% *****
lin1% = val(com1$)
if lin1% > 0 \
    then gosub 220 \ : rem set lin2%
    else lin1% = 1
return :rem ** End of set lin1% **

220 rem ***** Set lin2% *****
t% = len(com1$)
p% = match(":",com1$,1)
if p% = 0 then \
    return
s% = match("#",com1$,p%)
if s% = 0 then \
    return
lin2% = val(right$(com1$,(t% - s% + 1)))
if lin2% > tot.inst% then \
    lin2% = tot.inst%
return :rem ** End of set lin2% **

225 rem ***** Search line *****
p% = match(search$,instruction$(i%),1)
if p% > 0 then \
    t% = len(instruction$(i%)) : \
    temp$ = left$(instruction$(i%),(p% - 1)) : \
    temp$ = temp$ + replace$ : \
    temp$ = temp$ + right$(instruction$(i%),(t% - p% - f1% + 1)) : \
    gosub 230 : rem check for new line length
return :rem ** End of search line **

230 rem ***** Check length of new line *****
t1% = len(temp$)
if t1% > length% then \
    print :print :print : \
    print "Line number ";i%;" can not be replaced as the new line " : \
    print "would have a length of ";t1% : \
    print "Type any character to continue : "; : \
    dummy% = conchar% : \
    return
instruction$(i%) = temp$
t% = len(instruction$(i%))
p% = match(search$,replace$,1)
if p% > 0 then \
    return
gosub 225 :rem search line
return :rem ** End of check length of new line **
BJ		Object of SAL.SRC
03.26	2K	SAL.SRC		Routine to generate payslips
 ':TR:'	;TELETYPE READER
	DB ':O1:'	;USER CO
	DB ':I1:'	;USER CI
	DB ':VO:'	;CRT O/P
	DB ':VI:'	;CRT I/P
	DB ':TO:'	;TELETYееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1$* µ  (  ~ ~~  ~~~~~~~~~~   ~6 АААRААRА $d4Ђ  Ђ  ЂЂ6 :АЂА
7 EЂАА6 -ЂАЂЂ d4d4            Editor. $d4           ********* $d4d4d4ЂED АED 7ђ# n;Ђ1'ЂАsЂYES АI 7 ИЂNO АS 7 ЬЂNO САT 7 рЂNO АL 7ЂNO гАP 7ЂNO •АC 7,ЂNO ›$ АЂ\Ђ 7JЂNO ЂААE 7dЂNO ЂEXIT АYES 7ЌCOMMAND NOT RECOGNISED ! $d46 ‘PROG yЂЂ ААЂ!END 7єЂАЂ6ќЂ ААThere is room for  $А p# more lines. $d4Type in line number where text is to be inserted :  n;Ђ!":'А!А77Ђ!АА $d4Ђ"А!Ђ#  Ђ!А!ЂА## 7CЂ!А!ЂА!А 7›BUFFER FULL : Insertion terminated. $d4Ђ## 6«А!p#d : n;Ђ#1'А## 7їА!АЂ!А#А#TА7@Ђ!А!ЂINPUT LINE TOO LONG RE-INPUT ! $d4Line is  $А#Tp# characters. $d4Max permissable is  $Аp# characters. $d46OЂ$А!А"Ђ%АА"ЂЂАЂЂЂ6sА%ЂА
7—ЂАЂЂ&АА$А&АЂ!ААЂ!26fЂЂ 6ЇА$ЂЂА
7ЛЂ&А"АА&АЂ!А&АЂ!26џА $d4„АЂ ЂЂЂЂkЂЂ ААЂ!END 7ЂАЂЂ&ААЂ!,?6дЂ@Ђ'###&/...5....0....5....0....5....0..../ А $d4d4d4Each page typed is 20 lines at 2 instructions per line $d4d4The bottom 3 lines are used for typing editor commmands. $d4d4Type in the line number where display is to start :  n;Ђ!":'	JЂ(ED А(ED 7	IЂ)NOT BULK ЂЂЂЂ $                          $d4ЂЂЂЂ $dCOMMAND :  n;Ђ1'Ђ*АsЂ+NOT FOUND ЂЂЂЂ
 $                                          $d4$ А*Ђ\Ђ 7лЂ*АЂ+FOUND Ђ*$ 	JА*P 7
Ђ!А!Ђ(Ђ+FOUND 	JА*-P 7*Ђ!А!Ђ)Ђ+FOUND 	JB А*Ђ\Ђ 7HЂ)BULK C	JT А*Ђ\Ђ 7lЂ!А*XA:Ђ+FOUND 	JD А*Ђ\Ђ А)BULK 7§Ђ,А*XA:Ђ+FOUND А,АЂ!  2
R А*Ђ\Ђ А)BULK 7ЂЂЂЂ $                             $d4Ђ,А*XA:Ђ+FOUND ЂЂЂЂ $                            $d4ЂЂЂЂ $А,p# :  $А,АЂ!$ :   $dType in instruction. $d4А,p#d : n;А,АЂ!1'ЂЂЂЂ $                                 $d                                 $d4                                                $d4
А*E 77Ђ(STOP А $d4Ђ+FOUND А*C 7QЂ+FOUND ѕ	JI А*Ђ\Ђ А)BULK 7ѓЂ,А*XA:Ђ+FOUND 	JS А*Ђ\Ђ А)BULK 7	Ђ,А*XA:Ђ-S А*Ђ\Ђ.А*TЂ/# А*А-\Ђ0А*А.А/ЂVXA:Ђ1А0АЂ!А0АЂ!А,АЂ!2А,АЂ!А12Ђ+FOUND 	JА+FOUND 7	FЂЂЂЂ
 $ERROR *** COMMAND NOT FOUND *** $d46А!Ђ7	XЂ!ЂЂЂААЂ!END 7	zЂАЂ6	]А $d4ЂЂ6	”ЂЂА
7
ЂАЂЂ $dЂ0А!АЂЂ,А!АЂА0А7	ГА'cА0p#5: $5А0АЂ!$d4А,А7
ЂАЂЂ) $dА'cА,p#5: $5А,АЂ!$d46	‡А,АЂ!TА7„ЂЂЂЂ $ERROR : Line is  $А,АЂ!Tp#d characters long.MAX allowed is  $Аp#.RE-INPUT ! $d4Ђ2АЂЂ6
¤А,АЂ!TЂА
7
ЇЂ2А2А6
ђА2$d4ЂЂЂЂ $А,p#d : n;А,АЂ!1'ЂЂЂЂ $d                                                    $d4ЂЂЂЂ $                                       $d                                       $d46
Ђ3А,А!ЂА3Ђ7«Ђ4ЂА3ЂЂ 6ѕЂ4ЂА3ЂЂЂ) А4$А$d4А4$dА'cА,p#5: $5А,АЂ!$d4„АЂ ЂЂЂЂjЂЂ ААЂ!END 7 ЂАЂЂ&ААЂ!*>6цЂ5АЂЂА56=АЂА
7LААЂ!X 260Program loaded is  $А5Ђp# instructions long. $d4Ђ@А $d4d4d4d4All disc files used by this program to store results have $d4ambiguous filenames of '.SRC'. $d4d4Only the unambiguous part therefore needs to be specified $d4in the form 'test@' where @ is carriage return. $d4This will be interpreted as 'TEST.SRC'. $d4d4d4Type in filename :  n;Ђ1'ЂА.SRC 2Ђ6Ђ ЂЂ ААЂ!END 7ЂАЂААЂ!  7эЂ6А6Ђ6Ђ&АА6А&АЂ!ААЂ!26ИА,ЂА,А7kLine number beyond range. $d4Type any key to continue. $d4Ђ7xЂА,ААЂ!END ААЂ!  АА7ўЂАЂ6pАА7шToo many instructions to insert more. $d4Type any key to continue. $d4Ђ7xААЂ!  7ЂАЂАА,78АЂАЂ!ААЂ!2ЂАЂ6Ђ8Ђ(ЂЂЂЂ $                                      $d4А8Ђ#7BЂЂЂЂ
 $                                       $d4                                                        $d4ЂЂЂЂ
 $ Type in line to be inserted. $d4 : n;А,АЂ!1'Ђ8А,АЂ!T6uЂ,Ђ Ђ0А*XA:А0Ђ 7ZЂ-B А*Ђ\Ђ.А*TЂ/# А*А-\А/Ђ 7ЂЂ9А*А.А/ЂVXA:Ђ-: А*А/\А-Ђ 7­Ђ-А.ЂЂ/# А*А-\А/Ђ 7ТЂ,А*А.А/ЂVXA:C А*Ђ\Ђ 7пЂ+FOUND dM А*Ђ\Ђ 7Ђ+FOUND R А*Ђ\Ђ 7)Ђ+FOUND D А*Ђ\Ђ 7FЂ+FOUND BI А*Ђ\Ђ 7cЂ+FOUND чА9ЂА9Ђ 7‰мА,АЂ!А0АЂ!2ЂЂ ААЂ!END 7«ЂАЂ6ЋЂ ААА9А 7OThere are too many instructions to insert a block $d4of  $А9p#.There are only  $А p# lines left. $d4Type any character to continue :  $d4Ђ7xЂЂ6dА9ЂА
7‚Ђ8А0АЂААЂ!А8АЂ!6WЂАЂАА,7·ЂАЂЂ&АА9А&АЂ!ААЂ!26ЉЂЂ6МА9ЂА
7лЂ&А,АЂА&АЂ!ААЂ!26їА,ЂА,А7=Line number beyond range. $d4Type any key to continue. $d4Ђ7xЂА,ААЂ!END ААЂ!  АА7tЂАЂ6BАА7КToo many instructions to insert more. $d4Type any key to continue. $d4Ђ7xААЂ!  7вЂАЂАА,7
АЂАЂ!ААЂ!2ЂАЂ6вА,Ђ 7Ђ-А,А0А-Ђ А9А-7Ѓd4d4Error move is within move block. $d4Type any character to continue :  $d4Ђ7xА9АЂ7ЋЂЂ6ЈА9ЂА
7БЂ:А0АЂААЂ!А:АЂ!6–А0А,7Р6УSЂЂ6иА9ЂА
7Ђ&А,АЂА&АЂ!ААЂ!26ЫЂ-А,А0ЂЂ6%А-ЂА
7RЂ:А0АА9ЂЂ&А0АЂА&АЂ!А:АЂ!26Ђ-А0А,ЂЂ6pА-ЂА
7—Ђ:А0АЂ&А0АА9А&АЂ!А:АЂ!26cА9АЂ7ҐА9Ђ 7ЇА9Ђ7Эd4d4d4Line  $А0p#d :  n;А0АЂ!1'd4d4d4ЂЂ6шА9ЂА
7AЂ&А0АЂЂ8Ђ(А8Ђ#7>Line  $А&p#d :  n;А&АЂ!1'Ђ8А&АЂ!T66лА9А7LА9Ђ 7VА9Ђ7lА0АЂ!  2ЂЂ6ЃА9ЂА
7›Ђ&А0АЂА&АЂ!  26tЂ6Ђ ЂЂ ААЂ!END 7цЂАЂААЂ!  7ЪЂ6А6Ђ6уЂ&АА6А&АЂ!ААЂ!26ҐЂ,А0А9ЂА9Ђ 74мd4d4d4Line  $А0p#d :  n;А0АЂ!1'ЂЂ ААЂ!END 7VЂАЂ69Ђ ААА9А 7ыThere are too many instructions to insert a block $d4of  $А9p#.There are only  $А p# lines left. $d4Type any character to continiue :  $d4Ђ7xЂАЂАА,70ЂАЂЂ&АА9А&АЂ!ААЂ!26d4d4d4ЂЂ6KА9ЂА
7”Ђ&А,АЂЂ8Ђ(А8Ђ#7‘Line  $А&p#d :  n;А&АЂ!1'Ђ8А&АЂ!T6[6>ЂЂ ААЂ!END 7·ЂАЂ6љThere are  $Аp# lines in the buffer. $d4d4Ђ;Ђ А;ЂА;Ђ7    OPTIONS. $d4d4  1 : Print the whole buffer with page ejects. $d4d4  2 : Print the whole buffer without page ejects. $d4d4  3 : Print part of buffer with page ejects. $d4d4  4 : Print part of buffer without page ejects. $d4d4     Type in option number :  n;Ђ;":'6йЂ<А;А<Ђ7ЇЂ<ЂSpecify the first and last line numbers to be printed :- $d4d4First :  n;Ђ0":'Last  :  n;Ђ,":'А0А,7ђЂ<ЂА,А7ћЂ<ЂА0Ђ7¬Ђ<Ђ6А;ЂА;Ђ7ЗЂ<Ђ6МЂ<Ђfd4d4d4Ђ=ЂЂА06нА,ЂА
7hА<ЂА=Ђ<А7Ђ=А=Ђd4d4d4d4d4d4Ђ>АpWЂ8А>TА8Ђ72     $dА8Ђ7B    $dА8Ђ7Q   $dА>$ :  $ААЂ!$d46аА<ЂА=Ђ<А7€d4ЂАЂ6hА<Ђ7™d4d4d4d4gЂN АsY 7ЬCLEAR BUFFER.   (Y/N) :  n;Ђ1'АsN 7Щ6ЎЂЂ6сАЂА
7 ААЂ!X 26дЂАЂ!END 2АT 7Ђ*АЂ.А*TЂ?$ А*Ђ\Ђ@$ А*А?Ђ\А@А?ЂА@А.7мd4d4d4ERROR : Search string should follow first $ and replace $d4        string should follow second $ ! $d4d4d4Type any character to continue :  $dЂ7xЂAА*А?ЂА@А?ЂUЂBА*А.А@VЂ0Ђ Ђ,Ђ А?Ђ7(Ђ*А*А?S"А,Ђ АT 7>Ђ,А0А,Ђ АT 7TЂ,АА0А,7·d4d4d4ERROR : Second line less than first. $d4Type any character to continue :  $d4Ђ7xЂ?АATА0АЂ!X 7ОА0А,7аЂА0ЌА,А0Ђ7хЂА0ЌЂА06
А,ЂА
7!ААЂ!X 7Ќ6эЂ0А*X:А0Ђ 78>6=Ђ0ЂЂ.А*TЂ-: А*Ђ\А-Ђ 7YЂ/# А*А-\А/Ђ 7nЂ,А*А.А/ЂVX:А,А7ЊЂ,АЂ-АAААЂ!Ђ\А-Ђ 7иЂ.ААЂ!TЂCААЂ!А-ЂSЂCАCАBЂCАCААЂ!А.А-А?ЂVйЂDАCTАDА7…d4d4d4Line number  $Аp# can not be replaced as the new line  $d4would have a length of  $АDp#d4Type any character to continue :  $dЂ7xААЂ!АC2Ђ.ААЂ!TЂ-АAАBЂ\А-Ђ 7°ЌЂ  ! $d4d4d4Type any chacommon clear$,cursor$,c.offset%
common tot.inst%,length%,data.no(1),object$(1)
common instruction$(1),register(1)
common print.flag$,res.flag$,dat.flag$
common comp.flag$,f1$,f2$,f3$
common f4$,f5$
common end.data,delete.data,blank.data
rem :******************************************************************
rem :
rem :  Copyright (c) 1981 by Electronic Accounting Services.
rem :
rem :******************************************************************
def fnc$(r%,c%) = cursor$ + chr$(r% + c.offset%) + chr$(c% + c.offset%)
rem ***********************************************************
rem : Editor program to make a data file of real numbers.
rem : Must have a terminal with clear screen and
rem : addressable curser.
rem ***********************************************************
pic0$ = "###/....../#.############^^-"
pic1$ = "###/../#,###,###,###,###.############-"
pic2$ = "###/../#,###,###,###,###-"
print clear$
blk$ = " "
b.line$ = "    "
for i% = 2 to length%
    b.line$ = b.line$ + blk$
next i%
dim temp.data((tot.inst% + 1))
print :print
print "            Editor."
print "           *********"
print :print
ed.flag$ = "ED"
while ed.flag$ = "ED"
    input "#";answer$
    com$ = ucase$(answer$)
    err$ = "YES"
    if com$ = "I" then err$ = "NO" : \
        gosub 122 :rem insert data
    if com$ = "S" then err$ = "NO" : \
        gosub 123 :rem save on disc
    if com$ = "T" then err$ = "NO" : \
        gosub 124 :rem type page
    if com$ = "L" then err$ = "NO" : \
        gosub 127 :rem load from disc
    if com$ = "P" then err$ = "NO" : \
        gosub 190 :rem print buffer
    if com$ = "C" then err$ = "NO" : \
        gosub 200 :rem clear buffer
    if com$ = "E" then err$ = "NO" : \
        ed.flag$ = "EXIT"
    if err$ = "YES" then print "COMMAND NOT RECOGNISED !"
wend
chain "PROG"
stop

122 rem ***** Insert data *****
top% = 0
while data.no(top%) <> end.data
    top% = top% + 1
wend
room% = tot.inst% - top%
print "There is room for ";room%;" more lines."
input "Type in line number where text is to be inserted : ";l.no%
if l.no% > top% then l.no% = top%
print clear$
start% = l.no%
line$ = " "
l.no% = l.no% - 1
while line$ <> "#"
    l.no% = l.no% + 1
    if l.no% = room%  \
        then print "BUFFER FULL : Insertion terminated." : \
             line$ = "#" \
        else print l.no%; : \
             input " :";line$
    if line$ <> "#" then \
        temp.data(l.no%) = val(line$)
wend
insert.size% = l.no% - start%
move% = top% - start% + 1
top% = top% + 1
for i% = 1 to move%
    top% = top% - 1
    new% = top% + insert.size%
    data.no(new%) = data.no(top%)
next i%
for i% = 0 to (insert.size% - 1)
    new% = start% + i%
    data.no(new%) = temp.data(new%)
next i%
print clear$
return :rem ** End of insert text **

123 rem ***** Save data file *****
gosub 128 :rem name file
create f2$ as 2
i% = 0
while data.no(i%) <> end.data
    i% = i% + 1
    print #2;data.no(i%)
wend
close 2
return :rem ** End of save source program **

124 rem ***** Type page *****
print clear$
print :print
print "Each page typed is 20 lines at 2 numbers per line"
print
print "The bottom 3 lines are used for typing editor commmands."
print
input "Type in the line number where display is to start : ";l.no%
gosub 125 :rem type lines
type.flag$ = "ED"
while type.flag$ = "ED"
    bulk$ = "NOT BULK"
    print fnc$(22,20);"                         "
    print fnc$(22,20);
    input "COMMAND : ";answer$
    com1$ = ucase$(answer$)
    t.flag$ = "NOT FOUND"
    print fnc$(21,10);"                                         "
    if com1$ = "P" then \
        l.no% = l.no% + 40 : \
        t.flag$ = "FOUND" : \
        gosub 125 :rem type lines
    if com1$ = "-P" then \
        l.no% = l.no% - 41 : \
        t.flag$ = "FOUND" : \
        gosub 125 :rem type lines
    if match("B",com1$,1) > 0 then \
        bulk$ = "BULK" : \
        gosub 140 : \ rem bulk instructions
        gosub 125 :rem type lines
    if match("T",com1$,1) > 0 then \
        l.no% = abs(val(com1$)) : \
        t.flag$ = "FOUND" : \
        gosub 125 :rem type lines
    if match("D",com1$,1) > 0 and bulk$ <> "BULK" then \
        lin2% = abs(val(com1$)) : \
        t.flag$ = "FOUND" : \
        data.no(lin2%) = delete.data : \
        gosub 126 :rem amend display
    if match("R",com1$,1) > 0 and bulk$ <> "BULK" then \
        print fnc$(22,20);"                            " : \
        lin2% = abs(val(com1$)) : \
        t.flag$ = "FOUND" : \
        print fnc$(22,20);"                           " : \
        print fnc$(21,1);lin2%;" : ";data.no(lin2%);" : "; : \
        print "Type in replacement data." : \
        print lin2%; : \
        input " :";data.no(lin2%) : \
        print fnc$(21,1);"                                "; : \
        print "                                " : \
        print "                                               " : \
        gosub 126 : rem amend display
    if com1$ = "E" then \
        type.flag$ = "STOP" : \
        print clear$ : \
        t.flag$ = "FOUND"
    if com1$ = "C" then \
        t.flag$ = "FOUND" : \
        gosub 129 : \ rem close up blank lines
        gosub 125 : rem type lines
    if match("I",com1$,1) > 0 and bulk$ <> "BULK" then \
        lin2% = abs(val(com1$)) : \
        t.flag$ = "FOUND" : \
        gosub 130 : \ rem insert line
        gosub 125 : rem type lines
    if match("S",com1$,1) > 0 and bulk$ <> "BULK" then \
        lin2% = abs(val(com1$)) : \
        p% = match("S",com1$,1) : \
        t% = len(com1$) : \
        s% = match("#",com1$,1) : \
        lin1% = abs(val(com1$)) : \
        temp.data = data.no(lin1%) : \
        data.no(lin1%) = data.no(lin2%) : \
        data.no(lin2%) = temp.data : \
        t.flag$ = "FOUND" : \
        gosub 125 :rem type lines
    if t.flag$ <> "FOUND" then \
        print fnc$(21,10);"ERROR *** COMMAND NOT FOUND ***"
wend
return :rem ** End of type page **

125 rem ***** Type lines *****
if l.no% < 1 then l.no% = 1
top% = 1
while data.no(top%) <> end.data
    top% = top% + 1
wend
print clear$
for i% = 1 to 20
    print fnc$(i%,1);
    lin1% = l.no% + i% - 1
    lin2% = l.no% + i% + 19
    if lin1% >= top% then return
    disp% = lin1%
    display = data.no(lin1%)
    gosub 9000 :rem display
    if lin2% < top% then \
        print fnc$(i%,41); : \
        disp% = lin2% : \
        display = data.no(lin2%) : \
        gosub 9000 : rem display
next i%
return :rem ** End of type lines **

126 rem ***** Amend display *****
temp% = lin2% - l.no% + 1
if temp% <= 20 \
    then movecursor$ = fnc$(temp%,1) \
    else movecursor$ = fnc$(temp% - 20,41)
print movecursor$;b.line$
print movecursor$;
disp% = lin2%
display = data.no(lin2%)
gosub 9000 :rem display
return :rem ** End of amend display **

127 rem ***** Load source data file *****
gosub 128 :rem name file
open f2$ as 2
i% = 0
while data.no(i%) <> end.data
    i% = i% + 1
    read #2 ;data.no(i%)
wend
n% = i% + 1
for i% = n% to tot.inst%
    data.no(i%) = blank.data
next i%
print "Data file loaded is ";(n% - 1);" instructions long."
close 2
return :rem ** End of load source program **

128 rem ***** Name source file *****
print clear$
print :print :print
print "All disc files used by this program to store data files have"
print "ambiguous filenames of '.DAT'."
print
print "Only the unambiguous part therefore needs to be specified"
print "in the form 'test@' where @ is carriage return."
print "This will be interpreted as 'TEST.DAT'."
print :print
input "Type in filename : ";f2$
f2$ = f2$ + ".DAT"
return :rem ** End of name file **
 
129 rem ***** Close up blank lines *****
count% = 0
i% = 0
while data.no(i%) <> end.data
    i% = i% + 1
    if data.no(i%) = delete.data \
        then count% = count% + 1 \
        else new% = i% - count% : \
             data.no(new%) = data.no(i%)
wend
return :rem ** End of close up blank lines **

130 rem ***** Insert line during 'T' *****
if lin2% < 1 or lin2% > tot.inst% then \
    print "Line number beyond range" : \
    print "Type any key to continue:" : \
    dummy% = conchar% : \
    return
i% = lin2%
while data.no(i%) <> delete.data and data.no(i%) <> end.data \ 
                                 and i% < tot.inst%
    i% = i% + 1
wend
if i% = tot.inst% then \
    print "Too many data elements to add more." : \
    print "Type any character to continue:" : \
    dummy% = conchar% : \
    return
if data.no(i%) = delete.data then \
    i% = i% - 1
while i% >= lin2%
    data.no(i% + 1) = data.no(i%)
    i% = i% - 1
wend
print fnc$(22,20);"                                   "
print fnc$(21,10);
print lin2%;" : ";data.no(lin2%);" : Type in new item of data : "
print lin2%;" : ";
input data.no(lin2%)
return :rem ** End of insert line during 'T' **

140 rem ***** Block instructions *****
lin2% = 0
lin1% = abs(val(com1$))
if lin1% = 0 then \
    return
p% = match("B",com1$,1)
t% = len(com1$)
s% = match("#",com1$,p%)
if s% = 0 then \
    return
lin3% = abs(val(right$(com1$,(t% - s% + 1))))
p% = match(":",com1$,s%)
if p% = 0 then \
    p% = t% + 1
s% = match("#",com1$,p%)
if s% > 0 then \
    lin2% = abs(val(right$(com1$,(t% - s% + 1))))
if match("C",com1$,1) > 0 then \
    t.flag$ = "FOUND" : \
    gosub 145 : \ rem copy lines
    return
if match("M",com1$,1) > 0 then \
    t.flag$ = "FOUND" : \
    gosub 150 : \ rem move lines
    return
if match("R",com1$,1) > 0 then \
    t.flag$ = "FOUND" : \
    gosub 155 : \ rem replace lines
    return
if match("D",com1$,1) > 0 then \
    t.flag$ = "FOUND" : \
    gosub 160 : \ rem delete lines
    return
if match("I",com1$,1) > 0 then \
    t.flag$ = "FOUND" : \
    gosub 165 : \ rem insert lines
    return
return :rem ** End of block instructions **

145 rem ***** Copy lines *****
if lin3% = 1 or lin3% = 0 then \
    gosub 147 : \ rem place line
    data.no(lin2%) = data.no(lin1%) : \
    return
top% = 0
while data.no(top%) <> end.data
    top% = top% + 1
wend
room% = tot.inst% - top%
if lin3% > room% then \
    print "There are too many items of data to insert a block" : \
    print "of ";lin3%;".There are only ";room%;" lines left." : \
    print "Type any character to continue : " : \
    dummy% = conchar% : \
    return
for i% = 1 to lin3%
    l% = lin1% + i% - 1
    temp.data(i%) = data.no(l%)
next i%
top% = top% + 1
while top% > lin2%
    top% = top% - 1
    new% = top% + lin3% 
    data.no(new%) = data.no(top%)
wend
for i% = 1 to lin3%
    new% = lin2% + i% - 1
    data.no(new%) = temp.data(i%)
next i%
return :rem ** End of copy lines **

147 rem ***** Place line *****
if lin2% < 1 or lin2% > tot.inst% then \
    print "Line number beyond range." : \
    print "Type any key to continue." : \
    dummy% = conchar% : \
    return
i% = lin2%
while data.no(i%) <> end.data and data.no(i%) <> delete.data \
                                and  i% < tot.inst%
    i% = i% + 1
wend
if i% = tot.inst% then \
    print "Too many items of data to insert more." : \
    print "Type any key to continue." : \
    dummy% = conchar% : \
    return
if data.no(i%) = delete.data then \
    i% = i% - 1
while i% >= lin2%
    data.no(i% + 1) = data.no(i%)
    i% = i% - 1
wend
return :rem ** End of place line **

150 rem ***** Move lines *****
if lin2% = 0 then \
    return
if lin3% >= (tot.inst% - 1) then \
    return
p% = lin2% - lin1%
if p% > 0 and lin3% >= p% then \
    print :print : \
    print "Error move is within move block." : \
    print "Type any character to continue : " : \
    dummy% = conchar% : \
    return
for i% = 1 to lin3%
    old% = lin1% + i% - 1
    temp.data(i%) = data.no(old%)
next i%
if lin1% < lin2% \
    then gosub 152 \ rem move lines forward
    else gosub 154 : rem move lines backward
for i% = 1 to lin3%
    new% = lin2% + i% - 1
    data.no(new%) = temp.data(i%)
next i%
return :rem ** End of move lines **

152 rem ***** Move lines foreward *****
p% = lin2% - lin1%
for i% = 1 to p%
    old% = lin1% + i% + lin3% - 1
    new% = lin1% + i% - 1
    data.no(new%) = data.no(old%)
next i%
return :rem ** End of move lines foreward **

154 rem ***** Move lines backward *****
p% = lin1% - lin2%
for i% = 1 to p%
    old% = lin1% - i%
    new% = lin1% - i% + lin3%
    data.no(new%) = data.no(old%)
next i%
return :rem ** End of move lines backward **

155 rem ***** Replace lines *****
if lin3% >= (tot.inst% - 1) then \
    return
if lin3% = 0 then \
    return
if lin3% = 1 then \
    print :print :print : \
    print "Line ";lin1%; : \
    input " : ";data.no(lin1%) : \
    return
print :print :print
for i% = 1 to lin3%
    new% = lin1% + i% - 1
    print " Line ";new%;
    input " : ";data.no(new%)
next i%
return :rem ** End of replace lines **

160 rem ***** Delete lines *****
if lin3% >= tot.inst% then \
    return
if lin3% = 0 then \
    return
if lin3% = 1 then \
    data.no(lin1%) = delete.data : \
    return
for i% = 1 to lin3%
    new% = lin1% + i% - 1
    data.no(new%) = delete.data
next i%
count% = 0
i% = 0
while data.no(i%) <> end.data
    i% = i% + 1
    if data.no(i%) = delete.data \
        then count% = count% + 1 \
        else new% = i% - count% : \
             data.no(new%) = data.no(i%)
wend
return :rem ** End of delete lines **

165 rem ***** Insert lines *****
lin2% = lin1%
if lin3% = 1 or lin3% = 0 then \
    gosub 147 : \ rem place line
    print :print :print : \
    print "Line ";lin1%; : \
    input " : ";data.no(lin1%) : \
    return
top% = 0
while data.no(top%) <> end.data
    top% = top% + 1
wend
room% = tot.inst% - top%
if lin3% > room% then \
    print "There are too many items of data to insert a block" : \
    print "of ";lin3%;".There are only ";room%;" lines left." : \
    print "Type any character to continiue : " : \
    dummy% = conchar% : \
    return
top% = top% + 1
while top% > lin2%
    top% = top% - 1
    new% = top% + lin3% 
    data.no(new%) = data.no(top%)
wend
for i% = 1 to lin3%
    new% = lin2% + i% - 1
    print "Line ";new%;
    input " : ";data.no(new%)
next i%
return :rem ** End of insert lines **

190 rem ***** Print buffer *****
top% = 0
while data.no(top%) <> end.data
    top% = top% + 1
wend
print "There are ";top%;" lines in the buffer."
print
opt% = 0
while opt% < 1 or opt% > 4
    print "    OPTIONS."
    print
    print "  1 : Print the whole buffer with page ejects."
    print 
    print "  2 : Print the whole buffer without page ejects."
    print
    print "  3 : Print part of buffer with page ejects."
    print
    print "  4 : Print part of buffer without page ejects."
    print
    input "     Type in option number : ";opt%
wend
option% = opt%
while option% > 2
    option% = 1
    print "Specify the first and last line numbers to be printed :-"
    print
    input "First : ";lin1%
    input "Last  : ";lin2%
    if lin1% > = lin2% then \
        option% = 3
    if lin2% > top% then \
        option% = 3
    if lin1% < 1 then \
        option% = 3
wend
if opt% = 1 or opt% = 3 \
    then option% = 1 \
    else option% = 2
lprinter
print :print :print
j% = 1
for i% = lin1% to lin2%
    if option% = 1 and (j% * 60) = i% then \
        j% = j% + 1 : \
        print :print :print : \
        print :print :print
    d$ = str$(i%)
    l% = len(d$)
    if l% = 1 then \
        print "    ";
    if l% = 2 then \
        print "   ";
    if l% = 3 then \
        print "  ";
    print d$;" : ";data.no(i%)
next i%
while option% = 1 and (j% * 60) <> i%
    print
    i% = i% + 1
wend
if option% = 1 then \
    print :print :print : \
    print
console
return :rem ** End of print buffer **

200 rem ***** Clear buffer *****
for i% = 1 to tot.inst%
    data.no(i%) = blank.data
next i%
data.no(1) = end.data
return :rem ** End of clear buffer **
 
9000 rem ***** Form display picture *****
if display = delete.data then \
    print using "###/../" ;disp%," : " : \
    return
if display = 0 then \ rem integer
    print using pic2$;disp%," : ",display : \
    return
if abs(display) > 9999999999999  or abs(display) < 1.0E-2 \
    then print using pic0$; disp%," : ",display :  \
    return
dd$ = str$(display)
p% = match(".",dd$,1)
if p% = 0 then \ rem integer
    print using pic2$;disp%," : ",display : \
    return
print using pic1$;disp%," : ",display
return :rem ** End of form display picture **
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1$9999999999999$1.0E-2$* y    ~ ~~  ~~~~~~~~~~   ~6 АААRААRЂ###/....../#.############^^- Ђ###/../#,###,###,###,###.############- Ђ###/../#,###,###,###,###- А $d4Ђ  Ђ     ЂЂ6 §АЂА
7 ІЂАА6 љЂАЂЂ d4d4            Editor. $d4           ********* $d4d4d4ЂED АED 7Я# n;Ђ1'Ђ АsЂ!YES А I 75Ђ!NO зА S 7IЂ!NO ›А T 7]Ђ!NO ЩА L 7qЂ!NO 	їА P 7…Ђ!NO ›А C 7™Ђ!NO ћА E 7іЂ!NO ЂEXIT А!YES 7ЬCOMMAND NOT RECOGNISED ! $d46 юPROG yЂ"Ђ А"АЂ!А7Ђ"А"Ђ6мЂ#АА"There is room for  $А#p# more lines. $d4Type in line number where text is to be inserted :  n;Ђ$":'А$А"7ѓЂ$А"А $d4Ђ%А$Ђ&  Ђ$А$ЂА&# 7Ђ$А$ЂА$А#7зBUFFER FULL : Insertion terminated. $d4Ђ&# 6чА$p#d : n;Ђ&1'А&# 7А$АЂ!А&X6›Ђ'А$А%Ђ(А"А%ЂЂ"А"ЂЂЂ6?А(ЂА
7bЂ"А"ЂЂ)А"А'А)АЂ!А"АЂ!62ЂЂ 6zА'ЂЂА
7•Ђ)А%АА)АЂ!А)АЂ!6jА $d4
]АЂ ЂЂЂЂkЂЂ ААЂ!А7ХЂАЂЂ&ААЂ!+?6®Ђ@А $d4d4d4Each page typed is 20 lines at 2 numbers per line $d4d4The bottom 3 lines are used for typing editor commmands. $d4d4Type in the line number where display is to start :  n;Ђ$":'­Ђ*ED А*ED 7¬Ђ+NOT BULK ЂЂЂЂ $                          $d4ЂЂЂЂ $dCOMMAND :  n;Ђ1'Ђ,АsЂ-NOT FOUND ЂЂЂЂ
 $                                          $d4А,P 7vЂ$А$Ђ(Ђ-FOUND ­А,-P 7–Ђ$А$Ђ)Ђ-FOUND ­B А,Ђ\Ђ 7ґЂ+BULK Ў­T А,Ђ\Ђ 7ШЂ$А,XA:Ђ-FOUND ­D А,Ђ\Ђ А+BULK 7Ђ.А,XA:Ђ-FOUND А.АЂ!А	eR А,Ђ\Ђ А+BULK 7ѓЂЂЂЂ $                             $d4Ђ.А,XA:Ђ-FOUND ЂЂЂЂ $                            $d4ЂЂЂЂ $А.p# :  $А.АЂ!# :  $dType in replacement data. $d4А.p#d : n;А.АЂ!"'ЂЂЂЂ $                                 $d                                 $d4                                                $d4	eА,E 7ҐЂ*STOP А $d4Ђ-FOUND А,C 7їЂ-FOUND љ­I А,Ђ\Ђ А+BULK 7сЂ.А,XA:Ђ-FOUND с­S А,Ђ\Ђ А+BULK 7iЂ.А,XA:Ђ/S А,Ђ\Ђ0А,TЂ1# А,Ђ\Ђ2А,XA:Ђ3А2АЂ!А2АЂ!А.АЂ!А.АЂ!А3Ђ-FOUND ­А-FOUND 7©ЂЂЂЂ
 $ERROR *** COMMAND NOT FOUND *** $d46ЎА$Ђ7»Ђ$ЂЂ"ЂА"АЂ!А7ЪЂ"А"Ђ6АА $d4ЂЂ6фЂЂА
7	dЂАЂЂ $dЂ2А$АЂЂ.А$АЂА2А"7	#Ђ4А2Ђ5А2АЂ!ЛА.А"7	aЂАЂЂ) $dЂ4А.Ђ5А.АЂ!Л6зЂ6А.А$ЂА6Ђ7	ЊЂ7ЂА6ЂЂ 6	џЂ7ЂА6ЂЂЂ) А7$А$d4А7$dЂ4А.Ђ5А.АЂ!Л
]АЂ ЂЂЂЂjЂЂ ААЂ!А7	щЂАЂЂ&ААЂ!)>6	ТЂ8АЂЂА86
АЂА
7
#ААЂ!А6
	Data file loaded is  $А8Ђp# instructions long. $d4Ђ@А $d4d4d4d4All disc files used by this program to store data files have $d4ambiguous filenames of '.DAT'. $d4d4Only the unambiguous part therefore needs to be specified $d4in the form 'test@' where @ is carriage return. $d4This will be interpreted as 'TEST.DAT'. $d4d4d4Type in filename :  n;Ђ1'ЂА.DAT 2Ђ9Ђ ЂЂ ААЂ!А7рЂАЂААЂ!А7ХЂ9А9Ђ6нЂ)АА9А)АЂ!ААЂ!6¤А.ЂА.А7ALine number beyond range $d4Type any key to continue: $d4Ђ:xЂА.ААЂ!АААЂ!ААА7tЂАЂ6FАА7ОToo many data elements to add more. $d4Type any character to continue: $d4Ђ:xААЂ!А7еЂАЂАА.7АЂАЂ!ААЂ!ЂАЂ6еЂЂЂЂ $                                    $d4ЂЂЂЂ
 $dА.p# :  $А.АЂ!# : Type in new item of data :  $d4А.p# :  $dЂ n;А.АЂ!"'Ђ.Ђ Ђ2А,XA:А2Ђ 7ёЂ/B А,Ђ\Ђ0А,TЂ1# А,А/\А1Ђ 7ЮЂ;А,А0А1ЂVXA:Ђ/: А,А1\А/Ђ 7Ђ/А0ЂЂ1# А,А/\А1Ђ 70Ђ.А,А0А1ЂVXA:C А,Ђ\Ђ 7MЂ-FOUND ВM А,Ђ\Ђ 7jЂ-FOUND _R А,Ђ\Ђ 7‡Ђ-FOUND йD А,Ђ\Ђ 7¤Ђ-FOUND wI А,Ђ\Ђ 7БЂ-FOUND #А;ЂА;Ђ 7жEА.АЂ!А2АЂ!Ђ"Ђ А"АЂ!А7Ђ"А"Ђ6лЂ#АА"А;А#7ЄThere are too many items of data to insert a block $d4of  $А;p#.There are only  $А#p# lines left. $d4Type any character to continue :  $d4Ђ:xЂЂ6їА;ЂА
7ЭЂ<А2АЂААЂ!А<АЂ!6ІЂ"А"ЂА"А.7Ђ"А"ЂЂ)А"А;А)АЂ!А"АЂ!6еЂЂ6&А;ЂА
7DЂ)А.АЂА)АЂ!ААЂ!6А.ЂА.А7–Line number beyond range. $d4Type any key to continue. $d4Ђ:xЂА.ААЂ!АААЂ!ААА7ЙЂАЂ6›АА7 Too many items of data to insert more. $d4Type any key to continue. $d4Ђ:xААЂ!А77ЂАЂАА.7^АЂАЂ!ААЂ!ЂАЂ67А.Ђ 7iА;АЂ7vЂ/А.А2А/Ђ А;А/7вd4d4Error move is within move block. $d4Type any character to continue :  $d4Ђ:xЂЂ6чА;ЂА
7Ђ=А2АЂААЂ!А=АЂ!6кА2А.7$[6'ҐЂЂ6<А;ЂА
7ZЂ)А.АЂА)АЂ!ААЂ!6/Ђ/А.А2ЂЂ6xА/ЂА
7¤Ђ=А2АА;ЂЂ)А2АЂА)АЂ!А=АЂ!6kЂ/А2А.ЂЂ6ВА/ЂА
7иЂ=А2АЂ)А2АА;А)АЂ!А=АЂ!6µА;АЂ7цА;Ђ 7 А;Ђ7.d4d4d4Line  $А2p#d :  n;А2АЂ!"'d4d4d4ЂЂ6IА;ЂА
7vЂ)А2АЂ Line  $А)p#d :  n;А)АЂ!"'6<А;А7ЃА;Ђ 7‹А;Ђ7џА2АЂ!АЂЂ6ґА;ЂА
7МЂ)А2АЂА)АЂ!А6§Ђ9Ђ ЂЂ ААЂ!А7"ЂАЂААЂ!А7Ђ9А9Ђ6Ђ)АА9А)АЂ!ААЂ!6ЦЂ.А2А;ЂА;Ђ 7`Ed4d4d4Line  $А2p#d :  n;А2АЂ!"'Ђ"Ђ А"АЂ!А7Ђ"А"Ђ6eЂ#АА"А;А#7%There are too many items of data to insert a block $d4of  $А;p#.There are only  $А#p# lines left. $d4Type any character to continiue :  $d4Ђ:xЂ"А"ЂА"А.7YЂ"А"ЂЂ)А"А;А)АЂ!А"АЂ!6-ЂЂ6nА;ЂА
7љЂ)А.АЂLine  $А)p#d :  n;А)АЂ!"'6aЂ"Ђ А"АЂ!А7єЂ"А"Ђ6 There are  $А"p# lines in the buffer. $d4d4Ђ>Ђ А>ЂА>Ђ7    OPTIONS. $d4d4  1 : Print the whole buffer with page ejects. $d4d4  2 : Print the whole buffer without page ejects. $d4d4  3 : Print part of buffer with page ejects. $d4d4  4 : Print part of buffer without page ejects. $d4d4     Type in option number :  n;Ђ>":'6мЂ?А>А?Ђ7ІЂ?ЂSpecify the first and last line numbers to be printed :- $d4d4First :  n;Ђ2":'Last  :  n;Ђ.":'А2А.7“Ђ?ЂА.А"7ЎЂ?ЂА2Ђ7ЇЂ?Ђ6А>ЂА>Ђ7КЂ?Ђ6ПЂ?Ђfd4d4d4Ђ@ЂЂА26рА.ЂА
7kА?ЂА@Ђ<А7Ђ@А@Ђd4d4d4d4d4d4ЂAАpWЂ<АATА<Ђ75     $dА<Ђ7E    $dА<Ђ7T   $dАA$ :  $ААЂ!#d46гА?ЂА@Ђ<А7‹d4ЂАЂ6kА?Ђ7њd4d4d4d4gЂЂ6іАЂА
7АААЂ!А6¦ЂАЂ!АА5А7м###/../ cА4p#5 :  $d4А5Ђ p7АcА4p#5 :  $5А5#d4А5A. А5A. 74АcА4p#5 :  $5А5#d4ЂBА5WЂ/. АBЂ\А/Ђ 7cАcА4p#5 :  $5А5#d4АcА4p#5 :  $5А5#d4Ђ   3 : Print part of buffer with page ejects. $d4d4  4 : Prinееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееcommon clear$,cursor$,c.offset%
common tot.inst%,length%,data.no(1),object$(1)
common instruction$(1),register(1)
common print.flag$,res.flag$,dat.flag$
common comp.flag$,f1$,f2$,f3$
common f4$,f5$
common end.data,delete.data,blank.data
rem :******************************************************************
rem :
rem :  Copyright (c) 1981 by Electronic Accounting Services.
rem :
rem :******************************************************************
print clear$
print :print :print :print
print "         INITIALISING VARIABLES."
tot.inst% = 400
length% = 35
print.flag$ = "NO"
res.flag$ = "NO"
dat.flag$ = "NO"
end.data = 9E61
delete.data = 1E61
blank.data = 2E61
dim data.no(401),instruction$(401)
dim object$(401),register(222)
for i% = 1 to 400
    instruction$(i%) = "X"
    data.no(i%) = blank.data
next i%
instruction$(1) = "END"
data.no(1) = end.data
chain "PROG"
stop
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1$9E61$1E61$2E61$*   Щ   °  ~ ~~  ~~~~~~~~~~   ~А $d4d4d4d4d4         INITIALISING VARIABLES. $d4ЂЃђЂЂ#Ђ	NO 2Ђ
NO 2ЂNO 2Ђ. Ђ. Ђ. ЂЃ‘Ђ ЂЃ‘Ђ ЂЃ‘Ђ ЂЂЮЂ ЂЂ6 џЃђЂА
7 ёААЂ!X 2ААЂ!А6 ’ЂАЂ!END 2ЂАЂ!АPROG yЂ able calculator. $d4d4 3 : Exit program. $d4d4d4ЂЂАЂАЂ7VType in option number :  n;Ђzer
42.21	1K	START.COM	COM of above
42.22	2K	T.ASM		(3) Print time on..
42.23	1K	T.COM		    ..console
42.24	3K	TIME.ASM	(3) ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;     COPYRIGHT (c) 1981 ELECTRONIC ACCOUNTING SERVICES.
;PROGRAM TO READ A FILE AND SEND IT TO THE LIST DEVICE AFTER
;EXPANDING TABS TO EVERY EIGTH COLUMN.
;OUTPUT TO BE PAGINATED ON THE THE BASIS OF 60 LINES OF TEXT
;PER PAGE FOLLOWED BY 6 BLANK LINES.
;THE PROGRAM AS IT STANDS USES A BUFFER OF 16K THIS MAY HOWEVER
;BY CHANGING THE APPROPRIATE EQUATES.
;
;
BDOS	EQU	0005H		;BDOS ENTRY POINT
TPA	EQU	0100H		;BASE OF TPA
DMA	EQU	1100H		;ADDRESS FOR DIRECT MEMORY ACCESS
TCOUNT	EQU	10B0H		;LOCATION OF TAB COUNTER
LCOUNT	EQU	10C0H		;LOCATION OF LINE COUNTER
STACK	EQU	1050H		;USER STACK AREA
FCB	EQU	005CH		;ADDRESS OF FILE CONTROL BLOCK 1
SECTOR	EQU	128		;NUMBER OF BYTES IN SECTOR
NSECT	EQU	128		;NUMBER OF SECTORS IN BUFFER
SDMA	EQU	1AH		;BDOS FUNCTION 26
OPEN	EQU	0FH		;BDOS FUNCTION 15
READ	EQU	14H		;BDOS FUNCTION 20
LIST	EQU	05H		;BDOS FUNCTION 5
CONSTAT	EQU	06H		;BDOS FUNCTION 6
CLOSE	EQU	10H		;BDOS FUNCTION 16
EOF	EQU	1AH		;CPM END OF FILE (^Z)
TAB	EQU	09H		;TAB ASCII CONTROL I
CR	EQU	13		;ASCII CARRIAGE RETURN
LF	EQU	10		;ASCII LINE FEED
FF	EQU	0CH		;ASCII FORM FEED
SPACE	EQU	20H		;ASCII SPACE
;
;
;
	ORG	TPA
	LXI	SP,STACK	;SET LOCAL STACK AREA
	MVI	A,00H
	STA	TCOUNT		;INITIALISE TAB COUNTER
	STA	LCOUNT		;INITIALISE LINE COUNTER
;
;OPEN FILE SPECIFIED IN COMMAND LINE
;
OPEN1	LXI	D,FCB
	MVI	C,OPEN
	CALL	BDOS		;FUNCTION 15
	CPI	0FFH
	JZ	ABORT		;IF NO MATCH ABORT
	MVI	B,00H		;LOAD COUNT WITH ZERO
SDMA1	LXI	D,DMA
	PUSH	D		;SAVE DMA ADDRESS ON STACK
	MVI	C,SDMA
	CALL	BDOS		;FUNCTION 26
;
;READ OPENED FILE INTO 16K BUFFER
;
READ1	INR	B
	PUSH	B		;SAVE SECTOR COUNT ON STACK
	LXI	D,FCB
	MVI	C,READ
	CALL	BDOS		;FUNCTION 20
	CPI	00H
	JNZ	FLAG		;IF REAL END OF FILE JUMP OUT OF LOOP
SDMA2	POP	B
	POP	H		;GET PRESENT ADDRESS FOR DMA
	MVI	E,SECTOR	;LOAD SECTOR SIZE INTO LO BYTE OF DE
	MVI	D,00H		;LOAD ZERO INTO HI BYTE OF DE
	DAD	D		;ADD SECTOR OFFSET TO CURRENT DMA
	PUSH	H		;SAVE NEW DMA ADDRESS ON STACK
	PUSH	B
	XCHG			;SWAP REGISTERS HL AND DE
	MVI	C,SDMA
	CALL	BDOS		;FUNCTION 26
	POP	B		;GET PRESENT VALUE OF COUNT FROM STACK
	MOV	A,B
	CPI	NSECT
	JNZ	READ1		;IF = NUMBER OF SECTORS LOOP
	JMP	COMPAR
FLAG	POP	B		;GET COUNT FROM STACK
	DCR	B		;DECREMENT COUNT AS REAL EOF
;
;SEND 16K BUFFER TO LIST DEVICE
;
COMPAR	PUSH	B		;SAVE COUNT ON STACK
	LXI	H,DMA		;HL-START OF DATA BLOCK
LOOP2	MVI	D,SECTOR	;COUNT FOR INNER LOOP
LOOP1	MOV	A,M		;GET BYTE
	ANI	7FH		;SET BIT 7 TO 0
	CPI	EOF
	JZ	CLOSE1		;IF CPM EOF CLOSE FILE
	CALL	LCHAR		;SEND CHARACTER TO LIST DEVICE
COUNT	INX	H
	DCR	D
	JNZ	LOOP1		;INNER LOOP
	DCR	B
	JNZ	LOOP2		;OUTER LOOP
	POP	B		;LOAD CONTINUE FLAG
	MOV	A,B
	CPI	NSECT
	JZ	SDMA1		;IF NOT REAL EOF LOOP BACK FOR NEW BLOK
CLOSE1	LXI	D,FCB
	MVI	C,CLOSE
	CALL	BDOS		;FUNCTION 16
ABORT	NOP
	JMP	0000H		;RETURN TO CPM
;
;SEND CHARACTER TO LIST DEVICE.SETTING LINE AND TAB COUNTERS AS
;APPROPRIATE AND EXPANDING TABS AND FORM FEEDS WHERE NECESSARY.
;
LCHAR	NOP
	PUSH	A
	PUSH	B
	PUSH	D
	PUSH	H		;SAVE ALL REGISTERS ON STACK
	CPI	FF
	JNZ	NFF
	CALL	FFEED		;FORM FEED CHARACTER
	POP	H
	POP	D
	POP	B
	POP	A		;RESTORE REGISTERS FROM STACK
	RET
NFF	CPI	CR
	JNZ	NOTCR
	CALL	LIST1		;SEND CARRIAGE RETURN
	MVI	E,0FFH
	MVI	C,CONSTAT	;CHECK IF KEY PRESSED
	CALL	BDOS
	CPI	00H
	JNZ	CLOSE1		;IF KEY PRESSED ABORT
	MVI	A,00H
	STA	TCOUNT		;SET TAB COUNT TO ZERO
	LDA	LCOUNT
	INR	A		;INCREASE LINE COUNT
	CPI	61
	JNZ	NOTFF
	MVI	B,6		;SET COUNTER TO 6
LOOP3	PUSH	B
	MVI	A,LF		;SEND 6 LINE FEEDS TO LIST DEVICE
	CALL	LIST1
	POP	B
	DCR	B
	JNZ	LOOP3
	MVI	A,00H
NOTFF	STA	LCOUNT		;SET LINE COUNT
	POP	H
	POP	D
	POP	B
	POP	A		;RESTORE ALL REGISTERS FROM STACK
	RET
NOTCR	CPI	TAB
	JNZ	NOTAB
	CALL	ETAB		;EXPAND TABS TO EVERY 8TH COLUMN
	POP	H
	POP	D
	POP	B
	POP	A		;RESTORE ALL REGISTERS FROM STACK
	RET
NOTAB	CALL	LIST1		;SEND CHARACTER TO LIST DEVICE
	LDA	TCOUNT		;GET TAB COUNTER
	INR	A		;INCREMENT TAB COUNTER
	CPI	08H
	JNZ	NZTAB
	MVI	A,00H		;SET TAB COUNTER TO ZERO
NZTAB	STA	TCOUNT
	POP	H
	POP	D
	POP	B
	POP	A		;RESTORE ALL REGISTERS FROM STACK
	RET
LIST1	MOV	E,A
	MVI	C,LIST		;SEND CHARACTER TO LIST DEVICE
	CALL	BDOS
	RET
ETAB	LDA	TCOUNT		;TAB COUNTER TO ACCUMULATOR
	MOV	B,A
	MVI	A,08H
	SUB	B
	RZ
	MOV	B,A		;SET SPACE COUNTER IN REG B
LOOP4	PUSH	B
	MVI	A,SPACE
	CALL	LIST1		;SEND SPACES TO LIST DEVICE
	POP	B
	DCR	B
	JNZ	LOOP4
	MVI	A,00H
	STA	TCOUNT		;RESET TAB COUNTER TO ZERO
	RET
FFEED	LDA	LCOUNT		;LINE COUNTER TO ACCUMULATOR
	MOV	B,A
	MVI	A,42H		;LOAD ACCUMULATOR WITH 66
	SUB	B
	RZ
	MOV	B,A		;SET LINE FEED COUNTER IN REG B
LOOP5	PUSH	B
	MVI	A,LF
	CALL	LIST1		;SEND LINE FEEDS TO LIST DEVICE
	POP	B
	DCR	B
	JNZ	LOOP5
	MVI	A,00H
	STA	LCOUNT
	RET
ЂЂЂ $А0$d4АDEGREES 75Ђ>А/. 6:Ђ>А/Ђ JЂ АЂ!А5‘Ђ АЂ!А/А3‘Ђ АЂ!А/N‘Ђ АЂ!А/K‘Ђ АЂ!А/яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1P> 2°2А\ Н юяКv  ХН Е\ Н ю ВKБбЂ еЕлН БxюЂВ#ГMБЕ! Ђ~жюКnНz#ВSВQБxюЂК\ Н  Г   хЕХеюВЊН	бСБсЙюВЕНияН ю Вn> 2°:А<ю=ВЅЕ>
НиБВ°> 2АбСБсЙю	ВТНпбСБсЙНи:°<юВа> 2°бСБсЙ_Н Й:°G>ђИGЕ> НиБВш> 2°Й:АG>BђИGЕ>
НиБВ> 2АЙ                                                                                              ':TR:'	;TELETYPE READER
	DB ':O1:'	;USER CO
	DB ':I1:'	;USER CI
	DB ':VO:'	;CRT O/P
	DB ':VI:'	;CRT I/P
	DB ':TO:'	;TELETYееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееcommon clear$,cursor$,c.offset%
common tot.inst%,length%,data.no(1),object$(1)
common instruction$(1),register(1)
common print.flag$,res.flag$,dat.flag$
common comp.flag$,f1$,f2$,f3$
common f4$,f5$
common end.data,delete.data,blank.data
rem :******************************************************************
rem :
rem :  Copyright (c) 1981 by Electronic Accounting Services.
rem :
rem :******************************************************************
clear$ = chr$(26)
cursor$ = chr$(27) + "="
c.offset% = 31
def fnc$(r%,c%) = cursor$ + chr$(r% + c.offset%) + chr$(c% + c.offset%)
print clear$
%chain 100,13000,400,900
print : print :print :print
print :print
print "                     PROGRAMMABLE CALCULATOR."
print "                    **************************"
print :print
print "    MENU."
print "   '''''''"
print :print
print " 1 : Calculator."
print
print " 2 : Programmable calculator."
print
print " 3 : Exit program."
print :print
option% = 5
while option% < 1 or option% > 3
    input "Type in option number : ";option%
wend
if option% = 1 then \
    chain "CALC"
if option% = 2 then \
    chain "INIT"
stop
END 2ЂАЂ!АPROG yЂ able calculator. $d4d4 3 : Exit program. $d4d4d4ЂЂАЂАЂ7VType in option number :  n;Ђzer
42.21	1K	START.COM	COM of above
42.22	2K	T.ASM		(3) Print time on..
42.23	1K	T.COM		    ..console
42.24	3K	TIME.ASM	(3) ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1$* d2Иђ„  ~ ~~  ~~~~~~~~~~   ~Ђ ЂR2ЂЂR= 2ЂЂ6 +АААRААRА $d4d4d4d4d4d4d4                     PROGRAMMABLE CALCULATOR. $d4                    ************************** $d4d4d4    MENU. $d4   ''''''' $d4d4d4 1 : Calculator. $d4d4 2 : Programmable calculator. $d4d4 3 : Exit program. $d4d4d4ЂЂАЂАЂ7VType in option number :  n;Ђ":'6!АЂ7fCALC yАЂ7vINIT yЂ return
if op$(i%) = "(" and exp.flag$ = "EXPECTING OPERAND" then \
    brackets% =ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееcommon clear$,cursor$,c.offset%
common tot.inst%,length%,data.no(1),object$(1)
common instruction$(1),register(1)
common print.flag$,res.flag$,dat.flag$
common comp.flag$,f1$,f2$,f3$
common f4$,f5$
common end.data,delete.data,blank.data
rem :******************************************************************
rem :
rem :  Copyright (c) 1981 by Electronic Accounting Services.
rem :
rem :******************************************************************
print clear$
def fnc$(r%,c%) = cursor$ + chr$(r% + c.offset%) + chr$(c% + c.offset%)
rem *********************************************************
rem : Programmable algabraic calculator program.
rem : Requires a terminal with clear screen
rem : plus an addressable curser.
rem *********************************************************
continue.flag$ = "CONTINUE"
while continue.flag$ = "CONTINUE"
    print clear$
    print fnc$(1,23);"Programmable Calculator : MENU."
    print fnc$(2,21);"***********************************"
    print " "
    print "  1 : Load source program.            ";
    print "  2 : Load object program."
    print " "
    print "  3 : Load data file.                 ";
    print "  4 : Echo results to printer."
    print " "
    print "  5 : Echo results to disc file.      ";
    print "  6 : Echo results to printer & disc."
    print " "
    print "  7 : Compile source program.         ";
    print "  8 : Run object program."
    print " "
    print "  9 : Edit source program.            ";
    print " 10 : Edit data file."
    print " "
    print " 11 : Reset to no echo.               ";
    print " 12 : Exit from program."
    print :print :print
    input "          Type in option number : ";option%
    if option% < 13 then \
        on option% gosub \
            105,   \  rem : load source
            110,   \  rem : load object
            160,   \  rem : load data
            130,   \  rem : printer
            140,   \  rem : disc
            150,   \  rem : printer and disc
            180,   \  rem : compile
            190,   \  rem : run
            120,   \  rem : ed program
            170,   \  rem : ed data
            200,   \  rem : reset no echo to printer or disc
            210    :  rem : stop
wend
chain "PCALC"
stop

105 rem ***** Load source code *****
print clear$
print :print :print
print "All disc files used by this program to hold programs have"
print "ambiguous filenames of '.SRC'."
print
print "Only the unambiguous part therefore needs to be specified"
print "in the form 'test@' where @ is carriage return."
print "This will be interpreted as 'TEST.SRC'."
print :print
input "Type in filename : ";f4$
f4$ = f4$ + ".SRC"
open f4$ as 4
i% = 0
while ucase$(instruction$(i%)) <> "END"
    i% = i% + 1
    if i% > tot.inst% then \
        print :print : \
        print "PROGRAM MORE THAN ";tot.inst%;" INSTRUCTIONS :-" : \
        print "          PROGRAM LOAD ABORTED !" : \
        print "Type any character to return to menu : "; : \
        dummy% = conchar% : \
        close 4 :  \
        return
    read # 4 ;instruction$(i%)
wend
n% = i% + 1
for i% = n% to tot.inst%
    instruction$(i%) = "X"
next i%
print :print
print "Program loaded is ";(n% - 1);" instructions long."
print :print
print "Type any character to continue : ";
dummy% = conchar%
close 4
return :rem ** End load source code **

110 rem ***** Load object program *****
print clear$
print :print :print
print "All disc files used by this program to hold programs have"
print "ambiguous filenames of '.OBJ'."
print
print "Only the unambiguous part therefore needs to be specified"
print "in the form 'test@' where @ is carriage return."
print "This will be interpreted as 'TEST.OBJ'."
print :print
input "Type in filename : ";f1$
f1$ = f1$ + ".OBJ"
open f1$ as 1
i% = 0
while object$(i%) <> "END1"
     i% = i% + 1
     read #1 ; object$(i%)
wend
i% = 42
read #1;register$
while register$ <> "END2"
    register(i%) = val(register$)
    i% = i% + 1
    read #1; register$
wend
close 1
return :rem ** End of load object program **

120 rem ***** Ed program *****
chain "EDITOR"
return :rem ** End of editor program **

130 rem ***** Printer *****
print.flag$ = "YES"
return :rem ** End Printer **

140 rem ***** Disc files *****
option% = 0
while option% < 1 or option% > 3
    print clear$
    print :print :print
    print "   SPECIFY THE TYPE OF DISC FILE/S."
    print
    print "   1 : Disc file to hold a data file."
    print
    print "   2 : Disc file to hold a results file."
    print
    print "   3 : Disc file (data) + disc file (results)."
    print :print
    input "      Type in option number : ";option%
    if option% = 1 then \
        gosub 144 :rem data file
    if option% = 2 then \
        gosub 142 :rem results file
    if option% = 3 then \
        gosub 144 : \ rem data file
        gosub 142 :rem results file
wend
return :rem ** End of disc files **

142 rem ***** Disc results files *****
res.flag$ = "YES"
print clear$
print :print :print
print "All disc files used by this program to store results have"
print "ambiguous filenames of '.RES'."
print
print "Only the unambiguous part therefore needs to be specified"
print "in the form 'test@' where @ is carriage return."
print "This will be interpreted as 'TEST.RES'."
print :print
input "Type in filename : ";f3$
f3$ = f3$ + ".RES"
return :rem ** End disc results files **

144 rem ***** Disc data files *****
dat.flag$ = "YES"
print clear$
print :print :print
print "All disc files used by this program to store data files have"
print "ambiguous filenames of '.DAT'."
print
print "Only the unambiguous part therefore needs to be specified"
print "in the form 'test@' where @ is carriage return."
print "This will be interpreted as 'TEST.DAT'."
print :print
input "Type in filename : ";f5$
f5$ = f5$ + ".DAT"
return :rem ** End disc data files **

150 rem ***** Printer and disc *****
gosub 130 :rem printer
gosub 140 :rem disc
return :rem ** End printer and disc **

160 rem ***** Load data *****
print clear$
print :print :print
print "All disc files used by this program to hold data files have"
print "ambiguous filenames of '.DAT'."
print
print "Only the unambiguous part therefore needs to be specified"
print "in the form 'test@' where @ is carriage return."
print "This will be interpreted as 'TEST.DAT'."
print :print
input "Type in filename : ";f2$
f2$ = f2$ + ".DAT"
open f2$ as 2
print :print
i% = 0
while data.no(i%) <> end.data
    i% = i% + 1
    read # 2 ;data.no(i%)
wend
n% = i% + 1
for i% = n% to tot.inst%
    data.no(i%) = blank.data
next i%
print "Data file loaded is ";(n% - 1);" elements long."
close 2
print :print
print "Type any character to continue : ";
dummy% = conchar%
return :rem ** End load data **

170 rem ***** Ed data *****
type.file$ = "DATA"
chain "EDITOR1"
return :rem ** End ed data **

180 rem ***** Compile *****
chain "COMPILE"
if comp.flag$ <> "ERROR" then \
    return
for i% = 1 to 200
    object$(i%) = " "
    register(i%) = 0
next i%
for i% = 201 to 400
    object$(i%) = " "
next i%
return :rem ** End of compile **

190 rem ***** Run *****
if val(object$(1)) = 0 then \
    return
chain "RUNOBJ"
return :rem ** End run **

200 rem ***** Reset echo to printer or disc *****
print.flag$ = "NO"
res.flag$ = "NO"
dat.flag$ = "NO"
return :rem ** End of reset to printer or disc **

210 rem ***** Stop *****
continue.flag$ = "STOP"
return :rem ** End of stop **
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1$* Э   р  ~ ~~  ~~~~~~~~~~   ~А $d46 АААRААRЂCONTINUE АCONTINUE 7сА $d4ЂЂЂЂ $Programmable Calculator : MENU. $d4ЂЂЂЂ $*********************************** $d4  $d4  1 : Load source program.             $d  2 : Load object program. $d4  $d4  3 : Load data file.                  $d  4 : Echo results to printer. $d4  $d4  5 : Echo results to disc file.       $d  6 : Echo results to printer & disc. $d4  $d4  7 : Compile source program.          $d  8 : Run object program. $d4  $d4  9 : Edit source program.             $d 10 : Edit data file. $d4  $d4 11 : Reset to no echo.                $d 12 : Exit from program. $d4d4d4d4          Type in option number :  n;Ђ":'АЂ7оАоbЂ^96ъ6–66P6Z6606ќ6F66№6Т6 &PCALC yА $d4d4d4d4All disc files used by this program to hold programs have $d4ambiguous filenames of '.SRC'. $d4d4Only the unambiguous part therefore needs to be specified $d4in the form 'test@' where @ is carriage return. $d4This will be interpreted as 'TEST.SRC'. $d4d4d4Type in filename :  n;Ђ1'ЂА.SRC 2АЂ ЂЂЂЂjЂЂ ААЂ!sEND 7ЂАЂАА7сd4d4PROGRAM MORE THAN  $Аp# INSTRUCTIONS :- $d4          PROGRAM LOAD ABORTED ! $d4Type any character to return to menu :  $dЂxЂ@Ђ&ААЂ!*>6CЂАЂЂА6АЂА
7-ААЂ!X 26d4d4Program loaded is  $АЂp# instructions long. $d4d4d4Type any character to continue :  $dЂxЂ@А $d4d4d4d4All disc files used by this program to hold programs have $d4ambiguous filenames of '.OBJ'. $d4d4Only the unambiguous part therefore needs to be specified $d4in the form 'test@' where @ is carriage return. $d4This will be interpreted as 'TEST.OBJ'. $d4d4d4Type in filename :  n;Ђ1'ЂА.OBJ 2АЂ ЂЂЂЂjЂЂ ААЂ!END1 7
ЂАЂЂ&ААЂ!*>6ЯЂЂ*Ђ&Ђ*>АEND2 7BААЂ!АXЂАЂЂ&Ђ*>6Ђ@EDITOR yЂ	YES 2ЂЂ АЂАЂ7€А $d4d4d4d4   SPECIFY THE TYPE OF DISC FILE/S. $d4d4   1 : Disc file to hold a data file. $d4d4   2 : Disc file to hold a results file. $d4d4   3 : Disc file (data) + disc file (results). $d4d4d4      Type in option number :  n;Ђ":'АЂ7j	МАЂ7v‰АЂ7…	М‰6_Ђ
YES 2А $d4d4d4d4All disc files used by this program to store results have $d4ambiguous filenames of '.RES'. $d4d4Only the unambiguous part therefore needs to be specified $d4in the form 'test@' where @ is carriage return. $d4This will be interpreted as 'TEST.RES'. $d4d4d4Type in filename :  n;Ђ1'ЂА.RES 2ЂYES 2А $d4d4d4d4All disc files used by this program to store data files have $d4ambiguous filenames of '.DAT'. $d4d4Only the unambiguous part therefore needs to be specified $d4in the form 'test@' where @ is carriage return. $d4This will be interpreted as 'TEST.DAT'. $d4d4d4Type in filename :  n;Ђ1'ЂА.DAT 2PZА $d4d4d4d4All disc files used by this program to hold data files have $d4ambiguous filenames of '.DAT'. $d4d4Only the unambiguous part therefore needs to be specified $d4in the form 'test@' where @ is carriage return. $d4This will be interpreted as 'TEST.DAT'. $d4d4d4Type in filename :  n;Ђ1'ЂА.DAT 2АЂ ЂЂЂЂjd4d4ЂЂ ААЂ!А7ЏЂАЂЂ&ААЂ!)>6hЂАЂЂА6¬АЂА
7№ААЂ!А6џData file loaded is  $АЂp# elements long. $d4Ђ@d4d4Type any character to continue :  $dЂxЂDATA EDITOR1 yCOMPILE yАERROR 7IЂЂ6^ЂИЂА
7xААЂ!  2ААЂ!Ђ p6QЂЂЙ6ЌЃђЂА
7њААЂ!  26ЂЂАЂ!XЂ p7ЇRUNOBJ yЂ	NO 2Ђ
NO 2ЂNO 2ЂSTOP Ђ  $d4d4d4Type in filename :  n;Ђ1'ЂА.DAT 2PZА $d4d4d4d4All disc files used by this program to hol	A,00H
	STA	LCOUNT
	RET
ЂЂЂ $А0$d4АDEGREES 75Ђ>А/. 6:Ђ>А/Ђ JЂ АЂ!А5‘Ђ АЂ!А/А3‘Ђ АЂ!А/N‘Ђ АЂ!А/K‘Ђ АЂ!А/яяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя 	                    common clear$,cursor$,c.offset%
common tot.inst%,length%,data.no(1),object$(1)
common instruction$(1),register(1)
common print.flag$,res.flag$,dat.flag$
common comp.flag$,f1$,f2$,f3$
common f4$,f5$
common end.data,delete.data,blank.data
rem :******************************************************************
rem :
rem :  Copyright (c) 1981 by Electronic Accounting Services.
rem :
rem :******************************************************************
print clear$
data.counter% = 0
blk$ = " "
pic0$ = "/...5....0....5....0...../#.###########^^-"
picture1$ = "/...5....0....5....0./#,###,###,###,###"
rem *********************************************************
rem : Run object code generated by programmable calculator
rem : Requires a terminal with clear screen
rem : plus an addressable curser.
rem *********************************************************
if res.flag$ = "YES" then \
    create f3$ as 3
if dat.flag$ = "YES" then \
    create f5$ as 5
dim reg.label$(41)
dim j%(50)
dim n%(50)
dim test.flag$(50)
dim f.reg%(50)
dim s.reg%(50)
dim sel.times%(50)
dim sel.next%(50)
dim stack%(16)
data% = 1
fix.decimals% = 11
gosub 2100 :rem set fix.decimals for i/o pictures
for i% = 1 to 40
    register(i%) = 0
next i%
register(41) = 3.141592654
k% = 1
j%(k%) = 1
i% = j%(k%)
while object$(i%) <> "END1"
    p% = val(object$(i%))
    gosub 150 :rem jump to selected subroutine
    j%(k%) = j%(k%) + 1
    i% = j%(k%)
wend
print "Program completed."
if res.flag$ = "YES" then \
    close 3
if dat.flag$ = "YES" then \
    print #5 ;end.data : \
    close 5
print "Program completed type any character to continue :"
dummy% = conchar%
chain "PROG"
stop

5 rem :^ (power)
register(temp%) = first.number ^ second.number
st% = st% - 1
return

10 rem : +
register(temp%) = first.number + second.number
st% = st% - 1
return

15 rem : -
register(temp%) = first.number - second.number
st% = st% - 1
return

20 rem : *
register(temp%) = first.number * second.number
st% = st% - 1
return

25 rem : /
register(temp%) = first.number / second.number
st% = st% - 1
return

30 rem : =
if register(sec.reg%) < 1.0E-9 and fix.decimals% >= 9 then \
    register(first.reg%) = register(sec.reg%) : \
    return
fix.decimals3 = register(sec.reg%)
rem : Set answer to required number of decimal places according
rem : to value of fix.decimals%
if fix.decimals% = 0 then \
    register(first.reg%) = float(int%(fix.decimals3)) : \
    return
fix.decimals2 = int(fix.decimals3 * fix.decimals1)
register(first.reg%) = fix.decimals2 / fix.decimals1
return

35 rem :sin
register(temp%) = sin(second.number)
return

40 rem :cos
register(temp%) = cos(second.number)
return

45 rem :tan
register(temp%) = tan(second.number)
return

50 rem :asin
if second.number = 1.0 then \
    register(temp%) = 1.570796327 : \
    return
if second.number = -1.0 then \
    register(temp%) = -1.570796327 : \
    return
if abs(second.number) > 1 then \
    print "ERROR in line : ";i%; : \
    print " Value = ";second.number;" beyond range for arcsin." : \
    register(temp%) = 0 : \
    return
tempory = second.number / (sqr(1.0 - second.number * second.number))
register(temp%) = atn(tempory)
return

55 rem :acos
if abs(second.number) = 1.0 then \
    register(temp%) = 0 : \
    return
if abs(second.number) > 1 then \
    print "ERROR in line : ";i%; : \
    print " Value = ";second.number;" beyond range for arccos." : \
    register(temp%) = 0 : \
    return
pi = 3.141592654
tempory = second.number / sqr(1.0 - second.number * second.number)
register(temp%) = pi / 2.0 - atn(tempory)
return

60 rem :atan
register(temp%) = atn(second.number)
return

65 rem :log
register(temp%) = log(second.number) / log(10)
return

70 rem :alog
if abs(second.number) > 61 then \
    print "ERROR in line : ";i%; : \
    print " Value = ";second.number;" beyond range for antilog." : \
    register(temp%) = 0 : \
    return
register(temp%) = 10 ^ second.number
return

75 rem :ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее