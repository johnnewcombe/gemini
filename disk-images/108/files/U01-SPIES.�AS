DIM A%(20,20), Q$(10)
S% = 4
G% = 10
B% = 10
DIM ARRAY$(20,20)
RANDOMIZE
PRINT TAB(20); "SPIES"
PRINT TAB(20); "====="
5 PRINT "THE OBJECT OF THIS GAME IS TO FIND";S%;" SPIES HIDDEN ON"
PRINT "A";B%;" BY";B%;" BOARD.  THE ORIGIN IS POSITION 0,0 AND YOU"
PRINT "GUESS THEIR POSITION BY TYPING CO-ORDINATES AS TWO NUMBERS"
PRINT "BETWEEN 0 AND";B%-1;" SEPARATED BY A COMMA.  THE FIRST NUMBER"
PRINT "IS THE DISTANCE TO THE RIGHT OF THE ORIGIN AND THE SECOND"
PRINT "IS THE DISTANCE ABOVE THE ORIGIN."
PRINT
PRINT "YOU GET";G%;" TRIES AND AFTER EACH TRY YOU WILL BE TOLD"
PRINT "HOW FAR YOU ARE FROM EACH REMAINING SPY."

PRINT
INPUT "TYPE 'Y' AND RETURN IF YOU UNDERSTAND";DUMMY$
IF DUMMY$ <> "Y" THEN GOTO 5
X% = 1
PRINT
10	PRINT "THE BOARD LOOKS LIKE THIS:"
PRINT
FOR N% = B%-1 TO 0 STEP -1
FOR E% = 0 TO B%-1
ARRAY$(N%,E%) = "* "
NEXT E%, N%
GOSUB 1.00E10
10.5	FOR J% = 1 TO 2
		FOR I% = 1 TO S%
		IF INT(B%*RND) = 0 THEN GOTO 10.5
		A%(I%,J%) = INT(B%*RND)
		NEXT I%
	NEXT J%

	FOR T% = 1 TO G%
		PRINT
		PRINT "TURN NUMBER";T%;". TYPE YOUR GUESS AND PRESS RETURN."
15		INPUT Y%,X%
		PRINT
		IF INT(X%+Y%)<>X%+Y% THEN GOTO 20
		IF X%>B%-1 THEN GOTO 20
		IF Y%>B%-1 THEN GOTO 20
		IF X%<0 THEN GOTO 20
		IF Y%>=0 THEN GOTO 30
20		PRINT "VALUES MUST BE NUMBERS IN THE RANGE 0 TO";B%-1;".PLEASE RETYPE."
		GOTO 15
30			FOR I% = 1 TO S%
			IF A%(I%,1) = -1 THEN  GOTO 50
			IF A%(I%,1) <> X% THEN GOTO 40
			IF A%(I%,2) <> Y% THEN GOTO 40
			A%(I%,1) = -1
			PRINT "YOU HAVE FOUND SPY";I%; : PRINT CHR$(7) : ARRAY$(X%,Y%) = "!"
			GOTO 50
40			D% = SQR((A%(I%,1)-X%)^2+(A%(I%,2)-Y%)^2)
			PRINT "YOU ARE";INT(D%*10);" UNITS FROM SPY";I%
50		NEXT I%
	PRINT "YOUR BOARD LOOKS LIKE THIS NOW (THE + IS YOUR GO):"
	GOSUB 1.00E10
		FOR J% = 1 TO S%
			IF A%(J%,1) <> -1 THEN GOTO 60
		NEXT J%
	PRINT
	PRINT "CONGRATULATIONS YOU HAVE FOUND ALL";S%;" SPIES IN";T%;" TURNS!"
	GOTO 70
60 NEXT T%

	PRINT 
	PRINT "YOU HAVE HAD THE MAXIMUM OF";G%;" TRIES. THEY WERE HIDDEN AT:"
		FOR I% = 1 TO S%
			IF A%(I%,1) = -1 THEN GOTO 65
			PRINT "SPY";I%;" (";A%(I%,2);",";A%(I%,1);" )"
65		NEXT I%
70	PRINT
	PRINT "IF YOU WOULD LIKE ANOTHER GAME TYPE 'YES' -"
	INPUT "OTHERWISE TYPE 'NO' AND TYPE RETURN";Q$
	IF Q$ = "YES" THEN GOTO 90
	IF Q$ = "NO" THEN GOTO 100
	PRINT "I DO NOT UNDERSTAND YOUR REPLY ";Q$;" PLEASE TYPE YES OR NO."
	GOTO 70

90	PRINT
	INPUT "DO YOU WANT TO CHANGE ANY OF THE NUMBERS?"; CHANGE$
	IF CHANGE$ = "YES" THEN GOSUB 150
	PRINT
	PRINT S%;" SPIES ARE NOW IN HIDING"
	T% = 0
	GOTO 10
100	PRINT :PRINT "GOODBYE"
	STOP

150	PRINT "IF YOU WOULD LIKE TO CHANGE THE BOARD SIZE"
	GOSUB 850
	IF P$ = "NO" THEN GOTO 350
225	INPUT "INPUT LENGTH OF SIDE OF NEW SQUARE";B%
	PRINT
	IF B% <= 1 THEN GOTO 225
	IF B% > 20 THEN PRINT "THE SQUARE CANNOT BE BIGGER THAN 20 X 20.":GOTO 225
	IF INT(B%) <> B% THEN GOTO 225
350	PRINT "IF YOU WOULD LIKE TO CHANGE THE NUMBER OF GOES"
	GOSUB 850
	IF P$ = "NO" THEN GOTO 525
425	INPUT "INPUT THE NUMBER OF GOES";G%
	IF G% < 1 THEN GOTO 425
	IF INT(G%) <> G% THEN GOTO 425
525	PRINT "IF YOU WOULD LIKE TO CHANGE THE NUMBER OF SPIES"
	GOSUB 850
	IF P$ = "NO" THEN RETURN
600	PRINT
625	INPUT "INPUT THE NUMBER OF SPIES";S%
	IF S% < 1 THEN GOTO 625
	IF INT(S%) <> S% THEN GOTO 625
	IF S%<= 10 THEN RETURN
	PRINT "THERE CAN BE A MAXIMUM OF 10 SPIES"
	GOTO 600

850	PRINT
	INPUT "TYPE 'YES' OR 'NO' THEN TYPE RETURN";P$
	PRINT
	IF P$ = "YES" THEN RETURN
	IF P$ = "NO" THEN RETURN
	PRINT "YOUR REPLY ";P$;" NOT UNDERSTOOD"
	GOTO 850
	RETURN

1.00E10 REM ARRAY PRINT ROUTINE

FOR N% = B%-1 TO 0 STEP -1
FOR E% = 0 TO B%-1
IF T% > 0 AND ARRAY$ = "!" THEN GOTO 1.00E20
IF T% > 0 AND A%(I%,1)<>-1 THEN ARRAY$(X%,Y%) = "+"
1.00E20	PRINT TAB(5+E%*2); ARRAY$(N%,E%);
NEXT E%
PRINT N%
NEXT N%
PRINT TAB(4);
FOR ENO% = 0 TO B%-1: PRINT USING "##"; ENO%;: NEXT ENO%
PRINT
RETURN
